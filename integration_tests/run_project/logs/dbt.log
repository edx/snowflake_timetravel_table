2021-01-27 15:11:46.320213 (MainThread): Running with dbt=0.18.0
2021-01-27 15:11:46.778110 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 15:11:46.779134 (MainThread): Tracking: tracking
2021-01-27 15:11:46.779478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a9e48eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a9e480b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a9e48588>]}
2021-01-27 15:11:46.809333 (MainThread): Partial parsing not enabled
2021-01-27 15:11:46.810392 (MainThread): Parsing macros/catalog.sql
2021-01-27 15:11:46.813215 (MainThread): Parsing macros/adapters.sql
2021-01-27 15:11:46.848486 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 15:11:46.850458 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 15:11:46.861403 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 15:11:46.863672 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 15:11:46.870383 (MainThread): Parsing macros/core.sql
2021-01-27 15:11:46.874905 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 15:11:46.877044 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 15:11:46.879032 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 15:11:46.881257 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 15:11:46.884260 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 15:11:46.894376 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 15:11:46.901166 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 15:11:46.906409 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 15:11:46.925947 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 15:11:46.928019 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 15:11:46.958645 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 15:11:46.965792 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 15:11:46.972459 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 15:11:46.974486 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 15:11:46.989168 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 15:11:47.010407 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 15:11:47.020252 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 15:11:47.022044 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 15:11:47.023099 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 15:11:47.025286 (MainThread): Parsing macros/etc/query.sql
2021-01-27 15:11:47.026338 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 15:11:47.028055 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 15:11:47.079352 (MainThread): Partial parsing not enabled
2021-01-27 15:11:47.120901 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:11:47.143644 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:11:47.313024 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- seeds.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
- seeds.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change

2021-01-27 15:11:47.345561 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 15:11:47.346167 (MainThread): 
2021-01-27 15:11:47.346498 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:11:47.349970 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 15:11:47.365268 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 15:11:47.365405 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 15:11:47.365487 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 15:11:48.049986 (ThreadPoolExecutor-0_0): subprocess 11690 is still running
2021-01-27 15:11:51.748481 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.38 seconds
2021-01-27 15:11:51.788669 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 15:11:52.083810 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:11:52.097544 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:11:52.097722 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 15:11:52.097870 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 15:11:52.759642 (ThreadPoolExecutor-1_0): subprocess 11809 is still running
2021-01-27 15:11:57.442520 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 463 in 5.34 seconds
2021-01-27 15:11:57.873158 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 15:11:58.164426 (MainThread): Using snowflake connection "master".
2021-01-27 15:11:58.164625 (MainThread): On master: BEGIN
2021-01-27 15:11:58.164738 (MainThread): Opening a new connection, currently in state init
2021-01-27 15:11:58.728901 (MainThread): subprocess 11908 is still running
2021-01-27 15:12:02.441992 (MainThread): SQL status: SUCCESS 1 in 4.28 seconds
2021-01-27 15:12:02.443069 (MainThread): On master: COMMIT
2021-01-27 15:12:02.444086 (MainThread): Using snowflake connection "master".
2021-01-27 15:12:02.444533 (MainThread): On master: COMMIT
2021-01-27 15:12:02.710473 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 15:12:02.711488 (MainThread): On master: Close
2021-01-27 15:12:02.993861 (MainThread): 10:12:02 | Concurrency: 1 threads (target='snowflake')
2021-01-27 15:12:02.994692 (MainThread): 10:12:02 | 
2021-01-27 15:12:02.998502 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:12:03.002384 (Thread-1): 10:12:03 | 1 of 2 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_changed [RUN]
2021-01-27 15:12:03.003094 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:12:03.003404 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:12:03.032110 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"
2021-01-27 15:12:03.032589 (Thread-1): finished collecting timing info
2021-01-27 15:12:03.078708 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:12:03.078882 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"} */
drop table if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_CHANGED" cascade
2021-01-27 15:12:03.078978 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 15:12:03.687621 (Thread-1): subprocess 12012 is still running
2021-01-27 15:12:07.647968 (Thread-1): SQL status: SUCCESS 1 in 4.57 seconds
2021-01-27 15:12:07.679508 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"
2021-01-27 15:12:07.680857 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:12:07.681012 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: BEGIN
2021-01-27 15:12:07.915614 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 15:12:07.916260 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:12:07.916674 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_changed  as (
    -- col1,col2,col3
-- 1,foo,bar
-- 2,bin,baz

select 1
  );
2021-01-27 15:12:08.210780 (Thread-1): Snowflake query id: 0199e450-0555-50e9-0000-44a938955072
2021-01-27 15:12:08.211661 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-01-27 15:12:08.213269 (Thread-1): finished collecting timing info
2021-01-27 15:12:08.217420 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: ROLLBACK
2021-01-27 15:12:08.617771 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: Close
2021-01-27 15:12:08.885138 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_changed (models/snowflake_timetravel_table_integration_tests_columns_changed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_changed (models/snowflake_timetravel_table_integration_tests_columns_changed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_changed.sql
2021-01-27 15:12:08.905434 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd674d413-700e-451c-b036-81e18d7d5b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a80e67b8>]}
2021-01-27 15:12:08.911593 (Thread-1): 10:12:08 | 1 of 2 ERROR creating view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_changed [ERROR in 5.90s]
2021-01-27 15:12:08.912232 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:12:08.912619 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:12:08.915062 (Thread-1): 10:12:08 | 2 of 2 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 15:12:08.916387 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:12:08.916712 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:12:08.928191 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 15:12:08.928511 (Thread-1): finished collecting timing info
2021-01-27 15:12:08.942418 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:12:08.942708 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop table if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE" cascade
2021-01-27 15:12:08.942890 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 15:12:09.616921 (Thread-1): subprocess 12111 is still running
2021-01-27 15:12:13.359434 (Thread-1): SQL status: SUCCESS 1 in 4.42 seconds
2021-01-27 15:12:13.375813 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 15:12:13.380279 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:12:13.380867 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 15:12:13.651976 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 15:12:13.652941 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:12:13.653420 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as (
    -- col1,col2,col3
-- 1,foo,bar
-- 2,bin,baz

select 1
  );
2021-01-27 15:12:13.970459 (Thread-1): Snowflake query id: 0199e450-055b-a873-0000-44a938954146
2021-01-27 15:12:13.970647 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-01-27 15:12:13.970960 (Thread-1): finished collecting timing info
2021-01-27 15:12:13.971610 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-27 15:12:14.266758 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 15:12:14.528522 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 15:12:14.532258 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd674d413-700e-451c-b036-81e18d7d5b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a2569b70>]}
2021-01-27 15:12:14.542070 (Thread-1): 10:12:14 | 2 of 2 ERROR creating view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.62s]
2021-01-27 15:12:14.543096 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:12:14.560060 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:12:14.561446 (MainThread): Using snowflake connection "master".
2021-01-27 15:12:14.561965 (MainThread): On master: BEGIN
2021-01-27 15:12:14.562519 (MainThread): Opening a new connection, currently in state closed
2021-01-27 15:12:15.174331 (MainThread): subprocess 12214 is still running
2021-01-27 15:12:18.806940 (MainThread): SQL status: SUCCESS 1 in 4.24 seconds
2021-01-27 15:12:18.808287 (MainThread): On master: COMMIT
2021-01-27 15:12:18.809953 (MainThread): Using snowflake connection "master".
2021-01-27 15:12:18.810562 (MainThread): On master: COMMIT
2021-01-27 15:12:19.083619 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 15:12:19.084630 (MainThread): On master: Close
2021-01-27 15:12:19.402302 (MainThread): 10:12:19 | 
2021-01-27 15:12:19.403054 (MainThread): 10:12:19 | Finished running 2 view models in 32.06s.
2021-01-27 15:12:19.403561 (MainThread): Connection 'master' was properly closed.
2021-01-27 15:12:19.403926 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 15:12:19.420635 (MainThread): 
2021-01-27 15:12:19.420866 (MainThread): Completed with 2 errors and 0 warnings:
2021-01-27 15:12:19.421004 (MainThread): 
2021-01-27 15:12:19.421142 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_changed (models/snowflake_timetravel_table_integration_tests_columns_changed.sql)
2021-01-27 15:12:19.421237 (MainThread):   002022 (42601): SQL compilation error:
2021-01-27 15:12:19.421320 (MainThread):   Missing column specification
2021-01-27 15:12:19.421398 (MainThread):   compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_changed.sql
2021-01-27 15:12:19.421482 (MainThread): 
2021-01-27 15:12:19.421585 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 15:12:19.421673 (MainThread):   002022 (42601): SQL compilation error:
2021-01-27 15:12:19.421749 (MainThread):   Missing column specification
2021-01-27 15:12:19.421824 (MainThread):   compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 15:12:19.421919 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
2021-01-27 15:12:19.422144 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a80e9b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a80a4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8a3db7e48>]}
2021-01-27 15:12:19.422419 (MainThread): Flushing usage events
2021-01-27 15:24:57.994610 (MainThread): Running with dbt=0.18.0
2021-01-27 15:24:58.448333 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 15:24:58.449216 (MainThread): Tracking: tracking
2021-01-27 15:24:58.449570 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd42148ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd421486d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd42148208>]}
2021-01-27 15:24:58.483348 (MainThread): Partial parsing not enabled
2021-01-27 15:24:58.484904 (MainThread): Parsing macros/catalog.sql
2021-01-27 15:24:58.488245 (MainThread): Parsing macros/adapters.sql
2021-01-27 15:24:58.526211 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 15:24:58.528026 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 15:24:58.538646 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 15:24:58.540989 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 15:24:58.546042 (MainThread): Parsing macros/core.sql
2021-01-27 15:24:58.550131 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 15:24:58.552088 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 15:24:58.553764 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 15:24:58.555818 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 15:24:58.558828 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 15:24:58.568651 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 15:24:58.575445 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 15:24:58.580900 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 15:24:58.600213 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 15:24:58.602150 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 15:24:58.633343 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 15:24:58.640334 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 15:24:58.646655 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 15:24:58.648667 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 15:24:58.663678 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 15:24:58.685759 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 15:24:58.695035 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 15:24:58.696758 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 15:24:58.697829 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 15:24:58.700054 (MainThread): Parsing macros/etc/query.sql
2021-01-27 15:24:58.701121 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 15:24:58.702951 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 15:24:58.755818 (MainThread): Partial parsing not enabled
2021-01-27 15:24:58.796899 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:24:58.817488 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:24:58.834464 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd41ff7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd41fa83c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd41fa8668>]}
2021-01-27 15:24:58.834723 (MainThread): Flushing usage events
2021-01-27 15:24:59.451986 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 15:24:59.454419 (MainThread): Encountered an error:
2021-01-27 15:24:59.455022 (MainThread): Compilation Error
  Invalid models config given in models/snowflake_timetravel_table_integration_tests_columns_changed.yml @ models: {'name': 'snowflake_timetravel_table_integration_tests_columns_changed.yml', 'description': None, 'columns': [{'name': 'col1'}, {'name': 'col2renamed'}, {'name': 'col3'}], 'original_file_path': 'models/snowflake_timetravel_table_integration_tests_columns_changed.yml', 'yaml_key': 'models', 'package_name': 'snowflake_timetravel_table_integration_tests'} - at path ['description']: None is not of type 'string'
2021-01-27 15:24:59.465182 (MainThread): jsonschema.exceptions.ValidationError: None is not of type 'string'

Failed validating 'type' in schema['properties']['description']:
    {'default': '', 'type': 'string'}

On instance['description']:
    None

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/schemas.py", line 695, in get_unparsed_target
    model = self._target_type().from_dict(data)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/contracts/util.py", line 64, in from_dict
    self = super().from_dict(data=data, validate=validate)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/hologram/__init__.py", line 618, in from_dict
    cls.validate(data)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/hologram/__init__.py", line 961, in validate
    raise ValidationError.create_from(error) from error
hologram.ValidationError: None is not of type 'string'

Failed validating 'type' in schema['properties']['description']:
    {'default': '', 'type': 'string'}

On instance['description']:
    None

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 348, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/schemas.py", line 536, in parse_file
    for test_block in parser.parse():
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/schemas.py", line 674, in parse
    for node in self.get_unparsed_target():
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/schemas.py", line 698, in get_unparsed_target
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid models config given in models/snowflake_timetravel_table_integration_tests_columns_changed.yml @ models: {'name': 'snowflake_timetravel_table_integration_tests_columns_changed.yml', 'description': None, 'columns': [{'name': 'col1'}, {'name': 'col2renamed'}, {'name': 'col3'}], 'original_file_path': 'models/snowflake_timetravel_table_integration_tests_columns_changed.yml', 'yaml_key': 'models', 'package_name': 'snowflake_timetravel_table_integration_tests'} - at path ['description']: None is not of type 'string'

2021-01-27 15:25:28.431478 (MainThread): Running with dbt=0.18.0
2021-01-27 15:25:28.894935 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 15:25:28.895794 (MainThread): Tracking: tracking
2021-01-27 15:25:28.896117 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c5388cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c5388710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72c5388160>]}
2021-01-27 15:25:28.927133 (MainThread): Partial parsing not enabled
2021-01-27 15:25:28.928192 (MainThread): Parsing macros/catalog.sql
2021-01-27 15:25:28.930841 (MainThread): Parsing macros/adapters.sql
2021-01-27 15:25:28.966106 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 15:25:28.967881 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 15:25:28.978898 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 15:25:28.981223 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 15:25:28.986614 (MainThread): Parsing macros/core.sql
2021-01-27 15:25:28.992345 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 15:25:28.994553 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 15:25:28.996406 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 15:25:28.998715 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 15:25:29.002116 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 15:25:29.014314 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 15:25:29.021525 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 15:25:29.027178 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 15:25:29.045761 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 15:25:29.047753 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 15:25:29.078048 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 15:25:29.085290 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 15:25:29.091805 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 15:25:29.093734 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 15:25:29.108125 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 15:25:29.131723 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 15:25:29.142296 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 15:25:29.144154 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 15:25:29.145231 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 15:25:29.147642 (MainThread): Parsing macros/etc/query.sql
2021-01-27 15:25:29.148760 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 15:25:29.150867 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 15:25:29.202144 (MainThread): Partial parsing not enabled
2021-01-27 15:25:29.245964 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:25:29.268859 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:25:29.413326 (MainThread): WARNING: Found documentation for resource "snowflake_timetravel_table_integration_tests_columns_changed.yml" which was not found or is disabled
2021-01-27 15:25:29.493597 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 15:25:29.494251 (MainThread): 
2021-01-27 15:25:29.494732 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:25:29.498104 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 15:25:29.512715 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 15:25:29.512854 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 15:25:29.512944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 15:25:30.246633 (ThreadPoolExecutor-0_0): subprocess 18323 is still running
2021-01-27 15:25:34.531036 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.02 seconds
2021-01-27 15:25:34.568800 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 15:25:34.840114 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:25:34.862103 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:25:34.862324 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 15:25:34.862466 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 15:25:35.500676 (ThreadPoolExecutor-1_0): subprocess 18432 is still running
2021-01-27 15:25:39.845833 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 463 in 4.98 seconds
2021-01-27 15:25:40.266552 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 15:25:40.577083 (MainThread): Using snowflake connection "master".
2021-01-27 15:25:40.577317 (MainThread): On master: BEGIN
2021-01-27 15:25:40.577459 (MainThread): Opening a new connection, currently in state init
2021-01-27 15:25:41.264060 (MainThread): subprocess 18541 is still running
2021-01-27 15:25:44.992264 (MainThread): SQL status: SUCCESS 1 in 4.41 seconds
2021-01-27 15:25:44.993871 (MainThread): On master: COMMIT
2021-01-27 15:25:44.995114 (MainThread): Using snowflake connection "master".
2021-01-27 15:25:44.995589 (MainThread): On master: COMMIT
2021-01-27 15:25:45.298425 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 15:25:45.299349 (MainThread): On master: Close
2021-01-27 15:25:45.987023 (MainThread): 10:25:45 | Concurrency: 1 threads (target='snowflake')
2021-01-27 15:25:45.988144 (MainThread): 10:25:45 | 
2021-01-27 15:25:45.992891 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:25:45.997508 (Thread-1): 10:25:45 | 1 of 2 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_changed [RUN]
2021-01-27 15:25:45.998203 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:25:45.998526 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:25:46.032848 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"
2021-01-27 15:25:46.033431 (Thread-1): finished collecting timing info
2021-01-27 15:25:46.077619 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:25:46.077779 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"} */
drop table if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_CHANGED" cascade
2021-01-27 15:25:46.077868 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 15:25:46.640521 (Thread-1): subprocess 18647 is still running
2021-01-27 15:25:50.158488 (Thread-1): SQL status: SUCCESS 1 in 4.08 seconds
2021-01-27 15:25:50.167482 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"
2021-01-27 15:25:50.168475 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:25:50.168586 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: BEGIN
2021-01-27 15:25:50.351510 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 15:25:50.351683 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:25:50.351780 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_changed  as (
    -- col1,col2,col3
-- 1,foo,bar
-- 2,bin,baz

select
  1 as col1,
  2 as col2renamed,
  3 as col3
  );
2021-01-27 15:25:50.933019 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-27 15:25:50.938530 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: COMMIT
2021-01-27 15:25:50.939449 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:25:50.939861 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: COMMIT
2021-01-27 15:25:51.118012 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 15:25:51.154142 (Thread-1): finished collecting timing info
2021-01-27 15:25:51.154601 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed: Close
2021-01-27 15:25:51.433613 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa318ab5-d815-4713-b24c-f8cc8e49ad77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72bf372470>]}
2021-01-27 15:25:51.439614 (Thread-1): 10:25:51 | 1 of 2 OK created view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_changed [SUCCESS 1 in 5.43s]
2021-01-27 15:25:51.440241 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:25:51.441051 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:25:51.445813 (Thread-1): 10:25:51 | 2 of 2 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 15:25:51.447776 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:25:51.448269 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:25:51.467034 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 15:25:51.467475 (Thread-1): finished collecting timing info
2021-01-27 15:25:51.481238 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:25:51.481395 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop table if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE" cascade
2021-01-27 15:25:51.481485 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 15:25:52.081523 (Thread-1): subprocess 18751 is still running
2021-01-27 15:25:55.758823 (Thread-1): SQL status: SUCCESS 1 in 4.28 seconds
2021-01-27 15:25:55.779171 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 15:25:55.787097 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:25:55.787962 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 15:25:55.983594 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 15:25:55.983869 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:25:55.984019 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as (
    -- col1,col2,col3
-- 1,foo,bar
-- 2,bin,baz

select 1
  );
2021-01-27 15:25:56.209217 (Thread-1): Snowflake query id: 0199e45d-05ef-0bb2-0000-44a93895d466
2021-01-27 15:25:56.209851 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-01-27 15:25:56.210998 (Thread-1): finished collecting timing info
2021-01-27 15:25:56.213906 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-27 15:25:56.486404 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 15:25:56.753468 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 15:25:56.760518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa318ab5-d815-4713-b24c-f8cc8e49ad77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72bdb50780>]}
2021-01-27 15:25:56.766180 (Thread-1): 10:25:56 | 2 of 2 ERROR creating view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.31s]
2021-01-27 15:25:56.766876 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:25:56.842459 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:25:56.843898 (MainThread): Using snowflake connection "master".
2021-01-27 15:25:56.844319 (MainThread): On master: BEGIN
2021-01-27 15:25:56.844718 (MainThread): Opening a new connection, currently in state closed
2021-01-27 15:25:57.452472 (MainThread): subprocess 18855 is still running
2021-01-27 15:26:01.215151 (MainThread): SQL status: SUCCESS 1 in 4.37 seconds
2021-01-27 15:26:01.215519 (MainThread): On master: COMMIT
2021-01-27 15:26:01.215816 (MainThread): Using snowflake connection "master".
2021-01-27 15:26:01.215922 (MainThread): On master: COMMIT
2021-01-27 15:26:01.488675 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 15:26:01.489303 (MainThread): On master: Close
2021-01-27 15:26:01.756266 (MainThread): 10:26:01 | 
2021-01-27 15:26:01.756791 (MainThread): 10:26:01 | Finished running 2 view models in 32.26s.
2021-01-27 15:26:01.757170 (MainThread): Connection 'master' was properly closed.
2021-01-27 15:26:01.757395 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 15:26:01.773086 (MainThread): 
2021-01-27 15:26:01.773308 (MainThread): Completed with 1 error and 0 warnings:
2021-01-27 15:26:01.773476 (MainThread): 
2021-01-27 15:26:01.773625 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 15:26:01.773759 (MainThread):   002022 (42601): SQL compilation error:
2021-01-27 15:26:01.773880 (MainThread):   Missing column specification
2021-01-27 15:26:01.773999 (MainThread):   compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 15:26:01.774136 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-01-27 15:26:01.774462 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72bdaf02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72bdaf0278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72bdaf0c18>]}
2021-01-27 15:26:01.774761 (MainThread): Flushing usage events
2021-01-27 15:33:13.783700 (MainThread): Running with dbt=0.18.0
2021-01-27 15:33:14.245483 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.compile.CompileTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, parse_only=False, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='compile', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='compile', write_json=True)
2021-01-27 15:33:14.246440 (MainThread): Tracking: tracking
2021-01-27 15:33:14.246770 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bc6c7048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bc6c76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bc6c7160>]}
2021-01-27 15:33:14.278271 (MainThread): Partial parsing not enabled
2021-01-27 15:33:14.279311 (MainThread): Parsing macros/catalog.sql
2021-01-27 15:33:14.281956 (MainThread): Parsing macros/adapters.sql
2021-01-27 15:33:14.317602 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 15:33:14.319629 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 15:33:14.330714 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 15:33:14.333022 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 15:33:14.338381 (MainThread): Parsing macros/core.sql
2021-01-27 15:33:14.342675 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 15:33:14.344640 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 15:33:14.346389 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 15:33:14.348484 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 15:33:14.351467 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 15:33:14.361452 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 15:33:14.368285 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 15:33:14.373677 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 15:33:14.392301 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 15:33:14.394236 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 15:33:14.425540 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 15:33:14.432884 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 15:33:14.439824 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 15:33:14.441812 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 15:33:14.457866 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 15:33:14.481134 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 15:33:14.490431 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 15:33:14.492139 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 15:33:14.493128 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 15:33:14.495526 (MainThread): Parsing macros/etc/query.sql
2021-01-27 15:33:14.496717 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 15:33:14.498567 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 15:33:14.549161 (MainThread): Partial parsing not enabled
2021-01-27 15:33:14.590869 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:33:14.611484 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:33:14.748642 (MainThread): WARNING: Found documentation for resource "snowflake_timetravel_table_integration_tests_columns_changed.yml" which was not found or is disabled
2021-01-27 15:33:14.826805 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 143 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 15:33:14.827507 (MainThread): 
2021-01-27 15:33:14.827868 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:33:14.830943 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:33:14.846472 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:33:14.846615 (ThreadPoolExecutor-0_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 15:33:14.846703 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 15:33:15.532319 (ThreadPoolExecutor-0_0): subprocess 22279 is still running
2021-01-27 15:33:19.253702 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 462 in 4.41 seconds
2021-01-27 15:33:19.737435 (ThreadPoolExecutor-0_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 15:33:20.150452 (MainThread): 10:33:20 | Concurrency: 1 threads (target='snowflake')
2021-01-27 15:33:20.150732 (MainThread): 10:33:20 | 
2021-01-27 15:33:20.152340 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:33:20.152821 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed".
2021-01-27 15:33:20.153009 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:33:20.171971 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed"
2021-01-27 15:33:20.172406 (Thread-1): finished collecting timing info
2021-01-27 15:33:20.172948 (Thread-1): finished collecting timing info
2021-01-27 15:33:20.173505 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_changed
2021-01-27 15:33:20.173669 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:33:20.173977 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:33:20.174129 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:33:20.184202 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 15:33:20.184559 (Thread-1): finished collecting timing info
2021-01-27 15:33:20.184862 (Thread-1): finished collecting timing info
2021-01-27 15:33:20.185355 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:33:20.253095 (MainThread): Connection 'master' was properly closed.
2021-01-27 15:33:20.253578 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 15:33:20.284391 (MainThread): 10:33:20 | Done.
2021-01-27 15:33:20.284944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85bc5a8a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b6bb1f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b67667f0>]}
2021-01-27 15:33:20.285354 (MainThread): Flushing usage events
2021-01-27 15:35:14.895429 (MainThread): Running with dbt=0.18.0
2021-01-27 15:35:14.902850 (MainThread): Profile not loaded due to error: Runtime Error
  Could not find profile named 'integration_tests'
2021-01-27 15:35:14.902891 (MainThread): No profile "integration_tests" found, continuing with no target
2021-01-27 15:35:14.930284 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/tsankey/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 15:35:14.930695 (MainThread): Tracking: do not track
2021-01-27 15:35:14.936696 (MainThread): Set downloads directory='/tmp/dbt-downloads-h83hgwj3'
2021-01-27 15:35:14.951270 (MainThread): Installing ../../
2021-01-27 15:35:14.951548 (MainThread):   Creating symlink to local dependency.
2021-01-27 15:35:14.951699 (MainThread):   Installed from <local @ ../../>

2021-01-27 15:35:14.952078 (MainThread): Flushing usage events
2021-01-27 15:36:00.987766 (MainThread): Running with dbt=0.18.0
2021-01-27 15:36:01.458560 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 15:36:01.458938 (MainThread): Tracking: tracking
2021-01-27 15:36:01.459086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98964c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98908470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98908ba8>]}
2021-01-27 15:36:01.459689 (MainThread): Set downloads directory='/tmp/dbt-downloads-5kbrwyk9'
2021-01-27 15:36:01.472739 (MainThread): Installing ../../
2021-01-27 15:36:01.473042 (MainThread):   Creating symlink to local dependency.
2021-01-27 15:36:01.473178 (MainThread):   Installed from <local @ ../../>

2021-01-27 15:36:01.473346 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e43bebfc-3ffd-44e4-addd-45471e29a529', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98908f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98908eb8>]}
2021-01-27 15:36:01.473681 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98902c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98964c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a98908d30>]}
2021-01-27 15:36:01.473988 (MainThread): Flushing usage events
2021-01-27 15:57:40.802833 (MainThread): Running with dbt=0.18.0
2021-01-27 15:57:41.271239 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 15:57:41.272174 (MainThread): Tracking: tracking
2021-01-27 15:57:41.272499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ac707f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ac707470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ac6e0390>]}
2021-01-27 15:57:41.316844 (MainThread): Partial parsing not enabled
2021-01-27 15:57:41.318136 (MainThread): Parsing macros/catalog.sql
2021-01-27 15:57:41.320825 (MainThread): Parsing macros/adapters.sql
2021-01-27 15:57:41.358289 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 15:57:41.362422 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 15:57:41.389382 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 15:57:41.394791 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 15:57:41.401399 (MainThread): Parsing macros/core.sql
2021-01-27 15:57:41.405715 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 15:57:41.407911 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 15:57:41.409778 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 15:57:41.412033 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 15:57:41.415357 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 15:57:41.425583 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 15:57:41.432298 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 15:57:41.437646 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 15:57:41.456138 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 15:57:41.458042 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 15:57:41.489797 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 15:57:41.497288 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 15:57:41.504100 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 15:57:41.506134 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 15:57:41.520735 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 15:57:41.542371 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 15:57:41.551274 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 15:57:41.552915 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 15:57:41.553844 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 15:57:41.555897 (MainThread): Parsing macros/etc/query.sql
2021-01-27 15:57:41.556916 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 15:57:41.558658 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 15:57:41.604625 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 15:57:41.611989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ac6b0978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ac6b0dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35ac6b00f0>]}
2021-01-27 15:57:41.612378 (MainThread): Flushing usage events
2021-01-27 15:57:43.206585 (MainThread): Encountered an error:
2021-01-27 15:57:43.209775 (MainThread): Compilation Error in macro (macros/snowflake_timetravel_table.sql)
  unexpected '}'
    line 33
      {% do run_query(create_view_as(true, tmp_relation, sql)) }}
2021-01-27 15:57:43.220091 (MainThread): Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 33, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '}'
  line 33
    {% do run_query(create_view_as(true, tmp_relation, sql)) }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 260, in load_macro_manifest
    self.config, self.connections.set_query_header
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 670, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 364, in load_macros
    return loader.load_only_macros()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 185, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/snowflake_timetravel_table.sql)
  unexpected '}'
    line 33
      {% do run_query(create_view_as(true, tmp_relation, sql)) }}

2021-01-27 15:58:33.609304 (MainThread): Running with dbt=0.18.0
2021-01-27 15:58:34.192681 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 15:58:34.193849 (MainThread): Tracking: tracking
2021-01-27 15:58:34.194414 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f373f2c5978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37358a0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37358a0048>]}
2021-01-27 15:58:34.271368 (MainThread): Partial parsing not enabled
2021-01-27 15:58:34.272489 (MainThread): Parsing macros/catalog.sql
2021-01-27 15:58:34.275535 (MainThread): Parsing macros/adapters.sql
2021-01-27 15:58:34.313693 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 15:58:34.316028 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 15:58:34.328393 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 15:58:34.331249 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 15:58:34.337818 (MainThread): Parsing macros/core.sql
2021-01-27 15:58:34.343217 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 15:58:34.345684 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 15:58:34.347844 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 15:58:34.350828 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 15:58:34.357470 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 15:58:34.371337 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 15:58:34.381149 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 15:58:34.388195 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 15:58:34.412196 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 15:58:34.415283 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 15:58:34.452584 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 15:58:34.461306 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 15:58:34.469235 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 15:58:34.471856 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 15:58:34.489534 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 15:58:34.517912 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 15:58:34.529124 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 15:58:34.531220 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 15:58:34.532457 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 15:58:34.535034 (MainThread): Parsing macros/etc/query.sql
2021-01-27 15:58:34.536504 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 15:58:34.538627 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 15:58:34.602311 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 15:58:34.619974 (MainThread): Partial parsing not enabled
2021-01-27 15:58:34.675161 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:58:34.699472 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 15:58:34.710760 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 15:58:34.888155 (MainThread): WARNING: Found documentation for resource "snowflake_timetravel_table_integration_tests_columns_renamed.yml" which was not found or is disabled
2021-01-27 15:58:34.968587 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 15:58:34.969244 (MainThread): 
2021-01-27 15:58:34.969589 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:58:34.974486 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 15:58:34.989886 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 15:58:34.990027 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 15:58:34.990110 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 15:58:35.804802 (ThreadPoolExecutor-0_0): subprocess 2827 is still running
2021-01-27 15:58:39.877701 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.89 seconds
2021-01-27 15:58:39.922961 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 15:58:40.208452 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:58:40.229244 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:58:40.229487 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 15:58:40.229644 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 15:58:40.902386 (ThreadPoolExecutor-1_0): subprocess 2944 is still running
2021-01-27 15:58:44.805171 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 462 in 4.58 seconds
2021-01-27 15:58:45.288522 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 15:58:45.583872 (MainThread): Using snowflake connection "master".
2021-01-27 15:58:45.584076 (MainThread): On master: BEGIN
2021-01-27 15:58:45.584190 (MainThread): Opening a new connection, currently in state init
2021-01-27 15:58:46.194102 (MainThread): subprocess 3043 is still running
2021-01-27 15:58:49.891031 (MainThread): SQL status: SUCCESS 1 in 4.31 seconds
2021-01-27 15:58:49.891343 (MainThread): On master: COMMIT
2021-01-27 15:58:49.891584 (MainThread): Using snowflake connection "master".
2021-01-27 15:58:49.891682 (MainThread): On master: COMMIT
2021-01-27 15:58:50.163580 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 15:58:50.163824 (MainThread): On master: Close
2021-01-27 15:58:50.483130 (MainThread): 10:58:50 | Concurrency: 1 threads (target='snowflake')
2021-01-27 15:58:50.483776 (MainThread): 10:58:50 | 
2021-01-27 15:58:50.488391 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 15:58:50.495061 (Thread-1): 10:58:50 | 1 of 3 START view model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 15:58:50.496208 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 15:58:50.496715 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 15:58:50.526260 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 15:58:50.526600 (Thread-1): finished collecting timing info
2021-01-27 15:58:50.563445 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 15:58:50.564253 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 15:58:50.564350 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 15:58:50.564433 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 15:58:51.167040 (Thread-1): subprocess 3425 is still running
2021-01-27 15:58:54.784888 (Thread-1): SQL status: SUCCESS 1 in 4.22 seconds
2021-01-27 15:58:54.785218 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 15:58:54.785406 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).

select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 15:58:55.364639 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-27 15:58:55.367706 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 15:58:55.368066 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 15:58:55.368206 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 15:58:55.813574 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-27 15:58:55.851706 (Thread-1): finished collecting timing info
2021-01-27 15:58:55.852294 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 15:58:56.150008 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab46b006-4ab9-4fcc-809b-8eb2434f9048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372f7bb4a8>]}
2021-01-27 15:58:56.152041 (Thread-1): 10:58:56 | 1 of 3 OK created view model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 5.65s]
2021-01-27 15:58:56.152278 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 15:58:56.152554 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:58:56.154543 (Thread-1): 10:58:56 | 2 of 3 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 15:58:56.155005 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:58:56.155212 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:58:56.165267 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 15:58:56.165715 (Thread-1): finished collecting timing info
2021-01-27 15:58:56.175495 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 15:58:56.176289 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:58:56.176405 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 15:58:56.176487 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 15:58:56.779862 (Thread-1): subprocess 3538 is still running
2021-01-27 15:59:01.507031 (Thread-1): SQL status: SUCCESS 1 in 5.33 seconds
2021-01-27 15:59:01.507878 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:59:01.508432 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as (
    select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 15:59:02.335795 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-27 15:59:02.345864 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 15:59:02.346985 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:59:02.347436 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 15:59:02.510757 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-27 15:59:02.539800 (Thread-1): finished collecting timing info
2021-01-27 15:59:02.540763 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 15:59:02.816202 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab46b006-4ab9-4fcc-809b-8eb2434f9048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372df84ac8>]}
2021-01-27 15:59:02.823963 (Thread-1): 10:59:02 | 2 of 3 OK created view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 6.66s]
2021-01-27 15:59:02.825165 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 15:59:02.826265 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 15:59:02.829753 (Thread-1): 10:59:02 | 3 of 3 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 15:59:02.830869 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 15:59:02.831792 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 15:59:02.845183 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 15:59:02.845619 (Thread-1): finished collecting timing info
2021-01-27 15:59:02.857979 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 15:59:02.859129 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 15:59:02.859340 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 15:59:02.859462 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 15:59:03.516383 (Thread-1): subprocess 3648 is still running
2021-01-27 15:59:07.213703 (Thread-1): SQL status: SUCCESS 1 in 4.35 seconds
2021-01-27 15:59:07.213937 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 15:59:07.214054 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as (
    -- Test renaming columns.

select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 15:59:07.948217 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2021-01-27 15:59:07.957630 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 15:59:07.958737 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 15:59:07.959187 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 15:59:08.139845 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 15:59:08.166143 (Thread-1): finished collecting timing info
2021-01-27 15:59:08.168201 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 15:59:08.418822 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab46b006-4ab9-4fcc-809b-8eb2434f9048', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372f7cbc50>]}
2021-01-27 15:59:08.421656 (Thread-1): 10:59:08 | 3 of 3 OK created view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 5.59s]
2021-01-27 15:59:08.422298 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 15:59:08.471498 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:59:08.471824 (MainThread): Using snowflake connection "master".
2021-01-27 15:59:08.471915 (MainThread): On master: BEGIN
2021-01-27 15:59:08.471996 (MainThread): Opening a new connection, currently in state closed
2021-01-27 15:59:09.031435 (MainThread): subprocess 3750 is still running
2021-01-27 15:59:13.531460 (MainThread): SQL status: SUCCESS 1 in 5.06 seconds
2021-01-27 15:59:13.531877 (MainThread): On master: COMMIT
2021-01-27 15:59:13.532341 (MainThread): Using snowflake connection "master".
2021-01-27 15:59:13.532515 (MainThread): On master: COMMIT
2021-01-27 15:59:13.856445 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 15:59:13.857609 (MainThread): On master: Close
2021-01-27 15:59:14.210920 (MainThread): 10:59:14 | 
2021-01-27 15:59:14.211905 (MainThread): 10:59:14 | Finished running 3 view models in 39.24s.
2021-01-27 15:59:14.212646 (MainThread): Connection 'master' was properly closed.
2021-01-27 15:59:14.213093 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 15:59:14.240070 (MainThread): 
2021-01-27 15:59:14.240316 (MainThread): Completed successfully
2021-01-27 15:59:14.240513 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 15:59:14.240827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372df842b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372f8649b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f372fcb9cc0>]}
2021-01-27 15:59:14.241136 (MainThread): Flushing usage events
2021-01-27 15:59:43.302985 (MainThread): Running with dbt=0.18.1
2021-01-27 15:59:43.790488 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 15:59:43.791340 (MainThread): Tracking: tracking
2021-01-27 15:59:43.791683 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b3d8a908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b3d8a518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b3d8a550>]}
2021-01-27 15:59:43.834991 (MainThread): Partial parsing not enabled
2021-01-27 15:59:43.836074 (MainThread): Parsing macros/catalog.sql
2021-01-27 15:59:43.839042 (MainThread): Parsing macros/adapters.sql
2021-01-27 15:59:43.874988 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 15:59:43.877038 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 15:59:43.888084 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 15:59:43.890504 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 15:59:43.896079 (MainThread): Parsing macros/core.sql
2021-01-27 15:59:43.900518 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 15:59:43.902652 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 15:59:43.904591 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 15:59:43.906913 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 15:59:43.911535 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 15:59:43.922590 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 15:59:43.930011 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 15:59:43.935835 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 15:59:43.954980 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 15:59:43.957048 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 15:59:43.987255 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 15:59:43.994533 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 15:59:44.001136 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 15:59:44.003250 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 15:59:44.018592 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 15:59:44.041992 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 15:59:44.051350 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 15:59:44.053140 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 15:59:44.054157 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 15:59:44.056347 (MainThread): Parsing macros/etc/query.sql
2021-01-27 15:59:44.057442 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 15:59:44.059250 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 15:59:44.106475 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 15:59:44.122200 (MainThread): Partial parsing not enabled
2021-01-27 15:59:44.166009 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 15:59:44.193789 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 15:59:44.209590 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 15:59:44.423856 (MainThread): WARNING: Found documentation for resource "snowflake_timetravel_table_integration_tests_columns_renamed.yml" which was not found or is disabled
2021-01-27 15:59:44.520177 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 15:59:44.520959 (MainThread): 
2021-01-27 15:59:44.521339 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 15:59:44.526658 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 15:59:44.545671 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 15:59:44.545841 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 15:59:44.545928 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 15:59:45.334195 (ThreadPoolExecutor-0_0): subprocess 4175 is still running
2021-01-27 15:59:49.675220 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.13 seconds
2021-01-27 15:59:49.686776 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 15:59:49.939577 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:59:49.956359 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 15:59:49.956567 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 15:59:49.956699 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 15:59:50.598547 (ThreadPoolExecutor-1_0): subprocess 4275 is still running
2021-01-27 15:59:54.352049 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.40 seconds
2021-01-27 15:59:54.839303 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 15:59:55.801655 (MainThread): Using snowflake connection "master".
2021-01-27 15:59:55.801832 (MainThread): On master: BEGIN
2021-01-27 15:59:55.801937 (MainThread): Opening a new connection, currently in state init
2021-01-27 15:59:56.362692 (MainThread): subprocess 4730 is still running
2021-01-27 15:59:59.887795 (MainThread): SQL status: SUCCESS 1 in 4.09 seconds
2021-01-27 15:59:59.888455 (MainThread): On master: COMMIT
2021-01-27 15:59:59.889155 (MainThread): Using snowflake connection "master".
2021-01-27 15:59:59.889681 (MainThread): On master: COMMIT
2021-01-27 16:00:00.332897 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-27 16:00:00.333182 (MainThread): On master: Close
2021-01-27 16:00:00.628342 (MainThread): 11:00:00 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:00:00.628706 (MainThread): 11:00:00 | 
2021-01-27 16:00:00.630336 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:00:00.632664 (Thread-1): 11:00:00 | 1 of 3 START view model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:00:00.633127 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:00:00.633303 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:00:00.656054 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:00:00.656623 (Thread-1): finished collecting timing info
2021-01-27 16:00:00.741741 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:00:00.743416 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:00:00.743607 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 16:00:00.743755 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:00:01.390740 (Thread-1): subprocess 4832 is still running
2021-01-27 16:00:05.470282 (Thread-1): SQL status: SUCCESS 1 in 4.73 seconds
2021-01-27 16:00:05.470589 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:00:05.470772 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).

select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:00:06.245932 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-01-27 16:00:06.252040 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 16:00:06.252887 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:00:06.253202 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 16:00:06.440555 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 16:00:06.474468 (Thread-1): finished collecting timing info
2021-01-27 16:00:06.474967 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:00:06.765674 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6045db77-ed54-4b6c-97b5-c1b42f565ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b1d8dc18>]}
2021-01-27 16:00:06.771729 (Thread-1): 11:00:06 | 1 of 3 OK created view model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 6.13s]
2021-01-27 16:00:06.772396 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:00:06.773049 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:00:06.777482 (Thread-1): 11:00:06 | 2 of 3 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:00:06.780653 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:00:06.781652 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:00:06.800165 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:00:06.800644 (Thread-1): finished collecting timing info
2021-01-27 16:00:06.812568 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:00:06.813392 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:00:06.813521 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 16:00:06.813610 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:00:07.545561 (Thread-1): subprocess 4930 is still running
2021-01-27 16:00:12.428727 (Thread-1): SQL status: SUCCESS 1 in 5.61 seconds
2021-01-27 16:00:12.429536 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:00:12.430017 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as (
    select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:00:12.970192 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-27 16:00:12.979581 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 16:00:12.980728 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:00:12.981256 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 16:00:13.435463 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-27 16:00:13.440663 (Thread-1): finished collecting timing info
2021-01-27 16:00:13.441051 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:00:13.770450 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6045db77-ed54-4b6c-97b5-c1b42f565ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b1d45f60>]}
2021-01-27 16:00:13.778029 (Thread-1): 11:00:13 | 2 of 3 OK created view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 6.99s]
2021-01-27 16:00:13.778924 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:00:13.779526 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:00:13.783045 (Thread-1): 11:00:13 | 3 of 3 START view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:00:13.784523 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:00:13.784893 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:00:13.803946 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:00:13.804460 (Thread-1): finished collecting timing info
2021-01-27 16:00:13.818799 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:00:13.819651 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:00:13.819755 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 16:00:13.819838 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:00:14.463617 (Thread-1): subprocess 5032 is still running
2021-01-27 16:00:18.541966 (Thread-1): SQL status: SUCCESS 1 in 4.72 seconds
2021-01-27 16:00:18.542274 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:00:18.542428 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as (
    -- Test renaming columns.

select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:00:19.183325 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-27 16:00:19.190154 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 16:00:19.190940 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:00:19.191402 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 16:00:19.544802 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-27 16:00:19.570696 (Thread-1): finished collecting timing info
2021-01-27 16:00:19.571450 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:00:19.964144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6045db77-ed54-4b6c-97b5-c1b42f565ed6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b1d290b8>]}
2021-01-27 16:00:19.971584 (Thread-1): 11:00:19 | 3 of 3 OK created view model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 6.18s]
2021-01-27 16:00:19.972140 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:00:20.024031 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:00:20.025134 (MainThread): Using snowflake connection "master".
2021-01-27 16:00:20.025606 (MainThread): On master: BEGIN
2021-01-27 16:00:20.026042 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:00:21.231349 (MainThread): subprocess 5147 is still running
2021-01-27 16:00:25.257461 (MainThread): SQL status: SUCCESS 1 in 5.23 seconds
2021-01-27 16:00:25.258503 (MainThread): On master: COMMIT
2021-01-27 16:00:25.259568 (MainThread): Using snowflake connection "master".
2021-01-27 16:00:25.260000 (MainThread): On master: COMMIT
2021-01-27 16:00:25.542756 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 16:00:25.543304 (MainThread): On master: Close
2021-01-27 16:00:26.061741 (MainThread): 11:00:26 | 
2021-01-27 16:00:26.062827 (MainThread): 11:00:26 | Finished running 3 view models in 41.54s.
2021-01-27 16:00:26.063804 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:00:26.064285 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:00:26.092179 (MainThread): 
2021-01-27 16:00:26.092418 (MainThread): Completed successfully
2021-01-27 16:00:26.092610 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 16:00:26.092957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58baac5978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b2351d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58b1da8a58>]}
2021-01-27 16:00:26.093337 (MainThread): Flushing usage events
2021-01-27 16:07:30.406644 (MainThread): Running with dbt=0.18.1
2021-01-27 16:07:30.871383 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:07:30.872255 (MainThread): Tracking: tracking
2021-01-27 16:07:30.872617 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb58690550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb58690518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb58690978>]}
2021-01-27 16:07:30.916406 (MainThread): Partial parsing not enabled
2021-01-27 16:07:30.917456 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:07:30.920209 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:07:30.955482 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:07:30.957426 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:07:30.968269 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:07:30.970569 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:07:30.975729 (MainThread): Parsing macros/core.sql
2021-01-27 16:07:30.979862 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:07:30.981789 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:07:30.983559 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:07:30.985669 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:07:30.990109 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:07:31.000627 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:07:31.008450 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:07:31.014779 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:07:31.033465 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:07:31.035431 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:07:31.065159 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:07:31.071904 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:07:31.078397 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:07:31.080421 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:07:31.094555 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:07:31.116226 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:07:31.125161 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:07:31.127252 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:07:31.128284 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:07:31.130610 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:07:31.131709 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:07:31.133540 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:07:31.177790 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:07:31.192123 (MainThread): Partial parsing not enabled
2021-01-27 16:07:31.235956 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:07:31.262625 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:07:31.276255 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:07:31.522244 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:07:31.522909 (MainThread): 
2021-01-27 16:07:31.523222 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:07:31.527889 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:07:31.542626 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:07:31.542769 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:07:31.542849 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:07:32.267774 (ThreadPoolExecutor-0_0): subprocess 6957 is still running
2021-01-27 16:07:36.631635 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.09 seconds
2021-01-27 16:07:36.641693 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:07:37.101813 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:07:37.117024 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:07:37.117236 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:07:37.117379 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:07:37.776745 (ThreadPoolExecutor-1_0): subprocess 7074 is still running
2021-01-27 16:07:42.833560 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 5.72 seconds
2021-01-27 16:07:43.277614 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:07:43.613723 (MainThread): Using snowflake connection "master".
2021-01-27 16:07:43.613913 (MainThread): On master: BEGIN
2021-01-27 16:07:43.614034 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:07:44.485673 (MainThread): subprocess 7191 is still running
2021-01-27 16:07:48.636395 (MainThread): SQL status: SUCCESS 1 in 5.02 seconds
2021-01-27 16:07:48.637630 (MainThread): On master: COMMIT
2021-01-27 16:07:48.638764 (MainThread): Using snowflake connection "master".
2021-01-27 16:07:48.639211 (MainThread): On master: COMMIT
2021-01-27 16:07:49.056652 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-27 16:07:49.057562 (MainThread): On master: Close
2021-01-27 16:07:49.555606 (MainThread): 11:07:49 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:07:49.555875 (MainThread): 11:07:49 | 
2021-01-27 16:07:49.557309 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:07:49.559230 (Thread-1): 11:07:49 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:07:49.559642 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:07:49.559804 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:07:49.579276 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:07:49.579666 (Thread-1): finished collecting timing info
2021-01-27 16:07:49.616250 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMN_TYPES_CHANGED" because it is of type view
2021-01-27 16:07:49.624842 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:07:49.624991 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMN_TYPES_CHANGED" cascade
2021-01-27 16:07:49.625081 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:07:50.428026 (Thread-1): subprocess 7303 is still running
2021-01-27 16:07:54.331694 (Thread-1): SQL status: SUCCESS 1 in 4.71 seconds
2021-01-27 16:07:54.372318 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:07:54.373709 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:07:54.373838 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 16:07:54.845573 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-27 16:07:54.846116 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:07:54.846509 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace transient table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 16:07:57.304418 (Thread-1): SQL status: SUCCESS 1 in 2.46 seconds
2021-01-27 16:07:57.311196 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 16:07:57.312220 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:07:57.312676 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 16:07:57.549017 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 16:07:57.580896 (Thread-1): finished collecting timing info
2021-01-27 16:07:57.581304 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:07:57.893661 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f63fe85-2a73-44dc-8e91-25df7d1fe6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52675470>]}
2021-01-27 16:07:57.901793 (Thread-1): 11:07:57 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 8.33s]
2021-01-27 16:07:57.902801 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:07:57.903831 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:07:57.915242 (Thread-1): 11:07:57 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:07:57.916125 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:07:57.916412 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:07:57.930466 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:07:57.930985 (Thread-1): finished collecting timing info
2021-01-27 16:07:57.951854 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE" because it is of type view
2021-01-27 16:07:57.955248 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:07:57.955410 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE" cascade
2021-01-27 16:07:57.955510 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:07:58.551635 (Thread-1): subprocess 7404 is still running
2021-01-27 16:08:02.807925 (Thread-1): SQL status: SUCCESS 1 in 4.85 seconds
2021-01-27 16:08:02.820318 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:08:02.825128 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:08:02.825655 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 16:08:03.162832 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 16:08:03.163508 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:08:03.163948 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace transient table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 16:08:05.852564 (Thread-1): SQL status: SUCCESS 1 in 2.69 seconds
2021-01-27 16:08:05.858310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 16:08:05.859199 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:08:05.859635 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 16:08:06.142632 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 16:08:06.150727 (Thread-1): finished collecting timing info
2021-01-27 16:08:06.151729 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:08:06.647460 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f63fe85-2a73-44dc-8e91-25df7d1fe6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52619860>]}
2021-01-27 16:08:06.655827 (Thread-1): 11:08:06 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 8.73s]
2021-01-27 16:08:06.656752 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:08:06.657744 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:08:06.664974 (Thread-1): 11:08:06 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:08:06.666646 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:08:06.667109 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:08:06.685015 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:08:06.685597 (Thread-1): finished collecting timing info
2021-01-27 16:08:06.697292 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_RENAMED" because it is of type view
2021-01-27 16:08:06.699981 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:08:06.700094 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_RENAMED" cascade
2021-01-27 16:08:06.700182 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:08:07.320871 (Thread-1): subprocess 7512 is still running
2021-01-27 16:08:11.554093 (Thread-1): SQL status: SUCCESS 1 in 4.85 seconds
2021-01-27 16:08:11.559026 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:08:11.561589 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:08:11.561828 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 16:08:11.842280 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 16:08:11.842555 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:08:11.842722 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace transient table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 16:08:13.875806 (Thread-1): SQL status: SUCCESS 1 in 2.03 seconds
2021-01-27 16:08:13.881548 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 16:08:13.883017 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:08:13.883496 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 16:08:14.235969 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-27 16:08:14.254129 (Thread-1): finished collecting timing info
2021-01-27 16:08:14.256224 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:08:15.367833 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f63fe85-2a73-44dc-8e91-25df7d1fe6d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52619860>]}
2021-01-27 16:08:15.373998 (Thread-1): 11:08:15 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.70s]
2021-01-27 16:08:15.374890 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:08:15.464224 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:08:15.465343 (MainThread): Using snowflake connection "master".
2021-01-27 16:08:15.465804 (MainThread): On master: BEGIN
2021-01-27 16:08:15.466271 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:08:16.075844 (MainThread): subprocess 7621 is still running
2021-01-27 16:08:19.828016 (MainThread): SQL status: SUCCESS 1 in 4.36 seconds
2021-01-27 16:08:19.828332 (MainThread): On master: COMMIT
2021-01-27 16:08:19.828641 (MainThread): Using snowflake connection "master".
2021-01-27 16:08:19.828783 (MainThread): On master: COMMIT
2021-01-27 16:08:20.262111 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-27 16:08:20.263051 (MainThread): On master: Close
2021-01-27 16:08:20.548794 (MainThread): 11:08:20 | 
2021-01-27 16:08:20.549921 (MainThread): 11:08:20 | Finished running 3 snowflake_timetravel_table models in 49.02s.
2021-01-27 16:08:20.550715 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:08:20.551167 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:08:20.575913 (MainThread): 
2021-01-27 16:08:20.576128 (MainThread): Completed successfully
2021-01-27 16:08:20.576260 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 16:08:20.576521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52675550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52675f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb52675518>]}
2021-01-27 16:08:20.576807 (MainThread): Flushing usage events
2021-01-27 16:13:53.382756 (MainThread): Running with dbt=0.18.1
2021-01-27 16:13:53.854922 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:13:53.855806 (MainThread): Tracking: tracking
2021-01-27 16:13:53.856153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0524d4e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0524d4e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0524d4e518>]}
2021-01-27 16:13:53.900865 (MainThread): Partial parsing not enabled
2021-01-27 16:13:53.902962 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:13:53.906328 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:13:53.941977 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:13:53.943792 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:13:53.954646 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:13:53.956972 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:13:53.962294 (MainThread): Parsing macros/core.sql
2021-01-27 16:13:53.966686 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:13:53.968797 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:13:53.970594 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:13:53.973238 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:13:53.978105 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:13:53.989655 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:13:53.997687 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:13:54.003595 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:13:54.023950 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:13:54.026269 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:13:54.058413 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:13:54.066155 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:13:54.072964 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:13:54.075072 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:13:54.090244 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:13:54.113202 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:13:54.122416 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:13:54.124200 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:13:54.125190 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:13:54.127198 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:13:54.128218 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:13:54.130054 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:13:54.180487 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:13:54.197174 (MainThread): Partial parsing not enabled
2021-01-27 16:13:54.248994 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:13:54.296047 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:13:54.309855 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:13:54.576125 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:13:54.577127 (MainThread): 
2021-01-27 16:13:54.577513 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:13:54.582895 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:13:54.599874 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:13:54.600023 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:13:54.600109 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:13:55.335843 (ThreadPoolExecutor-0_0): subprocess 9320 is still running
2021-01-27 16:13:58.939068 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.34 seconds
2021-01-27 16:13:58.986097 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:13:59.324690 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:13:59.334812 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:13:59.334968 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:13:59.335064 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:13:59.934167 (ThreadPoolExecutor-1_0): subprocess 9433 is still running
2021-01-27 16:14:03.598128 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.26 seconds
2021-01-27 16:14:04.103509 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:14:04.586579 (MainThread): Using snowflake connection "master".
2021-01-27 16:14:04.586737 (MainThread): On master: BEGIN
2021-01-27 16:14:04.586828 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:14:05.220115 (MainThread): subprocess 9533 is still running
2021-01-27 16:14:09.181449 (MainThread): SQL status: SUCCESS 1 in 4.59 seconds
2021-01-27 16:14:09.181765 (MainThread): On master: COMMIT
2021-01-27 16:14:09.182196 (MainThread): Using snowflake connection "master".
2021-01-27 16:14:09.182346 (MainThread): On master: COMMIT
2021-01-27 16:14:10.163140 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-27 16:14:10.164047 (MainThread): On master: Close
2021-01-27 16:14:10.496020 (MainThread): 11:14:10 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:14:10.496370 (MainThread): 11:14:10 | 
2021-01-27 16:14:10.498440 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:14:10.500700 (Thread-1): 11:14:10 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:14:10.501188 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:14:10.501366 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:14:10.526202 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:14:10.526875 (Thread-1): finished collecting timing info
2021-01-27 16:14:10.575991 (Thread-1): finished collecting timing info
2021-01-27 16:14:10.576667 (Thread-1): Compilation Error in macro create_view_as (macros/adapters/common.sql)
  macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by macro create_view_as (macros/adapters/common.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 672, in __call__
    % (self.name, len(self.arguments))
TypeError: macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 80, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro create_view_as (macros/adapters/common.sql)
  macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:10.578259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a997d07-b3f8-4b4c-83db-6c9acf90f51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051ed2a860>]}
2021-01-27 16:14:10.579844 (Thread-1): 11:14:10 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 0.08s]
2021-01-27 16:14:10.580030 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:14:10.580205 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:14:10.581705 (Thread-1): 11:14:10 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:14:10.582054 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:14:10.582177 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:14:10.592098 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:14:10.592506 (Thread-1): finished collecting timing info
2021-01-27 16:14:10.604404 (Thread-1): finished collecting timing info
2021-01-27 16:14:10.604972 (Thread-1): Compilation Error in macro create_view_as (macros/adapters/common.sql)
  macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by macro create_view_as (macros/adapters/common.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 672, in __call__
    % (self.name, len(self.arguments))
TypeError: macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 80, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro create_view_as (macros/adapters/common.sql)
  macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:10.605437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a997d07-b3f8-4b4c-83db-6c9acf90f51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051ed76160>]}
2021-01-27 16:14:10.606789 (Thread-1): 11:14:10 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 0.02s]
2021-01-27 16:14:10.606957 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:14:10.607122 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:14:10.608951 (Thread-1): 11:14:10 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:14:10.609432 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:14:10.609661 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:14:10.620010 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:14:10.620382 (Thread-1): finished collecting timing info
2021-01-27 16:14:10.632430 (Thread-1): finished collecting timing info
2021-01-27 16:14:10.633017 (Thread-1): Compilation Error in macro create_view_as (macros/adapters/common.sql)
  macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by macro create_view_as (macros/adapters/common.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 672, in __call__
    % (self.name, len(self.arguments))
TypeError: macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 80, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro create_view_as (macros/adapters/common.sql)
  macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:10.633527 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a997d07-b3f8-4b4c-83db-6c9acf90f51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051eccc240>]}
2021-01-27 16:14:10.634934 (Thread-1): 11:14:10 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 0.02s]
2021-01-27 16:14:10.635127 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:14:10.703671 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:14:10.703979 (MainThread): Using snowflake connection "master".
2021-01-27 16:14:10.704089 (MainThread): On master: BEGIN
2021-01-27 16:14:10.704186 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:14:11.278682 (MainThread): subprocess 9643 is still running
2021-01-27 16:14:14.808198 (MainThread): SQL status: SUCCESS 1 in 4.10 seconds
2021-01-27 16:14:14.809040 (MainThread): On master: COMMIT
2021-01-27 16:14:14.810303 (MainThread): Using snowflake connection "master".
2021-01-27 16:14:14.810709 (MainThread): On master: COMMIT
2021-01-27 16:14:15.159552 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-27 16:14:15.159779 (MainThread): On master: Close
2021-01-27 16:14:15.413970 (MainThread): 11:14:15 | 
2021-01-27 16:14:15.414856 (MainThread): 11:14:15 | Finished running 3 snowflake_timetravel_table models in 20.84s.
2021-01-27 16:14:15.415435 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:14:15.416076 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:14:15.438637 (MainThread): 
2021-01-27 16:14:15.438925 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:14:15.439100 (MainThread): 
2021-01-27 16:14:15.439256 (MainThread): Compilation Error in macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:15.439386 (MainThread):   macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
2021-01-27 16:14:15.439507 (MainThread):   
2021-01-27 16:14:15.439636 (MainThread):   > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:14:15.439738 (MainThread):   > called by macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:15.439874 (MainThread): 
2021-01-27 16:14:15.440006 (MainThread): Compilation Error in macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:15.440134 (MainThread):   macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
2021-01-27 16:14:15.440224 (MainThread):   
2021-01-27 16:14:15.440333 (MainThread):   > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:14:15.440416 (MainThread):   > called by macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:15.440500 (MainThread): 
2021-01-27 16:14:15.440592 (MainThread): Compilation Error in macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:15.440676 (MainThread):   macro 'dbt_macro__create_view_as' takes not more than 2 argument(s)
2021-01-27 16:14:15.440790 (MainThread):   
2021-01-27 16:14:15.440887 (MainThread):   > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:14:15.440965 (MainThread):   > called by macro create_view_as (macros/adapters/common.sql)
2021-01-27 16:14:15.441055 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:14:15.441297 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051f30feb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051ed76160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051ed3cb70>]}
2021-01-27 16:14:15.441571 (MainThread): Flushing usage events
2021-01-27 16:16:01.478463 (MainThread): Running with dbt=0.18.1
2021-01-27 16:16:01.947463 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:16:01.948375 (MainThread): Tracking: tracking
2021-01-27 16:16:01.948717 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f40290908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f40290518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f40290ac8>]}
2021-01-27 16:16:01.994171 (MainThread): Partial parsing not enabled
2021-01-27 16:16:01.995301 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:16:01.998058 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:16:02.032763 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:16:02.034539 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:16:02.044834 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:16:02.047087 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:16:02.052085 (MainThread): Parsing macros/core.sql
2021-01-27 16:16:02.056210 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:16:02.058190 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:16:02.059927 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:16:02.061989 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:16:02.066252 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:16:02.076362 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:16:02.083456 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:16:02.088855 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:16:02.106970 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:16:02.108784 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:16:02.139873 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:16:02.147149 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:16:02.153829 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:16:02.155880 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:16:02.171073 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:16:02.193047 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:16:02.202574 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:16:02.204260 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:16:02.205225 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:16:02.207472 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:16:02.208579 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:16:02.210488 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:16:02.256014 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:16:02.271391 (MainThread): Partial parsing not enabled
2021-01-27 16:16:02.317047 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:16:02.341576 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:16:02.354620 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:16:02.608165 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:16:02.608885 (MainThread): 
2021-01-27 16:16:02.609317 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:16:02.614502 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:16:02.630523 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:16:02.630669 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:16:02.630756 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:16:03.356780 (ThreadPoolExecutor-0_0): subprocess 10251 is still running
2021-01-27 16:16:07.034728 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.40 seconds
2021-01-27 16:16:07.083910 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:16:07.384178 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:16:07.398359 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:16:07.398559 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:16:07.398709 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:16:07.981715 (ThreadPoolExecutor-1_0): subprocess 10353 is still running
2021-01-27 16:16:11.540300 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.14 seconds
2021-01-27 16:16:12.046580 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:16:12.826321 (MainThread): Using snowflake connection "master".
2021-01-27 16:16:12.826621 (MainThread): On master: BEGIN
2021-01-27 16:16:12.826775 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:16:13.436486 (MainThread): subprocess 10455 is still running
2021-01-27 16:16:17.388747 (MainThread): SQL status: SUCCESS 1 in 4.56 seconds
2021-01-27 16:16:17.389719 (MainThread): On master: COMMIT
2021-01-27 16:16:17.390632 (MainThread): Using snowflake connection "master".
2021-01-27 16:16:17.391006 (MainThread): On master: COMMIT
2021-01-27 16:16:17.898029 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-27 16:16:17.898283 (MainThread): On master: Close
2021-01-27 16:16:18.236935 (MainThread): 11:16:18 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:16:18.237339 (MainThread): 11:16:18 | 
2021-01-27 16:16:18.240029 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:16:18.243228 (Thread-1): 11:16:18 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:16:18.243769 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:16:18.243999 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:16:18.272097 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:16:18.272509 (Thread-1): finished collecting timing info
2021-01-27 16:16:18.320415 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:16:18.320602 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:16:18.320731 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:16:18.980155 (Thread-1): subprocess 10570 is still running
2021-01-27 16:16:22.812750 (Thread-1): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 16:16:22.829845 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:16:22.830034 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:16:23.018639 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 16:16:23.025305 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:16:23.025512 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 16:16:23.237522 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 16:16:23.239464 (Thread-1): finished collecting timing info
2021-01-27 16:16:23.240137 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:16:23.519094 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:16:23.526615 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a405f89-5cd6-4806-895b-c00075cd8e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f389b12b0>]}
2021-01-27 16:16:23.532159 (Thread-1): 11:16:23 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.28s]
2021-01-27 16:16:23.532629 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:16:23.533093 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:16:23.536672 (Thread-1): 11:16:23 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:16:23.537339 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:16:23.537579 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:16:23.550031 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:16:23.550425 (Thread-1): finished collecting timing info
2021-01-27 16:16:23.563024 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:16:23.563186 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:16:23.563277 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:16:24.231794 (Thread-1): subprocess 10681 is still running
2021-01-27 16:16:27.947388 (Thread-1): SQL status: SUCCESS 1 in 4.38 seconds
2021-01-27 16:16:27.952973 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:16:27.953133 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:16:28.448887 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-01-27 16:16:28.467633 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:16:28.468333 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 16:16:28.675831 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 16:16:28.680568 (Thread-1): finished collecting timing info
2021-01-27 16:16:28.682042 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:16:28.940904 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:16:28.942515 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a405f89-5cd6-4806-895b-c00075cd8e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f3a263048>]}
2021-01-27 16:16:28.947190 (Thread-1): 11:16:28 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.41s]
2021-01-27 16:16:28.947857 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:16:28.948421 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:16:28.951582 (Thread-1): 11:16:28 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:16:28.952442 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:16:28.952775 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:16:28.971035 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:16:28.971484 (Thread-1): finished collecting timing info
2021-01-27 16:16:28.986288 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:16:28.986465 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:16:28.986560 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:16:29.593524 (Thread-1): subprocess 10786 is still running
2021-01-27 16:16:33.480433 (Thread-1): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 16:16:33.484879 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:16:33.485037 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:16:33.875051 (Thread-1): SQL status: SUCCESS 3 in 0.39 seconds
2021-01-27 16:16:33.891992 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:16:33.892632 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 16:16:34.191828 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-27 16:16:34.195399 (Thread-1): finished collecting timing info
2021-01-27 16:16:34.196742 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:16:34.807016 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:16:34.809342 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a405f89-5cd6-4806-895b-c00075cd8e58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f3a1fdfd0>]}
2021-01-27 16:16:34.815829 (Thread-1): 11:16:34 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.86s]
2021-01-27 16:16:34.816748 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:16:34.919255 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:16:34.920190 (MainThread): Using snowflake connection "master".
2021-01-27 16:16:34.920642 (MainThread): On master: BEGIN
2021-01-27 16:16:34.921153 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:16:35.550341 (MainThread): subprocess 10893 is still running
2021-01-27 16:16:39.163367 (MainThread): SQL status: SUCCESS 1 in 4.24 seconds
2021-01-27 16:16:39.164367 (MainThread): On master: COMMIT
2021-01-27 16:16:39.165388 (MainThread): Using snowflake connection "master".
2021-01-27 16:16:39.165820 (MainThread): On master: COMMIT
2021-01-27 16:16:39.435222 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 16:16:39.436532 (MainThread): On master: Close
2021-01-27 16:16:39.717009 (MainThread): 11:16:39 | 
2021-01-27 16:16:39.718021 (MainThread): 11:16:39 | Finished running 3 snowflake_timetravel_table models in 37.11s.
2021-01-27 16:16:39.718777 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:16:39.719230 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:16:39.747833 (MainThread): 
2021-01-27 16:16:39.748092 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:16:39.748285 (MainThread): 
2021-01-27 16:16:39.748473 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:16:39.748660 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:16:39.748843 (MainThread): 
2021-01-27 16:16:39.749012 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:16:39.749145 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:16:39.749341 (MainThread): 
2021-01-27 16:16:39.749501 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:16:39.749615 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:16:39.749735 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:16:39.750033 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f3a83d908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f38999e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f38999cf8>]}
2021-01-27 16:16:39.750374 (MainThread): Flushing usage events
2021-01-27 16:34:07.150696 (MainThread): Running with dbt=0.18.1
2021-01-27 16:34:07.629850 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:34:07.630997 (MainThread): Tracking: tracking
2021-01-27 16:34:07.631491 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953f70b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953f70b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953f70b588>]}
2021-01-27 16:34:07.701285 (MainThread): Partial parsing not enabled
2021-01-27 16:34:07.702341 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:34:07.705070 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:34:07.737536 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:34:07.739207 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:34:07.748632 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:34:07.750796 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:34:07.755520 (MainThread): Parsing macros/core.sql
2021-01-27 16:34:07.759309 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:34:07.761112 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:34:07.762746 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:34:07.764653 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:34:07.768628 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:34:07.778316 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:34:07.785311 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:34:07.790790 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:34:07.808526 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:34:07.810376 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:34:07.840435 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:34:07.847493 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:34:07.854032 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:34:07.856336 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:34:07.871775 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:34:07.896215 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:34:07.906006 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:34:07.907841 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:34:07.909024 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:34:07.911258 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:34:07.912404 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:34:07.914351 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:34:07.960584 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:34:07.975360 (MainThread): Partial parsing not enabled
2021-01-27 16:34:08.017026 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:34:08.040731 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:34:08.054679 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:34:08.306427 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:34:08.307085 (MainThread): 
2021-01-27 16:34:08.307427 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:34:08.312195 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:34:08.327495 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:34:08.327641 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:34:08.327725 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:34:09.071812 (ThreadPoolExecutor-0_0): subprocess 21177 is still running
2021-01-27 16:34:13.025628 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.70 seconds
2021-01-27 16:34:13.043820 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:34:13.345298 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:34:13.386561 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:34:13.386825 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:34:13.387003 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:34:14.045062 (ThreadPoolExecutor-1_0): subprocess 21276 is still running
2021-01-27 16:34:18.098764 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 4.71 seconds
2021-01-27 16:34:18.644436 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:34:18.989015 (MainThread): Using snowflake connection "master".
2021-01-27 16:34:18.989253 (MainThread): On master: BEGIN
2021-01-27 16:34:18.989391 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:34:19.643256 (MainThread): subprocess 21378 is still running
2021-01-27 16:34:23.398631 (MainThread): SQL status: SUCCESS 1 in 4.41 seconds
2021-01-27 16:34:23.399921 (MainThread): On master: COMMIT
2021-01-27 16:34:23.401461 (MainThread): Using snowflake connection "master".
2021-01-27 16:34:23.402178 (MainThread): On master: COMMIT
2021-01-27 16:34:23.667831 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 16:34:23.669439 (MainThread): On master: Close
2021-01-27 16:34:23.926724 (MainThread): 11:34:23 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:34:23.927197 (MainThread): 11:34:23 | 
2021-01-27 16:34:23.930161 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:34:23.934269 (Thread-1): 11:34:23 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:34:23.935062 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:34:23.935393 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:34:23.989182 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:34:23.989926 (Thread-1): finished collecting timing info
2021-01-27 16:34:24.055610 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:34:24.055766 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:34:24.055855 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:34:24.718703 (Thread-1): subprocess 21529 is still running
2021-01-27 16:34:28.966525 (Thread-1): SQL status: SUCCESS 1 in 4.91 seconds
2021-01-27 16:34:28.980139 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:34:28.980311 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:34:29.204775 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 16:34:29.209564 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:34:29.209992 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 16:34:29.438799 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 16:34:29.440494 (Thread-1): finished collecting timing info
2021-01-27 16:34:29.441142 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:34:29.781367 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:34:29.788371 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd0ba641-9cb1-42fa-8cfd-196d978df9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953f69d400>]}
2021-01-27 16:34:29.795972 (Thread-1): 11:34:29 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.85s]
2021-01-27 16:34:29.796699 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:34:29.797467 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:34:29.800638 (Thread-1): 11:34:29 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:34:29.802575 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:34:29.802862 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:34:29.816176 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:34:29.816589 (Thread-1): finished collecting timing info
2021-01-27 16:34:29.832492 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:34:29.832665 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:34:29.832756 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:34:30.434013 (Thread-1): subprocess 21724 is still running
2021-01-27 16:34:34.347959 (Thread-1): SQL status: SUCCESS 1 in 4.52 seconds
2021-01-27 16:34:34.353508 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:34:34.353730 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:34:34.529536 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 16:34:34.547899 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:34:34.548300 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 16:34:34.767890 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 16:34:34.771161 (Thread-1): finished collecting timing info
2021-01-27 16:34:34.772369 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:34:35.035683 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:34:35.037871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd0ba641-9cb1-42fa-8cfd-196d978df9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953d7247b8>]}
2021-01-27 16:34:35.044729 (Thread-1): 11:34:35 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.24s]
2021-01-27 16:34:35.045359 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:34:35.046028 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:34:35.051578 (Thread-1): 11:34:35 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:34:35.052768 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:34:35.053230 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:34:35.069205 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:34:35.069617 (Thread-1): finished collecting timing info
2021-01-27 16:34:35.085358 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:34:35.085632 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:34:35.085733 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:34:35.691074 (Thread-1): subprocess 21828 is still running
2021-01-27 16:34:39.339851 (Thread-1): SQL status: SUCCESS 1 in 4.25 seconds
2021-01-27 16:34:39.344468 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:34:39.344656 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:34:39.512282 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-27 16:34:39.515811 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:34:39.515937 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 16:34:39.770324 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-27 16:34:39.773392 (Thread-1): finished collecting timing info
2021-01-27 16:34:39.774591 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:34:40.029524 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:34:40.031464 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd0ba641-9cb1-42fa-8cfd-196d978df9bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953d7247b8>]}
2021-01-27 16:34:40.037119 (Thread-1): 11:34:40 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 4.98s]
2021-01-27 16:34:40.037691 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:34:40.101898 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:34:40.102675 (MainThread): Using snowflake connection "master".
2021-01-27 16:34:40.102985 (MainThread): On master: BEGIN
2021-01-27 16:34:40.103240 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:34:40.808062 (MainThread): subprocess 21936 is still running
2021-01-27 16:34:44.688505 (MainThread): SQL status: SUCCESS 1 in 4.59 seconds
2021-01-27 16:34:44.689510 (MainThread): On master: COMMIT
2021-01-27 16:34:44.690589 (MainThread): Using snowflake connection "master".
2021-01-27 16:34:44.691022 (MainThread): On master: COMMIT
2021-01-27 16:34:45.094185 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-27 16:34:45.095141 (MainThread): On master: Close
2021-01-27 16:34:45.383363 (MainThread): 11:34:45 | 
2021-01-27 16:34:45.384295 (MainThread): 11:34:45 | Finished running 3 snowflake_timetravel_table models in 37.08s.
2021-01-27 16:34:45.384897 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:34:45.385336 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:34:45.408237 (MainThread): 
2021-01-27 16:34:45.408486 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:34:45.408612 (MainThread): 
2021-01-27 16:34:45.408728 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:34:45.408828 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:34:45.408925 (MainThread): 
2021-01-27 16:34:45.409025 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:34:45.409114 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:34:45.409202 (MainThread): 
2021-01-27 16:34:45.409297 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:34:45.409384 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:34:45.409477 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:34:45.409712 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9546418978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953d6ae3c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f953c5f32b0>]}
2021-01-27 16:34:45.409980 (MainThread): Flushing usage events
2021-01-27 16:35:45.248218 (MainThread): Running with dbt=0.18.1
2021-01-27 16:35:45.725747 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:35:45.726656 (MainThread): Tracking: tracking
2021-01-27 16:35:45.727006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c107cb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c107cb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c107cbb00>]}
2021-01-27 16:35:45.769207 (MainThread): Partial parsing not enabled
2021-01-27 16:35:45.770307 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:35:45.773073 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:35:45.809067 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:35:45.810930 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:35:45.821430 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:35:45.823666 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:35:45.828801 (MainThread): Parsing macros/core.sql
2021-01-27 16:35:45.832777 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:35:45.834659 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:35:45.836376 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:35:45.838403 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:35:45.842454 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:35:45.852319 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:35:45.859106 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:35:45.864456 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:35:45.881977 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:35:45.883946 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:35:45.912778 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:35:45.919652 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:35:45.926022 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:35:45.927864 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:35:45.942250 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:35:45.963239 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:35:45.972901 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:35:45.975133 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:35:45.976228 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:35:45.978370 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:35:45.979453 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:35:45.981324 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:35:46.027876 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:35:46.042884 (MainThread): Partial parsing not enabled
2021-01-27 16:35:46.083965 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:35:46.108892 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:35:46.121977 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:35:46.361504 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:35:46.362141 (MainThread): 
2021-01-27 16:35:46.362476 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:35:46.367188 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:35:46.385887 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:35:46.386027 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:35:46.386110 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:35:47.069325 (ThreadPoolExecutor-0_0): subprocess 22235 is still running
2021-01-27 16:35:50.672138 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.29 seconds
2021-01-27 16:35:50.690522 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:35:50.970537 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:35:50.984434 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:35:50.984621 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:35:50.984739 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:35:51.627220 (ThreadPoolExecutor-1_0): subprocess 22345 is still running
2021-01-27 16:35:55.508888 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 4.52 seconds
2021-01-27 16:35:56.014589 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:35:56.297534 (MainThread): Using snowflake connection "master".
2021-01-27 16:35:56.297729 (MainThread): On master: BEGIN
2021-01-27 16:35:56.297850 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:35:56.891141 (MainThread): subprocess 22442 is still running
2021-01-27 16:36:00.592683 (MainThread): SQL status: SUCCESS 1 in 4.29 seconds
2021-01-27 16:36:00.593061 (MainThread): On master: COMMIT
2021-01-27 16:36:00.593599 (MainThread): Using snowflake connection "master".
2021-01-27 16:36:00.593769 (MainThread): On master: COMMIT
2021-01-27 16:36:00.872788 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 16:36:00.873199 (MainThread): On master: Close
2021-01-27 16:36:01.123293 (MainThread): 11:36:01 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:36:01.123562 (MainThread): 11:36:01 | 
2021-01-27 16:36:01.125121 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:36:01.127289 (Thread-1): 11:36:01 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:36:01.127696 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:36:01.127871 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:36:01.150344 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:36:01.150760 (Thread-1): finished collecting timing info
2021-01-27 16:36:01.205186 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:36:01.205361 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:36:01.205462 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:36:01.859994 (Thread-1): subprocess 22553 is still running
2021-01-27 16:36:05.706111 (Thread-1): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 16:36:05.744345 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:36:05.744592 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:36:05.909311 (Thread-1): SQL status: SUCCESS 3 in 0.16 seconds
2021-01-27 16:36:05.917500 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:36:05.918344 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 16:36:06.123128 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 16:36:06.125075 (Thread-1): finished collecting timing info
2021-01-27 16:36:06.125819 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:36:06.363581 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:36:06.366614 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '185c2a52-0ef3-4b90-8cbb-6584b060a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0ad2f710>]}
2021-01-27 16:36:06.369774 (Thread-1): 11:36:06 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.24s]
2021-01-27 16:36:06.370282 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:36:06.370608 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:36:06.373708 (Thread-1): 11:36:06 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:36:06.374524 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:36:06.374750 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:36:06.395473 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:36:06.396016 (Thread-1): finished collecting timing info
2021-01-27 16:36:06.433841 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:36:06.434085 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:36:06.434274 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:36:07.099612 (Thread-1): subprocess 22660 is still running
2021-01-27 16:36:10.907702 (Thread-1): SQL status: SUCCESS 1 in 4.47 seconds
2021-01-27 16:36:10.915094 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:36:10.915310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:36:11.097072 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 16:36:11.105115 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:36:11.105357 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 16:36:11.301501 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 16:36:11.303348 (Thread-1): finished collecting timing info
2021-01-27 16:36:11.304003 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:36:11.574381 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:36:11.575622 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '185c2a52-0ef3-4b90-8cbb-6584b060a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0a7419b0>]}
2021-01-27 16:36:11.578551 (Thread-1): 11:36:11 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.20s]
2021-01-27 16:36:11.578815 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:36:11.579101 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:36:11.581246 (Thread-1): 11:36:11 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:36:11.582065 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:36:11.582264 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:36:11.591791 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:36:11.592178 (Thread-1): finished collecting timing info
2021-01-27 16:36:11.609245 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:36:11.609421 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:36:11.609518 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:36:12.191469 (Thread-1): subprocess 22773 is still running
2021-01-27 16:36:15.817110 (Thread-1): SQL status: SUCCESS 1 in 4.21 seconds
2021-01-27 16:36:15.844036 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:36:15.844656 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:36:16.031352 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 16:36:16.035220 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:36:16.035378 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 16:36:16.214825 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 16:36:16.215874 (Thread-1): finished collecting timing info
2021-01-27 16:36:16.216327 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:36:16.535854 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 92, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 16:36:16.539603 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '185c2a52-0ef3-4b90-8cbb-6584b060a998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0a772160>]}
2021-01-27 16:36:16.548205 (Thread-1): 11:36:16 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 4.96s]
2021-01-27 16:36:16.548962 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:36:16.600634 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:36:16.601889 (MainThread): Using snowflake connection "master".
2021-01-27 16:36:16.602363 (MainThread): On master: BEGIN
2021-01-27 16:36:16.602744 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:36:17.350565 (MainThread): subprocess 22869 is still running
2021-01-27 16:36:20.836278 (MainThread): SQL status: SUCCESS 1 in 4.23 seconds
2021-01-27 16:36:20.837458 (MainThread): On master: COMMIT
2021-01-27 16:36:20.838735 (MainThread): Using snowflake connection "master".
2021-01-27 16:36:20.839153 (MainThread): On master: COMMIT
2021-01-27 16:36:21.127263 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 16:36:21.128163 (MainThread): On master: Close
2021-01-27 16:36:21.651761 (MainThread): 11:36:21 | 
2021-01-27 16:36:21.652730 (MainThread): 11:36:21 | Finished running 3 snowflake_timetravel_table models in 35.29s.
2021-01-27 16:36:21.653428 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:36:21.653887 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:36:21.687698 (MainThread): 
2021-01-27 16:36:21.688644 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:36:21.689119 (MainThread): 
2021-01-27 16:36:21.689501 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:36:21.689848 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:36:21.690108 (MainThread): 
2021-01-27 16:36:21.690323 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:36:21.690448 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:36:21.690555 (MainThread): 
2021-01-27 16:36:21.690674 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:36:21.690778 (MainThread):   'relation_columns_different' is undefined
2021-01-27 16:36:21.690892 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:36:21.691362 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c08f07cf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c08f07dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c08ee48d0>]}
2021-01-27 16:36:21.691733 (MainThread): Flushing usage events
2021-01-27 16:38:23.290723 (MainThread): Running with dbt=0.18.1
2021-01-27 16:38:23.856293 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:38:23.857204 (MainThread): Tracking: tracking
2021-01-27 16:38:23.857662 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9117e0c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9117e0c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9117e0c588>]}
2021-01-27 16:38:23.905620 (MainThread): Partial parsing not enabled
2021-01-27 16:38:23.906707 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:38:23.909809 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:38:23.948901 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:38:23.950917 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:38:23.962253 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:38:23.964800 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:38:23.970134 (MainThread): Parsing macros/core.sql
2021-01-27 16:38:23.974661 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:38:23.976744 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:38:23.978711 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:38:23.981131 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:38:23.985743 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:38:23.996790 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:38:24.004386 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:38:24.010458 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:38:24.030308 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:38:24.032534 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:38:24.063588 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:38:24.070728 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:38:24.077243 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:38:24.079205 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:38:24.093880 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:38:24.116980 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:38:24.126561 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:38:24.128554 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:38:24.129609 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:38:24.132187 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:38:24.133377 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:38:24.135175 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:38:24.182620 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:38:24.197428 (MainThread): Partial parsing not enabled
2021-01-27 16:38:24.238586 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:38:24.264219 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:38:24.277047 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:38:24.519819 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:38:24.520532 (MainThread): 
2021-01-27 16:38:24.520876 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:38:24.525605 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:38:24.541740 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:38:24.541975 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:38:24.542064 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:38:25.300107 (ThreadPoolExecutor-0_0): subprocess 23155 is still running
2021-01-27 16:38:29.125883 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.58 seconds
2021-01-27 16:38:29.136615 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:38:29.424064 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:38:29.440424 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:38:29.440663 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:38:29.440821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:38:30.025550 (ThreadPoolExecutor-1_0): subprocess 23258 is still running
2021-01-27 16:38:33.656883 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 4.21 seconds
2021-01-27 16:38:34.196090 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:38:34.502140 (MainThread): Using snowflake connection "master".
2021-01-27 16:38:34.502326 (MainThread): On master: BEGIN
2021-01-27 16:38:34.502425 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:38:35.174106 (MainThread): subprocess 23357 is still running
2021-01-27 16:38:38.962260 (MainThread): SQL status: SUCCESS 1 in 4.46 seconds
2021-01-27 16:38:38.962507 (MainThread): On master: COMMIT
2021-01-27 16:38:38.962726 (MainThread): Using snowflake connection "master".
2021-01-27 16:38:38.962810 (MainThread): On master: COMMIT
2021-01-27 16:38:39.266287 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 16:38:39.266551 (MainThread): On master: Close
2021-01-27 16:38:39.568987 (MainThread): 11:38:39 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:38:39.569348 (MainThread): 11:38:39 | 
2021-01-27 16:38:39.571495 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:38:39.575380 (Thread-1): 11:38:39 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:38:39.576092 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:38:39.576361 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:38:39.607938 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:38:39.608348 (Thread-1): finished collecting timing info
2021-01-27 16:38:39.658627 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:38:39.658802 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:38:39.658917 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:38:40.243287 (Thread-1): subprocess 23464 is still running
2021-01-27 16:38:43.828269 (Thread-1): SQL status: SUCCESS 1 in 4.17 seconds
2021-01-27 16:38:43.845675 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:38:43.845862 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:38:44.034303 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 16:38:44.040942 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:38:44.041165 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 16:38:44.296625 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-27 16:38:44.303518 (Thread-1): finished collecting timing info
2021-01-27 16:38:44.304733 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:38:44.664246 (Thread-1): Compilation Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp, but its type is null.
  
  > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
  > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 95, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 26, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/impl.py", line 147, in drop_relation
    .format(relation))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp, but its type is null.
  
  > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
  > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 16:38:44.666035 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dab1dd-12a6-4c2a-bbf4-c27e01197b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115e6e160>]}
2021-01-27 16:38:44.668081 (Thread-1): 11:38:44 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.09s]
2021-01-27 16:38:44.668325 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:38:44.668560 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:38:44.670418 (Thread-1): 11:38:44 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:38:44.670911 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:38:44.671120 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:38:44.683452 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:38:44.683858 (Thread-1): finished collecting timing info
2021-01-27 16:38:44.699489 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:38:44.699663 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:38:44.699763 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:38:45.316119 (Thread-1): subprocess 23560 is still running
2021-01-27 16:38:49.091000 (Thread-1): SQL status: SUCCESS 1 in 4.39 seconds
2021-01-27 16:38:49.098763 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:38:49.098999 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:38:49.311009 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 16:38:49.315029 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:38:49.315181 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 16:38:49.555847 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 16:38:49.559486 (Thread-1): finished collecting timing info
2021-01-27 16:38:49.561028 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:38:49.796116 (Thread-1): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp, but its type is null.
  
  > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
  > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 95, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 26, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/impl.py", line 147, in drop_relation
    .format(relation))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp, but its type is null.
  
  > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
  > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 16:38:49.798629 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dab1dd-12a6-4c2a-bbf4-c27e01197b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115e5cc50>]}
2021-01-27 16:38:49.803665 (Thread-1): 11:38:49 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.13s]
2021-01-27 16:38:49.804247 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:38:49.804709 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:38:49.807214 (Thread-1): 11:38:49 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:38:49.808548 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:38:49.808810 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:38:49.820892 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:38:49.821320 (Thread-1): finished collecting timing info
2021-01-27 16:38:49.833716 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:38:49.833876 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:38:49.833966 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:38:50.431265 (Thread-1): subprocess 23667 is still running
2021-01-27 16:38:54.428963 (Thread-1): SQL status: SUCCESS 1 in 4.59 seconds
2021-01-27 16:38:54.433153 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:38:54.433278 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:38:54.586867 (Thread-1): SQL status: SUCCESS 3 in 0.15 seconds
2021-01-27 16:38:54.602687 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:38:54.603138 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 16:38:54.803660 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 16:38:54.807979 (Thread-1): finished collecting timing info
2021-01-27 16:38:54.809562 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:38:55.127764 (Thread-1): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp, but its type is null.
  
  > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
  > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 95, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 26, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/impl.py", line 147, in drop_relation
    .format(relation))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp, but its type is null.
  
  > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
  > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 16:38:55.130690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38dab1dd-12a6-4c2a-bbf4-c27e01197b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115e5cc50>]}
2021-01-27 16:38:55.138006 (Thread-1): 11:38:55 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.32s]
2021-01-27 16:38:55.138814 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:38:55.147111 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:38:55.148063 (MainThread): Using snowflake connection "master".
2021-01-27 16:38:55.148439 (MainThread): On master: BEGIN
2021-01-27 16:38:55.148793 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:38:55.752595 (MainThread): subprocess 23764 is still running
2021-01-27 16:38:59.943195 (MainThread): SQL status: SUCCESS 1 in 4.79 seconds
2021-01-27 16:38:59.945925 (MainThread): On master: COMMIT
2021-01-27 16:38:59.947764 (MainThread): Using snowflake connection "master".
2021-01-27 16:38:59.952062 (MainThread): On master: COMMIT
2021-01-27 16:39:00.247109 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 16:39:00.248042 (MainThread): On master: Close
2021-01-27 16:39:00.533174 (MainThread): 11:39:00 | 
2021-01-27 16:39:00.534176 (MainThread): 11:39:00 | Finished running 3 snowflake_timetravel_table models in 36.01s.
2021-01-27 16:39:00.534943 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:39:00.535391 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:39:00.568323 (MainThread): 
2021-01-27 16:39:00.568556 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:39:00.568695 (MainThread): 
2021-01-27 16:39:00.568826 (MainThread): Compilation Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 16:39:00.568937 (MainThread):   Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp, but its type is null.
2021-01-27 16:39:00.569033 (MainThread):   
2021-01-27 16:39:00.569125 (MainThread):   > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
2021-01-27 16:39:00.569216 (MainThread):   > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:39:00.569306 (MainThread):   > called by model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 16:39:00.569406 (MainThread): 
2021-01-27 16:39:00.569514 (MainThread): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 16:39:00.569614 (MainThread):   Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp, but its type is null.
2021-01-27 16:39:00.569758 (MainThread):   
2021-01-27 16:39:00.569848 (MainThread):   > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
2021-01-27 16:39:00.569935 (MainThread):   > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:39:00.570021 (MainThread):   > called by model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 16:39:00.570118 (MainThread): 
2021-01-27 16:39:00.570237 (MainThread): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 16:39:00.570339 (MainThread):   Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp, but its type is null.
2021-01-27 16:39:00.570428 (MainThread):   
2021-01-27 16:39:00.570515 (MainThread):   > in macro drop_relation_if_exists (macros/materializations/helpers.sql)
2021-01-27 16:39:00.570602 (MainThread):   > called by macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:39:00.570687 (MainThread):   > called by model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 16:39:00.570788 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:39:00.571060 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115dac0b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115dac2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9115db8940>]}
2021-01-27 16:39:00.571378 (MainThread): Flushing usage events
2021-01-27 16:45:57.722646 (MainThread): Running with dbt=0.18.1
2021-01-27 16:45:58.196565 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:45:58.197422 (MainThread): Tracking: tracking
2021-01-27 16:45:58.197772 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445ecb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445ecb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445ecb588>]}
2021-01-27 16:45:58.244532 (MainThread): Partial parsing not enabled
2021-01-27 16:45:58.245621 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:45:58.248274 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:45:58.283519 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:45:58.285355 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:45:58.298131 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:45:58.300678 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:45:58.306422 (MainThread): Parsing macros/core.sql
2021-01-27 16:45:58.311152 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:45:58.313295 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:45:58.315251 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:45:58.317525 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:45:58.322884 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:45:58.334361 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:45:58.343670 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:45:58.350072 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:45:58.372333 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:45:58.374779 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:45:58.406916 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:45:58.414155 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:45:58.420722 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:45:58.422749 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:45:58.437393 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:45:58.459122 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:45:58.468472 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:45:58.470324 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:45:58.471354 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:45:58.473553 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:45:58.474706 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:45:58.476498 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:45:58.521462 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:45:58.536577 (MainThread): Partial parsing not enabled
2021-01-27 16:45:58.597420 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:45:58.643481 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:45:58.659242 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:45:58.915464 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:45:58.916143 (MainThread): 
2021-01-27 16:45:58.916479 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:45:58.921354 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:45:58.939209 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:45:58.939355 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:45:58.939452 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:45:59.659108 (ThreadPoolExecutor-0_0): subprocess 24444 is still running
2021-01-27 16:46:03.533985 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.59 seconds
2021-01-27 16:46:03.572237 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:46:03.883774 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:46:03.895519 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:46:03.895683 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:46:03.895796 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:46:04.492941 (ThreadPoolExecutor-1_0): subprocess 24554 is still running
2021-01-27 16:46:08.100887 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 4.21 seconds
2021-01-27 16:46:08.595694 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:46:08.846554 (MainThread): Using snowflake connection "master".
2021-01-27 16:46:08.846724 (MainThread): On master: BEGIN
2021-01-27 16:46:08.846816 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:46:09.457165 (MainThread): subprocess 24655 is still running
2021-01-27 16:46:13.177757 (MainThread): SQL status: SUCCESS 1 in 4.33 seconds
2021-01-27 16:46:13.178022 (MainThread): On master: COMMIT
2021-01-27 16:46:13.178283 (MainThread): Using snowflake connection "master".
2021-01-27 16:46:13.178379 (MainThread): On master: COMMIT
2021-01-27 16:46:13.485718 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 16:46:13.485941 (MainThread): On master: Close
2021-01-27 16:46:13.780837 (MainThread): 11:46:13 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:46:13.781917 (MainThread): 11:46:13 | 
2021-01-27 16:46:13.787596 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:46:13.793798 (Thread-1): 11:46:13 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:46:13.795065 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:46:13.795541 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:46:13.828440 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:46:13.828833 (Thread-1): finished collecting timing info
2021-01-27 16:46:13.876672 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:46:13.876826 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:46:13.876921 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:46:14.463916 (Thread-1): subprocess 24771 is still running
2021-01-27 16:46:18.259532 (Thread-1): SQL status: SUCCESS 1 in 4.38 seconds
2021-01-27 16:46:18.331393 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:46:18.331667 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:46:18.489692 (Thread-1): SQL status: SUCCESS 3 in 0.16 seconds
2021-01-27 16:46:18.505606 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:46:18.506099 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 16:46:18.734118 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 16:46:18.739115 (Thread-1): finished collecting timing info
2021-01-27 16:46:18.741245 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:46:18.987459 (Thread-1): Compilation Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp, but its type is null.
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 95, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/impl.py", line 147, in drop_relation
    .format(relation))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp, but its type is null.
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 16:46:18.992965 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b3df79-a1ce-4a1e-8569-24577c7701a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44403c860>]}
2021-01-27 16:46:18.999666 (Thread-1): 11:46:18 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.20s]
2021-01-27 16:46:19.000394 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:46:19.001238 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:46:19.004133 (Thread-1): 11:46:19 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:46:19.005691 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:46:19.006014 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:46:19.018961 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:46:19.019364 (Thread-1): finished collecting timing info
2021-01-27 16:46:19.032826 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:46:19.032988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:46:19.033079 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:46:19.684245 (Thread-1): subprocess 24880 is still running
2021-01-27 16:46:23.521141 (Thread-1): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 16:46:23.543489 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:46:23.544327 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:46:23.864382 (Thread-1): SQL status: SUCCESS 3 in 0.32 seconds
2021-01-27 16:46:23.882277 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:46:23.882894 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 16:46:24.076255 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 16:46:24.078117 (Thread-1): finished collecting timing info
2021-01-27 16:46:24.078819 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:46:24.324033 (Thread-1): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp, but its type is null.
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 95, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/impl.py", line 147, in drop_relation
    .format(relation))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp, but its type is null.
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 16:46:24.328006 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b3df79-a1ce-4a1e-8569-24577c7701a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445e15390>]}
2021-01-27 16:46:24.331867 (Thread-1): 11:46:24 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.32s]
2021-01-27 16:46:24.332230 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:46:24.332591 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:46:24.335348 (Thread-1): 11:46:24 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:46:24.336361 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:46:24.336609 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:46:24.354113 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:46:24.354557 (Thread-1): finished collecting timing info
2021-01-27 16:46:24.371320 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:46:24.371494 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:46:24.371596 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:46:24.948503 (Thread-1): subprocess 24982 is still running
2021-01-27 16:46:28.662704 (Thread-1): SQL status: SUCCESS 1 in 4.29 seconds
2021-01-27 16:46:28.682899 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:46:28.683267 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:46:28.928127 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 16:46:28.952597 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:46:28.952952 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 16:46:29.153162 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 16:46:29.158959 (Thread-1): finished collecting timing info
2021-01-27 16:46:29.161384 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:46:29.511269 (Thread-1): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp, but its type is null.
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 95, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/impl.py", line 147, in drop_relation
    .format(relation))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp, but its type is null.
  
  > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  > called by model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 16:46:29.514297 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b3df79-a1ce-4a1e-8569-24577c7701a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44409e0b8>]}
2021-01-27 16:46:29.523453 (Thread-1): 11:46:29 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.18s]
2021-01-27 16:46:29.524630 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:46:29.582176 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:46:29.583399 (MainThread): Using snowflake connection "master".
2021-01-27 16:46:29.583878 (MainThread): On master: BEGIN
2021-01-27 16:46:29.584282 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:46:30.306899 (MainThread): subprocess 25084 is still running
2021-01-27 16:46:34.043408 (MainThread): SQL status: SUCCESS 1 in 4.46 seconds
2021-01-27 16:46:34.044178 (MainThread): On master: COMMIT
2021-01-27 16:46:34.044977 (MainThread): Using snowflake connection "master".
2021-01-27 16:46:34.045301 (MainThread): On master: COMMIT
2021-01-27 16:46:34.377695 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 16:46:34.378027 (MainThread): On master: Close
2021-01-27 16:46:34.699321 (MainThread): 11:46:34 | 
2021-01-27 16:46:34.699549 (MainThread): 11:46:34 | Finished running 3 snowflake_timetravel_table models in 35.78s.
2021-01-27 16:46:34.699663 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:46:34.699736 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:46:34.711229 (MainThread): 
2021-01-27 16:46:34.711421 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:46:34.711527 (MainThread): 
2021-01-27 16:46:34.711636 (MainThread): Compilation Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 16:46:34.711729 (MainThread):   Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp, but its type is null.
2021-01-27 16:46:34.711809 (MainThread):   
2021-01-27 16:46:34.711886 (MainThread):   > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:46:34.711961 (MainThread):   > called by model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 16:46:34.712044 (MainThread): 
2021-01-27 16:46:34.712135 (MainThread): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 16:46:34.712218 (MainThread):   Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp, but its type is null.
2021-01-27 16:46:34.712316 (MainThread):   
2021-01-27 16:46:34.712403 (MainThread):   > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:46:34.712478 (MainThread):   > called by model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 16:46:34.712559 (MainThread): 
2021-01-27 16:46:34.712649 (MainThread): Compilation Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 16:46:34.712732 (MainThread):   Tried to drop relation USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp, but its type is null.
2021-01-27 16:46:34.712805 (MainThread):   
2021-01-27 16:46:34.712877 (MainThread):   > in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:46:34.712950 (MainThread):   > called by model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 16:46:34.713043 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:46:34.713272 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44408df98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445c4c438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe444128080>]}
2021-01-27 16:46:34.713518 (MainThread): Flushing usage events
2021-01-27 16:49:20.459465 (MainThread): Running with dbt=0.18.1
2021-01-27 16:49:20.947223 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:49:20.948303 (MainThread): Tracking: tracking
2021-01-27 16:49:20.948837 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604dcce908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604dcce518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604dcce550>]}
2021-01-27 16:49:21.017748 (MainThread): Partial parsing not enabled
2021-01-27 16:49:21.018906 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:49:21.021586 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:49:21.056170 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:49:21.057952 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:49:21.068313 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:49:21.070599 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:49:21.075556 (MainThread): Parsing macros/core.sql
2021-01-27 16:49:21.079492 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:49:21.081347 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:49:21.083068 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:49:21.085096 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:49:21.089326 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:49:21.099634 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:49:21.106989 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:49:21.112732 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:49:21.130935 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:49:21.132834 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:49:21.163404 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:49:21.170611 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:49:21.177085 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:49:21.179147 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:49:21.194173 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:49:21.216720 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:49:21.225883 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:49:21.227573 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:49:21.228578 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:49:21.230684 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:49:21.231833 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:49:21.233590 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:49:21.281606 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:49:21.297789 (MainThread): Partial parsing not enabled
2021-01-27 16:49:21.341299 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:49:21.365689 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:49:21.378253 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:49:21.630991 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:49:21.631662 (MainThread): 
2021-01-27 16:49:21.632002 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:49:21.636778 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:49:21.652696 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:49:21.652842 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:49:21.652927 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:49:22.496155 (ThreadPoolExecutor-0_0): subprocess 30578 is still running
2021-01-27 16:49:26.866963 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.21 seconds
2021-01-27 16:49:26.901037 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:49:27.212987 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:49:27.231549 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:49:27.231761 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:49:27.231907 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:49:27.868382 (ThreadPoolExecutor-1_0): subprocess 30680 is still running
2021-01-27 16:49:31.514050 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 4.28 seconds
2021-01-27 16:49:31.973325 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:49:32.301441 (MainThread): Using snowflake connection "master".
2021-01-27 16:49:32.301641 (MainThread): On master: BEGIN
2021-01-27 16:49:32.301755 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:49:32.908680 (MainThread): subprocess 30779 is still running
2021-01-27 16:49:36.771408 (MainThread): SQL status: SUCCESS 1 in 4.47 seconds
2021-01-27 16:49:36.772386 (MainThread): On master: COMMIT
2021-01-27 16:49:36.773681 (MainThread): Using snowflake connection "master".
2021-01-27 16:49:36.774434 (MainThread): On master: COMMIT
2021-01-27 16:49:37.242953 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-27 16:49:37.244130 (MainThread): On master: Close
2021-01-27 16:49:38.813345 (MainThread): 11:49:38 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:49:38.814465 (MainThread): 11:49:38 | 
2021-01-27 16:49:38.819249 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:49:38.823971 (Thread-1): 11:49:38 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:49:38.824713 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:49:38.825029 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:49:38.859537 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:49:38.859937 (Thread-1): finished collecting timing info
2021-01-27 16:49:38.899977 (Thread-1): finished collecting timing info
2021-01-27 16:49:38.900528 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  cannot assign attribute on non-namespace object
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 80, in macro
jinja2.exceptions.TemplateRuntimeError: cannot assign attribute on non-namespace object

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  cannot assign attribute on non-namespace object
2021-01-27 16:49:38.901780 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b481f234-99d2-46ee-ac07-13c49eac9c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c1ad978>]}
2021-01-27 16:49:38.903116 (Thread-1): 11:49:38 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 0.08s]
2021-01-27 16:49:38.903280 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:49:38.903440 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:49:38.904516 (Thread-1): 11:49:38 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:49:38.904832 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:49:38.904939 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:49:38.913224 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:49:38.913550 (Thread-1): finished collecting timing info
2021-01-27 16:49:38.924155 (Thread-1): finished collecting timing info
2021-01-27 16:49:38.924649 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  cannot assign attribute on non-namespace object
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 80, in macro
jinja2.exceptions.TemplateRuntimeError: cannot assign attribute on non-namespace object

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  cannot assign attribute on non-namespace object
2021-01-27 16:49:38.925047 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b481f234-99d2-46ee-ac07-13c49eac9c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c090438>]}
2021-01-27 16:49:38.926748 (Thread-1): 11:49:38 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 0.02s]
2021-01-27 16:49:38.927204 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:49:38.927483 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:49:38.929681 (Thread-1): 11:49:38 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:49:38.930413 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:49:38.930620 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:49:38.939270 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:49:38.939635 (Thread-1): finished collecting timing info
2021-01-27 16:49:38.952242 (Thread-1): finished collecting timing info
2021-01-27 16:49:38.952805 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  cannot assign attribute on non-namespace object
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 80, in macro
jinja2.exceptions.TemplateRuntimeError: cannot assign attribute on non-namespace object

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  cannot assign attribute on non-namespace object
2021-01-27 16:49:38.953210 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b481f234-99d2-46ee-ac07-13c49eac9c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c07f828>]}
2021-01-27 16:49:38.954452 (Thread-1): 11:49:38 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 0.02s]
2021-01-27 16:49:38.954594 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:49:39.024064 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:49:39.024541 (MainThread): Using snowflake connection "master".
2021-01-27 16:49:39.024726 (MainThread): On master: BEGIN
2021-01-27 16:49:39.024894 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:49:39.956388 (MainThread): subprocess 30893 is still running
2021-01-27 16:49:44.565822 (MainThread): SQL status: SUCCESS 1 in 5.54 seconds
2021-01-27 16:49:44.566901 (MainThread): On master: COMMIT
2021-01-27 16:49:44.567931 (MainThread): Using snowflake connection "master".
2021-01-27 16:49:44.568351 (MainThread): On master: COMMIT
2021-01-27 16:49:44.872611 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 16:49:44.873530 (MainThread): On master: Close
2021-01-27 16:49:45.202840 (MainThread): 11:49:45 | 
2021-01-27 16:49:45.204049 (MainThread): 11:49:45 | Finished running 3 snowflake_timetravel_table models in 23.57s.
2021-01-27 16:49:45.204697 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:49:45.205312 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:49:45.234413 (MainThread): 
2021-01-27 16:49:45.234663 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:49:45.234939 (MainThread): 
2021-01-27 16:49:45.235095 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:49:45.235214 (MainThread):   cannot assign attribute on non-namespace object
2021-01-27 16:49:45.235328 (MainThread): 
2021-01-27 16:49:45.235462 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:49:45.235606 (MainThread):   cannot assign attribute on non-namespace object
2021-01-27 16:49:45.235715 (MainThread): 
2021-01-27 16:49:45.235830 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 16:49:45.235936 (MainThread):   cannot assign attribute on non-namespace object
2021-01-27 16:49:45.236049 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:49:45.236350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c141128>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c097c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f604c097ef0>]}
2021-01-27 16:49:45.236684 (MainThread): Flushing usage events
2021-01-27 16:56:41.719220 (MainThread): Running with dbt=0.18.1
2021-01-27 16:56:42.185637 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 16:56:42.186528 (MainThread): Tracking: tracking
2021-01-27 16:56:42.186882 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcb28a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcb28a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bcb28a588>]}
2021-01-27 16:56:42.230080 (MainThread): Partial parsing not enabled
2021-01-27 16:56:42.231157 (MainThread): Parsing macros/catalog.sql
2021-01-27 16:56:42.233914 (MainThread): Parsing macros/adapters.sql
2021-01-27 16:56:42.268673 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 16:56:42.270509 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 16:56:42.282079 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 16:56:42.284887 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 16:56:42.290488 (MainThread): Parsing macros/core.sql
2021-01-27 16:56:42.295011 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 16:56:42.297083 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 16:56:42.298921 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 16:56:42.301142 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 16:56:42.305720 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 16:56:42.316845 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 16:56:42.324311 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 16:56:42.329979 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 16:56:42.348219 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 16:56:42.350181 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 16:56:42.380365 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 16:56:42.387859 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 16:56:42.394429 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 16:56:42.396422 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 16:56:42.412458 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 16:56:42.435357 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 16:56:42.444954 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 16:56:42.446735 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 16:56:42.447860 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 16:56:42.449993 (MainThread): Parsing macros/etc/query.sql
2021-01-27 16:56:42.451083 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 16:56:42.452845 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 16:56:42.500052 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 16:56:42.515908 (MainThread): Partial parsing not enabled
2021-01-27 16:56:42.559725 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:56:42.584977 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:56:42.598035 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:56:42.848215 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 16:56:42.848895 (MainThread): 
2021-01-27 16:56:42.849222 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:56:42.854142 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 16:56:42.872899 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 16:56:42.873059 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 16:56:42.873145 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 16:56:43.630102 (ThreadPoolExecutor-0_0): subprocess 1305 is still running
2021-01-27 16:56:47.520605 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.65 seconds
2021-01-27 16:56:47.555752 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 16:56:48.137754 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:56:48.165642 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 16:56:48.165871 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 16:56:48.166019 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 16:56:48.784059 (ThreadPoolExecutor-1_0): subprocess 1421 is still running
2021-01-27 16:56:52.410626 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 4.24 seconds
2021-01-27 16:56:52.931185 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 16:56:53.244421 (MainThread): Using snowflake connection "master".
2021-01-27 16:56:53.244656 (MainThread): On master: BEGIN
2021-01-27 16:56:53.244807 (MainThread): Opening a new connection, currently in state init
2021-01-27 16:56:53.838344 (MainThread): subprocess 1517 is still running
2021-01-27 16:56:57.691854 (MainThread): SQL status: SUCCESS 1 in 4.45 seconds
2021-01-27 16:56:57.692160 (MainThread): On master: COMMIT
2021-01-27 16:56:57.692460 (MainThread): Using snowflake connection "master".
2021-01-27 16:56:57.692585 (MainThread): On master: COMMIT
2021-01-27 16:56:58.024318 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 16:56:58.025103 (MainThread): On master: Close
2021-01-27 16:56:58.283304 (MainThread): 11:56:58 | Concurrency: 1 threads (target='snowflake')
2021-01-27 16:56:58.283695 (MainThread): 11:56:58 | 
2021-01-27 16:56:58.285824 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:56:58.288497 (Thread-1): 11:56:58 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 16:56:58.289102 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:56:58.289323 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:56:58.313617 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 16:56:58.314137 (Thread-1): finished collecting timing info
2021-01-27 16:56:58.368904 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:56:58.369117 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:56:58.369235 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:56:59.103707 (Thread-1): subprocess 1622 is still running
2021-01-27 16:57:03.277242 (Thread-1): SQL status: SUCCESS 1 in 4.91 seconds
2021-01-27 16:57:03.302902 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:57:03.303135 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:57:03.550428 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-27 16:57:03.557062 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:57:03.557294 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 16:57:03.742428 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 16:57:03.770803 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:57:03.771085 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 16:57:04.013709 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 16:57:04.021135 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 16:57:04.021752 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 16:57:04.264433 (Thread-1): Snowflake query id: 0199e4b9-0517-67b4-0000-44a93898792a
2021-01-27 16:57:04.264594 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 16:57:04.264803 (Thread-1): finished collecting timing info
2021-01-27 16:57:04.265201 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 16:57:04.623703 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 16:57:04.631125 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4b6631-a74f-4454-a1f5-399ab8cbf5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc9825b00>]}
2021-01-27 16:57:04.636731 (Thread-1): 11:57:04 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 6.34s]
2021-01-27 16:57:04.637270 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 16:57:04.637888 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:57:04.642609 (Thread-1): 11:57:04 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 16:57:04.643643 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:57:04.644051 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:57:04.659789 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 16:57:04.660220 (Thread-1): finished collecting timing info
2021-01-27 16:57:04.674295 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:57:04.674497 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:57:04.674592 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:57:05.266535 (Thread-1): subprocess 1734 is still running
2021-01-27 16:57:09.597408 (Thread-1): SQL status: SUCCESS 1 in 4.92 seconds
2021-01-27 16:57:09.602124 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:57:09.602309 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:57:09.788861 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 16:57:09.793018 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:57:09.793180 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 16:57:10.363545 (Thread-1): SQL status: SUCCESS 3 in 0.57 seconds
2021-01-27 16:57:10.376078 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:57:10.376479 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 16:57:10.641395 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 16:57:10.646162 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 16:57:10.646548 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 16:57:10.829548 (Thread-1): Snowflake query id: 0199e4b9-05e9-e7f6-0000-44a93898798e
2021-01-27 16:57:10.829776 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 16:57:10.830091 (Thread-1): finished collecting timing info
2021-01-27 16:57:10.830744 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 16:57:11.189250 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 16:57:11.191583 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4b6631-a74f-4454-a1f5-399ab8cbf5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc9310f60>]}
2021-01-27 16:57:11.197407 (Thread-1): 11:57:11 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 6.55s]
2021-01-27 16:57:11.197951 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 16:57:11.198848 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:57:11.204246 (Thread-1): 11:57:11 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 16:57:11.205338 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:57:11.205751 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:57:11.229291 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 16:57:11.229913 (Thread-1): finished collecting timing info
2021-01-27 16:57:11.246070 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:57:11.246247 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 16:57:11.246341 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 16:57:11.871863 (Thread-1): subprocess 1840 is still running
2021-01-27 16:57:16.402038 (Thread-1): SQL status: SUCCESS 1 in 5.16 seconds
2021-01-27 16:57:16.418188 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:57:16.418680 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:57:16.607458 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 16:57:16.618895 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:57:16.619300 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 16:57:16.921173 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-27 16:57:16.941289 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:57:16.941716 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 16:57:18.065013 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-27 16:57:18.073286 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 16:57:18.073971 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 16:57:18.320858 (Thread-1): Snowflake query id: 0199e4b9-056a-91e8-0000-44a938986e32
2021-01-27 16:57:18.321001 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 16:57:18.321218 (Thread-1): finished collecting timing info
2021-01-27 16:57:18.321602 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 16:57:18.635763 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 16:57:18.637635 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4b6631-a74f-4454-a1f5-399ab8cbf5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc923f588>]}
2021-01-27 16:57:18.641643 (Thread-1): 11:57:18 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 7.43s]
2021-01-27 16:57:18.642017 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 16:57:18.684073 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 16:57:18.684469 (MainThread): Using snowflake connection "master".
2021-01-27 16:57:18.684576 (MainThread): On master: BEGIN
2021-01-27 16:57:18.684672 (MainThread): Opening a new connection, currently in state closed
2021-01-27 16:57:19.294566 (MainThread): subprocess 1945 is still running
2021-01-27 16:57:23.016167 (MainThread): SQL status: SUCCESS 1 in 4.33 seconds
2021-01-27 16:57:23.016457 (MainThread): On master: COMMIT
2021-01-27 16:57:23.016717 (MainThread): Using snowflake connection "master".
2021-01-27 16:57:23.016818 (MainThread): On master: COMMIT
2021-01-27 16:57:23.279865 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 16:57:23.280094 (MainThread): On master: Close
2021-01-27 16:57:23.542534 (MainThread): 11:57:23 | 
2021-01-27 16:57:23.543491 (MainThread): 11:57:23 | Finished running 3 snowflake_timetravel_table models in 40.69s.
2021-01-27 16:57:23.544199 (MainThread): Connection 'master' was properly closed.
2021-01-27 16:57:23.544675 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 16:57:23.567494 (MainThread): 
2021-01-27 16:57:23.567704 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 16:57:23.567865 (MainThread): 
2021-01-27 16:57:23.568012 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 16:57:23.568132 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 16:57:23.568243 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 16:57:23.568350 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 16:57:23.568463 (MainThread): 
2021-01-27 16:57:23.568600 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 16:57:23.568707 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 16:57:23.568811 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 16:57:23.568934 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 16:57:23.569052 (MainThread): 
2021-01-27 16:57:23.569179 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 16:57:23.569309 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 16:57:23.569426 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 16:57:23.569545 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 16:57:23.569691 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 16:57:23.569950 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc812ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc812e198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bc812ef98>]}
2021-01-27 16:57:23.570238 (MainThread): Flushing usage events
2021-01-27 17:14:33.373592 (MainThread): Running with dbt=0.18.1
2021-01-27 17:14:33.833220 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:14:33.834250 (MainThread): Tracking: tracking
2021-01-27 17:14:33.834600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843484f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843484f4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f843484f518>]}
2021-01-27 17:14:33.876414 (MainThread): Partial parsing not enabled
2021-01-27 17:14:33.877632 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:14:33.882630 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:14:33.916972 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:14:33.918747 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:14:33.929253 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:14:33.931408 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:14:33.936650 (MainThread): Parsing macros/core.sql
2021-01-27 17:14:33.940838 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:14:33.942875 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:14:33.944676 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:14:33.946768 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:14:33.951116 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:14:33.961333 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:14:33.968544 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:14:33.973980 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:14:33.992339 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:14:33.994689 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:14:34.035677 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:14:34.043206 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:14:34.049765 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:14:34.051753 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:14:34.068773 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:14:34.092746 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:14:34.102185 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:14:34.104846 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:14:34.106894 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:14:34.109375 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:14:34.110623 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:14:34.112582 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:14:34.160809 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:14:34.176071 (MainThread): Partial parsing not enabled
2021-01-27 17:14:34.218185 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:14:34.241951 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:14:34.254034 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:14:34.491053 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:14:34.491695 (MainThread): 
2021-01-27 17:14:34.492017 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:14:34.496680 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:14:34.512022 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:14:34.512161 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:14:34.512244 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:14:36.523125 (ThreadPoolExecutor-0_0): subprocess 6633 is still running
2021-01-27 17:14:42.267129 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 7.75 seconds
2021-01-27 17:14:42.306298 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:14:42.580296 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:14:42.596892 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:14:42.597289 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:14:42.597471 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:14:43.407757 (ThreadPoolExecutor-1_0): subprocess 6750 is still running
2021-01-27 17:14:47.846388 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 5.25 seconds
2021-01-27 17:14:48.328919 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:14:49.332595 (MainThread): Using snowflake connection "master".
2021-01-27 17:14:49.332829 (MainThread): On master: BEGIN
2021-01-27 17:14:49.332978 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:14:50.623561 (MainThread): subprocess 6882 is still running
2021-01-27 17:14:55.949408 (MainThread): SQL status: SUCCESS 1 in 6.62 seconds
2021-01-27 17:14:55.949772 (MainThread): On master: COMMIT
2021-01-27 17:14:55.950134 (MainThread): Using snowflake connection "master".
2021-01-27 17:14:55.950281 (MainThread): On master: COMMIT
2021-01-27 17:14:56.267010 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 17:14:56.267578 (MainThread): On master: Close
2021-01-27 17:14:57.648233 (MainThread): 12:14:57 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:14:57.648611 (MainThread): 12:14:57 | 
2021-01-27 17:14:57.650643 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:14:57.654303 (Thread-1): 12:14:57 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:14:57.655031 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:14:57.655302 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:14:57.693838 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:14:57.694374 (Thread-1): finished collecting timing info
2021-01-27 17:14:57.800624 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:14:57.800865 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:14:57.801021 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:14:58.692376 (Thread-1): subprocess 6984 is still running
2021-01-27 17:15:04.530087 (Thread-1): SQL status: SUCCESS 1 in 6.73 seconds
2021-01-27 17:15:04.575969 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:15:04.576155 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:15:05.027412 (Thread-1): SQL status: SUCCESS 3 in 0.45 seconds
2021-01-27 17:15:05.040024 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:15:05.040448 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 17:15:05.288012 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-27 17:15:05.311396 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:15:05.311637 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 17:15:06.594816 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-27 17:15:06.597204 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:15:06.597559 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 17:15:07.126147 (Thread-1): Snowflake query id: 0199e4cb-0554-f094-0000-44a9389900a6
2021-01-27 17:15:07.126542 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:15:07.127208 (Thread-1): finished collecting timing info
2021-01-27 17:15:07.128448 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:15:07.643997 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:15:07.658398 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43152e17-f2a2-48f9-9bb1-c50f30166072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8434093d30>]}
2021-01-27 17:15:07.669143 (Thread-1): 12:15:07 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 10.00s]
2021-01-27 17:15:07.670206 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:15:07.671316 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:15:07.682071 (Thread-1): 12:15:07 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:15:07.685122 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:15:07.687497 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:15:07.712962 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:15:07.713397 (Thread-1): finished collecting timing info
2021-01-27 17:15:07.731417 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:15:07.731576 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:15:07.731705 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:15:08.487704 (Thread-1): subprocess 7096 is still running
2021-01-27 17:15:13.088064 (Thread-1): SQL status: SUCCESS 1 in 5.36 seconds
2021-01-27 17:15:13.110339 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:15:13.110708 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:15:13.444846 (Thread-1): SQL status: SUCCESS 3 in 0.33 seconds
2021-01-27 17:15:13.463728 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:15:13.464152 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 17:15:13.790653 (Thread-1): SQL status: SUCCESS 3 in 0.33 seconds
2021-01-27 17:15:13.812862 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:15:13.813363 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 17:15:14.321875 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-27 17:15:14.330057 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:15:14.330702 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 17:15:14.546925 (Thread-1): Snowflake query id: 0199e4cb-05a7-3ee0-0000-44a93898e762
2021-01-27 17:15:14.547834 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:15:14.549135 (Thread-1): finished collecting timing info
2021-01-27 17:15:14.551106 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:15:15.260838 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:15:15.264029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43152e17-f2a2-48f9-9bb1-c50f30166072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8434093d30>]}
2021-01-27 17:15:15.266195 (Thread-1): 12:15:15 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 7.58s]
2021-01-27 17:15:15.266487 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:15:15.266813 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:15:15.268775 (Thread-1): 12:15:15 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:15:15.269192 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:15:15.269335 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:15:15.280370 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:15:15.280723 (Thread-1): finished collecting timing info
2021-01-27 17:15:15.298436 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:15:15.298815 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:15:15.298946 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:15:16.140824 (Thread-1): subprocess 7224 is still running
2021-01-27 17:15:21.153317 (Thread-1): SQL status: SUCCESS 1 in 5.85 seconds
2021-01-27 17:15:21.170464 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:15:21.170884 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:15:21.359922 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 17:15:21.374893 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:15:21.375353 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 17:15:21.921078 (Thread-1): SQL status: SUCCESS 3 in 0.55 seconds
2021-01-27 17:15:21.940102 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:15:21.940547 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 17:15:22.381963 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-27 17:15:22.389097 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:15:22.389578 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 17:15:22.665978 (Thread-1): Snowflake query id: 0199e4cb-0580-3555-0000-44a93899014a
2021-01-27 17:15:22.666606 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:15:22.667597 (Thread-1): finished collecting timing info
2021-01-27 17:15:22.669500 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:15:22.949744 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:15:22.954441 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43152e17-f2a2-48f9-9bb1-c50f30166072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842e810be0>]}
2021-01-27 17:15:22.963142 (Thread-1): 12:15:22 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 7.68s]
2021-01-27 17:15:22.963619 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:15:23.052982 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:15:23.053537 (MainThread): Using snowflake connection "master".
2021-01-27 17:15:23.053739 (MainThread): On master: BEGIN
2021-01-27 17:15:23.053921 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:15:23.799046 (MainThread): subprocess 7332 is still running
2021-01-27 17:15:27.865478 (MainThread): SQL status: SUCCESS 1 in 4.81 seconds
2021-01-27 17:15:27.865931 (MainThread): On master: COMMIT
2021-01-27 17:15:27.866344 (MainThread): Using snowflake connection "master".
2021-01-27 17:15:27.866499 (MainThread): On master: COMMIT
2021-01-27 17:15:28.318150 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-27 17:15:28.318594 (MainThread): On master: Close
2021-01-27 17:15:28.692622 (MainThread): 12:15:28 | 
2021-01-27 17:15:28.693208 (MainThread): 12:15:28 | Finished running 3 snowflake_timetravel_table models in 54.20s.
2021-01-27 17:15:28.693773 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:15:28.694124 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:15:28.723040 (MainThread): 
2021-01-27 17:15:28.723324 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 17:15:28.723514 (MainThread): 
2021-01-27 17:15:28.723685 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 17:15:28.723818 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:15:28.723936 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:15:28.724073 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:15:28.724211 (MainThread): 
2021-01-27 17:15:28.724358 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 17:15:28.724476 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:15:28.724614 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:15:28.724733 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:15:28.724875 (MainThread): 
2021-01-27 17:15:28.725009 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 17:15:28.725166 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:15:28.725274 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:15:28.725395 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:15:28.725573 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 17:15:28.726000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842cec7f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842cec7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f842cec7eb8>]}
2021-01-27 17:15:28.726423 (MainThread): Flushing usage events
2021-01-27 17:24:24.981825 (MainThread): Running with dbt=0.18.1
2021-01-27 17:24:25.460728 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:24:25.461691 (MainThread): Tracking: tracking
2021-01-27 17:24:25.462061 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590c94b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590c94b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f590c94b588>]}
2021-01-27 17:24:25.510358 (MainThread): Partial parsing not enabled
2021-01-27 17:24:25.511463 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:24:25.514208 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:24:25.549356 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:24:25.551330 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:24:25.562193 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:24:25.564476 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:24:25.569683 (MainThread): Parsing macros/core.sql
2021-01-27 17:24:25.573876 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:24:25.575895 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:24:25.577652 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:24:25.579784 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:24:25.584112 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:24:25.595036 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:24:25.602190 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:24:25.608084 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:24:25.627043 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:24:25.629143 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:24:25.661448 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:24:25.669357 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:24:25.676297 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:24:25.678530 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:24:25.694809 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:24:25.718068 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:24:25.727747 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:24:25.729532 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:24:25.730565 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:24:25.732853 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:24:25.734027 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:24:25.735898 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:24:25.780339 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:24:25.795604 (MainThread): Partial parsing not enabled
2021-01-27 17:24:25.844492 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:24:25.871446 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:24:25.884442 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:24:26.133226 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:24:26.133938 (MainThread): 
2021-01-27 17:24:26.134275 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:24:26.139165 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:24:26.155053 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:24:26.155201 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:24:26.155296 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:24:26.914317 (ThreadPoolExecutor-0_0): subprocess 12984 is still running
2021-01-27 17:24:30.569958 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.41 seconds
2021-01-27 17:24:30.612185 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:24:31.273345 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:24:31.288267 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:24:31.288453 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:24:31.288564 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:24:32.034207 (ThreadPoolExecutor-1_0): subprocess 13096 is still running
2021-01-27 17:24:36.055703 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.77 seconds
2021-01-27 17:24:36.678550 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:24:37.347713 (MainThread): Using snowflake connection "master".
2021-01-27 17:24:37.347962 (MainThread): On master: BEGIN
2021-01-27 17:24:37.348109 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:24:37.991449 (MainThread): subprocess 13198 is still running
2021-01-27 17:24:41.654957 (MainThread): SQL status: SUCCESS 1 in 4.31 seconds
2021-01-27 17:24:41.655195 (MainThread): On master: COMMIT
2021-01-27 17:24:41.655406 (MainThread): Using snowflake connection "master".
2021-01-27 17:24:41.655488 (MainThread): On master: COMMIT
2021-01-27 17:24:42.050209 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-27 17:24:42.051234 (MainThread): On master: Close
2021-01-27 17:24:42.610201 (MainThread): 12:24:42 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:24:42.610697 (MainThread): 12:24:42 | 
2021-01-27 17:24:42.612610 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:24:42.615765 (Thread-1): 12:24:42 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:24:42.616520 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:24:42.616748 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:24:42.663779 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:24:42.664302 (Thread-1): finished collecting timing info
2021-01-27 17:24:42.752149 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:24:42.752374 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:24:42.752516 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:24:43.463875 (Thread-1): subprocess 13299 is still running
2021-01-27 17:24:47.966989 (Thread-1): SQL status: SUCCESS 1 in 5.21 seconds
2021-01-27 17:24:47.981304 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:24:47.981551 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:24:48.396877 (Thread-1): SQL status: SUCCESS 3 in 0.42 seconds
2021-01-27 17:24:48.403186 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:24:48.403409 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 17:24:48.602281 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 17:24:48.610482 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:24:48.610660 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 17:24:48.820827 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 17:24:48.822430 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:24:48.822562 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 17:24:49.013547 (Thread-1): Snowflake query id: 0199e4d4-056e-b80d-0000-44a938991d62
2021-01-27 17:24:49.013771 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:24:49.014104 (Thread-1): finished collecting timing info
2021-01-27 17:24:49.014800 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:24:49.246699 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:24:49.250049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22866a42-ca10-4d3c-8855-799d77c37472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59068c83c8>]}
2021-01-27 17:24:49.252865 (Thread-1): 12:24:49 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 6.63s]
2021-01-27 17:24:49.253129 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:24:49.253396 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:24:49.255437 (Thread-1): 12:24:49 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:24:49.256207 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:24:49.256388 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:24:49.271598 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:24:49.271969 (Thread-1): finished collecting timing info
2021-01-27 17:24:49.288461 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:24:49.288708 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:24:49.288851 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:24:49.879378 (Thread-1): subprocess 13398 is still running
2021-01-27 17:24:53.990488 (Thread-1): SQL status: SUCCESS 1 in 4.70 seconds
2021-01-27 17:24:54.003956 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:24:54.004499 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:24:54.202948 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 17:24:54.214873 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:24:54.215255 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 17:24:54.414588 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 17:24:54.427516 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:24:54.427994 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 17:24:54.652916 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 17:24:54.656939 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:24:54.657287 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 17:24:54.871244 (Thread-1): Snowflake query id: 0199e4d4-05f9-1ba2-0000-44a93899385a
2021-01-27 17:24:54.871396 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:24:54.871639 (Thread-1): finished collecting timing info
2021-01-27 17:24:54.872045 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:24:55.137132 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:24:55.138115 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22866a42-ca10-4d3c-8855-799d77c37472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5906eb9198>]}
2021-01-27 17:24:55.140403 (Thread-1): 12:24:55 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.88s]
2021-01-27 17:24:55.140685 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:24:55.140971 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:24:55.144313 (Thread-1): 12:24:55 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:24:55.145048 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:24:55.145297 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:24:55.165276 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:24:55.165834 (Thread-1): finished collecting timing info
2021-01-27 17:24:55.197915 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:24:55.198139 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:24:55.198301 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:24:55.895956 (Thread-1): subprocess 13508 is still running
2021-01-27 17:24:59.740400 (Thread-1): SQL status: SUCCESS 1 in 4.54 seconds
2021-01-27 17:24:59.745670 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:24:59.745845 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:24:59.949188 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 17:24:59.961145 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:24:59.961532 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 17:25:00.173194 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 17:25:00.184196 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:25:00.184579 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 17:25:00.419853 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 17:25:00.425849 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:25:00.426295 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 17:25:00.641253 (Thread-1): Snowflake query id: 0199e4d5-0503-4fb5-0000-44a938993872
2021-01-27 17:25:00.641415 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:25:00.641641 (Thread-1): finished collecting timing info
2021-01-27 17:25:00.642058 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:25:00.900473 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 99, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:25:00.902677 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22866a42-ca10-4d3c-8855-799d77c37472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5906e0aac8>]}
2021-01-27 17:25:00.908570 (Thread-1): 12:25:00 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.76s]
2021-01-27 17:25:00.909029 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:25:00.993479 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:25:00.994379 (MainThread): Using snowflake connection "master".
2021-01-27 17:25:00.994732 (MainThread): On master: BEGIN
2021-01-27 17:25:00.995080 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:25:01.653472 (MainThread): subprocess 13614 is still running
2021-01-27 17:25:05.867231 (MainThread): SQL status: SUCCESS 1 in 4.87 seconds
2021-01-27 17:25:05.868274 (MainThread): On master: COMMIT
2021-01-27 17:25:05.869793 (MainThread): Using snowflake connection "master".
2021-01-27 17:25:05.870320 (MainThread): On master: COMMIT
2021-01-27 17:25:06.188773 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 17:25:06.189666 (MainThread): On master: Close
2021-01-27 17:25:06.519359 (MainThread): 12:25:06 | 
2021-01-27 17:25:06.520445 (MainThread): 12:25:06 | Finished running 3 snowflake_timetravel_table models in 40.38s.
2021-01-27 17:25:06.521234 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:25:06.522093 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:25:06.547708 (MainThread): 
2021-01-27 17:25:06.548019 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 17:25:06.548204 (MainThread): 
2021-01-27 17:25:06.548363 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 17:25:06.548480 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:25:06.548578 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:25:06.548670 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:25:06.548773 (MainThread): 
2021-01-27 17:25:06.548885 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 17:25:06.548986 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:25:06.549093 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:25:06.549201 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:25:06.549304 (MainThread): 
2021-01-27 17:25:06.549415 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 17:25:06.549525 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:25:06.549600 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:25:06.549674 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:25:06.549767 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 17:25:06.550033 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59050270f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5905027e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5905027668>]}
2021-01-27 17:25:06.550433 (MainThread): Flushing usage events
2021-01-27 17:25:38.088859 (MainThread): Running with dbt=0.18.1
2021-01-27 17:25:38.558996 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:25:38.560034 (MainThread): Tracking: tracking
2021-01-27 17:25:38.560384 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd2cc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd2cc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9cd2cc588>]}
2021-01-27 17:25:38.607825 (MainThread): Partial parsing not enabled
2021-01-27 17:25:38.609099 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:25:38.612062 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:25:38.648768 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:25:38.650671 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:25:38.662044 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:25:38.664478 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:25:38.670082 (MainThread): Parsing macros/core.sql
2021-01-27 17:25:38.674524 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:25:38.676623 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:25:38.679017 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:25:38.681318 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:25:38.685625 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:25:38.696900 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:25:38.704441 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:25:38.710508 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:25:38.730330 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:25:38.732417 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:25:38.764085 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:25:38.771443 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:25:38.778316 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:25:38.780374 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:25:38.795852 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:25:38.818961 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:25:38.829064 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:25:38.830805 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:25:38.831803 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:25:38.833996 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:25:38.835108 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:25:38.837055 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:25:38.883299 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:25:38.899721 (MainThread): Partial parsing not enabled
2021-01-27 17:25:38.945603 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:25:38.971834 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:25:38.985140 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:25:39.242202 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:25:39.242887 (MainThread): 
2021-01-27 17:25:39.243249 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:25:39.247964 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:25:39.263853 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:25:39.264012 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:25:39.264098 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:25:39.982543 (ThreadPoolExecutor-0_0): subprocess 13839 is still running
2021-01-27 17:25:43.962085 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.70 seconds
2021-01-27 17:25:44.030699 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:25:44.358265 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:25:44.387616 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:25:44.387793 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:25:44.387911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:25:45.032906 (ThreadPoolExecutor-1_0): subprocess 13949 is still running
2021-01-27 17:25:48.963817 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.58 seconds
2021-01-27 17:25:49.975754 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:25:50.249566 (MainThread): Using snowflake connection "master".
2021-01-27 17:25:50.249793 (MainThread): On master: BEGIN
2021-01-27 17:25:50.249936 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:25:50.822629 (MainThread): subprocess 14048 is still running
2021-01-27 17:25:54.778258 (MainThread): SQL status: SUCCESS 1 in 4.53 seconds
2021-01-27 17:25:54.778599 (MainThread): On master: COMMIT
2021-01-27 17:25:54.778945 (MainThread): Using snowflake connection "master".
2021-01-27 17:25:54.779087 (MainThread): On master: COMMIT
2021-01-27 17:25:55.063971 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 17:25:55.064205 (MainThread): On master: Close
2021-01-27 17:25:55.324553 (MainThread): 12:25:55 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:25:55.324819 (MainThread): 12:25:55 | 
2021-01-27 17:25:55.326234 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:25:55.328142 (Thread-1): 12:25:55 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:25:55.328542 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:25:55.328714 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:25:55.348666 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:25:55.349042 (Thread-1): finished collecting timing info
2021-01-27 17:25:55.398611 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:25:55.398767 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:25:55.398861 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:25:56.165674 (Thread-1): subprocess 14153 is still running
2021-01-27 17:25:59.943492 (Thread-1): SQL status: SUCCESS 1 in 4.54 seconds
2021-01-27 17:25:59.967198 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:25:59.967408 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:26:00.130363 (Thread-1): SQL status: SUCCESS 3 in 0.16 seconds
2021-01-27 17:26:00.143364 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:26:00.143785 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 17:26:00.363326 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 17:26:00.396309 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:26:00.396513 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 17:26:00.645992 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 17:26:00.653943 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:26:00.654967 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 17:26:00.856708 (Thread-1): Snowflake query id: 0199e4d6-0568-f739-0000-44a938991ff6
2021-01-27 17:26:00.857737 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:26:00.858001 (Thread-1): finished collecting timing info
2021-01-27 17:26:00.859794 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:26:01.271012 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 102, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:26:01.281804 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33c7a90-61be-4d00-a334-cfc200618761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c7263748>]}
2021-01-27 17:26:01.293991 (Thread-1): 12:26:01 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.95s]
2021-01-27 17:26:01.295098 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:26:01.296241 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:26:01.305497 (Thread-1): 12:26:01 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:26:01.307299 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:26:01.307971 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:26:01.344615 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:26:01.345270 (Thread-1): finished collecting timing info
2021-01-27 17:26:01.381494 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:26:01.381752 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:26:01.382040 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:26:01.980580 (Thread-1): subprocess 14254 is still running
2021-01-27 17:26:06.072152 (Thread-1): SQL status: SUCCESS 1 in 4.69 seconds
2021-01-27 17:26:06.080124 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:26:06.080331 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:26:06.256411 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 17:26:06.272559 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:26:06.273231 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 17:26:06.477034 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 17:26:06.487278 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:26:06.487694 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 17:26:06.773519 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 17:26:06.775254 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:26:06.775386 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 17:26:06.956436 (Thread-1): Snowflake query id: 0199e4d6-0548-7602-0000-44a938992caa
2021-01-27 17:26:06.957089 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:26:06.958073 (Thread-1): finished collecting timing info
2021-01-27 17:26:06.959954 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:26:09.570894 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 102, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:26:09.575581 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33c7a90-61be-4d00-a334-cfc200618761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c728dfd0>]}
2021-01-27 17:26:09.585972 (Thread-1): 12:26:09 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 8.27s]
2021-01-27 17:26:09.586931 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:26:09.587670 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:26:09.592811 (Thread-1): 12:26:09 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:26:09.593634 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:26:09.593901 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:26:09.609090 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:26:09.609516 (Thread-1): finished collecting timing info
2021-01-27 17:26:09.632436 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:26:09.632608 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:26:09.632705 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:26:10.379806 (Thread-1): subprocess 14353 is still running
2021-01-27 17:26:15.296307 (Thread-1): SQL status: SUCCESS 1 in 5.66 seconds
2021-01-27 17:26:15.300992 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:26:15.301160 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:26:15.565619 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-27 17:26:15.569485 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:26:15.569643 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 17:26:15.793380 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 17:26:15.804710 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:26:15.804993 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 17:26:16.218164 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-27 17:26:16.223025 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:26:16.223458 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 17:26:16.457552 (Thread-1): Snowflake query id: 0199e4d6-056e-41a0-0000-44a93899409a
2021-01-27 17:26:16.457876 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:26:16.458641 (Thread-1): finished collecting timing info
2021-01-27 17:26:16.459715 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:26:16.726884 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 102, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:26:16.728083 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e33c7a90-61be-4d00-a334-cfc200618761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c7267710>]}
2021-01-27 17:26:16.730669 (Thread-1): 12:26:16 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 7.13s]
2021-01-27 17:26:16.730917 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:26:16.735442 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:26:16.735833 (MainThread): Using snowflake connection "master".
2021-01-27 17:26:16.736055 (MainThread): On master: BEGIN
2021-01-27 17:26:16.736248 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:26:17.666204 (MainThread): subprocess 14452 is still running
2021-01-27 17:26:21.556678 (MainThread): SQL status: SUCCESS 1 in 4.82 seconds
2021-01-27 17:26:21.557388 (MainThread): On master: COMMIT
2021-01-27 17:26:21.558126 (MainThread): Using snowflake connection "master".
2021-01-27 17:26:21.558456 (MainThread): On master: COMMIT
2021-01-27 17:26:21.886470 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 17:26:21.887040 (MainThread): On master: Close
2021-01-27 17:26:22.178961 (MainThread): 12:26:22 | 
2021-01-27 17:26:22.179704 (MainThread): 12:26:22 | Finished running 3 snowflake_timetravel_table models in 42.94s.
2021-01-27 17:26:22.180257 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:26:22.180578 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:26:22.204591 (MainThread): 
2021-01-27 17:26:22.204807 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 17:26:22.204941 (MainThread): 
2021-01-27 17:26:22.205068 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 17:26:22.205193 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:26:22.205293 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:26:22.205404 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:26:22.205530 (MainThread): 
2021-01-27 17:26:22.205660 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 17:26:22.205777 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:26:22.205881 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:26:22.205989 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:26:22.206122 (MainThread): 
2021-01-27 17:26:22.206272 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 17:26:22.206406 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:26:22.206522 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:26:22.206630 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:26:22.206753 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 17:26:22.207077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c5971898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c5971940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9c5971ef0>]}
2021-01-27 17:26:22.207411 (MainThread): Flushing usage events
2021-01-27 17:32:57.259049 (MainThread): Running with dbt=0.18.1
2021-01-27 17:32:57.727561 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:32:57.730347 (MainThread): Tracking: tracking
2021-01-27 17:32:57.730773 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190310ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190310a908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190310a518>]}
2021-01-27 17:32:57.773781 (MainThread): Partial parsing not enabled
2021-01-27 17:32:57.775023 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:32:57.777851 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:32:57.814184 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:32:57.816079 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:32:57.827123 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:32:57.829820 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:32:57.835396 (MainThread): Parsing macros/core.sql
2021-01-27 17:32:57.839953 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:32:57.842113 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:32:57.843897 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:32:57.846108 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:32:57.850950 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:32:57.861928 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:32:57.869568 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:32:57.875400 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:32:57.894428 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:32:57.896719 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:32:57.927072 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:32:57.935825 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:32:57.942603 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:32:57.944969 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:32:57.960496 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:32:57.982768 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:32:57.992240 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:32:57.994158 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:32:57.995206 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:32:57.997334 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:32:57.998439 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:32:58.000227 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:32:58.047530 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:32:58.063345 (MainThread): Partial parsing not enabled
2021-01-27 17:32:58.112633 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:32:58.138806 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:32:58.152328 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:32:58.406469 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:32:58.407112 (MainThread): 
2021-01-27 17:32:58.407437 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:32:58.412330 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:32:58.429512 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:32:58.429663 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:32:58.429750 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:32:59.130618 (ThreadPoolExecutor-0_0): subprocess 17181 is still running
2021-01-27 17:33:03.986462 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.56 seconds
2021-01-27 17:33:04.021601 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:33:04.340703 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:33:04.350626 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:33:04.350777 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:33:04.350870 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:33:04.965384 (ThreadPoolExecutor-1_0): subprocess 17290 is still running
2021-01-27 17:33:08.824605 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 462 in 4.47 seconds
2021-01-27 17:33:09.347859 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:33:09.654617 (MainThread): Using snowflake connection "master".
2021-01-27 17:33:09.654822 (MainThread): On master: BEGIN
2021-01-27 17:33:09.654942 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:33:10.273152 (MainThread): subprocess 17395 is still running
2021-01-27 17:33:15.050996 (MainThread): SQL status: SUCCESS 1 in 5.40 seconds
2021-01-27 17:33:15.051856 (MainThread): On master: COMMIT
2021-01-27 17:33:15.052990 (MainThread): Using snowflake connection "master".
2021-01-27 17:33:15.053386 (MainThread): On master: COMMIT
2021-01-27 17:33:15.326438 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 17:33:15.327496 (MainThread): On master: Close
2021-01-27 17:33:15.798895 (MainThread): 12:33:15 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:33:15.799501 (MainThread): 12:33:15 | 
2021-01-27 17:33:15.803023 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:33:15.806848 (Thread-1): 12:33:15 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:33:15.807562 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:33:15.807866 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:33:15.840985 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:33:15.841379 (Thread-1): finished collecting timing info
2021-01-27 17:33:15.894280 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:33:15.894440 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:33:15.894546 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:33:16.519221 (Thread-1): subprocess 17505 is still running
2021-01-27 17:33:20.690730 (Thread-1): SQL status: SUCCESS 1 in 4.80 seconds
2021-01-27 17:33:20.732593 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:33:20.732791 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:33:21.212745 (Thread-1): Snowflake query id: 0199e4dd-0532-7611-0000-44a9389970ba
2021-01-27 17:33:21.214605 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Table 'USER_DATA.TSANKEY.SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMN_TYPES_CHANGED' does not exist or not authorized.
2021-01-27 17:33:21.215676 (Thread-1): Error running SQL: macro get_columns_in_relation
2021-01-27 17:33:21.216346 (Thread-1): Rolling back transaction.
2021-01-27 17:33:21.233082 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:33:21.233596 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 17:33:21.502665 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-27 17:33:21.526254 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:33:21.526439 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 17:33:21.821150 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 17:33:21.830801 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:33:21.831781 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 17:33:22.048303 (Thread-1): Snowflake query id: 0199e4dd-0561-5c6d-0000-44a9389970c6
2021-01-27 17:33:22.048579 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:33:22.048960 (Thread-1): finished collecting timing info
2021-01-27 17:33:22.049711 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:33:22.307363 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 102, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:33:22.317418 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d6d97b6-e6c6-4769-9c1c-19af61c9a629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190111e390>]}
2021-01-27 17:33:22.321912 (Thread-1): 12:33:22 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 6.51s]
2021-01-27 17:33:22.322337 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:33:22.322760 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:33:22.325693 (Thread-1): 12:33:22 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:33:22.326352 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:33:22.326586 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:33:22.338026 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:33:22.338417 (Thread-1): finished collecting timing info
2021-01-27 17:33:22.353960 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:33:22.354119 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:33:22.354238 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:33:22.948563 (Thread-1): subprocess 17609 is still running
2021-01-27 17:33:26.998583 (Thread-1): SQL status: SUCCESS 1 in 4.64 seconds
2021-01-27 17:33:27.017104 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:33:27.017607 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:33:27.243996 (Thread-1): Snowflake query id: 0199e4dd-059c-54a9-0000-44a938996c6e
2021-01-27 17:33:27.244695 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Table 'USER_DATA.TSANKEY.SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE' does not exist or not authorized.
2021-01-27 17:33:27.245311 (Thread-1): Error running SQL: macro get_columns_in_relation
2021-01-27 17:33:27.245662 (Thread-1): Rolling back transaction.
2021-01-27 17:33:27.258096 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:33:27.258691 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 17:33:27.546260 (Thread-1): SQL status: SUCCESS 3 in 0.29 seconds
2021-01-27 17:33:27.563312 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:33:27.563907 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 17:33:27.802080 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 17:33:27.803930 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:33:27.804044 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 17:33:28.028388 (Thread-1): Snowflake query id: 0199e4dd-05c5-7447-0000-44a938996c7a
2021-01-27 17:33:28.028988 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:33:28.030516 (Thread-1): finished collecting timing info
2021-01-27 17:33:28.033013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:33:28.307954 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 102, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:33:28.308760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d6d97b6-e6c6-4769-9c1c-19af61c9a629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190115f128>]}
2021-01-27 17:33:28.310476 (Thread-1): 12:33:28 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.98s]
2021-01-27 17:33:28.310649 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:33:28.310861 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:33:28.311981 (Thread-1): 12:33:28 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:33:28.312339 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:33:28.312479 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:33:28.322189 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:33:28.322576 (Thread-1): finished collecting timing info
2021-01-27 17:33:28.336391 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:33:28.336554 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:33:28.336647 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:33:28.908475 (Thread-1): subprocess 17721 is still running
2021-01-27 17:33:33.285464 (Thread-1): SQL status: SUCCESS 1 in 4.95 seconds
2021-01-27 17:33:33.313319 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:33:33.314010 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:33:34.349020 (Thread-1): Snowflake query id: 0199e4dd-052d-286b-0000-44a938995e3e
2021-01-27 17:33:34.349729 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Table 'USER_DATA.TSANKEY.SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_RENAMED' does not exist or not authorized.
2021-01-27 17:33:34.350492 (Thread-1): Error running SQL: macro get_columns_in_relation
2021-01-27 17:33:34.350906 (Thread-1): Rolling back transaction.
2021-01-27 17:33:34.366041 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:33:34.366717 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 17:33:34.680762 (Thread-1): SQL status: SUCCESS 3 in 0.31 seconds
2021-01-27 17:33:34.696267 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:33:34.697059 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 17:33:35.035984 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 17:33:35.043276 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:33:35.043718 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 17:33:35.550430 (Thread-1): Snowflake query id: 0199e4dd-057e-5e54-0000-44a938995e52
2021-01-27 17:33:35.550976 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:33:35.551867 (Thread-1): finished collecting timing info
2021-01-27 17:33:35.553752 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:33:35.968898 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 102, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:33:35.971762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d6d97b6-e6c6-4769-9c1c-19af61c9a629', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19010a93c8>]}
2021-01-27 17:33:35.978980 (Thread-1): 12:33:35 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 7.66s]
2021-01-27 17:33:35.979581 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:33:36.001211 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:33:36.001489 (MainThread): Using snowflake connection "master".
2021-01-27 17:33:36.001589 (MainThread): On master: BEGIN
2021-01-27 17:33:36.001668 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:33:37.028514 (MainThread): subprocess 17829 is still running
2021-01-27 17:33:40.847964 (MainThread): SQL status: SUCCESS 1 in 4.85 seconds
2021-01-27 17:33:40.849083 (MainThread): On master: COMMIT
2021-01-27 17:33:40.850581 (MainThread): Using snowflake connection "master".
2021-01-27 17:33:40.851195 (MainThread): On master: COMMIT
2021-01-27 17:33:41.180859 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 17:33:41.181754 (MainThread): On master: Close
2021-01-27 17:33:41.456973 (MainThread): 12:33:41 | 
2021-01-27 17:33:41.457301 (MainThread): 12:33:41 | Finished running 3 snowflake_timetravel_table models in 43.05s.
2021-01-27 17:33:41.457488 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:33:41.457620 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:33:41.493199 (MainThread): 
2021-01-27 17:33:41.493441 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 17:33:41.493575 (MainThread): 
2021-01-27 17:33:41.493702 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 17:33:41.493803 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:33:41.493891 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:33:41.493975 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:33:41.494065 (MainThread): 
2021-01-27 17:33:41.494165 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 17:33:41.494287 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:33:41.494404 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:33:41.494489 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:33:41.494581 (MainThread): 
2021-01-27 17:33:41.494688 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 17:33:41.494780 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:33:41.494861 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:33:41.494941 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:33:41.495035 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 17:33:41.495296 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f37f4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f37f4f28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f37f4da0>]}
2021-01-27 17:33:41.495592 (MainThread): Flushing usage events
2021-01-27 17:40:01.566924 (MainThread): Running with dbt=0.18.1
2021-01-27 17:40:02.033474 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:40:02.034362 (MainThread): Tracking: tracking
2021-01-27 17:40:02.034709 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5deacb940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5deacb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5deacb588>]}
2021-01-27 17:40:02.080049 (MainThread): Partial parsing not enabled
2021-01-27 17:40:02.081294 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:40:02.084141 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:40:02.119970 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:40:02.123549 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:40:02.135635 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:40:02.138221 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:40:02.143634 (MainThread): Parsing macros/core.sql
2021-01-27 17:40:02.148058 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:40:02.150137 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:40:02.151989 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:40:02.154321 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:40:02.159065 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:40:02.170085 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:40:02.177565 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:40:02.183603 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:40:02.202774 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:40:02.204885 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:40:02.235550 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:40:02.242922 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:40:02.249584 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:40:02.251612 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:40:02.270243 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:40:02.296779 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:40:02.307591 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:40:02.309427 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:40:02.310526 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:40:02.312870 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:40:02.314037 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:40:02.316063 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:40:02.366513 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:40:02.383908 (MainThread): Partial parsing not enabled
2021-01-27 17:40:02.430793 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:40:02.458172 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:40:02.471215 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:40:02.731497 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:40:02.732214 (MainThread): 
2021-01-27 17:40:02.732571 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:40:02.738017 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:40:02.754437 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:40:02.754581 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:40:02.754667 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:40:03.501003 (ThreadPoolExecutor-0_0): subprocess 19544 is still running
2021-01-27 17:40:07.984441 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.23 seconds
2021-01-27 17:40:08.031079 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:40:08.542649 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:40:08.561138 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:40:08.561330 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:40:08.561455 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:40:09.203604 (ThreadPoolExecutor-1_0): subprocess 19653 is still running
2021-01-27 17:40:13.156409 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 462 in 4.59 seconds
2021-01-27 17:40:13.653652 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:40:13.933371 (MainThread): Using snowflake connection "master".
2021-01-27 17:40:13.933537 (MainThread): On master: BEGIN
2021-01-27 17:40:13.933626 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:40:14.498127 (MainThread): subprocess 19757 is still running
2021-01-27 17:40:18.216758 (MainThread): SQL status: SUCCESS 1 in 4.28 seconds
2021-01-27 17:40:18.217083 (MainThread): On master: COMMIT
2021-01-27 17:40:18.217397 (MainThread): Using snowflake connection "master".
2021-01-27 17:40:18.217521 (MainThread): On master: COMMIT
2021-01-27 17:40:18.484037 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 17:40:18.485142 (MainThread): On master: Close
2021-01-27 17:40:18.761885 (MainThread): 12:40:18 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:40:18.762551 (MainThread): 12:40:18 | 
2021-01-27 17:40:18.766689 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:40:18.770907 (Thread-1): 12:40:18 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:40:18.771689 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:40:18.772016 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:40:18.795751 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:40:18.796145 (Thread-1): finished collecting timing info
2021-01-27 17:40:18.856497 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:40:18.857136 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:40:18.857229 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 17:40:18.857309 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:40:19.494642 (Thread-1): subprocess 19858 is still running
2021-01-27 17:40:23.544092 (Thread-1): SQL status: SUCCESS 1 in 4.69 seconds
2021-01-27 17:40:23.544995 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:40:23.545477 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
TEST
2021-01-27 17:40:23.845628 (Thread-1): Snowflake query id: 0199e4e4-05ec-3414-0000-44a93899a0a2
2021-01-27 17:40:23.846475 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'TEST'.
2021-01-27 17:40:23.848123 (Thread-1): finished collecting timing info
2021-01-27 17:40:23.851729 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: ROLLBACK
2021-01-27 17:40:24.115152 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:40:24.371678 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'TEST'.
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'TEST'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 159, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'TEST'.
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:40:24.374246 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84d93df-041b-42b3-8d7e-0ff14b0f71f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dca91080>]}
2021-01-27 17:40:24.376339 (Thread-1): 12:40:24 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.60s]
2021-01-27 17:40:24.376587 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:40:24.376813 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:40:24.378730 (Thread-1): 12:40:24 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:40:24.379149 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:40:24.379315 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:40:24.391131 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:40:24.391553 (Thread-1): finished collecting timing info
2021-01-27 17:40:24.402595 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:40:24.403271 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:40:24.403453 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 17:40:24.403595 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:40:24.977920 (Thread-1): subprocess 19964 is still running
2021-01-27 17:40:28.770866 (Thread-1): SQL status: SUCCESS 1 in 4.37 seconds
2021-01-27 17:40:28.780949 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:40:28.781806 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
TEST
2021-01-27 17:40:28.976164 (Thread-1): Snowflake query id: 0199e4e4-058e-fe44-0000-44a938999c72
2021-01-27 17:40:28.976322 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'TEST'.
2021-01-27 17:40:28.976634 (Thread-1): finished collecting timing info
2021-01-27 17:40:28.977263 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-27 17:40:29.410830 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:40:29.729118 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'TEST'.
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'TEST'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 159, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'TEST'.
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:40:29.729927 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84d93df-041b-42b3-8d7e-0ff14b0f71f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dc1bb9b0>]}
2021-01-27 17:40:29.731827 (Thread-1): 12:40:29 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.35s]
2021-01-27 17:40:29.732044 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:40:29.732261 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:40:29.733829 (Thread-1): 12:40:29 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:40:29.734259 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:40:29.734437 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:40:29.744648 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:40:29.745021 (Thread-1): finished collecting timing info
2021-01-27 17:40:29.754915 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:40:29.755712 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:40:29.755852 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 17:40:29.755977 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:40:30.362447 (Thread-1): subprocess 20066 is still running
2021-01-27 17:40:34.348683 (Thread-1): SQL status: SUCCESS 1 in 4.59 seconds
2021-01-27 17:40:34.349291 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:40:34.349643 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
TEST
2021-01-27 17:40:34.564333 (Thread-1): Snowflake query id: 0199e4e4-05bc-e768-0000-44a938999c8a
2021-01-27 17:40:34.564767 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'TEST'.
2021-01-27 17:40:34.565775 (Thread-1): finished collecting timing info
2021-01-27 17:40:34.567849 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: ROLLBACK
2021-01-27 17:40:34.857006 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:40:35.108639 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'TEST'.
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'TEST'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 159, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'TEST'.
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:40:35.110931 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b84d93df-041b-42b3-8d7e-0ff14b0f71f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dca913c8>]}
2021-01-27 17:40:35.116271 (Thread-1): 12:40:35 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.38s]
2021-01-27 17:40:35.116855 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:40:35.132104 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:40:35.132417 (MainThread): Using snowflake connection "master".
2021-01-27 17:40:35.132510 (MainThread): On master: BEGIN
2021-01-27 17:40:35.132591 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:40:35.803013 (MainThread): subprocess 20177 is still running
2021-01-27 17:40:40.249822 (MainThread): SQL status: SUCCESS 1 in 5.12 seconds
2021-01-27 17:40:40.250921 (MainThread): On master: COMMIT
2021-01-27 17:40:40.252928 (MainThread): Using snowflake connection "master".
2021-01-27 17:40:40.253416 (MainThread): On master: COMMIT
2021-01-27 17:40:41.102048 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-27 17:40:41.102974 (MainThread): On master: Close
2021-01-27 17:40:41.389100 (MainThread): 12:40:41 | 
2021-01-27 17:40:41.390057 (MainThread): 12:40:41 | Finished running 3 snowflake_timetravel_table models in 38.66s.
2021-01-27 17:40:41.390555 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:40:41.391142 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:40:41.416060 (MainThread): 
2021-01-27 17:40:41.416299 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 17:40:41.416508 (MainThread): 
2021-01-27 17:40:41.416706 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 17:40:41.416855 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:40:41.416987 (MainThread):   syntax error line 1 at position 0 unexpected 'TEST'.
2021-01-27 17:40:41.417115 (MainThread):   compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:40:41.417319 (MainThread): 
2021-01-27 17:40:41.417453 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 17:40:41.417591 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:40:41.417718 (MainThread):   syntax error line 1 at position 0 unexpected 'TEST'.
2021-01-27 17:40:41.417827 (MainThread):   compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:40:41.417923 (MainThread): 
2021-01-27 17:40:41.418033 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 17:40:41.418154 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:40:41.418276 (MainThread):   syntax error line 1 at position 0 unexpected 'TEST'.
2021-01-27 17:40:41.418388 (MainThread):   compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:40:41.418518 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 17:40:41.418810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dd058fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dd0bb240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5dd0bbdd8>]}
2021-01-27 17:40:41.419186 (MainThread): Flushing usage events
2021-01-27 17:41:42.461347 (MainThread): Running with dbt=0.18.1
2021-01-27 17:41:42.926354 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:41:42.927355 (MainThread): Tracking: tracking
2021-01-27 17:41:42.927705 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9ec8e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9ec8e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9ec8e518>]}
2021-01-27 17:41:42.970894 (MainThread): Partial parsing not enabled
2021-01-27 17:41:42.971966 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:41:42.974752 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:41:43.008926 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:41:43.010927 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:41:43.021302 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:41:43.023665 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:41:43.028869 (MainThread): Parsing macros/core.sql
2021-01-27 17:41:43.035422 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:41:43.037665 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:41:43.039843 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:41:43.042208 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:41:43.046822 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:41:43.058204 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:41:43.065817 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:41:43.073029 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:41:43.093759 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:41:43.095977 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:41:43.127828 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:41:43.135291 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:41:43.141710 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:41:43.143727 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:41:43.158519 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:41:43.181005 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:41:43.190702 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:41:43.192563 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:41:43.193588 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:41:43.195822 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:41:43.197059 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:41:43.198884 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:41:43.245624 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:41:43.262320 (MainThread): Partial parsing not enabled
2021-01-27 17:41:43.304390 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:41:43.330866 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:41:43.343861 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:41:43.598719 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:41:43.599413 (MainThread): 
2021-01-27 17:41:43.599845 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:41:43.604857 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:41:43.620771 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:41:43.620918 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:41:43.621003 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:41:44.385407 (ThreadPoolExecutor-0_0): subprocess 20557 is still running
2021-01-27 17:41:49.179795 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.56 seconds
2021-01-27 17:41:49.215135 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:41:49.510856 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:41:49.533218 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:41:49.533394 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:41:49.533486 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:41:50.137660 (ThreadPoolExecutor-1_0): subprocess 20658 is still running
2021-01-27 17:41:54.504634 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 462 in 4.97 seconds
2021-01-27 17:41:55.154156 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:41:55.803203 (MainThread): Using snowflake connection "master".
2021-01-27 17:41:55.803409 (MainThread): On master: BEGIN
2021-01-27 17:41:55.803531 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:41:56.474540 (MainThread): subprocess 20761 is still running
2021-01-27 17:42:01.665500 (MainThread): SQL status: SUCCESS 1 in 5.86 seconds
2021-01-27 17:42:01.665805 (MainThread): On master: COMMIT
2021-01-27 17:42:01.666102 (MainThread): Using snowflake connection "master".
2021-01-27 17:42:01.666237 (MainThread): On master: COMMIT
2021-01-27 17:42:02.113801 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-27 17:42:02.114085 (MainThread): On master: Close
2021-01-27 17:42:02.372072 (MainThread): 12:42:02 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:42:02.372387 (MainThread): 12:42:02 | 
2021-01-27 17:42:02.374396 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:42:02.376405 (Thread-1): 12:42:02 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:42:02.376824 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:42:02.376986 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:42:02.397225 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:42:02.397630 (Thread-1): finished collecting timing info
2021-01-27 17:42:02.450120 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:42:02.451032 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:42:02.451147 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 17:42:02.451232 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:42:03.124768 (Thread-1): subprocess 20865 is still running
2021-01-27 17:42:07.677400 (Thread-1): SQL status: SUCCESS 1 in 5.23 seconds
2021-01-27 17:42:07.677908 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:42:07.678201 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace transient table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:42:10.369200 (Thread-1): SQL status: SUCCESS 1 in 2.69 seconds
2021-01-27 17:42:10.373174 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 17:42:10.373583 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:42:10.373737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 17:42:10.571843 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 17:42:10.601782 (Thread-1): finished collecting timing info
2021-01-27 17:42:10.602432 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:42:11.608713 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e669d76-ee21-43ec-9afc-9f9536c5201e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9d218780>]}
2021-01-27 17:42:11.615785 (Thread-1): 12:42:11 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 9.23s]
2021-01-27 17:42:11.616632 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:42:11.617555 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:42:11.622251 (Thread-1): 12:42:11 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:42:11.623350 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:42:11.623722 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:42:11.642708 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:42:11.643194 (Thread-1): finished collecting timing info
2021-01-27 17:42:11.654729 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:42:11.655763 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:42:11.655888 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 17:42:11.655984 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:42:12.298945 (Thread-1): subprocess 20963 is still running
2021-01-27 17:42:16.825753 (Thread-1): SQL status: SUCCESS 1 in 5.17 seconds
2021-01-27 17:42:16.826066 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:42:16.826245 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace transient table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:42:19.091930 (Thread-1): SQL status: SUCCESS 1 in 2.27 seconds
2021-01-27 17:42:19.100367 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 17:42:19.101049 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:42:19.101298 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 17:42:19.267496 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 17:42:19.282838 (Thread-1): finished collecting timing info
2021-01-27 17:42:19.284528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:42:19.574536 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e669d76-ee21-43ec-9afc-9f9536c5201e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9cc46f60>]}
2021-01-27 17:42:19.576015 (Thread-1): 12:42:19 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 7.95s]
2021-01-27 17:42:19.576192 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:42:19.576375 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:42:19.577596 (Thread-1): 12:42:19 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:42:19.577977 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:42:19.578120 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:42:19.588073 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:42:19.588430 (Thread-1): finished collecting timing info
2021-01-27 17:42:19.598257 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:42:19.599121 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:42:19.599227 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 17:42:19.599317 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:42:20.215223 (Thread-1): subprocess 21227 is still running
2021-01-27 17:42:24.549243 (Thread-1): SQL status: SUCCESS 1 in 4.95 seconds
2021-01-27 17:42:24.549985 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:42:24.550529 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace transient table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:42:25.603099 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-01-27 17:42:25.613709 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 17:42:25.614792 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:42:25.615252 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 17:42:26.039997 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-27 17:42:26.058938 (Thread-1): finished collecting timing info
2021-01-27 17:42:26.060021 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:42:26.316601 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e669d76-ee21-43ec-9afc-9f9536c5201e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9c3f7400>]}
2021-01-27 17:42:26.323756 (Thread-1): 12:42:26 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 6.74s]
2021-01-27 17:42:26.324278 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:42:26.366605 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:42:26.367103 (MainThread): Using snowflake connection "master".
2021-01-27 17:42:26.367336 (MainThread): On master: BEGIN
2021-01-27 17:42:26.367509 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:42:26.990330 (MainThread): subprocess 21327 is still running
2021-01-27 17:42:30.856340 (MainThread): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 17:42:30.857297 (MainThread): On master: COMMIT
2021-01-27 17:42:30.858149 (MainThread): Using snowflake connection "master".
2021-01-27 17:42:30.858598 (MainThread): On master: COMMIT
2021-01-27 17:42:31.194128 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 17:42:31.194426 (MainThread): On master: Close
2021-01-27 17:42:31.504219 (MainThread): 12:42:31 | 
2021-01-27 17:42:31.507802 (MainThread): 12:42:31 | Finished running 3 snowflake_timetravel_table models in 47.90s.
2021-01-27 17:42:31.510885 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:42:31.511328 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:42:31.538317 (MainThread): 
2021-01-27 17:42:31.538581 (MainThread): Completed successfully
2021-01-27 17:42:31.538805 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 17:42:31.539188 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9cc34d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9ebc7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff9c40bc88>]}
2021-01-27 17:42:31.539556 (MainThread): Flushing usage events
2021-01-27 17:52:18.079082 (MainThread): Running with dbt=0.18.1
2021-01-27 17:52:18.549767 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:52:18.550698 (MainThread): Tracking: tracking
2021-01-27 17:52:18.551048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84a80c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84a80c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84a80c588>]}
2021-01-27 17:52:18.595186 (MainThread): Partial parsing not enabled
2021-01-27 17:52:18.596366 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:52:18.599170 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:52:18.634726 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:52:18.636570 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:52:18.647426 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:52:18.649810 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:52:18.655358 (MainThread): Parsing macros/core.sql
2021-01-27 17:52:18.659677 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:52:18.661659 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:52:18.663429 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:52:18.665553 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:52:18.671342 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:52:18.682571 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:52:18.691217 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:52:18.697370 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:52:18.718707 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:52:18.721651 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:52:18.756190 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:52:18.764115 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:52:18.771231 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:52:18.773439 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:52:18.788722 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:52:18.811154 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:52:18.820637 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:52:18.822366 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:52:18.823513 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:52:18.825634 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:52:18.826769 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:52:18.828497 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:52:18.874841 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:52:18.890912 (MainThread): Partial parsing not enabled
2021-01-27 17:52:18.934821 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:52:18.962611 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:52:18.976006 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:52:19.248483 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:52:19.249228 (MainThread): 
2021-01-27 17:52:19.249604 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:52:19.254764 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:52:19.270701 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:52:19.270849 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:52:19.270938 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:52:20.107845 (ThreadPoolExecutor-0_0): subprocess 23479 is still running
2021-01-27 17:52:23.959040 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.69 seconds
2021-01-27 17:52:24.038387 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:52:24.472670 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:52:24.522617 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:52:24.522982 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:52:24.523240 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:52:25.245513 (ThreadPoolExecutor-1_0): subprocess 23587 is still running
2021-01-27 17:52:29.083978 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 462 in 4.56 seconds
2021-01-27 17:52:29.554965 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:52:29.878798 (MainThread): Using snowflake connection "master".
2021-01-27 17:52:29.879532 (MainThread): On master: BEGIN
2021-01-27 17:52:29.879929 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:52:30.586671 (MainThread): subprocess 23694 is still running
2021-01-27 17:52:34.413220 (MainThread): SQL status: SUCCESS 1 in 4.53 seconds
2021-01-27 17:52:34.413477 (MainThread): On master: COMMIT
2021-01-27 17:52:34.413694 (MainThread): Using snowflake connection "master".
2021-01-27 17:52:34.413777 (MainThread): On master: COMMIT
2021-01-27 17:52:34.758611 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 17:52:34.764976 (MainThread): On master: Close
2021-01-27 17:52:35.112933 (MainThread): 12:52:35 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:52:35.113729 (MainThread): 12:52:35 | 
2021-01-27 17:52:35.118339 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:52:35.123200 (Thread-1): 12:52:35 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:52:35.124344 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:52:35.124749 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:52:35.154559 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:52:35.154955 (Thread-1): finished collecting timing info
2021-01-27 17:52:35.203247 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:52:35.204117 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:52:35.204219 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 17:52:35.204302 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:52:35.918672 (Thread-1): subprocess 23803 is still running
2021-01-27 17:52:40.448038 (Thread-1): SQL status: SUCCESS 1 in 5.24 seconds
2021-01-27 17:52:40.448284 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:52:40.448407 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:52:42.926292 (Thread-1): SQL status: SUCCESS 1 in 2.48 seconds
2021-01-27 17:52:42.936360 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 17:52:42.937668 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:52:42.938144 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 17:52:43.318402 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-27 17:52:43.340512 (Thread-1): finished collecting timing info
2021-01-27 17:52:43.340906 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:52:43.750757 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e6d0a0e-d9d3-4dd6-9f41-ffd893edf85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc848d97a90>]}
2021-01-27 17:52:43.758399 (Thread-1): 12:52:43 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 8.62s]
2021-01-27 17:52:43.758948 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:52:43.759495 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:52:43.763176 (Thread-1): 12:52:43 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:52:43.763865 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:52:43.764143 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:52:43.779738 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:52:43.780733 (Thread-1): finished collecting timing info
2021-01-27 17:52:43.792622 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:52:43.793495 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:52:43.793648 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 17:52:43.793777 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:52:44.581379 (Thread-1): subprocess 23905 is still running
2021-01-27 17:52:48.999328 (Thread-1): SQL status: SUCCESS 1 in 5.21 seconds
2021-01-27 17:52:49.000159 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:52:49.000651 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:52:50.366351 (Thread-1): SQL status: SUCCESS 1 in 1.37 seconds
2021-01-27 17:52:50.376947 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 17:52:50.378124 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:52:50.378677 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 17:52:50.530104 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-27 17:52:50.548229 (Thread-1): finished collecting timing info
2021-01-27 17:52:50.550040 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:52:50.863095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e6d0a0e-d9d3-4dd6-9f41-ffd893edf85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8487d2f60>]}
2021-01-27 17:52:50.870060 (Thread-1): 12:52:50 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 7.10s]
2021-01-27 17:52:50.870672 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:52:50.871277 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:52:50.875626 (Thread-1): 12:52:50 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:52:50.876680 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:52:50.876985 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:52:50.890858 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:52:50.891300 (Thread-1): finished collecting timing info
2021-01-27 17:52:50.902152 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:52:50.903188 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:52:50.903296 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 17:52:50.903381 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:52:51.546328 (Thread-1): subprocess 24016 is still running
2021-01-27 17:52:55.401635 (Thread-1): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 17:52:55.402489 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:52:55.402969 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:52:57.539661 (Thread-1): SQL status: SUCCESS 1 in 2.14 seconds
2021-01-27 17:52:57.546724 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 17:52:57.547459 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:52:57.547776 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 17:52:57.744469 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 17:52:57.750645 (Thread-1): finished collecting timing info
2021-01-27 17:52:57.751311 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:52:58.560417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e6d0a0e-d9d3-4dd6-9f41-ffd893edf85c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84877d048>]}
2021-01-27 17:52:58.568747 (Thread-1): 12:52:58 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.68s]
2021-01-27 17:52:58.569750 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:52:58.626832 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:52:58.627258 (MainThread): Using snowflake connection "master".
2021-01-27 17:52:58.627411 (MainThread): On master: BEGIN
2021-01-27 17:52:58.627542 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:52:59.250802 (MainThread): subprocess 24120 is still running
2021-01-27 17:53:04.160536 (MainThread): SQL status: SUCCESS 1 in 5.53 seconds
2021-01-27 17:53:04.160808 (MainThread): On master: COMMIT
2021-01-27 17:53:04.161030 (MainThread): Using snowflake connection "master".
2021-01-27 17:53:04.161113 (MainThread): On master: COMMIT
2021-01-27 17:53:04.417891 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 17:53:04.418159 (MainThread): On master: Close
2021-01-27 17:53:04.644983 (MainThread): 12:53:04 | 
2021-01-27 17:53:04.645270 (MainThread): 12:53:04 | Finished running 3 snowflake_timetravel_table models in 45.40s.
2021-01-27 17:53:04.645578 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:53:04.645685 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:53:04.665679 (MainThread): 
2021-01-27 17:53:04.665969 (MainThread): Completed successfully
2021-01-27 17:53:04.666181 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 17:53:04.666646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc848791ba8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84877ddd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc84877dac8>]}
2021-01-27 17:53:04.666960 (MainThread): Flushing usage events
2021-01-27 17:53:49.563473 (MainThread): Running with dbt=0.18.1
2021-01-27 17:53:50.032771 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:53:50.033656 (MainThread): Tracking: tracking
2021-01-27 17:53:50.034007 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7848b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7848b4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d7848b518>]}
2021-01-27 17:53:50.078057 (MainThread): Partial parsing not enabled
2021-01-27 17:53:50.079157 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:53:50.081932 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:53:50.118956 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:53:50.120796 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:53:50.131691 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:53:50.133972 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:53:50.139150 (MainThread): Parsing macros/core.sql
2021-01-27 17:53:50.143503 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:53:50.145550 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:53:50.147309 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:53:50.149455 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:53:50.153737 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:53:50.164684 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:53:50.171806 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:53:50.177568 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:53:50.196340 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:53:50.198391 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:53:50.231785 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:53:50.239539 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:53:50.246622 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:53:50.248802 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:53:50.264546 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:53:50.287293 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:53:50.297054 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:53:50.298837 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:53:50.299979 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:53:50.302242 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:53:50.303409 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:53:50.305276 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:53:50.351742 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:53:50.368385 (MainThread): Partial parsing not enabled
2021-01-27 17:53:50.415978 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:53:50.441367 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:53:50.454665 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:53:50.709145 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:53:50.709834 (MainThread): 
2021-01-27 17:53:50.710192 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:53:50.714948 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:53:50.731111 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:53:50.731262 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:53:50.731348 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:53:51.445675 (ThreadPoolExecutor-0_0): subprocess 24388 is still running
2021-01-27 17:53:56.405002 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:53:56.405683 (MainThread): Connection 'list_USER_DATA' was left open.
2021-01-27 17:53:56.406128 (MainThread): On list_USER_DATA: Close
2021-01-27 17:53:56.549828 (MainThread): Flushing usage events
2021-01-27 17:53:56.683388 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:53:56.684144 (MainThread): Connection 'list_USER_DATA' was left open.
2021-01-27 17:53:56.684741 (MainThread): On list_USER_DATA: Close
2021-01-27 17:53:56.749337 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 6.02 seconds
2021-01-27 17:53:56.803324 (MainThread): ctrl-c
2021-01-27 17:53:56.804485 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:53:56.807261 (MainThread): unclosed <socket.socket fd=8, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('192.168.50.133', 57292), raddr=('52.70.232.12', 443)>
2021-01-27 17:53:56.813752 (MainThread): unclosed <socket.socket fd=7, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('192.168.50.133', 51898), raddr=('3.211.96.98', 443)>
2021-01-27 17:53:56.821549 (MainThread): unclosed <socket.socket fd=5, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('192.168.50.133', 57288), raddr=('52.70.232.12', 443)>
2021-01-27 17:54:11.452807 (MainThread): Running with dbt=0.18.1
2021-01-27 17:54:11.939634 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:54:11.940871 (MainThread): Tracking: tracking
2021-01-27 17:54:11.941544 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad17f8c8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad17f8c4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad17f8c518>]}
2021-01-27 17:54:11.988082 (MainThread): Partial parsing not enabled
2021-01-27 17:54:11.989231 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:54:11.992160 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:54:12.026810 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:54:12.028659 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:54:12.039361 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:54:12.041683 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:54:12.046931 (MainThread): Parsing macros/core.sql
2021-01-27 17:54:12.051265 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:54:12.053289 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:54:12.055071 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:54:12.057179 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:54:12.061456 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:54:12.072231 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:54:12.079137 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:54:12.084829 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:54:12.105013 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:54:12.107213 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:54:12.138669 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:54:12.145891 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:54:12.152558 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:54:12.154580 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:54:12.169721 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:54:12.192556 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:54:12.202304 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:54:12.204562 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:54:12.206994 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:54:12.212708 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:54:12.215368 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:54:12.220016 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:54:12.295515 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:54:12.314426 (MainThread): Partial parsing not enabled
2021-01-27 17:54:12.366430 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:54:12.392011 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:54:12.406615 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:54:12.678073 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:54:12.678824 (MainThread): 
2021-01-27 17:54:12.679172 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:54:12.684129 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:54:12.700239 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:54:12.700379 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:54:12.700467 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:54:13.403754 (ThreadPoolExecutor-0_0): subprocess 24590 is still running
2021-01-27 17:54:17.117843 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.42 seconds
2021-01-27 17:54:17.157234 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:54:17.429255 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:54:17.449610 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:54:17.449839 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:54:17.449993 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:54:18.134984 (ThreadPoolExecutor-1_0): subprocess 24693 is still running
2021-01-27 17:54:22.078602 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 462 in 4.63 seconds
2021-01-27 17:54:22.637932 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:54:22.931174 (MainThread): Using snowflake connection "master".
2021-01-27 17:54:22.931385 (MainThread): On master: BEGIN
2021-01-27 17:54:22.931515 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:54:23.603245 (MainThread): subprocess 24790 is still running
2021-01-27 17:54:27.432720 (MainThread): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 17:54:27.433720 (MainThread): On master: COMMIT
2021-01-27 17:54:27.434771 (MainThread): Using snowflake connection "master".
2021-01-27 17:54:27.435232 (MainThread): On master: COMMIT
2021-01-27 17:54:27.728165 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 17:54:27.728756 (MainThread): On master: Close
2021-01-27 17:54:28.008754 (MainThread): 12:54:28 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:54:28.009313 (MainThread): 12:54:28 | 
2021-01-27 17:54:28.012865 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:54:28.016784 (Thread-1): 12:54:28 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:54:28.017355 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:54:28.017609 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:54:28.045571 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:54:28.045965 (Thread-1): finished collecting timing info
2021-01-27 17:54:28.093250 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:54:28.094093 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:54:28.094198 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 17:54:28.094304 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:54:28.726513 (Thread-1): subprocess 24889 is still running
2021-01-27 17:54:32.313453 (Thread-1): SQL status: SUCCESS 1 in 4.22 seconds
2021-01-27 17:54:32.313737 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:54:32.313898 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:54:33.356823 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-27 17:54:33.360290 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 17:54:33.360641 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:54:33.360786 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 17:54:33.510184 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-27 17:54:33.557068 (Thread-1): finished collecting timing info
2021-01-27 17:54:33.557545 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:54:33.817116 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae004171-dc1f-4104-a3a5-98034db2f35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad15f9c6d8>]}
2021-01-27 17:54:33.823286 (Thread-1): 12:54:33 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 5.80s]
2021-01-27 17:54:33.823960 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:54:33.824683 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:54:33.830630 (Thread-1): 12:54:33 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:54:33.831657 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:54:33.832163 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:54:33.847752 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:54:33.848161 (Thread-1): finished collecting timing info
2021-01-27 17:54:33.860917 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:54:33.861785 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:54:33.861892 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 17:54:33.861979 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:54:34.504435 (Thread-1): subprocess 24997 is still running
2021-01-27 17:54:38.114743 (Thread-1): SQL status: SUCCESS 1 in 4.25 seconds
2021-01-27 17:54:38.115542 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:54:38.116020 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:54:39.474845 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-27 17:54:39.476879 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 17:54:39.477106 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:54:39.477190 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 17:54:39.621577 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-27 17:54:39.631499 (Thread-1): finished collecting timing info
2021-01-27 17:54:39.632537 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:54:39.903710 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae004171-dc1f-4104-a3a5-98034db2f35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad15f55f28>]}
2021-01-27 17:54:39.911351 (Thread-1): 12:54:39 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 6.07s]
2021-01-27 17:54:39.912266 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:54:39.913563 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:54:39.919180 (Thread-1): 12:54:39 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:54:39.920221 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:54:39.920623 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:54:39.936756 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:54:39.937157 (Thread-1): finished collecting timing info
2021-01-27 17:54:39.949218 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:54:39.950098 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:54:39.950204 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 17:54:39.950304 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:54:40.624636 (Thread-1): subprocess 25103 is still running
2021-01-27 17:54:44.922935 (Thread-1): SQL status: SUCCESS 1 in 4.97 seconds
2021-01-27 17:54:44.923770 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:54:44.924261 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 17:54:47.353839 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2021-01-27 17:54:47.355838 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 17:54:47.356062 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:54:47.356221 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 17:54:48.362138 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-27 17:54:48.377360 (Thread-1): finished collecting timing info
2021-01-27 17:54:48.378501 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:54:48.658030 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae004171-dc1f-4104-a3a5-98034db2f35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad15f559e8>]}
2021-01-27 17:54:48.665074 (Thread-1): 12:54:48 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.74s]
2021-01-27 17:54:48.665598 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:54:48.701840 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:54:48.702759 (MainThread): Using snowflake connection "master".
2021-01-27 17:54:48.703159 (MainThread): On master: BEGIN
2021-01-27 17:54:48.703532 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:54:49.337294 (MainThread): subprocess 25217 is still running
2021-01-27 17:54:53.592074 (MainThread): SQL status: SUCCESS 1 in 4.89 seconds
2021-01-27 17:54:53.592567 (MainThread): On master: COMMIT
2021-01-27 17:54:53.593094 (MainThread): Using snowflake connection "master".
2021-01-27 17:54:53.593326 (MainThread): On master: COMMIT
2021-01-27 17:54:53.922690 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 17:54:53.923024 (MainThread): On master: Close
2021-01-27 17:54:54.239915 (MainThread): 12:54:54 | 
2021-01-27 17:54:54.241665 (MainThread): 12:54:54 | Finished running 3 snowflake_timetravel_table models in 41.56s.
2021-01-27 17:54:54.242366 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:54:54.242759 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:54:54.264922 (MainThread): 
2021-01-27 17:54:54.265124 (MainThread): Completed successfully
2021-01-27 17:54:54.265245 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 17:54:54.265495 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad15f55ac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad15f55f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad15f55518>]}
2021-01-27 17:54:54.265766 (MainThread): Flushing usage events
2021-01-27 17:56:07.932967 (MainThread): Running with dbt=0.18.1
2021-01-27 17:56:08.406995 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 17:56:08.407841 (MainThread): Tracking: tracking
2021-01-27 17:56:08.408208 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3d3cf898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3d3cf4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a3d3cf4e0>]}
2021-01-27 17:56:08.453741 (MainThread): Partial parsing not enabled
2021-01-27 17:56:08.454873 (MainThread): Parsing macros/catalog.sql
2021-01-27 17:56:08.458868 (MainThread): Parsing macros/adapters.sql
2021-01-27 17:56:08.498073 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 17:56:08.500415 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 17:56:08.511383 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 17:56:08.513825 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 17:56:08.519527 (MainThread): Parsing macros/core.sql
2021-01-27 17:56:08.524074 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 17:56:08.526330 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 17:56:08.528167 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 17:56:08.530367 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 17:56:08.534869 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 17:56:08.545724 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 17:56:08.553243 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 17:56:08.559205 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 17:56:08.579136 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 17:56:08.581241 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 17:56:08.612457 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 17:56:08.620051 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 17:56:08.627032 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 17:56:08.629128 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 17:56:08.644130 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 17:56:08.666971 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 17:56:08.676318 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 17:56:08.678179 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 17:56:08.679199 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 17:56:08.681685 (MainThread): Parsing macros/etc/query.sql
2021-01-27 17:56:08.683124 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 17:56:08.685109 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 17:56:08.732260 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 17:56:08.748970 (MainThread): Partial parsing not enabled
2021-01-27 17:56:08.795763 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:56:08.821330 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:56:08.834536 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:56:09.087152 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 17:56:09.087833 (MainThread): 
2021-01-27 17:56:09.088151 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:56:09.092809 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 17:56:09.108691 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 17:56:09.108836 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 17:56:09.108932 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 17:56:10.125248 (ThreadPoolExecutor-0_0): subprocess 25745 is still running
2021-01-27 17:56:14.971710 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.86 seconds
2021-01-27 17:56:15.016103 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 17:56:15.296687 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:56:15.317704 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 17:56:15.317905 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 17:56:15.318041 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 17:56:16.022057 (ThreadPoolExecutor-1_0): subprocess 25883 is still running
2021-01-27 17:56:20.222775 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.90 seconds
2021-01-27 17:56:20.795982 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 17:56:21.306430 (MainThread): Using snowflake connection "master".
2021-01-27 17:56:21.306620 (MainThread): On master: BEGIN
2021-01-27 17:56:21.306742 (MainThread): Opening a new connection, currently in state init
2021-01-27 17:56:21.883110 (MainThread): subprocess 26006 is still running
2021-01-27 17:56:25.563538 (MainThread): SQL status: SUCCESS 1 in 4.26 seconds
2021-01-27 17:56:25.563820 (MainThread): On master: COMMIT
2021-01-27 17:56:25.564063 (MainThread): Using snowflake connection "master".
2021-01-27 17:56:25.564155 (MainThread): On master: COMMIT
2021-01-27 17:56:25.879458 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 17:56:25.880306 (MainThread): On master: Close
2021-01-27 17:56:26.154259 (MainThread): 12:56:26 | Concurrency: 1 threads (target='snowflake')
2021-01-27 17:56:26.154513 (MainThread): 12:56:26 | 
2021-01-27 17:56:26.155844 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:56:26.157910 (Thread-1): 12:56:26 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 17:56:26.158388 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:56:26.158554 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:56:26.179920 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 17:56:26.180353 (Thread-1): finished collecting timing info
2021-01-27 17:56:26.234309 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:56:26.234469 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:56:26.234565 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:56:26.804568 (Thread-1): subprocess 26113 is still running
2021-01-27 17:56:30.611144 (Thread-1): SQL status: SUCCESS 1 in 4.38 seconds
2021-01-27 17:56:30.651793 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:56:30.652006 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:56:30.897011 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 17:56:30.920646 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:56:30.920991 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 17:56:31.190564 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-27 17:56:31.215637 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:56:31.215905 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 17:56:31.647543 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-27 17:56:31.649776 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 17:56:31.649945 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 17:56:31.869743 (Thread-1): Snowflake query id: 0199e4f4-05db-3046-0000-44a9389a04c2
2021-01-27 17:56:31.869906 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:56:31.870145 (Thread-1): finished collecting timing info
2021-01-27 17:56:31.870634 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 17:56:32.102240 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 113, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:56:32.104543 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aedcdfcd-09c5-46cb-aacf-91768240c0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a37950be0>]}
2021-01-27 17:56:32.106263 (Thread-1): 12:56:32 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.95s]
2021-01-27 17:56:32.106457 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 17:56:32.106658 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:56:32.108224 (Thread-1): 12:56:32 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 17:56:32.108584 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:56:32.108713 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:56:32.117354 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 17:56:32.117806 (Thread-1): finished collecting timing info
2021-01-27 17:56:32.134300 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:56:32.134479 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:56:32.134587 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:56:32.724833 (Thread-1): subprocess 26212 is still running
2021-01-27 17:56:36.652626 (Thread-1): SQL status: SUCCESS 1 in 4.52 seconds
2021-01-27 17:56:36.674750 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:56:36.675376 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:56:36.999457 (Thread-1): SQL status: SUCCESS 3 in 0.32 seconds
2021-01-27 17:56:37.003484 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:56:37.003639 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 17:56:37.220087 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 17:56:37.238002 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:56:37.239112 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 17:56:37.690098 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-27 17:56:37.693575 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 17:56:37.693800 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 17:56:37.937129 (Thread-1): Snowflake query id: 0199e4f4-05b9-697d-0000-44a9389a056a
2021-01-27 17:56:37.937329 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:56:37.937734 (Thread-1): finished collecting timing info
2021-01-27 17:56:37.938377 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 17:56:38.220100 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 113, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:56:38.223433 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aedcdfcd-09c5-46cb-aacf-91768240c0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a373acda0>]}
2021-01-27 17:56:38.230903 (Thread-1): 12:56:38 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 6.11s]
2021-01-27 17:56:38.231813 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 17:56:38.232631 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:56:38.237341 (Thread-1): 12:56:38 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 17:56:38.238314 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:56:38.238670 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:56:38.253616 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 17:56:38.254143 (Thread-1): finished collecting timing info
2021-01-27 17:56:38.272423 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:56:38.272588 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 17:56:38.272696 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 17:56:38.865243 (Thread-1): subprocess 26315 is still running
2021-01-27 17:56:42.694867 (Thread-1): SQL status: SUCCESS 1 in 4.42 seconds
2021-01-27 17:56:42.706129 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:56:42.706421 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:56:42.930695 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 17:56:42.935761 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:56:42.936090 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 17:56:43.152148 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 17:56:43.159367 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:56:43.159769 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 17:56:43.413796 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 17:56:43.415493 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 17:56:43.415598 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 17:56:43.659346 (Thread-1): Snowflake query id: 0199e4f4-05b7-872a-0000-44a9389a164e
2021-01-27 17:56:43.659923 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:56:43.660921 (Thread-1): finished collecting timing info
2021-01-27 17:56:43.662783 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 17:56:43.948990 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 113, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:56:43.956211 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aedcdfcd-09c5-46cb-aacf-91768240c0c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a37370940>]}
2021-01-27 17:56:43.963461 (Thread-1): 12:56:43 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.72s]
2021-01-27 17:56:43.963994 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 17:56:44.043285 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 17:56:44.044512 (MainThread): Using snowflake connection "master".
2021-01-27 17:56:44.045027 (MainThread): On master: BEGIN
2021-01-27 17:56:44.045554 (MainThread): Opening a new connection, currently in state closed
2021-01-27 17:56:44.703418 (MainThread): subprocess 26417 is still running
2021-01-27 17:56:48.581817 (MainThread): SQL status: SUCCESS 1 in 4.54 seconds
2021-01-27 17:56:48.583563 (MainThread): On master: COMMIT
2021-01-27 17:56:48.584689 (MainThread): Using snowflake connection "master".
2021-01-27 17:56:48.585135 (MainThread): On master: COMMIT
2021-01-27 17:56:48.886665 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 17:56:48.887758 (MainThread): On master: Close
2021-01-27 17:56:49.182645 (MainThread): 12:56:49 | 
2021-01-27 17:56:49.183925 (MainThread): 12:56:49 | Finished running 3 snowflake_timetravel_table models in 40.09s.
2021-01-27 17:56:49.184688 (MainThread): Connection 'master' was properly closed.
2021-01-27 17:56:49.185278 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 17:56:49.259578 (MainThread): 
2021-01-27 17:56:49.259883 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 17:56:49.260120 (MainThread): 
2021-01-27 17:56:49.260333 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 17:56:49.260504 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:56:49.260664 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:56:49.260827 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 17:56:49.261016 (MainThread): 
2021-01-27 17:56:49.261206 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 17:56:49.261370 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:56:49.261522 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:56:49.261669 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 17:56:49.261832 (MainThread): 
2021-01-27 17:56:49.262010 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 17:56:49.262167 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 17:56:49.262347 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 17:56:49.262502 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 17:56:49.262684 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 17:56:49.263070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a35a6aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a35a6aef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a35a6af28>]}
2021-01-27 17:56:49.263455 (MainThread): Flushing usage events
2021-01-27 18:51:10.549592 (MainThread): Running with dbt=0.18.1
2021-01-27 18:51:11.008082 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 18:51:11.008978 (MainThread): Tracking: tracking
2021-01-27 18:51:11.009369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26284b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26284b4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26284b518>]}
2021-01-27 18:51:11.052152 (MainThread): Partial parsing not enabled
2021-01-27 18:51:11.053227 (MainThread): Parsing macros/catalog.sql
2021-01-27 18:51:11.056177 (MainThread): Parsing macros/adapters.sql
2021-01-27 18:51:11.089709 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 18:51:11.091474 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 18:51:11.101310 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 18:51:11.103454 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 18:51:11.108415 (MainThread): Parsing macros/core.sql
2021-01-27 18:51:11.112412 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 18:51:11.114286 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 18:51:11.115995 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 18:51:11.118046 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 18:51:11.122180 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 18:51:11.132266 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 18:51:11.139024 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 18:51:11.144605 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 18:51:11.162198 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 18:51:11.164154 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 18:51:11.193091 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 18:51:11.199832 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 18:51:11.206341 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 18:51:11.208276 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 18:51:11.223142 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 18:51:11.249526 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 18:51:11.259005 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 18:51:11.260865 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 18:51:11.261914 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 18:51:11.264119 (MainThread): Parsing macros/etc/query.sql
2021-01-27 18:51:11.265259 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 18:51:11.267081 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 18:51:11.312028 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 18:51:11.328433 (MainThread): Partial parsing not enabled
2021-01-27 18:51:11.369540 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 18:51:11.392578 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 18:51:11.404562 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 18:51:11.669726 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 18:51:11.670433 (MainThread): 
2021-01-27 18:51:11.670779 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 18:51:11.675391 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 18:51:11.690339 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 18:51:11.690484 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 18:51:11.690606 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 18:51:12.429323 (ThreadPoolExecutor-0_0): subprocess 3867 is still running
2021-01-27 18:51:16.460335 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.77 seconds
2021-01-27 18:51:16.496774 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 18:51:16.759618 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 18:51:16.768636 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 18:51:16.768782 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 18:51:16.768874 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 18:51:17.385887 (ThreadPoolExecutor-1_0): subprocess 3974 is still running
2021-01-27 18:51:21.576580 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.81 seconds
2021-01-27 18:51:22.011669 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 18:51:22.307108 (MainThread): Using snowflake connection "master".
2021-01-27 18:51:22.307301 (MainThread): On master: BEGIN
2021-01-27 18:51:22.307411 (MainThread): Opening a new connection, currently in state init
2021-01-27 18:51:22.956135 (MainThread): subprocess 4080 is still running
2021-01-27 18:51:26.804763 (MainThread): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 18:51:26.805150 (MainThread): On master: COMMIT
2021-01-27 18:51:26.805521 (MainThread): Using snowflake connection "master".
2021-01-27 18:51:26.805687 (MainThread): On master: COMMIT
2021-01-27 18:51:27.294694 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 18:51:27.295619 (MainThread): On master: Close
2021-01-27 18:51:27.555003 (MainThread): 13:51:27 | Concurrency: 1 threads (target='snowflake')
2021-01-27 18:51:27.555742 (MainThread): 13:51:27 | 
2021-01-27 18:51:27.567930 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 18:51:27.575846 (Thread-1): 13:51:27 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 18:51:27.577173 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 18:51:27.577740 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 18:51:27.612960 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 18:51:27.613323 (Thread-1): finished collecting timing info
2021-01-27 18:51:27.664367 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 18:51:27.664517 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 18:51:27.664617 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 18:51:28.242007 (Thread-1): subprocess 4187 is still running
2021-01-27 18:51:33.456199 (Thread-1): SQL status: SUCCESS 1 in 5.79 seconds
2021-01-27 18:51:33.497789 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 18:51:33.497989 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 18:51:33.678024 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 18:51:33.693539 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 18:51:33.694376 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 18:51:33.910932 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 18:51:33.937428 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 18:51:33.937672 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 18:51:34.379392 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-27 18:51:34.388192 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 18:51:34.388758 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 18:51:34.574390 (Thread-1): Snowflake query id: 0199e52b-0541-d392-0000-44a9389b6e0e
2021-01-27 18:51:34.574901 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 18:51:34.576313 (Thread-1): finished collecting timing info
2021-01-27 18:51:34.578356 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 18:51:34.848888 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 111, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 18:51:34.861308 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638c8fca-0184-4507-97e7-cc0d9c2e2ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2608631d0>]}
2021-01-27 18:51:34.871533 (Thread-1): 13:51:34 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 7.28s]
2021-01-27 18:51:34.872983 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 18:51:34.873989 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 18:51:34.879875 (Thread-1): 13:51:34 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 18:51:34.880821 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 18:51:34.881188 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 18:51:34.900194 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 18:51:34.900838 (Thread-1): finished collecting timing info
2021-01-27 18:51:34.922593 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 18:51:34.922752 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 18:51:34.922846 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 18:51:35.517375 (Thread-1): subprocess 4289 is still running
2021-01-27 18:51:40.217616 (Thread-1): SQL status: SUCCESS 1 in 5.29 seconds
2021-01-27 18:51:40.240693 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 18:51:40.241317 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 18:51:40.433171 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 18:51:40.439106 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 18:51:40.439320 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 18:51:40.936814 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-01-27 18:51:40.956829 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 18:51:40.957340 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 18:51:41.447628 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 18:51:41.454387 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 18:51:41.454650 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 18:51:41.710052 (Thread-1): Snowflake query id: 0199e52b-0542-f794-0000-44a9389b6ece
2021-01-27 18:51:41.710211 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 18:51:41.710482 (Thread-1): finished collecting timing info
2021-01-27 18:51:41.710944 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 18:51:41.960670 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 111, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 18:51:41.964719 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638c8fca-0184-4507-97e7-cc0d9c2e2ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc26089eef0>]}
2021-01-27 18:51:41.969370 (Thread-1): 13:51:41 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 7.08s]
2021-01-27 18:51:41.969649 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 18:51:41.969940 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 18:51:41.971693 (Thread-1): 13:51:41 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 18:51:41.972540 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 18:51:41.972728 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 18:51:41.982201 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 18:51:41.982611 (Thread-1): finished collecting timing info
2021-01-27 18:51:41.996334 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 18:51:41.996537 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 18:51:41.996661 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 18:51:42.632759 (Thread-1): subprocess 4397 is still running
2021-01-27 18:51:47.283388 (Thread-1): SQL status: SUCCESS 1 in 5.29 seconds
2021-01-27 18:51:47.315222 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 18:51:47.316264 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 18:51:47.525883 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 18:51:47.544532 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 18:51:47.545149 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 18:51:47.742460 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 18:51:47.767385 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 18:51:47.767756 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 18:51:48.146718 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-27 18:51:48.154872 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 18:51:48.155472 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 18:51:48.351674 (Thread-1): Snowflake query id: 0199e52b-0586-9f7d-0000-44a9389b6f8a
2021-01-27 18:51:48.352253 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 18:51:48.353218 (Thread-1): finished collecting timing info
2021-01-27 18:51:48.355127 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 18:51:48.607043 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 111, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 18:51:48.610722 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638c8fca-0184-4507-97e7-cc0d9c2e2ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2606f05f8>]}
2021-01-27 18:51:48.629018 (Thread-1): 13:51:48 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 6.64s]
2021-01-27 18:51:48.629896 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 18:51:48.669660 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 18:51:48.670072 (MainThread): Using snowflake connection "master".
2021-01-27 18:51:48.670242 (MainThread): On master: BEGIN
2021-01-27 18:51:48.670380 (MainThread): Opening a new connection, currently in state closed
2021-01-27 18:51:49.321540 (MainThread): subprocess 4508 is still running
2021-01-27 18:51:53.157754 (MainThread): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 18:51:53.158090 (MainThread): On master: COMMIT
2021-01-27 18:51:53.158428 (MainThread): Using snowflake connection "master".
2021-01-27 18:51:53.158565 (MainThread): On master: COMMIT
2021-01-27 18:51:53.514409 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 18:51:53.515315 (MainThread): On master: Close
2021-01-27 18:51:53.820908 (MainThread): 13:51:53 | 
2021-01-27 18:51:53.821499 (MainThread): 13:51:53 | Finished running 3 snowflake_timetravel_table models in 42.15s.
2021-01-27 18:51:53.821835 (MainThread): Connection 'master' was properly closed.
2021-01-27 18:51:53.822053 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 18:51:53.841259 (MainThread): 
2021-01-27 18:51:53.841454 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 18:51:53.841571 (MainThread): 
2021-01-27 18:51:53.841691 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 18:51:53.841788 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 18:51:53.841874 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 18:51:53.841959 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 18:51:53.842049 (MainThread): 
2021-01-27 18:51:53.842146 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 18:51:53.842244 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 18:51:53.842329 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 18:51:53.842408 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 18:51:53.842495 (MainThread): 
2021-01-27 18:51:53.842590 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 18:51:53.842708 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 18:51:53.842791 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 18:51:53.842870 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 18:51:53.842963 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 18:51:53.843211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2606eac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2606eaef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2606ea748>]}
2021-01-27 18:51:53.843493 (MainThread): Flushing usage events
2021-01-27 19:03:11.140939 (MainThread): Running with dbt=0.18.1
2021-01-27 19:03:11.623647 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:03:11.626268 (MainThread): Tracking: tracking
2021-01-27 19:03:11.626753 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fec10908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fec10518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fec10550>]}
2021-01-27 19:03:11.669856 (MainThread): Partial parsing not enabled
2021-01-27 19:03:11.670949 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:03:11.673772 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:03:11.709473 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:03:11.711411 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:03:11.723498 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:03:11.726163 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:03:11.731808 (MainThread): Parsing macros/core.sql
2021-01-27 19:03:11.736287 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:03:11.738698 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:03:11.740613 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:03:11.743120 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:03:11.747953 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:03:11.761345 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:03:11.768892 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:03:11.774968 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:03:11.794858 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:03:11.796899 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:03:11.830329 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:03:11.837896 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:03:11.845020 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:03:11.847582 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:03:11.864034 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:03:11.887520 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:03:11.897089 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:03:11.898861 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:03:11.899893 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:03:11.902239 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:03:11.903480 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:03:11.905341 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:03:11.953636 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:03:11.970352 (MainThread): Partial parsing not enabled
2021-01-27 19:03:12.012773 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:03:12.037295 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:03:12.050495 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:03:12.296454 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:03:12.297122 (MainThread): 
2021-01-27 19:03:12.297448 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:03:12.301976 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:03:12.317822 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:03:12.317968 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:03:12.318054 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:03:14.694839 (ThreadPoolExecutor-0_0): subprocess 6296 is still running
2021-01-27 19:03:37.424469 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 25.11 seconds
2021-01-27 19:03:37.460100 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:03:37.789193 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:03:37.801133 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:03:37.801284 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:03:37.801384 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:03:38.501478 (ThreadPoolExecutor-1_0): subprocess 6411 is still running
2021-01-27 19:03:44.328777 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 6.53 seconds
2021-01-27 19:03:44.777287 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:03:45.171569 (MainThread): Using snowflake connection "master".
2021-01-27 19:03:45.171772 (MainThread): On master: BEGIN
2021-01-27 19:03:45.171888 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:03:45.841031 (MainThread): subprocess 6527 is still running
2021-01-27 19:03:49.690210 (MainThread): SQL status: SUCCESS 1 in 4.52 seconds
2021-01-27 19:03:49.691273 (MainThread): On master: COMMIT
2021-01-27 19:03:49.692443 (MainThread): Using snowflake connection "master".
2021-01-27 19:03:49.692924 (MainThread): On master: COMMIT
2021-01-27 19:03:50.043590 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-27 19:03:50.044502 (MainThread): On master: Close
2021-01-27 19:03:50.382058 (MainThread): 14:03:50 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:03:50.382746 (MainThread): 14:03:50 | 
2021-01-27 19:03:50.387152 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:03:50.392987 (Thread-1): 14:03:50 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:03:50.394348 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:03:50.394872 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:03:50.427996 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:03:50.428393 (Thread-1): finished collecting timing info
2021-01-27 19:03:50.478369 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:03:50.478528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:03:50.478619 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:03:51.113645 (Thread-1): subprocess 6634 is still running
2021-01-27 19:03:55.844486 (Thread-1): SQL status: SUCCESS 1 in 5.37 seconds
2021-01-27 19:03:55.879725 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:03:55.879930 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:03:56.060062 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 19:03:56.076584 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:03:56.077089 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 19:03:56.275655 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:03:56.311070 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:03:56.311320 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 19:03:56.706857 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-27 19:03:56.714836 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:03:56.715402 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 19:03:57.328290 (Thread-1): Snowflake query id: 0199e537-05ae-943c-0000-44a9389bf4b2
2021-01-27 19:03:57.328515 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:03:57.328868 (Thread-1): finished collecting timing info
2021-01-27 19:03:57.329526 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:03:57.582572 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 111, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 19:03:57.593334 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8bbd2b-ee76-4e12-9a82-44fcc108476b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fd197b38>]}
2021-01-27 19:03:57.601703 (Thread-1): 14:03:57 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 7.20s]
2021-01-27 19:03:57.602173 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:03:57.602725 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:03:57.606106 (Thread-1): 14:03:57 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:03:57.607367 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:03:57.607635 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:03:57.620619 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:03:57.621033 (Thread-1): finished collecting timing info
2021-01-27 19:03:57.636135 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:03:57.636290 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:03:57.636380 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:03:58.222113 (Thread-1): subprocess 6736 is still running
2021-01-27 19:04:02.127418 (Thread-1): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 19:04:02.143396 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:04:02.144002 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:04:02.323567 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 19:04:02.338030 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:04:02.338766 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 19:04:02.528570 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 19:04:02.531949 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:04:02.532081 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 19:04:02.816497 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 19:04:02.821922 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:04:02.822325 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 19:04:03.061547 (Thread-1): Snowflake query id: 0199e538-05d9-9112-0000-44a9389be96a
2021-01-27 19:04:03.062130 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:04:03.063212 (Thread-1): finished collecting timing info
2021-01-27 19:04:03.065032 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:04:03.388301 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 111, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 19:04:03.392767 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8bbd2b-ee76-4e12-9a82-44fcc108476b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09060005f8>]}
2021-01-27 19:04:03.398706 (Thread-1): 14:04:03 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.79s]
2021-01-27 19:04:03.399185 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:04:03.399708 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:04:03.402207 (Thread-1): 14:04:03 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:04:03.403536 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:04:03.403818 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:04:03.422291 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:04:03.422785 (Thread-1): finished collecting timing info
2021-01-27 19:04:03.440408 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:04:03.440572 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:04:03.440661 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:04:04.103162 (Thread-1): subprocess 6837 is still running
2021-01-27 19:04:07.887487 (Thread-1): SQL status: SUCCESS 1 in 4.45 seconds
2021-01-27 19:04:07.911823 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:04:07.912714 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:04:08.097300 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 19:04:08.117572 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:04:08.118184 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 19:04:08.376622 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-27 19:04:08.379919 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:04:08.380060 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 19:04:08.708728 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 19:04:08.719821 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:04:08.720398 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 19:04:09.003586 (Thread-1): Snowflake query id: 0199e538-0548-9a26-0000-44a9389bdbce
2021-01-27 19:04:09.004170 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:04:09.005179 (Thread-1): finished collecting timing info
2021-01-27 19:04:09.007092 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:04:09.324377 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 111, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 19:04:09.331583 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed8bbd2b-ee76-4e12-9a82-44fcc108476b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fc2af390>]}
2021-01-27 19:04:09.342463 (Thread-1): 14:04:09 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.93s]
2021-01-27 19:04:09.342879 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:04:09.373338 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:04:09.373733 (MainThread): Using snowflake connection "master".
2021-01-27 19:04:09.373870 (MainThread): On master: BEGIN
2021-01-27 19:04:09.373993 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:04:10.021541 (MainThread): subprocess 6948 is still running
2021-01-27 19:04:14.064530 (MainThread): SQL status: SUCCESS 1 in 4.69 seconds
2021-01-27 19:04:14.065257 (MainThread): On master: COMMIT
2021-01-27 19:04:14.066525 (MainThread): Using snowflake connection "master".
2021-01-27 19:04:14.066909 (MainThread): On master: COMMIT
2021-01-27 19:04:14.422955 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 19:04:14.423634 (MainThread): On master: Close
2021-01-27 19:04:14.750905 (MainThread): 14:04:14 | 
2021-01-27 19:04:14.751873 (MainThread): 14:04:14 | Finished running 3 snowflake_timetravel_table models in 62.45s.
2021-01-27 19:04:14.752472 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:04:14.752885 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:04:14.777242 (MainThread): 
2021-01-27 19:04:14.777463 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 19:04:14.777629 (MainThread): 
2021-01-27 19:04:14.777772 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 19:04:14.777892 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 19:04:14.777997 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:04:14.778106 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 19:04:14.778248 (MainThread): 
2021-01-27 19:04:14.778358 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 19:04:14.778455 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 19:04:14.778621 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:04:14.778696 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 19:04:14.778777 (MainThread): 
2021-01-27 19:04:14.778866 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 19:04:14.778947 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 19:04:14.779019 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:04:14.779089 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 19:04:14.779178 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 19:04:14.779426 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fc2bb710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fc2bbd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08fc2bb5c0>]}
2021-01-27 19:04:14.779713 (MainThread): Flushing usage events
2021-01-27 19:06:15.787534 (MainThread): Running with dbt=0.18.1
2021-01-27 19:06:16.274629 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:06:16.275571 (MainThread): Tracking: tracking
2021-01-27 19:06:16.275929 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cab74a908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cab74a518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cab74a550>]}
2021-01-27 19:06:16.320493 (MainThread): Partial parsing not enabled
2021-01-27 19:06:16.321581 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:06:16.324399 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:06:16.359691 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:06:16.361569 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:06:16.372094 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:06:16.374459 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:06:16.379787 (MainThread): Parsing macros/core.sql
2021-01-27 19:06:16.383818 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:06:16.385751 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:06:16.387421 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:06:16.389487 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:06:16.393763 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:06:16.404176 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:06:16.411560 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:06:16.417230 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:06:16.438253 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:06:16.440537 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:06:16.472177 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:06:16.479594 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:06:16.486244 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:06:16.488229 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:06:16.503137 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:06:16.527884 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:06:16.540861 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:06:16.543080 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:06:16.544282 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:06:16.546800 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:06:16.548072 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:06:16.550190 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:06:16.597366 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:06:16.614843 (MainThread): Partial parsing not enabled
2021-01-27 19:06:16.657699 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:06:16.681955 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:06:16.694759 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:06:16.940270 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:06:16.941043 (MainThread): 
2021-01-27 19:06:16.941395 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:06:16.946189 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:06:16.961448 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:06:16.961590 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:06:16.961675 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:06:17.659562 (ThreadPoolExecutor-0_0): subprocess 7354 is still running
2021-01-27 19:06:21.447399 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.49 seconds
2021-01-27 19:06:21.491074 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:06:21.785474 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:06:21.799920 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:06:21.800134 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:06:21.800272 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:06:22.459348 (ThreadPoolExecutor-1_0): subprocess 7467 is still running
2021-01-27 19:06:26.166942 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.37 seconds
2021-01-27 19:06:26.625370 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:06:26.977037 (MainThread): Using snowflake connection "master".
2021-01-27 19:06:26.977233 (MainThread): On master: BEGIN
2021-01-27 19:06:26.977353 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:06:27.625430 (MainThread): subprocess 7566 is still running
2021-01-27 19:06:31.992041 (MainThread): SQL status: SUCCESS 1 in 5.01 seconds
2021-01-27 19:06:31.993061 (MainThread): On master: COMMIT
2021-01-27 19:06:31.994095 (MainThread): Using snowflake connection "master".
2021-01-27 19:06:31.994570 (MainThread): On master: COMMIT
2021-01-27 19:06:32.366159 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-27 19:06:32.367074 (MainThread): On master: Close
2021-01-27 19:06:32.810515 (MainThread): 14:06:32 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:06:32.811506 (MainThread): 14:06:32 | 
2021-01-27 19:06:32.817538 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:06:32.823254 (Thread-1): 14:06:32 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:06:32.824269 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:06:32.824706 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:06:32.864789 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:06:32.865176 (Thread-1): finished collecting timing info
2021-01-27 19:06:32.915221 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:06:32.915382 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:06:32.915478 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:06:33.583534 (Thread-1): subprocess 7664 is still running
2021-01-27 19:06:37.343037 (Thread-1): SQL status: SUCCESS 1 in 4.43 seconds
2021-01-27 19:06:37.394608 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:06:37.394824 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:06:37.565221 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-27 19:06:37.584317 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:06:37.584922 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 19:06:37.815161 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 19:06:37.820050 (Thread-1): DEBUG: about to invoke drop statement for temp relation
2021-01-27 19:06:37.851483 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:06:37.851980 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 19:06:38.088691 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 19:06:38.096655 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:06:38.097320 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    None
2021-01-27 19:06:38.347255 (Thread-1): Snowflake query id: 0199e53a-0500-85c5-0000-44a9389c30be
2021-01-27 19:06:38.347853 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:06:38.348956 (Thread-1): finished collecting timing info
2021-01-27 19:06:38.350825 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:06:38.623938 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 113, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 19:06:38.646430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a7e2eb-a98e-4d35-8e01-f2f726b257f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca9cd9898>]}
2021-01-27 19:06:38.653378 (Thread-1): 14:06:38 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.82s]
2021-01-27 19:06:38.653858 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:06:38.654381 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:06:38.657677 (Thread-1): 14:06:38 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:06:38.658980 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:06:38.659250 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:06:38.673257 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:06:38.673672 (Thread-1): finished collecting timing info
2021-01-27 19:06:38.689183 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:06:38.689344 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:06:38.689447 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:06:39.303004 (Thread-1): subprocess 7758 is still running
2021-01-27 19:06:42.984604 (Thread-1): SQL status: SUCCESS 1 in 4.30 seconds
2021-01-27 19:06:42.991938 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:06:42.992148 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:06:43.608091 (Thread-1): SQL status: SUCCESS 3 in 0.62 seconds
2021-01-27 19:06:43.623264 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:06:43.623709 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 19:06:43.835654 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 19:06:43.840120 (Thread-1): DEBUG: about to invoke drop statement for temp relation
2021-01-27 19:06:43.852070 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:06:43.852796 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 19:06:44.098282 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 19:06:44.106377 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:06:44.106923 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    None
2021-01-27 19:06:44.295055 (Thread-1): Snowflake query id: 0199e53a-0505-fe9e-0000-44a9389c2d4e
2021-01-27 19:06:44.295637 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:06:44.296755 (Thread-1): finished collecting timing info
2021-01-27 19:06:44.298721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:06:44.582530 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 113, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 19:06:44.583366 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a7e2eb-a98e-4d35-8e01-f2f726b257f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca96f8748>]}
2021-01-27 19:06:44.585169 (Thread-1): 14:06:44 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.92s]
2021-01-27 19:06:44.585400 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:06:44.585631 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:06:44.587295 (Thread-1): 14:06:44 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:06:44.587717 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:06:44.587855 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:06:44.597649 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:06:44.598081 (Thread-1): finished collecting timing info
2021-01-27 19:06:44.615302 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:06:44.615571 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:06:44.615724 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:06:45.221143 (Thread-1): subprocess 7855 is still running
2021-01-27 19:06:49.239921 (Thread-1): SQL status: SUCCESS 1 in 4.62 seconds
2021-01-27 19:06:49.263088 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:06:49.263527 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:06:49.464069 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:06:49.483571 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:06:49.484144 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 19:06:49.889535 (Thread-1): SQL status: SUCCESS 3 in 0.40 seconds
2021-01-27 19:06:49.892952 (Thread-1): DEBUG: about to invoke drop statement for temp relation
2021-01-27 19:06:49.903869 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:06:49.904336 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 19:06:50.195456 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 19:06:50.203472 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:06:50.204025 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    None
2021-01-27 19:06:50.394963 (Thread-1): Snowflake query id: 0199e53a-05f1-d7ab-0000-44a9389c414a
2021-01-27 19:06:50.395161 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:06:50.395448 (Thread-1): finished collecting timing info
2021-01-27 19:06:50.396067 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:06:50.656680 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 0 unexpected 'None'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 113, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 0 unexpected 'None'.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 19:06:50.660985 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11a7e2eb-a98e-4d35-8e01-f2f726b257f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca979d908>]}
2021-01-27 19:06:50.668078 (Thread-1): 14:06:50 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 6.07s]
2021-01-27 19:06:50.668620 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:06:50.695594 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:06:50.695898 (MainThread): Using snowflake connection "master".
2021-01-27 19:06:50.695997 (MainThread): On master: BEGIN
2021-01-27 19:06:50.696102 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:06:51.307366 (MainThread): subprocess 7952 is still running
2021-01-27 19:06:54.955280 (MainThread): SQL status: SUCCESS 1 in 4.26 seconds
2021-01-27 19:06:54.956318 (MainThread): On master: COMMIT
2021-01-27 19:06:54.957379 (MainThread): Using snowflake connection "master".
2021-01-27 19:06:54.957815 (MainThread): On master: COMMIT
2021-01-27 19:06:55.240731 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 19:06:55.241136 (MainThread): On master: Close
2021-01-27 19:06:55.534016 (MainThread): 14:06:55 | 
2021-01-27 19:06:55.534306 (MainThread): 14:06:55 | Finished running 3 snowflake_timetravel_table models in 38.59s.
2021-01-27 19:06:55.534457 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:06:55.534546 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:06:55.550288 (MainThread): 
2021-01-27 19:06:55.550498 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 19:06:55.550633 (MainThread): 
2021-01-27 19:06:55.550789 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 19:06:55.550898 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 19:06:55.550992 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:06:55.551074 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 19:06:55.551166 (MainThread): 
2021-01-27 19:06:55.551269 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_no_change (models/snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 19:06:55.551361 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 19:06:55.551482 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:06:55.551577 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 19:06:55.551685 (MainThread): 
2021-01-27 19:06:55.551809 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_columns_renamed (models/snowflake_timetravel_table_integration_tests_columns_renamed.sql)
2021-01-27 19:06:55.551914 (MainThread):   001003 (42000): SQL compilation error:
2021-01-27 19:06:55.552009 (MainThread):   syntax error line 1 at position 0 unexpected 'None'.
2021-01-27 19:06:55.552104 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_columns_renamed.sql
2021-01-27 19:06:55.552227 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 19:06:55.552486 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca9d7fe48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca85f1358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ca85f1cf8>]}
2021-01-27 19:06:55.552768 (MainThread): Flushing usage events
2021-01-27 19:08:44.187594 (MainThread): Running with dbt=0.18.1
2021-01-27 19:08:44.638622 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:08:44.639514 (MainThread): Tracking: tracking
2021-01-27 19:08:44.639904 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68598d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68598d4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68598d518>]}
2021-01-27 19:08:44.682979 (MainThread): Partial parsing not enabled
2021-01-27 19:08:44.684065 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:08:44.686901 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:08:44.723708 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:08:44.725526 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:08:44.737791 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:08:44.740448 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:08:44.745931 (MainThread): Parsing macros/core.sql
2021-01-27 19:08:44.750489 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:08:44.752620 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:08:44.754478 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:08:44.756720 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:08:44.761214 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:08:44.772360 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:08:44.779864 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:08:44.786084 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:08:44.804878 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:08:44.806847 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:08:44.836499 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:08:44.844509 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:08:44.851073 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:08:44.853142 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:08:44.868011 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:08:44.893968 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:08:44.903488 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:08:44.905234 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:08:44.906239 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:08:44.908418 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:08:44.909504 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:08:44.911602 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:08:44.960656 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:08:44.991284 (MainThread): Partial parsing not enabled
2021-01-27 19:08:45.050655 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:08:45.077660 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:08:45.090613 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:08:45.332978 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:08:45.333615 (MainThread): 
2021-01-27 19:08:45.333949 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:08:45.338515 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:08:45.354253 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:08:45.354398 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:08:45.354482 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:08:46.097202 (ThreadPoolExecutor-0_0): subprocess 8376 is still running
2021-01-27 19:08:49.585763 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.23 seconds
2021-01-27 19:08:49.639768 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:08:49.938813 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:08:49.978831 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:08:49.979047 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:08:49.979195 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:08:50.612672 (ThreadPoolExecutor-1_0): subprocess 8478 is still running
2021-01-27 19:08:54.467220 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.49 seconds
2021-01-27 19:08:54.970942 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:08:55.297840 (MainThread): Using snowflake connection "master".
2021-01-27 19:08:55.298032 (MainThread): On master: BEGIN
2021-01-27 19:08:55.298136 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:08:55.929853 (MainThread): subprocess 8575 is still running
2021-01-27 19:08:59.525648 (MainThread): SQL status: SUCCESS 1 in 4.23 seconds
2021-01-27 19:08:59.526684 (MainThread): On master: COMMIT
2021-01-27 19:08:59.527694 (MainThread): Using snowflake connection "master".
2021-01-27 19:08:59.528128 (MainThread): On master: COMMIT
2021-01-27 19:08:59.947805 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-27 19:08:59.948715 (MainThread): On master: Close
2021-01-27 19:09:00.219365 (MainThread): 14:09:00 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:09:00.220457 (MainThread): 14:09:00 | 
2021-01-27 19:09:00.227439 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:09:00.238514 (Thread-1): 14:09:00 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:09:00.240562 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:00.241534 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:09:00.292247 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:09:00.292645 (Thread-1): finished collecting timing info
2021-01-27 19:09:00.344210 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:00.344387 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:09:00.344480 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:09:00.967890 (Thread-1): subprocess 8682 is still running
2021-01-27 19:09:05.204199 (Thread-1): SQL status: SUCCESS 1 in 4.86 seconds
2021-01-27 19:09:05.221088 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:05.221252 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:09:05.440234 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 19:09:05.445327 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:05.445510 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 19:09:05.647162 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:09:05.650891 (Thread-1): DEBUG: about to invoke drop statement for temp relation
2021-01-27 19:09:05.673597 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:05.673902 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 19:09:05.973970 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 19:09:05.978688 (Thread-1): DEBUG: invoked drop statement for temp relation
2021-01-27 19:09:06.013832 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:09:06.014925 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:06.015063 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 19:09:06.196235 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 19:09:06.196782 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:06.197134 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:09:07.764262 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-01-27 19:09:07.767704 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:09:07.768189 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:09:07.768458 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:09:07.942081 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 19:09:07.971056 (Thread-1): finished collecting timing info
2021-01-27 19:09:07.971462 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:09:08.274738 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e315f20-2970-4321-a056-f6907f44c86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb684198eb8>]}
2021-01-27 19:09:08.280086 (Thread-1): 14:09:08 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 8.03s]
2021-01-27 19:09:08.280774 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:09:08.281452 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:09:08.286829 (Thread-1): 14:09:08 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:09:08.288198 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:08.288676 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:09:08.312497 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:09:08.312954 (Thread-1): finished collecting timing info
2021-01-27 19:09:08.336279 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:08.336435 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:09:08.336538 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:09:08.971323 (Thread-1): subprocess 8790 is still running
2021-01-27 19:09:13.281170 (Thread-1): SQL status: SUCCESS 1 in 4.94 seconds
2021-01-27 19:09:13.298236 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:13.298725 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:09:13.499906 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:09:13.510940 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:13.511440 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 19:09:13.744731 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 19:09:13.750519 (Thread-1): DEBUG: about to invoke drop statement for temp relation
2021-01-27 19:09:13.756508 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:13.756749 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 19:09:14.002618 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 19:09:14.008565 (Thread-1): DEBUG: invoked drop statement for temp relation
2021-01-27 19:09:14.012954 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:09:14.019713 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:14.020382 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 19:09:14.284508 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 19:09:14.284672 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:14.284759 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:09:15.744644 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-01-27 19:09:15.748744 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:09:15.749339 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:09:15.749674 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:09:15.917339 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 19:09:15.921356 (Thread-1): finished collecting timing info
2021-01-27 19:09:15.921812 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:09:16.368641 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e315f20-2970-4321-a056-f6907f44c86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67f929320>]}
2021-01-27 19:09:16.371196 (Thread-1): 14:09:16 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 8.08s]
2021-01-27 19:09:16.371454 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:09:16.371732 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:09:16.374026 (Thread-1): 14:09:16 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:09:16.374781 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:16.374977 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:09:16.392400 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:09:16.392856 (Thread-1): finished collecting timing info
2021-01-27 19:09:16.421330 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:16.421543 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:09:16.421682 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:09:16.997753 (Thread-1): subprocess 8903 is still running
2021-01-27 19:09:20.719747 (Thread-1): SQL status: SUCCESS 1 in 4.30 seconds
2021-01-27 19:09:20.744786 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:20.745335 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:09:20.923697 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 19:09:20.930867 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:20.931126 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 19:09:21.140714 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 19:09:21.145003 (Thread-1): DEBUG: about to invoke drop statement for temp relation
2021-01-27 19:09:21.152724 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:21.153001 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 19:09:21.419741 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 19:09:21.426189 (Thread-1): DEBUG: invoked drop statement for temp relation
2021-01-27 19:09:21.429957 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:09:21.434426 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:21.435184 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 19:09:21.632038 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 19:09:21.632707 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:21.633135 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:09:23.483616 (Thread-1): SQL status: SUCCESS 1 in 1.85 seconds
2021-01-27 19:09:23.489180 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:09:23.490053 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:09:23.490546 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:09:23.715894 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 19:09:23.731855 (Thread-1): finished collecting timing info
2021-01-27 19:09:23.734049 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:09:24.215361 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e315f20-2970-4321-a056-f6907f44c86b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67f8f2c18>]}
2021-01-27 19:09:24.223692 (Thread-1): 14:09:24 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.84s]
2021-01-27 19:09:24.224609 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:09:24.249873 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:09:24.250638 (MainThread): Using snowflake connection "master".
2021-01-27 19:09:24.250955 (MainThread): On master: BEGIN
2021-01-27 19:09:24.251261 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:09:24.887887 (MainThread): subprocess 9004 is still running
2021-01-27 19:09:28.476853 (MainThread): SQL status: SUCCESS 1 in 4.23 seconds
2021-01-27 19:09:28.477933 (MainThread): On master: COMMIT
2021-01-27 19:09:28.479074 (MainThread): Using snowflake connection "master".
2021-01-27 19:09:28.482033 (MainThread): On master: COMMIT
2021-01-27 19:09:28.801661 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 19:09:28.802764 (MainThread): On master: Close
2021-01-27 19:09:29.079732 (MainThread): 14:09:29 | 
2021-01-27 19:09:29.080509 (MainThread): 14:09:29 | Finished running 3 snowflake_timetravel_table models in 43.75s.
2021-01-27 19:09:29.080922 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:09:29.081188 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:09:29.101758 (MainThread): 
2021-01-27 19:09:29.101951 (MainThread): Completed successfully
2021-01-27 19:09:29.102107 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 19:09:29.102412 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb68cd5f630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67e0ca208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb67e0ca080>]}
2021-01-27 19:09:29.102706 (MainThread): Flushing usage events
2021-01-27 19:11:36.338157 (MainThread): Running with dbt=0.18.1
2021-01-27 19:11:36.801907 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:11:36.802938 (MainThread): Tracking: tracking
2021-01-27 19:11:36.803337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16350e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16350e518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16350e4e0>]}
2021-01-27 19:11:36.847222 (MainThread): Partial parsing not enabled
2021-01-27 19:11:36.848376 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:11:36.851452 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:11:36.887581 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:11:36.889434 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:11:36.900711 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:11:36.903322 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:11:36.908798 (MainThread): Parsing macros/core.sql
2021-01-27 19:11:36.913385 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:11:36.915581 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:11:36.917487 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:11:36.920003 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:11:36.924537 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:11:36.935690 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:11:36.943414 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:11:36.949974 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:11:36.970526 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:11:36.972716 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:11:37.014195 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:11:37.023391 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:11:37.033957 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:11:37.036620 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:11:37.054770 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:11:37.082666 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:11:37.097185 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:11:37.099381 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:11:37.100668 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:11:37.103776 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:11:37.105554 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:11:37.107712 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:11:37.162157 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:11:37.187029 (MainThread): Partial parsing not enabled
2021-01-27 19:11:37.238113 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:11:37.267958 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:37.283156 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:11:37.696232 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:11:37.697124 (MainThread): 
2021-01-27 19:11:37.697517 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:11:37.702990 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:11:37.745225 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:11:37.745385 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:11:37.745489 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:11:38.540450 (ThreadPoolExecutor-0_0): subprocess 9330 is still running
2021-01-27 19:11:42.823455 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.08 seconds
2021-01-27 19:11:42.835169 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:11:43.145006 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:11:43.181093 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:11:43.181370 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:11:43.181594 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:11:43.786680 (ThreadPoolExecutor-1_0): subprocess 9446 is still running
2021-01-27 19:11:47.838511 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.66 seconds
2021-01-27 19:11:48.286992 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:11:48.641065 (MainThread): Using snowflake connection "master".
2021-01-27 19:11:48.641279 (MainThread): On master: BEGIN
2021-01-27 19:11:48.641405 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:11:49.373482 (MainThread): subprocess 9543 is still running
2021-01-27 19:11:53.161535 (MainThread): SQL status: SUCCESS 1 in 4.52 seconds
2021-01-27 19:11:53.162966 (MainThread): On master: COMMIT
2021-01-27 19:11:53.164052 (MainThread): Using snowflake connection "master".
2021-01-27 19:11:53.164521 (MainThread): On master: COMMIT
2021-01-27 19:11:53.445451 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 19:11:53.446266 (MainThread): On master: Close
2021-01-27 19:11:53.891694 (MainThread): 14:11:53 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:11:53.892608 (MainThread): 14:11:53 | 
2021-01-27 19:11:53.896788 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:11:53.901109 (Thread-1): 14:11:53 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:11:53.901840 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:53.902165 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:11:53.933497 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:11:53.933874 (Thread-1): finished collecting timing info
2021-01-27 19:11:53.982748 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:53.982952 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:11:53.983069 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:11:54.665651 (Thread-1): subprocess 9645 is still running
2021-01-27 19:11:58.545819 (Thread-1): SQL status: SUCCESS 1 in 4.56 seconds
2021-01-27 19:11:58.608132 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:58.608620 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:11:58.825576 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 19:11:58.849509 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:58.850108 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 19:11:59.052641 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:11:59.075165 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:59.075417 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 19:11:59.312995 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 19:11:59.357350 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:11:59.359036 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:59.359289 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 19:11:59.579734 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 19:11:59.580451 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:11:59.580868 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:12:01.195217 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-01-27 19:12:01.200670 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:12:01.201474 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:12:01.201909 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:12:01.401454 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 19:12:01.445304 (Thread-1): finished collecting timing info
2021-01-27 19:12:01.445738 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:12:01.713620 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb651cc-acb1-467d-8bf4-26e44e1c9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa161a9a400>]}
2021-01-27 19:12:01.716880 (Thread-1): 14:12:01 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.81s]
2021-01-27 19:12:01.717228 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:12:01.717607 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:12:01.720444 (Thread-1): 14:12:01 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:12:01.721030 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:01.721292 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:12:01.733925 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:12:01.734351 (Thread-1): finished collecting timing info
2021-01-27 19:12:01.750774 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:01.750989 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:12:01.751121 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:12:02.440286 (Thread-1): subprocess 9743 is still running
2021-01-27 19:12:06.169765 (Thread-1): SQL status: SUCCESS 1 in 4.42 seconds
2021-01-27 19:12:06.193599 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:06.194303 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:12:06.406490 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 19:12:06.415924 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:06.416182 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 19:12:06.658612 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 19:12:06.678453 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:06.679074 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 19:12:07.347314 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-01-27 19:12:07.356375 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:12:07.360486 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:07.361055 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 19:12:07.547412 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 19:12:07.548054 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:07.548711 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:12:08.925252 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-01-27 19:12:08.931838 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:12:08.932790 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:12:08.933348 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:12:09.340696 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-27 19:12:09.361388 (Thread-1): finished collecting timing info
2021-01-27 19:12:09.362487 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:12:09.630884 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb651cc-acb1-467d-8bf4-26e44e1c9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1614d8198>]}
2021-01-27 19:12:09.636184 (Thread-1): 14:12:09 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 7.91s]
2021-01-27 19:12:09.636670 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:12:09.637158 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:12:09.640595 (Thread-1): 14:12:09 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:12:09.641409 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:09.641642 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:12:09.656389 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:12:09.656786 (Thread-1): finished collecting timing info
2021-01-27 19:12:09.672149 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:09.672419 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:12:09.672544 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:12:10.237841 (Thread-1): subprocess 9846 is still running
2021-01-27 19:12:14.230783 (Thread-1): SQL status: SUCCESS 1 in 4.56 seconds
2021-01-27 19:12:14.255582 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:14.256218 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:12:14.475686 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 19:12:14.494944 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:14.495735 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 19:12:14.766867 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-27 19:12:14.806904 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:14.807832 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 19:12:15.082080 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 19:12:15.084963 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:12:15.086555 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:15.086751 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 19:12:15.368947 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 19:12:15.369591 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:15.370008 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:12:16.907271 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-01-27 19:12:16.914307 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:12:16.915540 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:12:16.915955 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:12:17.071780 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-27 19:12:17.089352 (Thread-1): finished collecting timing info
2021-01-27 19:12:17.091375 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:12:17.344585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb651cc-acb1-467d-8bf4-26e44e1c9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1614d8cc0>]}
2021-01-27 19:12:17.346249 (Thread-1): 14:12:17 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.70s]
2021-01-27 19:12:17.346551 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:12:17.410125 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:12:17.410423 (MainThread): Using snowflake connection "master".
2021-01-27 19:12:17.410508 (MainThread): On master: BEGIN
2021-01-27 19:12:17.410588 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:12:18.050599 (MainThread): subprocess 9967 is still running
2021-01-27 19:12:21.566161 (MainThread): SQL status: SUCCESS 1 in 4.16 seconds
2021-01-27 19:12:21.566518 (MainThread): On master: COMMIT
2021-01-27 19:12:21.566825 (MainThread): Using snowflake connection "master".
2021-01-27 19:12:21.566944 (MainThread): On master: COMMIT
2021-01-27 19:12:21.852868 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 19:12:21.853778 (MainThread): On master: Close
2021-01-27 19:12:22.150466 (MainThread): 14:12:22 | 
2021-01-27 19:12:22.151482 (MainThread): 14:12:22 | Finished running 3 snowflake_timetravel_table models in 44.45s.
2021-01-27 19:12:22.152213 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:12:22.152677 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:12:22.226142 (MainThread): 
2021-01-27 19:12:22.226435 (MainThread): Completed successfully
2021-01-27 19:12:22.226653 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 19:12:22.227039 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16043ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16043e748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16043e4a8>]}
2021-01-27 19:12:22.227433 (MainThread): Flushing usage events
2021-01-27 19:14:17.472375 (MainThread): Running with dbt=0.18.1
2021-01-27 19:14:17.949445 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:14:17.950306 (MainThread): Tracking: tracking
2021-01-27 19:14:17.950646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923cd0f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923cd0f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923cd0f588>]}
2021-01-27 19:14:18.002134 (MainThread): Partial parsing not enabled
2021-01-27 19:14:18.003177 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:14:18.006116 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:14:18.041374 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:14:18.043624 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:14:18.054842 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:14:18.057415 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:14:18.064533 (MainThread): Parsing macros/core.sql
2021-01-27 19:14:18.075112 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:14:18.079834 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:14:18.083432 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:14:18.085844 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:14:18.090504 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:14:18.101797 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:14:18.109685 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:14:18.116183 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:14:18.137123 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:14:18.139333 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:14:18.174406 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:14:18.182647 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:14:18.190388 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:14:18.192756 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:14:18.212396 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:14:18.238292 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:14:18.249164 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:14:18.251155 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:14:18.252271 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:14:18.254748 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:14:18.256128 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:14:18.258150 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:14:18.309807 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:14:18.327661 (MainThread): Partial parsing not enabled
2021-01-27 19:14:18.384236 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:14:18.412588 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:14:18.425524 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:14:18.677694 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:14:18.678439 (MainThread): 
2021-01-27 19:14:18.678792 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:14:18.683830 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:14:18.700352 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:14:18.700503 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:14:18.700589 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:14:19.429218 (ThreadPoolExecutor-0_0): subprocess 10202 is still running
2021-01-27 19:14:23.020797 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.32 seconds
2021-01-27 19:14:23.070513 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:14:23.342029 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:14:23.350771 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:14:23.351054 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:14:23.351149 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:14:23.984169 (ThreadPoolExecutor-1_0): subprocess 10303 is still running
2021-01-27 19:14:27.389089 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 462 in 4.04 seconds
2021-01-27 19:14:27.929943 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:14:28.203790 (MainThread): Using snowflake connection "master".
2021-01-27 19:14:28.204014 (MainThread): On master: BEGIN
2021-01-27 19:14:28.204157 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:14:28.775499 (MainThread): subprocess 10401 is still running
2021-01-27 19:14:32.575943 (MainThread): SQL status: SUCCESS 1 in 4.37 seconds
2021-01-27 19:14:32.576270 (MainThread): On master: COMMIT
2021-01-27 19:14:32.576603 (MainThread): Using snowflake connection "master".
2021-01-27 19:14:32.576731 (MainThread): On master: COMMIT
2021-01-27 19:14:32.860474 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 19:14:32.860713 (MainThread): On master: Close
2021-01-27 19:14:33.122201 (MainThread): 14:14:33 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:14:33.122926 (MainThread): 14:14:33 | 
2021-01-27 19:14:33.127739 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:14:33.136109 (Thread-1): 14:14:33 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:14:33.137706 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:14:33.138310 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:14:33.179460 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:14:33.179836 (Thread-1): finished collecting timing info
2021-01-27 19:14:33.225217 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:14:33.226067 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:14:33.226177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 19:14:33.226274 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:14:33.846295 (Thread-1): subprocess 10508 is still running
2021-01-27 19:14:37.286835 (Thread-1): SQL status: SUCCESS 1 in 4.06 seconds
2021-01-27 19:14:37.287131 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:14:37.287332 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:14:38.507726 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-01-27 19:14:38.515138 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:14:38.515979 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:14:38.516304 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:14:38.855252 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 19:14:38.874031 (Thread-1): finished collecting timing info
2021-01-27 19:14:38.874415 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:14:39.254992 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42642d2-841a-4079-8565-5093ab737a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9236cf3198>]}
2021-01-27 19:14:39.261465 (Thread-1): 14:14:39 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 6.12s]
2021-01-27 19:14:39.262162 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:14:39.263213 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:14:39.269454 (Thread-1): 14:14:39 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:14:39.271012 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:14:39.271646 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:14:39.293765 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:14:39.294315 (Thread-1): finished collecting timing info
2021-01-27 19:14:39.305667 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:14:39.306527 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:14:39.306633 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 19:14:39.306718 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:14:39.929060 (Thread-1): subprocess 10622 is still running
2021-01-27 19:14:43.485752 (Thread-1): SQL status: SUCCESS 1 in 4.18 seconds
2021-01-27 19:14:43.486622 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:14:43.487014 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:14:44.697309 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-01-27 19:14:44.704494 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:14:44.705288 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:14:44.705656 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:14:44.884142 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 19:14:44.897006 (Thread-1): finished collecting timing info
2021-01-27 19:14:44.898305 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:14:45.186054 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42642d2-841a-4079-8565-5093ab737a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9236cb7eb8>]}
2021-01-27 19:14:45.191706 (Thread-1): 14:14:45 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 5.91s]
2021-01-27 19:14:45.192345 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:14:45.193003 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:14:45.197774 (Thread-1): 14:14:45 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:14:45.199824 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:14:45.200351 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:14:45.223336 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:14:45.223995 (Thread-1): finished collecting timing info
2021-01-27 19:14:45.235979 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:14:45.236838 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:14:45.236940 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 19:14:45.237025 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:14:46.186066 (Thread-1): subprocess 11846 is still running
2021-01-27 19:14:49.713094 (Thread-1): SQL status: SUCCESS 1 in 4.48 seconds
2021-01-27 19:14:49.713627 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:14:49.714041 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:14:50.893255 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-27 19:14:50.896249 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:14:50.896595 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:14:50.896737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:14:51.048551 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-27 19:14:51.061609 (Thread-1): finished collecting timing info
2021-01-27 19:14:51.063113 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:14:51.353945 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f42642d2-841a-4079-8565-5093ab737a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9236c8ef98>]}
2021-01-27 19:14:51.361124 (Thread-1): 14:14:51 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 6.15s]
2021-01-27 19:14:51.361851 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:14:51.396815 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:14:51.398197 (MainThread): Using snowflake connection "master".
2021-01-27 19:14:51.399221 (MainThread): On master: BEGIN
2021-01-27 19:14:51.399897 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:14:52.072800 (MainThread): subprocess 12113 is still running
2021-01-27 19:14:55.770806 (MainThread): SQL status: SUCCESS 1 in 4.37 seconds
2021-01-27 19:14:55.771418 (MainThread): On master: COMMIT
2021-01-27 19:14:55.771838 (MainThread): Using snowflake connection "master".
2021-01-27 19:14:55.771984 (MainThread): On master: COMMIT
2021-01-27 19:14:56.038004 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 19:14:56.038612 (MainThread): On master: Close
2021-01-27 19:14:56.287201 (MainThread): 14:14:56 | 
2021-01-27 19:14:56.287978 (MainThread): 14:14:56 | Finished running 3 snowflake_timetravel_table models in 37.61s.
2021-01-27 19:14:56.288486 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:14:56.288878 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:14:56.313528 (MainThread): 
2021-01-27 19:14:56.313772 (MainThread): Completed successfully
2021-01-27 19:14:56.313964 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 19:14:56.314373 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923727ba20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f923727b2e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9235442cc0>]}
2021-01-27 19:14:56.314793 (MainThread): Flushing usage events
2021-01-27 19:16:54.496437 (MainThread): Running with dbt=0.18.1
2021-01-27 19:16:54.959246 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:16:54.960113 (MainThread): Tracking: tracking
2021-01-27 19:16:54.960446 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e48c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e48c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9e48c588>]}
2021-01-27 19:16:55.004368 (MainThread): Partial parsing not enabled
2021-01-27 19:16:55.005824 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:16:55.008507 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:16:55.042357 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:16:55.044092 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:16:55.054251 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:16:55.056386 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:16:55.061258 (MainThread): Parsing macros/core.sql
2021-01-27 19:16:55.065226 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:16:55.067116 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:16:55.068757 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:16:55.070866 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:16:55.074882 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:16:55.085193 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:16:55.092127 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:16:55.097531 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:16:55.115758 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:16:55.117822 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:16:55.150278 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:16:55.157665 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:16:55.164497 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:16:55.166557 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:16:55.181392 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:16:55.204042 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:16:55.217429 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:16:55.220549 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:16:55.221752 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:16:55.224337 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:16:55.225598 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:16:55.227760 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:16:55.277208 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:16:55.293498 (MainThread): Partial parsing not enabled
2021-01-27 19:16:55.342135 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:16:55.368380 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:16:55.381365 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:16:55.619267 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:16:55.619971 (MainThread): 
2021-01-27 19:16:55.620325 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:16:55.624854 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:16:55.640242 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:16:55.640392 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:16:55.640478 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:16:56.480883 (ThreadPoolExecutor-0_0): subprocess 13734 is still running
2021-01-27 19:17:00.472793 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.83 seconds
2021-01-27 19:17:00.484481 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:17:00.773538 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:17:00.797213 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:17:00.797452 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:17:00.797576 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:17:01.440621 (ThreadPoolExecutor-1_0): subprocess 13843 is still running
2021-01-27 19:17:05.866116 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 5.07 seconds
2021-01-27 19:17:06.452409 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:17:06.891681 (MainThread): Using snowflake connection "master".
2021-01-27 19:17:06.891917 (MainThread): On master: BEGIN
2021-01-27 19:17:06.892078 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:17:07.579240 (MainThread): subprocess 13956 is still running
2021-01-27 19:17:12.774601 (MainThread): SQL status: SUCCESS 1 in 5.88 seconds
2021-01-27 19:17:12.775370 (MainThread): On master: COMMIT
2021-01-27 19:17:12.776191 (MainThread): Using snowflake connection "master".
2021-01-27 19:17:12.776497 (MainThread): On master: COMMIT
2021-01-27 19:17:14.004522 (MainThread): SQL status: SUCCESS 1 in 1.23 seconds
2021-01-27 19:17:14.005194 (MainThread): On master: Close
2021-01-27 19:17:14.279448 (MainThread): 14:17:14 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:17:14.280077 (MainThread): 14:17:14 | 
2021-01-27 19:17:14.283191 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:17:14.286681 (Thread-1): 14:17:14 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:17:14.287240 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:14.287483 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:17:14.309759 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:17:14.310190 (Thread-1): finished collecting timing info
2021-01-27 19:17:14.367303 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:14.367465 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:17:14.367577 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:17:15.370660 (Thread-1): subprocess 14057 is still running
2021-01-27 19:17:20.417850 (Thread-1): SQL status: SUCCESS 1 in 6.05 seconds
2021-01-27 19:17:20.466470 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:20.466643 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:17:20.821810 (Thread-1): SQL status: SUCCESS 3 in 0.35 seconds
2021-01-27 19:17:20.839886 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:20.840461 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 19:17:21.182287 (Thread-1): SQL status: SUCCESS 3 in 0.34 seconds
2021-01-27 19:17:21.219240 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:21.219463 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 19:17:21.475414 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 19:17:21.505419 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:17:21.506354 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:21.506481 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 19:17:21.737071 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 19:17:21.737447 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:21.737687 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:17:24.049040 (Thread-1): SQL status: SUCCESS 1 in 2.31 seconds
2021-01-27 19:17:24.054567 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:17:24.055372 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:17:24.055805 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 19:17:24.493913 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-27 19:17:24.511160 (Thread-1): finished collecting timing info
2021-01-27 19:17:24.511633 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:17:24.872973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0f5191-1603-471e-b4f3-7a777b28bc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9ca185f8>]}
2021-01-27 19:17:24.881266 (Thread-1): 14:17:24 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 10.58s]
2021-01-27 19:17:24.882158 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:17:24.883074 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:17:24.886571 (Thread-1): 14:17:24 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:17:24.887976 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:24.888228 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:17:24.902815 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:17:24.903205 (Thread-1): finished collecting timing info
2021-01-27 19:17:24.920536 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:24.920700 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:17:24.920799 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:17:25.583465 (Thread-1): subprocess 14159 is still running
2021-01-27 19:17:29.304828 (Thread-1): SQL status: SUCCESS 1 in 4.38 seconds
2021-01-27 19:17:29.310989 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:29.311236 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:17:29.519441 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 19:17:29.532433 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:29.532860 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 19:17:29.759394 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 19:17:29.764545 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:29.764732 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 19:17:30.055898 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 19:17:30.061953 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:17:30.064942 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:30.065310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 19:17:30.421857 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 19:17:30.422434 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:30.422789 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change  as
      (-- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:17:31.880345 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-01-27 19:17:31.884490 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:17:31.884874 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:17:31.885068 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 19:17:32.218310 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 19:17:32.235484 (Thread-1): finished collecting timing info
2021-01-27 19:17:32.237374 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:17:32.533491 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0f5191-1603-471e-b4f3-7a777b28bc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9c49dbe0>]}
2021-01-27 19:17:32.540249 (Thread-1): 14:17:32 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 1 in 7.64s]
2021-01-27 19:17:32.540818 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:17:32.541453 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:17:32.544625 (Thread-1): 14:17:32 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:17:32.545729 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:32.545999 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:17:32.559407 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:17:32.559797 (Thread-1): finished collecting timing info
2021-01-27 19:17:32.578999 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:32.579168 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:17:32.579263 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:17:33.442867 (Thread-1): subprocess 14265 is still running
2021-01-27 19:17:37.225661 (Thread-1): SQL status: SUCCESS 1 in 4.65 seconds
2021-01-27 19:17:37.244616 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:37.245104 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:17:37.463848 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 19:17:37.483693 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:37.484367 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 19:17:37.875358 (Thread-1): SQL status: SUCCESS 3 in 0.39 seconds
2021-01-27 19:17:37.882585 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:37.882812 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 19:17:38.164522 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 19:17:38.166199 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:17:38.167240 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:38.167360 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 19:17:39.112469 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-27 19:17:39.112695 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:39.112825 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 19:17:40.472595 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-27 19:17:40.478277 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:17:40.479098 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:17:40.479857 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 19:17:40.658600 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 19:17:40.674633 (Thread-1): finished collecting timing info
2021-01-27 19:17:40.676598 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:17:40.984411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0f5191-1603-471e-b4f3-7a777b28bc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9c40f470>]}
2021-01-27 19:17:40.989685 (Thread-1): 14:17:40 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.44s]
2021-01-27 19:17:40.990297 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:17:40.995007 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:17:40.995483 (MainThread): Using snowflake connection "master".
2021-01-27 19:17:40.995659 (MainThread): On master: BEGIN
2021-01-27 19:17:40.995826 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:17:41.600966 (MainThread): subprocess 14362 is still running
2021-01-27 19:17:45.533957 (MainThread): SQL status: SUCCESS 1 in 4.54 seconds
2021-01-27 19:17:45.535112 (MainThread): On master: COMMIT
2021-01-27 19:17:45.536293 (MainThread): Using snowflake connection "master".
2021-01-27 19:17:45.536768 (MainThread): On master: COMMIT
2021-01-27 19:17:46.171300 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-27 19:17:46.171556 (MainThread): On master: Close
2021-01-27 19:17:46.459556 (MainThread): 14:17:46 | 
2021-01-27 19:17:46.459918 (MainThread): 14:17:46 | Finished running 3 snowflake_timetravel_table models in 50.84s.
2021-01-27 19:17:46.460115 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:17:46.460259 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:17:46.487631 (MainThread): 
2021-01-27 19:17:46.487925 (MainThread): Completed successfully
2021-01-27 19:17:46.488134 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 19:17:46.488475 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9c3bfac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9c3bf5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9c3bf898>]}
2021-01-27 19:17:46.488850 (MainThread): Flushing usage events
2021-01-27 19:19:13.112801 (MainThread): Running with dbt=0.18.1
2021-01-27 19:19:13.570531 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:19:13.571409 (MainThread): Tracking: tracking
2021-01-27 19:19:13.571785 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb907dce8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb907dce4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb907dce518>]}
2021-01-27 19:19:13.614512 (MainThread): Partial parsing not enabled
2021-01-27 19:19:13.615639 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:19:13.618509 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:19:13.653036 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:19:13.654751 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:19:13.664715 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:19:13.666939 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:19:13.671833 (MainThread): Parsing macros/core.sql
2021-01-27 19:19:13.675791 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:19:13.677706 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:19:13.679379 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:19:13.681479 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:19:13.685797 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:19:13.696154 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:19:13.702952 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:19:13.708341 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:19:13.728638 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:19:13.731026 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:19:13.772425 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:19:13.779779 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:19:13.786570 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:19:13.788639 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:19:13.803255 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:19:13.831256 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:19:13.841420 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:19:13.843389 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:19:13.844498 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:19:13.846732 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:19:13.847895 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:19:13.849782 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:19:13.894475 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:19:13.909756 (MainThread): Partial parsing not enabled
2021-01-27 19:19:13.951686 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:19:13.975312 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:19:13.988473 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:19:14.227904 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:19:14.228606 (MainThread): 
2021-01-27 19:19:14.228954 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:19:14.233661 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:19:14.248493 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:19:14.248638 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:19:14.248718 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:19:14.989056 (ThreadPoolExecutor-0_0): subprocess 15247 is still running
2021-01-27 19:19:18.569255 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.32 seconds
2021-01-27 19:19:18.626797 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:19:18.968541 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:19:18.999268 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:19:18.999508 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:19:18.999669 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:19:19.625594 (ThreadPoolExecutor-1_0): subprocess 15354 is still running
2021-01-27 19:19:23.618139 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.62 seconds
2021-01-27 19:19:24.112496 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:19:24.392914 (MainThread): Using snowflake connection "master".
2021-01-27 19:19:24.393216 (MainThread): On master: BEGIN
2021-01-27 19:19:24.393409 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:19:25.004284 (MainThread): subprocess 15452 is still running
2021-01-27 19:19:28.741317 (MainThread): SQL status: SUCCESS 1 in 4.35 seconds
2021-01-27 19:19:28.742367 (MainThread): On master: COMMIT
2021-01-27 19:19:28.743451 (MainThread): Using snowflake connection "master".
2021-01-27 19:19:28.743951 (MainThread): On master: COMMIT
2021-01-27 19:19:29.037839 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 19:19:29.038992 (MainThread): On master: Close
2021-01-27 19:19:29.318822 (MainThread): 14:19:29 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:19:29.319904 (MainThread): 14:19:29 | 
2021-01-27 19:19:29.326798 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:19:29.337861 (Thread-1): 14:19:29 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:19:29.339843 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:19:29.340699 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:19:29.376478 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:19:29.376851 (Thread-1): finished collecting timing info
2021-01-27 19:19:29.427301 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:19:29.427509 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:19:29.427610 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:19:30.018280 (Thread-1): subprocess 15555 is still running
2021-01-27 19:19:34.289534 (Thread-1): SQL status: SUCCESS 1 in 4.86 seconds
2021-01-27 19:19:34.343381 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:19:34.343933 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:19:34.599123 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-27 19:19:34.610205 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:19:34.610739 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 19:19:34.809579 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:19:34.813246 (Thread-1): finished collecting timing info
2021-01-27 19:19:34.814611 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:19:35.259517 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 118, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 19:19:35.264384 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e61336-64bf-4c18-b9c4-c94e825d45ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9063646d8>]}
2021-01-27 19:19:35.270631 (Thread-1): 14:19:35 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.93s]
2021-01-27 19:19:35.271206 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:19:35.271781 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:19:35.275618 (Thread-1): 14:19:35 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:19:35.277553 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:19:35.277966 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:19:35.293195 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:19:35.293648 (Thread-1): finished collecting timing info
2021-01-27 19:19:35.307803 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:19:35.307960 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:19:35.308053 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:19:35.939702 (Thread-1): subprocess 15651 is still running
2021-01-27 19:19:39.725074 (Thread-1): SQL status: SUCCESS 1 in 4.42 seconds
2021-01-27 19:19:39.750022 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:19:39.750729 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:19:40.016124 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-27 19:19:40.023202 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:19:40.023403 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 19:19:40.210237 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 19:19:40.211870 (Thread-1): finished collecting timing info
2021-01-27 19:19:40.212425 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:19:40.497425 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 118, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 19:19:40.498448 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e61336-64bf-4c18-b9c4-c94e825d45ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb905ddc1d0>]}
2021-01-27 19:19:40.501425 (Thread-1): 14:19:40 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.22s]
2021-01-27 19:19:40.501713 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:19:40.502001 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:19:40.504331 (Thread-1): 14:19:40 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:19:40.505183 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:19:40.505383 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:19:40.519299 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:19:40.519695 (Thread-1): finished collecting timing info
2021-01-27 19:19:40.536970 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:19:40.537157 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:19:40.537261 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:19:41.194318 (Thread-1): subprocess 15756 is still running
2021-01-27 19:19:45.767313 (Thread-1): SQL status: SUCCESS 1 in 5.23 seconds
2021-01-27 19:19:45.788080 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:19:45.788443 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:19:45.991806 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:19:46.010667 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:19:46.011095 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 19:19:46.209910 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:19:46.215124 (Thread-1): finished collecting timing info
2021-01-27 19:19:46.217121 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:19:46.774712 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 118, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 19:19:46.778006 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e61336-64bf-4c18-b9c4-c94e825d45ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb905d78f28>]}
2021-01-27 19:19:46.787746 (Thread-1): 14:19:46 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 6.27s]
2021-01-27 19:19:46.788689 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:19:46.805175 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:19:46.806450 (MainThread): Using snowflake connection "master".
2021-01-27 19:19:46.806925 (MainThread): On master: BEGIN
2021-01-27 19:19:46.807378 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:19:47.412985 (MainThread): subprocess 15854 is still running
2021-01-27 19:19:51.590584 (MainThread): SQL status: SUCCESS 1 in 4.78 seconds
2021-01-27 19:19:51.591701 (MainThread): On master: COMMIT
2021-01-27 19:19:51.592762 (MainThread): Using snowflake connection "master".
2021-01-27 19:19:51.593188 (MainThread): On master: COMMIT
2021-01-27 19:19:51.989695 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-27 19:19:51.990653 (MainThread): On master: Close
2021-01-27 19:19:52.312787 (MainThread): 14:19:52 | 
2021-01-27 19:19:52.313699 (MainThread): 14:19:52 | Finished running 3 snowflake_timetravel_table models in 38.08s.
2021-01-27 19:19:52.314312 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:19:52.314752 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:19:52.339388 (MainThread): 
2021-01-27 19:19:52.339614 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 19:19:52.339751 (MainThread): 
2021-01-27 19:19:52.339882 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 19:19:52.339991 (MainThread):   'relation_columns_different' is undefined
2021-01-27 19:19:52.340113 (MainThread): 
2021-01-27 19:19:52.340250 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 19:19:52.340379 (MainThread):   'relation_columns_different' is undefined
2021-01-27 19:19:52.340501 (MainThread): 
2021-01-27 19:19:52.340631 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 19:19:52.340765 (MainThread):   'relation_columns_different' is undefined
2021-01-27 19:19:52.340911 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 19:19:52.341225 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb905d80320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb90eb07978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb906364550>]}
2021-01-27 19:19:52.341530 (MainThread): Flushing usage events
2021-01-27 19:25:02.208877 (MainThread): Running with dbt=0.18.1
2021-01-27 19:25:02.670168 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 19:25:02.671059 (MainThread): Tracking: tracking
2021-01-27 19:25:02.671406 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f4ece8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f4ece518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5f4ece550>]}
2021-01-27 19:25:02.718601 (MainThread): Partial parsing not enabled
2021-01-27 19:25:02.719698 (MainThread): Parsing macros/catalog.sql
2021-01-27 19:25:02.722684 (MainThread): Parsing macros/adapters.sql
2021-01-27 19:25:02.756455 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 19:25:02.758198 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 19:25:02.768273 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 19:25:02.770415 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 19:25:02.775287 (MainThread): Parsing macros/core.sql
2021-01-27 19:25:02.779216 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 19:25:02.781073 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 19:25:02.782727 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 19:25:02.784845 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 19:25:02.789048 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 19:25:02.799170 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 19:25:02.805881 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 19:25:02.811290 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 19:25:02.829427 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 19:25:02.831366 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 19:25:02.860889 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 19:25:02.867821 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 19:25:02.874109 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 19:25:02.876152 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 19:25:02.894346 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 19:25:02.917925 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 19:25:02.927552 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 19:25:02.929320 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 19:25:02.930337 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 19:25:02.932492 (MainThread): Parsing macros/etc/query.sql
2021-01-27 19:25:02.933605 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 19:25:02.935421 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 19:25:02.981177 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 19:25:02.997124 (MainThread): Partial parsing not enabled
2021-01-27 19:25:03.045736 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:25:03.075647 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:25:03.089757 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:25:03.333786 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 19:25:03.334469 (MainThread): 
2021-01-27 19:25:03.334805 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:25:03.339503 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 19:25:03.355212 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 19:25:03.355371 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 19:25:03.355455 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 19:25:04.232514 (ThreadPoolExecutor-0_0): subprocess 17394 is still running
2021-01-27 19:25:08.016755 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.66 seconds
2021-01-27 19:25:08.026606 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 19:25:08.402426 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:25:08.417173 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 19:25:08.417376 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 19:25:08.417493 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 19:25:09.088267 (ThreadPoolExecutor-1_0): subprocess 17510 is still running
2021-01-27 19:25:12.950101 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 4.53 seconds
2021-01-27 19:25:13.471852 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 19:25:13.767594 (MainThread): Using snowflake connection "master".
2021-01-27 19:25:13.768231 (MainThread): On master: BEGIN
2021-01-27 19:25:13.768693 (MainThread): Opening a new connection, currently in state init
2021-01-27 19:25:15.070076 (MainThread): subprocess 17615 is still running
2021-01-27 19:25:18.837886 (MainThread): SQL status: SUCCESS 1 in 5.07 seconds
2021-01-27 19:25:18.839027 (MainThread): On master: COMMIT
2021-01-27 19:25:18.840142 (MainThread): Using snowflake connection "master".
2021-01-27 19:25:18.841068 (MainThread): On master: COMMIT
2021-01-27 19:25:19.139681 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 19:25:19.140624 (MainThread): On master: Close
2021-01-27 19:25:19.406578 (MainThread): 14:25:19 | Concurrency: 1 threads (target='snowflake')
2021-01-27 19:25:19.406845 (MainThread): 14:25:19 | 
2021-01-27 19:25:19.408478 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:25:19.410536 (Thread-1): 14:25:19 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 19:25:19.410960 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:25:19.411130 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:25:19.432098 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 19:25:19.432482 (Thread-1): finished collecting timing info
2021-01-27 19:25:19.495200 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:25:19.495359 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:25:19.495495 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:25:20.112797 (Thread-1): subprocess 17722 is still running
2021-01-27 19:25:24.010410 (Thread-1): SQL status: SUCCESS 1 in 4.51 seconds
2021-01-27 19:25:24.057130 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:25:24.057447 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:25:24.262364 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:25:24.279733 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 19:25:24.280270 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 19:25:24.765349 (Thread-1): SQL status: SUCCESS 3 in 0.48 seconds
2021-01-27 19:25:24.769331 (Thread-1): finished collecting timing info
2021-01-27 19:25:24.770946 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 19:25:25.025171 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 118, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 19:25:25.026740 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c7b116-d244-4d76-97dc-962d58651b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5ef4920b8>]}
2021-01-27 19:25:25.028524 (Thread-1): 14:25:25 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.62s]
2021-01-27 19:25:25.028707 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 19:25:25.028885 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:25:25.030017 (Thread-1): 14:25:25 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 19:25:25.030421 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:25:25.030560 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:25:25.039550 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 19:25:25.039937 (Thread-1): finished collecting timing info
2021-01-27 19:25:25.053695 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:25:25.053854 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:25:25.053946 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:25:25.705624 (Thread-1): subprocess 17829 is still running
2021-01-27 19:25:29.483898 (Thread-1): SQL status: SUCCESS 1 in 4.43 seconds
2021-01-27 19:25:29.498783 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:25:29.499219 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:25:29.707145 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 19:25:29.714793 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 19:25:29.715168 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 19:25:29.910814 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:25:29.914612 (Thread-1): finished collecting timing info
2021-01-27 19:25:29.916273 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 19:25:30.231037 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 118, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 19:25:30.233730 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c7b116-d244-4d76-97dc-962d58651b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eee43a90>]}
2021-01-27 19:25:30.240718 (Thread-1): 14:25:30 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.20s]
2021-01-27 19:25:30.241469 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 19:25:30.242273 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:25:30.246015 (Thread-1): 14:25:30 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 19:25:30.246862 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:25:30.247922 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:25:30.262354 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 19:25:30.262769 (Thread-1): finished collecting timing info
2021-01-27 19:25:30.277311 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:25:30.277489 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 19:25:30.277602 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 19:25:30.893152 (Thread-1): subprocess 17934 is still running
2021-01-27 19:25:34.881318 (Thread-1): SQL status: SUCCESS 1 in 4.60 seconds
2021-01-27 19:25:34.885390 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:25:34.885528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:25:35.080926 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 19:25:35.099691 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 19:25:35.100292 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 19:25:35.321669 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 19:25:35.326550 (Thread-1): finished collecting timing info
2021-01-27 19:25:35.328495 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 19:25:35.612989 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 118, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'relation_columns_different' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'relation_columns_different' is undefined
2021-01-27 19:25:35.616407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c7b116-d244-4d76-97dc-962d58651b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eee437f0>]}
2021-01-27 19:25:35.631311 (Thread-1): 14:25:35 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.37s]
2021-01-27 19:25:35.632150 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 19:25:35.701173 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 19:25:35.701473 (MainThread): Using snowflake connection "master".
2021-01-27 19:25:35.701575 (MainThread): On master: BEGIN
2021-01-27 19:25:35.701654 (MainThread): Opening a new connection, currently in state closed
2021-01-27 19:25:36.313963 (MainThread): subprocess 18037 is still running
2021-01-27 19:25:39.982522 (MainThread): SQL status: SUCCESS 1 in 4.28 seconds
2021-01-27 19:25:39.982857 (MainThread): On master: COMMIT
2021-01-27 19:25:39.983206 (MainThread): Using snowflake connection "master".
2021-01-27 19:25:39.983349 (MainThread): On master: COMMIT
2021-01-27 19:25:40.269259 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 19:25:40.269806 (MainThread): On master: Close
2021-01-27 19:25:40.645278 (MainThread): 14:25:40 | 
2021-01-27 19:25:40.645608 (MainThread): 14:25:40 | Finished running 3 snowflake_timetravel_table models in 37.31s.
2021-01-27 19:25:40.645836 (MainThread): Connection 'master' was properly closed.
2021-01-27 19:25:40.645964 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 19:25:40.661065 (MainThread): 
2021-01-27 19:25:40.661343 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 19:25:40.661542 (MainThread): 
2021-01-27 19:25:40.661702 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 19:25:40.661829 (MainThread):   'relation_columns_different' is undefined
2021-01-27 19:25:40.661961 (MainThread): 
2021-01-27 19:25:40.662122 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 19:25:40.662259 (MainThread):   'relation_columns_different' is undefined
2021-01-27 19:25:40.662399 (MainThread): 
2021-01-27 19:25:40.662533 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 19:25:40.662646 (MainThread):   'relation_columns_different' is undefined
2021-01-27 19:25:40.662776 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 19:25:40.663070 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eee6b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5fbbe7978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5eef2ad30>]}
2021-01-27 19:25:40.663365 (MainThread): Flushing usage events
2021-01-27 20:04:22.261792 (MainThread): Running with dbt=0.18.1
2021-01-27 20:04:22.718119 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:04:22.719025 (MainThread): Tracking: tracking
2021-01-27 20:04:22.719397 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c704c898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c704c4a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c704c4e0>]}
2021-01-27 20:04:22.763308 (MainThread): Partial parsing not enabled
2021-01-27 20:04:22.764585 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:04:22.767389 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:04:22.801574 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:04:22.803362 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:04:22.813523 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:04:22.815695 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:04:22.820462 (MainThread): Parsing macros/core.sql
2021-01-27 20:04:22.824539 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:04:22.826382 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:04:22.828060 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:04:22.829983 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:04:22.834001 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:04:22.843853 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:04:22.850775 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:04:22.856318 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:04:22.875716 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:04:22.877748 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:04:22.907767 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:04:22.914665 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:04:22.920962 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:04:22.923046 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:04:22.937582 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:04:22.959074 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:04:22.968339 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:04:22.969969 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:04:22.970934 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:04:22.973082 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:04:22.974117 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:04:22.975787 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:04:23.034734 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:04:23.051361 (MainThread): Partial parsing not enabled
2021-01-27 20:04:23.095954 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:04:23.121361 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:04:23.134111 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:04:23.374848 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:04:23.375512 (MainThread): 
2021-01-27 20:04:23.375847 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:04:23.380777 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:04:23.395931 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:04:23.396067 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:04:23.396150 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:04:24.233919 (ThreadPoolExecutor-0_0): subprocess 30655 is still running
2021-01-27 20:04:28.823185 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.43 seconds
2021-01-27 20:04:28.855916 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:04:29.746662 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:04:29.758806 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:04:29.758986 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:04:29.759101 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:04:30.486579 (ThreadPoolExecutor-1_0): subprocess 30766 is still running
2021-01-27 20:04:37.623891 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 7.86 seconds
2021-01-27 20:04:38.113152 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:04:39.212008 (MainThread): Using snowflake connection "master".
2021-01-27 20:04:39.212251 (MainThread): On master: BEGIN
2021-01-27 20:04:39.214012 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:04:39.955799 (MainThread): subprocess 30862 is still running
2021-01-27 20:04:45.709809 (MainThread): SQL status: SUCCESS 1 in 6.50 seconds
2021-01-27 20:04:45.710823 (MainThread): On master: COMMIT
2021-01-27 20:04:45.711861 (MainThread): Using snowflake connection "master".
2021-01-27 20:04:45.712290 (MainThread): On master: COMMIT
2021-01-27 20:04:47.758387 (MainThread): SQL status: SUCCESS 1 in 2.05 seconds
2021-01-27 20:04:47.759309 (MainThread): On master: Close
2021-01-27 20:04:49.635461 (MainThread): 15:04:49 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:04:49.636626 (MainThread): 15:04:49 | 
2021-01-27 20:04:49.643389 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:04:49.654108 (Thread-1): 15:04:49 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:04:49.656026 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:04:49.656846 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:04:49.694360 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:04:49.694722 (Thread-1): finished collecting timing info
2021-01-27 20:04:49.746932 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:04:49.747100 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:04:49.747197 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:04:50.410553 (Thread-1): subprocess 30970 is still running
2021-01-27 20:04:55.036399 (Thread-1): SQL status: SUCCESS 1 in 5.29 seconds
2021-01-27 20:04:55.094680 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:04:55.094904 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:04:55.949373 (Thread-1): SQL status: SUCCESS 3 in 0.85 seconds
2021-01-27 20:04:55.968342 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:04:55.968603 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:04:56.610078 (Thread-1): SQL status: SUCCESS 3 in 0.64 seconds
2021-01-27 20:04:56.630089 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:04:56.630369 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:04:57.498492 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-27 20:04:57.509719 (Thread-1): finished collecting timing info
2021-01-27 20:04:57.513278 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:05:00.389768 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'get_truncate_insert_sql' is undefined
2021-01-27 20:05:00.398424 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '934ed18a-52a9-4b2f-8cac-fdb321c20108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c6ffe390>]}
2021-01-27 20:05:00.404028 (Thread-1): 15:05:00 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 10.74s]
2021-01-27 20:05:00.404505 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:05:00.404951 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:05:00.408250 (Thread-1): 15:05:00 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:05:00.408923 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:05:00.409177 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:05:00.425037 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:05:00.425414 (Thread-1): finished collecting timing info
2021-01-27 20:05:00.442546 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:05:00.442712 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:05:00.442805 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:05:01.159696 (Thread-1): subprocess 31071 is still running
2021-01-27 20:05:05.835047 (Thread-1): SQL status: SUCCESS 1 in 5.39 seconds
2021-01-27 20:05:05.862069 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:05:05.862514 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:05:06.490880 (Thread-1): SQL status: SUCCESS 3 in 0.63 seconds
2021-01-27 20:05:06.509714 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:05:06.510332 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:05:06.754626 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 20:05:06.774550 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:05:06.774897 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:05:07.604959 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-27 20:05:07.611850 (Thread-1): finished collecting timing info
2021-01-27 20:05:07.613739 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:05:07.950302 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'get_truncate_insert_sql' is undefined
2021-01-27 20:05:07.953583 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '934ed18a-52a9-4b2f-8cac-fdb321c20108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c504ae48>]}
2021-01-27 20:05:07.963154 (Thread-1): 15:05:07 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 7.54s]
2021-01-27 20:05:07.963920 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:05:07.964466 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:05:07.972286 (Thread-1): 15:05:07 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:05:07.973158 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:05:07.973462 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:05:07.985855 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:05:07.986258 (Thread-1): finished collecting timing info
2021-01-27 20:05:08.003374 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:05:08.003535 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:05:08.003642 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:05:08.956385 (Thread-1): subprocess 31174 is still running
2021-01-27 20:05:23.644479 (Thread-1): SQL status: SUCCESS 1 in 15.64 seconds
2021-01-27 20:05:23.665465 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:05:23.665805 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:05:24.098510 (Thread-1): SQL status: SUCCESS 3 in 0.43 seconds
2021-01-27 20:05:24.111147 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:05:24.111417 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:05:24.572557 (Thread-1): SQL status: SUCCESS 3 in 0.46 seconds
2021-01-27 20:05:24.591875 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:05:24.592732 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:05:25.459068 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-01-27 20:05:25.465543 (Thread-1): finished collecting timing info
2021-01-27 20:05:25.467441 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:05:25.833492 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'get_truncate_insert_sql' is undefined
2021-01-27 20:05:25.837174 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '934ed18a-52a9-4b2f-8cac-fdb321c20108', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c4fec2e8>]}
2021-01-27 20:05:25.846191 (Thread-1): 15:05:25 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 17.86s]
2021-01-27 20:05:25.847135 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:05:25.903518 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:05:25.904244 (MainThread): Using snowflake connection "master".
2021-01-27 20:05:25.904539 (MainThread): On master: BEGIN
2021-01-27 20:05:25.904770 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:05:26.896100 (MainThread): subprocess 31280 is still running
2021-01-27 20:05:33.349113 (MainThread): SQL status: SUCCESS 1 in 7.44 seconds
2021-01-27 20:05:33.349485 (MainThread): On master: COMMIT
2021-01-27 20:05:33.349870 (MainThread): Using snowflake connection "master".
2021-01-27 20:05:33.350035 (MainThread): On master: COMMIT
2021-01-27 20:05:34.175221 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-27 20:05:34.175651 (MainThread): On master: Close
2021-01-27 20:05:34.644602 (MainThread): 15:05:34 | 
2021-01-27 20:05:34.645546 (MainThread): 15:05:34 | Finished running 3 snowflake_timetravel_table models in 71.27s.
2021-01-27 20:05:34.646063 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:05:34.646479 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:05:34.675252 (MainThread): 
2021-01-27 20:05:34.675520 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 20:05:34.675706 (MainThread): 
2021-01-27 20:05:34.675865 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:05:34.675993 (MainThread):   'get_truncate_insert_sql' is undefined
2021-01-27 20:05:34.676126 (MainThread): 
2021-01-27 20:05:34.676262 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:05:34.676375 (MainThread):   'get_truncate_insert_sql' is undefined
2021-01-27 20:05:34.676512 (MainThread): 
2021-01-27 20:05:34.676698 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:05:34.676813 (MainThread):   'get_truncate_insert_sql' is undefined
2021-01-27 20:05:34.676968 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 20:05:34.677295 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c473f978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c473ff28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c473f240>]}
2021-01-27 20:05:34.677653 (MainThread): Flushing usage events
2021-01-27 20:12:48.183057 (MainThread): Running with dbt=0.18.1
2021-01-27 20:12:48.649405 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:12:48.650321 (MainThread): Tracking: tracking
2021-01-27 20:12:48.650688 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1537acb8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1537acb4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1537acb518>]}
2021-01-27 20:12:48.697454 (MainThread): Partial parsing not enabled
2021-01-27 20:12:48.698621 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:12:48.701486 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:12:48.736103 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:12:48.737922 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:12:48.748580 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:12:48.750881 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:12:48.756026 (MainThread): Parsing macros/core.sql
2021-01-27 20:12:48.760269 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:12:48.762289 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:12:48.764135 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:12:48.766251 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:12:48.770396 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:12:48.783450 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:12:48.791276 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:12:48.797484 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:12:48.819566 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:12:48.821608 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:12:48.853060 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:12:48.860653 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:12:48.867376 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:12:48.869416 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:12:48.884261 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:12:48.907950 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:12:48.918200 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:12:48.920116 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:12:48.921192 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:12:48.923519 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:12:48.924717 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:12:48.926690 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:12:48.977592 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:12:48.994624 (MainThread): Partial parsing not enabled
2021-01-27 20:12:49.039742 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:12:49.064610 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:12:49.077904 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:12:49.328681 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:12:49.329391 (MainThread): 
2021-01-27 20:12:49.329727 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:12:49.334577 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:12:49.349803 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:12:49.349943 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:12:49.350106 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:12:50.192011 (ThreadPoolExecutor-0_0): subprocess 4102 is still running
2021-01-27 20:12:54.160189 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.81 seconds
2021-01-27 20:12:54.194245 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:12:54.480413 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:12:54.492665 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:12:54.492821 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:12:54.492918 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:12:55.120400 (ThreadPoolExecutor-1_0): subprocess 4210 is still running
2021-01-27 20:12:59.004529 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.51 seconds
2021-01-27 20:12:59.499906 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:12:59.818652 (MainThread): Using snowflake connection "master".
2021-01-27 20:12:59.818950 (MainThread): On master: BEGIN
2021-01-27 20:12:59.819144 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:13:00.392417 (MainThread): subprocess 4324 is still running
2021-01-27 20:13:04.568745 (MainThread): SQL status: SUCCESS 1 in 4.75 seconds
2021-01-27 20:13:04.569077 (MainThread): On master: COMMIT
2021-01-27 20:13:04.569393 (MainThread): Using snowflake connection "master".
2021-01-27 20:13:04.569531 (MainThread): On master: COMMIT
2021-01-27 20:13:04.879818 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:13:04.880397 (MainThread): On master: Close
2021-01-27 20:13:05.139532 (MainThread): 15:13:05 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:13:05.140164 (MainThread): 15:13:05 | 
2021-01-27 20:13:05.144436 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:13:05.151423 (Thread-1): 15:13:05 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:13:05.152600 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:13:05.153151 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:13:05.194180 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:13:05.194554 (Thread-1): finished collecting timing info
2021-01-27 20:13:05.243576 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:13:05.243801 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:13:05.243897 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:13:05.929332 (Thread-1): subprocess 4431 is still running
2021-01-27 20:13:09.722772 (Thread-1): SQL status: SUCCESS 1 in 4.48 seconds
2021-01-27 20:13:09.765639 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:13:09.765974 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:13:09.952376 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 20:13:09.968341 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:13:09.968790 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:13:10.164886 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 20:13:10.192039 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:13:10.192344 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:13:10.502068 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:13:10.506486 (Thread-1): finished collecting timing info
2021-01-27 20:13:10.507368 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:13:10.796729 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:13:10.805179 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efadfce5-f817-4646-9093-2e21d0dc382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1536061828>]}
2021-01-27 20:13:10.821756 (Thread-1): 15:13:10 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.65s]
2021-01-27 20:13:10.822998 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:13:10.823993 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:13:10.827765 (Thread-1): 15:13:10 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:13:10.829746 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:13:10.830139 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:13:10.847461 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:13:10.848004 (Thread-1): finished collecting timing info
2021-01-27 20:13:10.869071 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:13:10.869240 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:13:10.869337 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:13:11.479752 (Thread-1): subprocess 4535 is still running
2021-01-27 20:13:15.360838 (Thread-1): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 20:13:15.381317 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:13:15.381656 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:13:15.806874 (Thread-1): SQL status: SUCCESS 3 in 0.42 seconds
2021-01-27 20:13:15.810600 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:13:15.810744 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:13:16.016945 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 20:13:16.031693 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:13:16.032188 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:13:16.329493 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 20:13:16.336359 (Thread-1): finished collecting timing info
2021-01-27 20:13:16.338300 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:13:16.596372 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:13:16.599918 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efadfce5-f817-4646-9093-2e21d0dc382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1536066f28>]}
2021-01-27 20:13:16.607782 (Thread-1): 15:13:16 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.77s]
2021-01-27 20:13:16.608330 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:13:16.608928 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:13:16.612015 (Thread-1): 15:13:16 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:13:16.612757 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:13:16.613018 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:13:16.630653 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:13:16.631024 (Thread-1): finished collecting timing info
2021-01-27 20:13:16.646816 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:13:16.646976 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:13:16.647087 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:13:17.232932 (Thread-1): subprocess 4642 is still running
2021-01-27 20:13:20.978869 (Thread-1): SQL status: SUCCESS 1 in 4.33 seconds
2021-01-27 20:13:21.003644 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:13:21.004339 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:13:21.228103 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 20:13:21.247483 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:13:21.247846 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:13:21.490266 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 20:13:21.510162 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:13:21.510545 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:13:22.372104 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-27 20:13:22.379503 (Thread-1): finished collecting timing info
2021-01-27 20:13:22.381468 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:13:23.011635 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:13:23.014778 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efadfce5-f817-4646-9093-2e21d0dc382b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1534227748>]}
2021-01-27 20:13:23.024914 (Thread-1): 15:13:23 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 6.40s]
2021-01-27 20:13:23.025460 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:13:23.042786 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:13:23.043417 (MainThread): Using snowflake connection "master".
2021-01-27 20:13:23.043825 (MainThread): On master: BEGIN
2021-01-27 20:13:23.044069 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:13:23.659674 (MainThread): subprocess 4744 is still running
2021-01-27 20:13:28.012770 (MainThread): SQL status: SUCCESS 1 in 4.97 seconds
2021-01-27 20:13:28.013122 (MainThread): On master: COMMIT
2021-01-27 20:13:28.013450 (MainThread): Using snowflake connection "master".
2021-01-27 20:13:28.013585 (MainThread): On master: COMMIT
2021-01-27 20:13:28.772633 (MainThread): SQL status: SUCCESS 1 in 0.76 seconds
2021-01-27 20:13:28.773279 (MainThread): On master: Close
2021-01-27 20:13:29.294153 (MainThread): 15:13:29 | 
2021-01-27 20:13:29.294600 (MainThread): 15:13:29 | Finished running 3 snowflake_timetravel_table models in 39.96s.
2021-01-27 20:13:29.294916 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:13:29.295083 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:13:29.312915 (MainThread): 
2021-01-27 20:13:29.313117 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 20:13:29.313271 (MainThread): 
2021-01-27 20:13:29.313395 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:13:29.313500 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:13:29.313608 (MainThread): 
2021-01-27 20:13:29.313721 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:13:29.313826 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:13:29.313932 (MainThread): 
2021-01-27 20:13:29.314040 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:13:29.314142 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:13:29.314265 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 20:13:29.314549 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15341b1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15341b1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15341b18d0>]}
2021-01-27 20:13:29.314804 (MainThread): Flushing usage events
2021-01-27 20:14:20.482684 (MainThread): Running with dbt=0.18.1
2021-01-27 20:14:20.952607 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:14:20.953478 (MainThread): Tracking: tracking
2021-01-27 20:14:20.953811 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0ed0c588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0ed0c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0ed0c5f8>]}
2021-01-27 20:14:20.996944 (MainThread): Partial parsing not enabled
2021-01-27 20:14:20.998001 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:14:21.000906 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:14:21.036207 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:14:21.038122 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:14:21.049353 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:14:21.052528 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:14:21.058833 (MainThread): Parsing macros/core.sql
2021-01-27 20:14:21.063487 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:14:21.065674 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:14:21.067549 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:14:21.069862 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:14:21.074536 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:14:21.085622 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:14:21.092910 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:14:21.098564 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:14:21.118836 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:14:21.121000 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:14:21.151692 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:14:21.158915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:14:21.165833 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:14:21.168169 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:14:21.183629 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:14:21.209377 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:14:21.221185 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:14:21.223368 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:14:21.224634 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:14:21.227420 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:14:21.228867 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:14:21.231244 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:14:21.294766 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:14:21.317668 (MainThread): Partial parsing not enabled
2021-01-27 20:14:21.372785 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:14:21.399198 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:14:21.412995 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:14:21.656184 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:14:21.656818 (MainThread): 
2021-01-27 20:14:21.657129 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:14:21.661758 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:14:21.676855 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:14:21.677018 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:14:21.677101 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:14:22.494823 (ThreadPoolExecutor-0_0): subprocess 4987 is still running
2021-01-27 20:14:26.335033 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.66 seconds
2021-01-27 20:14:26.386495 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:14:26.962595 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:14:26.973345 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:14:26.973531 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:14:26.973646 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:14:27.567305 (ThreadPoolExecutor-1_0): subprocess 5095 is still running
2021-01-27 20:14:31.671262 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.70 seconds
2021-01-27 20:14:32.320592 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:14:35.798168 (MainThread): Using snowflake connection "master".
2021-01-27 20:14:35.798490 (MainThread): On master: BEGIN
2021-01-27 20:14:35.798703 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:14:36.504881 (MainThread): subprocess 5197 is still running
2021-01-27 20:14:40.394631 (MainThread): SQL status: SUCCESS 1 in 4.60 seconds
2021-01-27 20:14:40.395605 (MainThread): On master: COMMIT
2021-01-27 20:14:40.396600 (MainThread): Using snowflake connection "master".
2021-01-27 20:14:40.397017 (MainThread): On master: COMMIT
2021-01-27 20:14:40.730685 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 20:14:40.730941 (MainThread): On master: Close
2021-01-27 20:14:41.406519 (MainThread): 15:14:41 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:14:41.408076 (MainThread): 15:14:41 | 
2021-01-27 20:14:41.416058 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:14:41.428323 (Thread-1): 15:14:41 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:14:41.430778 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:14:41.431643 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:14:41.465465 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:14:41.465837 (Thread-1): finished collecting timing info
2021-01-27 20:14:41.515811 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:14:41.515979 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:14:41.516084 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:14:42.184644 (Thread-1): subprocess 5296 is still running
2021-01-27 20:14:45.953621 (Thread-1): SQL status: SUCCESS 1 in 4.44 seconds
2021-01-27 20:14:46.023248 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:14:46.023491 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:14:46.333311 (Thread-1): SQL status: SUCCESS 3 in 0.31 seconds
2021-01-27 20:14:46.351967 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:14:46.352355 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:14:46.704080 (Thread-1): SQL status: SUCCESS 3 in 0.35 seconds
2021-01-27 20:14:46.725483 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:14:46.725712 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:14:46.981794 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 20:14:46.983329 (Thread-1): finished collecting timing info
2021-01-27 20:14:46.983915 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:14:47.239582 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:14:47.247569 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3da6fe60-3b7f-4d49-a0ac-c53f39952013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0d2fb780>]}
2021-01-27 20:14:47.257069 (Thread-1): 15:14:47 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 5.82s]
2021-01-27 20:14:47.257929 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:14:47.259073 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:14:47.264607 (Thread-1): 15:14:47 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:14:47.265693 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:14:47.266130 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:14:47.280501 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:14:47.280941 (Thread-1): finished collecting timing info
2021-01-27 20:14:47.296979 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:14:47.297142 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:14:47.297234 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:14:47.889710 (Thread-1): subprocess 5401 is still running
2021-01-27 20:14:51.564317 (Thread-1): SQL status: SUCCESS 1 in 4.27 seconds
2021-01-27 20:14:51.586551 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:14:51.587227 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:14:51.823737 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 20:14:51.833781 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:14:51.834132 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:14:52.072118 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 20:14:52.092284 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:14:52.092945 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:14:52.404833 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:14:52.411923 (Thread-1): finished collecting timing info
2021-01-27 20:14:52.414364 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:14:52.699701 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:14:52.702817 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3da6fe60-3b7f-4d49-a0ac-c53f39952013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0c473588>]}
2021-01-27 20:14:52.711501 (Thread-1): 15:14:52 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.44s]
2021-01-27 20:14:52.712022 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:14:52.712577 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:14:52.715716 (Thread-1): 15:14:52 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:14:52.716955 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:14:52.717248 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:14:52.730724 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:14:52.731121 (Thread-1): finished collecting timing info
2021-01-27 20:14:52.745764 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:14:52.745923 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:14:52.746033 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:14:53.425764 (Thread-1): subprocess 5498 is still running
2021-01-27 20:14:57.517793 (Thread-1): SQL status: SUCCESS 1 in 4.77 seconds
2021-01-27 20:14:57.539909 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:14:57.540309 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:14:57.713830 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-27 20:14:57.722781 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:14:57.723092 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:14:58.041648 (Thread-1): SQL status: SUCCESS 3 in 0.32 seconds
2021-01-27 20:14:58.046662 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:14:58.046836 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:14:58.300909 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 20:14:58.307596 (Thread-1): finished collecting timing info
2021-01-27 20:14:58.309608 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:14:58.593357 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:14:58.596447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3da6fe60-3b7f-4d49-a0ac-c53f39952013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0ccd1470>]}
2021-01-27 20:14:58.605937 (Thread-1): 15:14:58 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 5.88s]
2021-01-27 20:14:58.606886 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:14:58.701062 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:14:58.702355 (MainThread): Using snowflake connection "master".
2021-01-27 20:14:58.702853 (MainThread): On master: BEGIN
2021-01-27 20:14:58.703569 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:14:59.308228 (MainThread): subprocess 5593 is still running
2021-01-27 20:15:03.141559 (MainThread): SQL status: SUCCESS 1 in 4.44 seconds
2021-01-27 20:15:03.142659 (MainThread): On master: COMMIT
2021-01-27 20:15:03.143745 (MainThread): Using snowflake connection "master".
2021-01-27 20:15:03.144208 (MainThread): On master: COMMIT
2021-01-27 20:15:03.450955 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:15:03.451934 (MainThread): On master: Close
2021-01-27 20:15:03.805495 (MainThread): 15:15:03 | 
2021-01-27 20:15:03.806795 (MainThread): 15:15:03 | Finished running 3 snowflake_timetravel_table models in 42.15s.
2021-01-27 20:15:03.807311 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:15:03.807622 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:15:03.829079 (MainThread): 
2021-01-27 20:15:03.829321 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 20:15:03.829461 (MainThread): 
2021-01-27 20:15:03.829591 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:15:03.829741 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:15:03.829841 (MainThread): 
2021-01-27 20:15:03.829936 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:15:03.830021 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:15:03.830116 (MainThread): 
2021-01-27 20:15:03.830208 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:15:03.830310 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:15:03.830401 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 20:15:03.830644 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0c40b9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0c40b3c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0c40b5f8>]}
2021-01-27 20:15:03.830974 (MainThread): Flushing usage events
2021-01-27 20:16:30.243821 (MainThread): Running with dbt=0.18.1
2021-01-27 20:16:30.714683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:16:30.715611 (MainThread): Tracking: tracking
2021-01-27 20:16:30.715957 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fd8b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fd8b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fd8b588>]}
2021-01-27 20:16:30.759654 (MainThread): Partial parsing not enabled
2021-01-27 20:16:30.760762 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:16:30.763441 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:16:30.798004 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:16:30.799706 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:16:30.809895 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:16:30.812234 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:16:30.817307 (MainThread): Parsing macros/core.sql
2021-01-27 20:16:30.821521 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:16:30.823778 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:16:30.825600 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:16:30.827780 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:16:30.832711 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:16:30.843350 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:16:30.850495 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:16:30.856414 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:16:30.874484 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:16:30.876435 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:16:30.905916 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:16:30.913140 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:16:30.919364 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:16:30.921211 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:16:30.935483 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:16:30.959349 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:16:30.968732 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:16:30.970536 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:16:30.971618 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:16:30.973964 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:16:30.975211 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:16:30.977035 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:16:31.023968 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:16:31.039824 (MainThread): Partial parsing not enabled
2021-01-27 20:16:31.085427 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:16:31.111100 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:16:31.124171 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:16:31.390683 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:16:31.391414 (MainThread): 
2021-01-27 20:16:31.391770 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:16:31.396950 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:16:31.412818 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:16:31.412972 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:16:31.413060 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:16:32.168596 (ThreadPoolExecutor-0_0): subprocess 5858 is still running
2021-01-27 20:16:36.577454 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.16 seconds
2021-01-27 20:16:36.612001 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:16:36.923161 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:16:36.938095 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:16:36.938322 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:16:36.938471 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:16:37.586539 (ThreadPoolExecutor-1_0): subprocess 5961 is still running
2021-01-27 20:16:42.648099 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 5.71 seconds
2021-01-27 20:16:43.125298 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:16:43.441443 (MainThread): Using snowflake connection "master".
2021-01-27 20:16:43.441784 (MainThread): On master: BEGIN
2021-01-27 20:16:43.441985 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:16:44.243447 (MainThread): subprocess 6074 is still running
2021-01-27 20:16:48.472592 (MainThread): SQL status: SUCCESS 1 in 5.03 seconds
2021-01-27 20:16:48.473873 (MainThread): On master: COMMIT
2021-01-27 20:16:48.475190 (MainThread): Using snowflake connection "master".
2021-01-27 20:16:48.475701 (MainThread): On master: COMMIT
2021-01-27 20:16:49.222009 (MainThread): SQL status: SUCCESS 1 in 0.75 seconds
2021-01-27 20:16:49.222349 (MainThread): On master: Close
2021-01-27 20:16:49.476963 (MainThread): 15:16:49 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:16:49.477363 (MainThread): 15:16:49 | 
2021-01-27 20:16:49.480051 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:16:49.483851 (Thread-1): 15:16:49 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:16:49.484521 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:16:49.484823 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:16:49.516037 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:16:49.516433 (Thread-1): finished collecting timing info
2021-01-27 20:16:49.587726 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:16:49.587916 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:16:49.588041 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:16:50.242104 (Thread-1): subprocess 6432 is still running
2021-01-27 20:16:54.491133 (Thread-1): SQL status: SUCCESS 1 in 4.90 seconds
2021-01-27 20:16:54.530540 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:16:54.530793 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:16:55.004879 (Thread-1): SQL status: SUCCESS 3 in 0.47 seconds
2021-01-27 20:16:55.019594 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:16:55.020228 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:16:55.358287 (Thread-1): SQL status: SUCCESS 3 in 0.34 seconds
2021-01-27 20:16:55.387045 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:16:55.387357 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:16:56.642507 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-01-27 20:16:56.649423 (Thread-1): finished collecting timing info
2021-01-27 20:16:56.651715 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:16:57.318606 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:16:57.327345 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '880be17e-9af7-495e-9176-1f9040c4fcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711dd2c4e0>]}
2021-01-27 20:16:57.336564 (Thread-1): 15:16:57 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 7.84s]
2021-01-27 20:16:57.337102 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:16:57.337661 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:16:57.341121 (Thread-1): 15:16:57 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:16:57.341975 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:16:57.342256 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:16:57.356280 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:16:57.356666 (Thread-1): finished collecting timing info
2021-01-27 20:16:57.374363 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:16:57.374528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:16:57.374630 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:16:57.953234 (Thread-1): subprocess 6540 is still running
2021-01-27 20:17:01.953062 (Thread-1): SQL status: SUCCESS 1 in 4.58 seconds
2021-01-27 20:17:01.960011 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:17:01.960289 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:17:02.248394 (Thread-1): SQL status: SUCCESS 3 in 0.29 seconds
2021-01-27 20:17:02.253243 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:17:02.253425 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:17:02.538133 (Thread-1): SQL status: SUCCESS 3 in 0.28 seconds
2021-01-27 20:17:02.557477 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:17:02.557855 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:17:02.811266 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 20:17:02.818937 (Thread-1): finished collecting timing info
2021-01-27 20:17:02.821044 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:17:03.281041 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:17:03.281731 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '880be17e-9af7-495e-9176-1f9040c4fcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711dd3e7b8>]}
2021-01-27 20:17:03.283622 (Thread-1): 15:17:03 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.94s]
2021-01-27 20:17:03.283840 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:17:03.284085 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:17:03.285610 (Thread-1): 15:17:03 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:17:03.286012 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:17:03.286145 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:17:03.295647 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:17:03.296094 (Thread-1): finished collecting timing info
2021-01-27 20:17:03.310859 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:17:03.311054 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:17:03.311216 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:17:04.067783 (Thread-1): subprocess 6660 is still running
2021-01-27 20:17:07.809647 (Thread-1): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 20:17:07.834507 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:17:07.835401 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:17:08.270355 (Thread-1): SQL status: SUCCESS 3 in 0.43 seconds
2021-01-27 20:17:08.289003 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:17:08.289597 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:17:08.589876 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-27 20:17:08.613970 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:17:08.614619 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:17:08.949202 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 20:17:08.955973 (Thread-1): finished collecting timing info
2021-01-27 20:17:08.957990 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:17:09.281102 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 135, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:17:09.284102 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '880be17e-9af7-495e-9176-1f9040c4fcac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711dd49e80>]}
2021-01-27 20:17:09.292828 (Thread-1): 15:17:09 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 6.00s]
2021-01-27 20:17:09.293405 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:17:09.372266 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:17:09.373373 (MainThread): Using snowflake connection "master".
2021-01-27 20:17:09.373822 (MainThread): On master: BEGIN
2021-01-27 20:17:09.374261 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:17:09.986484 (MainThread): subprocess 6772 is still running
2021-01-27 20:17:14.047255 (MainThread): SQL status: SUCCESS 1 in 4.67 seconds
2021-01-27 20:17:14.047530 (MainThread): On master: COMMIT
2021-01-27 20:17:14.047757 (MainThread): Using snowflake connection "master".
2021-01-27 20:17:14.047849 (MainThread): On master: COMMIT
2021-01-27 20:17:14.583251 (MainThread): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-27 20:17:14.583508 (MainThread): On master: Close
2021-01-27 20:17:15.005558 (MainThread): 15:17:15 | 
2021-01-27 20:17:15.006686 (MainThread): 15:17:15 | Finished running 3 snowflake_timetravel_table models in 43.61s.
2021-01-27 20:17:15.007475 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:17:15.007970 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:17:15.049385 (MainThread): 
2021-01-27 20:17:15.049673 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 20:17:15.049924 (MainThread): 
2021-01-27 20:17:15.050133 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:17:15.050321 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:17:15.050497 (MainThread): 
2021-01-27 20:17:15.050681 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:17:15.050880 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:17:15.051032 (MainThread): 
2021-01-27 20:17:15.051209 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:17:15.051376 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:17:15.051513 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 20:17:15.051859 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711c46eb38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711c46e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711c46e5f8>]}
2021-01-27 20:17:15.052179 (MainThread): Flushing usage events
2021-01-27 20:25:24.236856 (MainThread): Running with dbt=0.18.1
2021-01-27 20:25:24.698474 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:25:24.699331 (MainThread): Tracking: tracking
2021-01-27 20:25:24.699674 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f728c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f728c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f728c588>]}
2021-01-27 20:25:24.744987 (MainThread): Partial parsing not enabled
2021-01-27 20:25:24.746127 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:25:24.748898 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:25:24.783636 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:25:24.785511 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:25:24.795821 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:25:24.798076 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:25:24.802981 (MainThread): Parsing macros/core.sql
2021-01-27 20:25:24.806981 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:25:24.808930 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:25:24.810639 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:25:24.812707 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:25:24.816970 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:25:24.827288 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:25:24.834151 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:25:24.839738 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:25:24.860484 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:25:24.862712 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:25:24.893777 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:25:24.901166 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:25:24.907930 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:25:24.909957 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:25:24.925003 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:25:24.948220 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:25:24.957792 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:25:24.959559 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:25:24.960548 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:25:24.962711 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:25:24.963872 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:25:24.965692 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:25:25.012433 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:25:25.028291 (MainThread): Partial parsing not enabled
2021-01-27 20:25:25.070530 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:25:25.099232 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:25:25.112333 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:25:25.362863 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:25:25.363532 (MainThread): 
2021-01-27 20:25:25.363871 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:25:25.368635 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:25:25.385068 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:25:25.385214 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:25:25.385319 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:25:26.301978 (ThreadPoolExecutor-0_0): subprocess 11672 is still running
2021-01-27 20:25:30.966900 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.58 seconds
2021-01-27 20:25:30.998889 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:25:31.310393 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:25:31.328724 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:25:31.328993 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:25:31.329190 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:25:32.018823 (ThreadPoolExecutor-1_0): subprocess 11793 is still running
2021-01-27 20:25:36.028759 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.70 seconds
2021-01-27 20:25:36.534000 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:25:36.886736 (MainThread): Using snowflake connection "master".
2021-01-27 20:25:36.886914 (MainThread): On master: BEGIN
2021-01-27 20:25:36.887014 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:25:37.528449 (MainThread): subprocess 11899 is still running
2021-01-27 20:25:41.841508 (MainThread): SQL status: SUCCESS 1 in 4.95 seconds
2021-01-27 20:25:41.842350 (MainThread): On master: COMMIT
2021-01-27 20:25:41.843089 (MainThread): Using snowflake connection "master".
2021-01-27 20:25:41.843398 (MainThread): On master: COMMIT
2021-01-27 20:25:42.107602 (MainThread): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 20:25:42.108278 (MainThread): On master: Close
2021-01-27 20:25:42.378776 (MainThread): 15:25:42 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:25:42.379710 (MainThread): 15:25:42 | 
2021-01-27 20:25:42.393814 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:25:42.403047 (Thread-1): 15:25:42 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:25:42.404577 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:25:42.405310 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:25:42.468434 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:25:42.468921 (Thread-1): finished collecting timing info
2021-01-27 20:25:42.523329 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:25:42.523494 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:25:42.523587 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:25:43.898885 (Thread-1): subprocess 12014 is still running
2021-01-27 20:25:47.911478 (Thread-1): SQL status: SUCCESS 1 in 5.39 seconds
2021-01-27 20:25:47.940038 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:25:47.940233 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:25:48.111668 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-27 20:25:48.133252 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:25:48.133783 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:25:48.334478 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 20:25:48.370829 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:25:48.371052 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:25:48.620097 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 20:25:48.627677 (Thread-1): finished collecting timing info
2021-01-27 20:25:48.629871 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:25:48.916867 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:25:48.922893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707c5bae-3801-495d-9173-3116dc8c711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f587acf8>]}
2021-01-27 20:25:48.927010 (Thread-1): 15:25:48 | 1 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 6.52s]
2021-01-27 20:25:48.927355 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:25:48.927707 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:25:48.930043 (Thread-1): 15:25:48 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:25:48.931290 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:25:48.931523 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:25:48.943127 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:25:48.943510 (Thread-1): finished collecting timing info
2021-01-27 20:25:48.959131 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:25:48.959290 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:25:48.959393 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:25:49.624384 (Thread-1): subprocess 12118 is still running
2021-01-27 20:25:53.366992 (Thread-1): SQL status: SUCCESS 1 in 4.41 seconds
2021-01-27 20:25:53.394981 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:25:53.395615 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:25:53.584785 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 20:25:53.614729 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:25:53.615528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:25:53.806861 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 20:25:53.827110 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:25:53.827746 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:25:54.088472 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 20:25:54.094751 (Thread-1): finished collecting timing info
2021-01-27 20:25:54.096053 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:25:54.361782 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:25:54.364886 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707c5bae-3801-495d-9173-3116dc8c711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f52c1160>]}
2021-01-27 20:25:54.375403 (Thread-1): 15:25:54 | 2 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.43s]
2021-01-27 20:25:54.376688 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:25:54.377699 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:25:54.386954 (Thread-1): 15:25:54 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:25:54.389205 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:25:54.389918 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:25:54.409656 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:25:54.410127 (Thread-1): finished collecting timing info
2021-01-27 20:25:54.425303 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:25:54.425474 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:25:54.425569 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:25:55.028478 (Thread-1): subprocess 12216 is still running
2021-01-27 20:25:59.969694 (Thread-1): SQL status: SUCCESS 1 in 5.54 seconds
2021-01-27 20:25:59.993056 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:25:59.993684 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:26:00.255447 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-27 20:26:00.296515 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:26:00.297168 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:26:00.504013 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 20:26:00.529263 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:26:00.529689 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:26:00.886548 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 20:26:00.890240 (Thread-1): finished collecting timing info
2021-01-27 20:26:00.891263 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:26:01.155491 (Thread-1): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 132, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 460, in call
    if not __self.is_safe_callable(__obj):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 360, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 753, in __getattr__
    return self._fail_with_undefined_error()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 747, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'dbt_snowflake_get_truncate_insert_sql' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
  'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:26:01.158561 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '707c5bae-3801-495d-9173-3116dc8c711b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f5261d30>]}
2021-01-27 20:26:01.166669 (Thread-1): 15:26:01 | 3 of 3 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [ERROR in 6.77s]
2021-01-27 20:26:01.167194 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:26:01.186665 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:26:01.187138 (MainThread): Using snowflake connection "master".
2021-01-27 20:26:01.187309 (MainThread): On master: BEGIN
2021-01-27 20:26:01.187462 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:26:01.849265 (MainThread): subprocess 12335 is still running
2021-01-27 20:26:05.805790 (MainThread): SQL status: SUCCESS 1 in 4.62 seconds
2021-01-27 20:26:05.807256 (MainThread): On master: COMMIT
2021-01-27 20:26:05.808496 (MainThread): Using snowflake connection "master".
2021-01-27 20:26:05.808971 (MainThread): On master: COMMIT
2021-01-27 20:26:06.379939 (MainThread): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-27 20:26:06.380696 (MainThread): On master: Close
2021-01-27 20:26:06.669090 (MainThread): 15:26:06 | 
2021-01-27 20:26:06.670048 (MainThread): 15:26:06 | Finished running 3 snowflake_timetravel_table models in 41.30s.
2021-01-27 20:26:06.670699 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:26:06.671104 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:26:06.696352 (MainThread): 
2021-01-27 20:26:06.696567 (MainThread): Completed with 3 errors and 0 warnings:
2021-01-27 20:26:06.696718 (MainThread): 
2021-01-27 20:26:06.696858 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:26:06.696976 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:26:06.697086 (MainThread): 
2021-01-27 20:26:06.697243 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:26:06.697386 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:26:06.697500 (MainThread): 
2021-01-27 20:26:06.697620 (MainThread): Compilation Error in macro materialization_snowflake_timetravel_table_snowflake (macros/snowflake_timetravel_table.sql)
2021-01-27 20:26:06.697731 (MainThread):   'dbt_snowflake_get_truncate_insert_sql' is undefined
2021-01-27 20:26:06.697898 (MainThread): 
Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
2021-01-27 20:26:06.698200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f416fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f416f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f416f160>]}
2021-01-27 20:26:06.698507 (MainThread): Flushing usage events
2021-01-27 20:27:42.483631 (MainThread): Running with dbt=0.18.1
2021-01-27 20:27:42.941379 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:27:42.942432 (MainThread): Tracking: tracking
2021-01-27 20:27:42.942815 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e328e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e328e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e328e518>]}
2021-01-27 20:27:42.985286 (MainThread): Partial parsing not enabled
2021-01-27 20:27:42.986394 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:27:42.989198 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:27:43.023353 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:27:43.025083 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:27:43.035035 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:27:43.037192 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:27:43.042022 (MainThread): Parsing macros/core.sql
2021-01-27 20:27:43.046076 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:27:43.047945 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:27:43.049677 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:27:43.051781 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:27:43.055998 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:27:43.066130 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:27:43.072889 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:27:43.078273 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:27:43.096123 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:27:43.098242 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:27:43.129315 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:27:43.136548 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:27:43.142945 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:27:43.145163 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:27:43.159793 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:27:43.182206 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:27:43.191505 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:27:43.193239 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:27:43.194197 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:27:43.196271 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:27:43.197350 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:27:43.199161 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:27:43.245250 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:27:43.260983 (MainThread): Partial parsing not enabled
2021-01-27 20:27:43.302665 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:27:43.326286 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:27:43.338259 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:27:43.585682 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:27:43.586405 (MainThread): 
2021-01-27 20:27:43.586772 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:27:43.592114 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:27:43.607959 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:27:43.608128 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:27:43.608219 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:27:44.371430 (ThreadPoolExecutor-0_0): subprocess 12730 is still running
2021-01-27 20:27:49.896914 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 6.29 seconds
2021-01-27 20:27:49.907575 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:27:50.188840 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:27:50.207545 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:27:50.207826 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:27:50.208012 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:27:50.853805 (ThreadPoolExecutor-1_0): subprocess 12861 is still running
2021-01-27 20:27:54.982730 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.77 seconds
2021-01-27 20:27:55.493281 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:27:55.782394 (MainThread): Using snowflake connection "master".
2021-01-27 20:27:55.782615 (MainThread): On master: BEGIN
2021-01-27 20:27:55.782761 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:27:56.356220 (MainThread): subprocess 12969 is still running
2021-01-27 20:28:00.092488 (MainThread): SQL status: SUCCESS 1 in 4.31 seconds
2021-01-27 20:28:00.093587 (MainThread): On master: COMMIT
2021-01-27 20:28:00.094681 (MainThread): Using snowflake connection "master".
2021-01-27 20:28:00.095134 (MainThread): On master: COMMIT
2021-01-27 20:28:00.401396 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:28:00.402694 (MainThread): On master: Close
2021-01-27 20:28:00.691285 (MainThread): 15:28:00 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:28:00.692340 (MainThread): 15:28:00 | 
2021-01-27 20:28:00.700174 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:28:00.705194 (Thread-1): 15:28:00 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:28:00.705972 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:00.706334 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:28:00.735632 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:28:00.736022 (Thread-1): finished collecting timing info
2021-01-27 20:28:00.803055 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:00.803222 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:28:00.803329 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:28:01.407917 (Thread-1): subprocess 13075 is still running
2021-01-27 20:28:05.855849 (Thread-1): SQL status: SUCCESS 1 in 5.05 seconds
2021-01-27 20:28:05.874892 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:05.875113 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:28:06.111936 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 20:28:06.116170 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:06.116351 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:28:06.357221 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 20:28:06.386016 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:06.386297 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:28:06.661242 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 20:28:06.714369 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:28:06.720209 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:06.720669 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 20:28:06.942058 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 20:28:06.942785 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:06.943038 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed;
2021-01-27 20:28:07.398820 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-27 20:28:07.400090 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:07.400837 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed ("COL1", "COL2", "COL3")
  (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:28:08.214730 (Thread-1): SQL status: SUCCESS 2 in 0.81 seconds
2021-01-27 20:28:08.221021 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 20:28:08.222085 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:28:08.222623 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 20:28:08.890977 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-01-27 20:28:08.914423 (Thread-1): finished collecting timing info
2021-01-27 20:28:08.914916 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:28:09.348689 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005e2e5e-a84a-492b-acda-ff126ab609d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e1824eb8>]}
2021-01-27 20:28:09.352130 (Thread-1): 15:28:09 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 2 in 8.64s]
2021-01-27 20:28:09.352496 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:28:09.352836 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:28:09.355648 (Thread-1): 15:28:09 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:28:09.356273 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:09.356487 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:28:09.377438 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:28:09.378600 (Thread-1): finished collecting timing info
2021-01-27 20:28:09.409711 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:09.409956 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:28:09.410113 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:28:10.025007 (Thread-1): subprocess 13184 is still running
2021-01-27 20:28:14.637907 (Thread-1): SQL status: SUCCESS 1 in 5.23 seconds
2021-01-27 20:28:14.652516 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:14.652894 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:28:15.018247 (Thread-1): SQL status: SUCCESS 3 in 0.37 seconds
2021-01-27 20:28:15.024490 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:15.024713 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:28:15.260166 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 20:28:15.266902 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:15.267177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:28:15.952867 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-01-27 20:28:15.954725 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:28:15.955675 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:15.955780 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 20:28:16.158316 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 20:28:16.158559 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:16.158700 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 20:28:16.720076 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-27 20:28:16.720429 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:16.720604 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:28:17.460839 (Thread-1): SQL status: SUCCESS 2 in 0.74 seconds
2021-01-27 20:28:17.463543 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 20:28:17.463936 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:28:17.464107 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 20:28:18.402202 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-27 20:28:18.409919 (Thread-1): finished collecting timing info
2021-01-27 20:28:18.410704 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:28:19.006694 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005e2e5e-a84a-492b-acda-ff126ab609d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e1229d30>]}
2021-01-27 20:28:19.009608 (Thread-1): 15:28:19 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 9.65s]
2021-01-27 20:28:19.009935 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:28:19.010260 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:28:19.013310 (Thread-1): 15:28:19 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:28:19.013957 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:19.014165 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:28:19.067053 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:28:19.067632 (Thread-1): finished collecting timing info
2021-01-27 20:28:19.130840 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:19.131125 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:28:19.131309 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:28:19.825854 (Thread-1): subprocess 13287 is still running
2021-01-27 20:28:24.001245 (Thread-1): SQL status: SUCCESS 1 in 4.87 seconds
2021-01-27 20:28:24.006242 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:24.006427 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:28:24.217056 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 20:28:24.224145 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:24.224357 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:28:24.429314 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 20:28:24.436366 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:24.436578 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:28:24.747124 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:28:24.749145 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:28:24.750294 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:24.750432 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 20:28:24.989393 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 20:28:24.989629 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:24.989766 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed;
2021-01-27 20:28:25.429188 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-27 20:28:25.429806 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:25.430263 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed ("COL1", "COL2RENAMED", "COL3")
  (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:28:25.896663 (Thread-1): SQL status: SUCCESS 2 in 0.47 seconds
2021-01-27 20:28:25.903161 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 20:28:25.904749 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:28:25.905208 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 20:28:26.614385 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-01-27 20:28:26.621611 (Thread-1): finished collecting timing info
2021-01-27 20:28:26.622270 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:28:26.946113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '005e2e5e-a84a-492b-acda-ff126ab609d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e12dd978>]}
2021-01-27 20:28:26.956201 (Thread-1): 15:28:26 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 2 in 7.93s]
2021-01-27 20:28:26.956961 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:28:27.019423 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:28:27.020205 (MainThread): Using snowflake connection "master".
2021-01-27 20:28:27.020472 (MainThread): On master: BEGIN
2021-01-27 20:28:27.020712 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:28:27.988714 (MainThread): subprocess 13399 is still running
2021-01-27 20:28:31.890690 (MainThread): SQL status: SUCCESS 1 in 4.87 seconds
2021-01-27 20:28:31.890924 (MainThread): On master: COMMIT
2021-01-27 20:28:31.891292 (MainThread): Using snowflake connection "master".
2021-01-27 20:28:31.891399 (MainThread): On master: COMMIT
2021-01-27 20:28:32.291249 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-27 20:28:32.292144 (MainThread): On master: Close
2021-01-27 20:28:32.634093 (MainThread): 15:28:32 | 
2021-01-27 20:28:32.638418 (MainThread): 15:28:32 | Finished running 3 snowflake_timetravel_table models in 49.05s.
2021-01-27 20:28:32.640119 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:28:32.640924 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:28:32.702430 (MainThread): 
2021-01-27 20:28:32.702802 (MainThread): Completed successfully
2021-01-27 20:28:32.703116 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 20:28:32.703664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e01ac7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e01ac550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e01ac198>]}
2021-01-27 20:28:32.704182 (MainThread): Flushing usage events
2021-01-27 20:39:25.707963 (MainThread): Running with dbt=0.18.1
2021-01-27 20:39:26.168122 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:39:26.169118 (MainThread): Tracking: tracking
2021-01-27 20:39:26.169458 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e954e908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e954e518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e954e550>]}
2021-01-27 20:39:26.215608 (MainThread): Partial parsing not enabled
2021-01-27 20:39:26.216710 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:39:26.219771 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:39:26.255813 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:39:26.257752 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:39:26.267938 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:39:26.270188 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:39:26.275153 (MainThread): Parsing macros/core.sql
2021-01-27 20:39:26.279257 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:39:26.281112 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:39:26.282784 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:39:26.284814 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:39:26.289017 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:39:26.299188 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:39:26.306144 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:39:26.311869 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:39:26.330028 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:39:26.332212 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:39:26.364496 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:39:26.371638 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:39:26.378239 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:39:26.380253 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:39:26.396946 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:39:26.422590 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:39:26.432876 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:39:26.434719 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:39:26.435766 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:39:26.438006 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:39:26.439159 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:39:26.441027 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:39:26.487547 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:39:26.503688 (MainThread): Partial parsing not enabled
2021-01-27 20:39:26.547576 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:39:26.571467 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:26.583533 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:39:26.825049 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:39:26.825721 (MainThread): 
2021-01-27 20:39:26.826028 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:39:26.830828 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:39:26.846202 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:39:26.846360 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:39:26.846445 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:39:27.668693 (ThreadPoolExecutor-0_0): subprocess 18079 is still running
2021-01-27 20:39:31.532756 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.69 seconds
2021-01-27 20:39:31.588822 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:39:32.241302 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:39:32.259880 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:39:32.260109 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:39:32.260254 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:39:32.955484 (ThreadPoolExecutor-1_0): subprocess 18190 is still running
2021-01-27 20:39:37.465613 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 5.21 seconds
2021-01-27 20:39:37.899097 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:39:38.200416 (MainThread): Using snowflake connection "master".
2021-01-27 20:39:38.200651 (MainThread): On master: BEGIN
2021-01-27 20:39:38.200772 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:39:38.831959 (MainThread): subprocess 18296 is still running
2021-01-27 20:39:42.687979 (MainThread): SQL status: SUCCESS 1 in 4.49 seconds
2021-01-27 20:39:42.688894 (MainThread): On master: COMMIT
2021-01-27 20:39:42.689851 (MainThread): Using snowflake connection "master".
2021-01-27 20:39:42.690355 (MainThread): On master: COMMIT
2021-01-27 20:39:43.042579 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-27 20:39:43.043190 (MainThread): On master: Close
2021-01-27 20:39:43.305861 (MainThread): 15:39:43 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:39:43.306530 (MainThread): 15:39:43 | 
2021-01-27 20:39:43.311007 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:39:43.317293 (Thread-1): 15:39:43 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:39:43.318475 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:43.319068 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:39:43.347907 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:39:43.348290 (Thread-1): finished collecting timing info
2021-01-27 20:39:43.398264 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:43.398425 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:39:43.398518 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:39:44.009076 (Thread-1): subprocess 18403 is still running
2021-01-27 20:39:48.499619 (Thread-1): SQL status: SUCCESS 1 in 5.10 seconds
2021-01-27 20:39:48.535513 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:48.535844 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:39:48.953739 (Thread-1): SQL status: SUCCESS 3 in 0.42 seconds
2021-01-27 20:39:48.958102 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:48.958278 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:39:49.344627 (Thread-1): SQL status: SUCCESS 3 in 0.39 seconds
2021-01-27 20:39:49.360114 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:49.360275 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:39:50.120013 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-01-27 20:39:50.141685 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:39:50.142937 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:50.143074 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 20:39:50.432418 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 20:39:50.433360 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:50.434067 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed;
2021-01-27 20:39:50.961907 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-01-27 20:39:50.962761 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:50.963437 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed ("COL1", "COL2", "COL3")
  (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:39:52.973970 (Thread-1): SQL status: SUCCESS 2 in 2.01 seconds
2021-01-27 20:39:52.978596 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 20:39:52.979542 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:39:52.980013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 20:39:54.444443 (Thread-1): SQL status: SUCCESS 1 in 1.46 seconds
2021-01-27 20:39:54.471375 (Thread-1): finished collecting timing info
2021-01-27 20:39:54.471937 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:39:54.766086 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c83a8f2-d7e9-4cc0-840f-0facc2c82333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e3ad6f60>]}
2021-01-27 20:39:54.768783 (Thread-1): 15:39:54 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 2 in 11.45s]
2021-01-27 20:39:54.769105 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:39:54.769399 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:39:54.771974 (Thread-1): 15:39:54 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:39:54.772628 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:39:54.772813 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:39:54.785316 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:39:54.785688 (Thread-1): finished collecting timing info
2021-01-27 20:39:54.804113 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:39:54.804374 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:39:54.804523 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:39:55.404323 (Thread-1): subprocess 18548 is still running
2021-01-27 20:39:59.250418 (Thread-1): SQL status: SUCCESS 1 in 4.45 seconds
2021-01-27 20:39:59.270633 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:39:59.271007 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:39:59.486846 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 20:39:59.502014 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:39:59.502558 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:39:59.704200 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 20:39:59.733487 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:39:59.733950 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:40:00.671472 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-27 20:40:00.680364 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:40:00.685626 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:40:00.686372 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 20:40:01.924890 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-01-27 20:40:01.925553 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:40:01.925974 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 20:40:02.495069 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-27 20:40:02.495970 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:40:02.496533 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:40:03.370912 (Thread-1): SQL status: SUCCESS 2 in 0.87 seconds
2021-01-27 20:40:03.377245 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 20:40:03.378079 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:40:03.378632 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 20:40:03.965245 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-27 20:40:04.004258 (Thread-1): finished collecting timing info
2021-01-27 20:40:04.007604 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:40:04.708023 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c83a8f2-d7e9-4cc0-840f-0facc2c82333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e3564b00>]}
2021-01-27 20:40:04.715629 (Thread-1): 15:40:04 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 9.93s]
2021-01-27 20:40:04.716570 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:40:04.717572 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:40:04.725554 (Thread-1): 15:40:04 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:40:04.727771 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:04.728656 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:40:04.759943 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:40:04.760420 (Thread-1): finished collecting timing info
2021-01-27 20:40:04.775904 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:04.776067 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:40:04.776169 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:40:05.429010 (Thread-1): subprocess 18644 is still running
2021-01-27 20:40:10.486624 (Thread-1): SQL status: SUCCESS 1 in 5.71 seconds
2021-01-27 20:40:10.507386 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:10.507740 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:40:10.830177 (Thread-1): SQL status: SUCCESS 3 in 0.32 seconds
2021-01-27 20:40:10.851244 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:10.851750 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:40:11.066205 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 20:40:11.085230 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:11.085858 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:40:11.830414 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2021-01-27 20:40:11.839286 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:40:11.844023 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:11.844770 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 20:40:12.057751 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 20:40:12.058492 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:12.059095 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed;
2021-01-27 20:40:12.993643 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-01-27 20:40:12.993841 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:12.993930 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed ("COL1", "COL2RENAMED", "COL3")
  (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:40:13.656269 (Thread-1): SQL status: SUCCESS 2 in 0.66 seconds
2021-01-27 20:40:13.662530 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 20:40:13.663962 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:40:13.665012 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 20:40:14.487108 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-27 20:40:14.490200 (Thread-1): finished collecting timing info
2021-01-27 20:40:14.490622 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:40:15.194690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c83a8f2-d7e9-4cc0-840f-0facc2c82333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e3ad6f60>]}
2021-01-27 20:40:15.201541 (Thread-1): 15:40:15 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 2 in 10.47s]
2021-01-27 20:40:15.202027 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:40:15.255825 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:40:15.256452 (MainThread): Using snowflake connection "master".
2021-01-27 20:40:15.256707 (MainThread): On master: BEGIN
2021-01-27 20:40:15.256940 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:40:15.859865 (MainThread): subprocess 18745 is still running
2021-01-27 20:40:19.398443 (MainThread): SQL status: SUCCESS 1 in 4.14 seconds
2021-01-27 20:40:19.398995 (MainThread): On master: COMMIT
2021-01-27 20:40:19.399558 (MainThread): Using snowflake connection "master".
2021-01-27 20:40:19.400014 (MainThread): On master: COMMIT
2021-01-27 20:40:19.674347 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 20:40:19.675269 (MainThread): On master: Close
2021-01-27 20:40:19.959552 (MainThread): 15:40:19 | 
2021-01-27 20:40:19.960615 (MainThread): 15:40:19 | Finished running 3 snowflake_timetravel_table models in 53.13s.
2021-01-27 20:40:19.961343 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:40:19.961792 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:40:19.983873 (MainThread): 
2021-01-27 20:40:19.984167 (MainThread): Completed successfully
2021-01-27 20:40:19.984408 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 20:40:19.984809 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e359cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e1c83278>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27e1c83048>]}
2021-01-27 20:40:19.985260 (MainThread): Flushing usage events
2021-01-27 20:54:04.256963 (MainThread): Running with dbt=0.18.1
2021-01-27 20:54:04.722587 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 20:54:04.723615 (MainThread): Tracking: tracking
2021-01-27 20:54:04.723977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed600b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed600b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed600b588>]}
2021-01-27 20:54:04.766112 (MainThread): Partial parsing not enabled
2021-01-27 20:54:04.767204 (MainThread): Parsing macros/catalog.sql
2021-01-27 20:54:04.769879 (MainThread): Parsing macros/adapters.sql
2021-01-27 20:54:04.804178 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 20:54:04.805943 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 20:54:04.816736 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 20:54:04.819128 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 20:54:04.824452 (MainThread): Parsing macros/core.sql
2021-01-27 20:54:04.828655 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 20:54:04.830761 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 20:54:04.832514 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 20:54:04.834652 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 20:54:04.839963 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 20:54:04.850863 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 20:54:04.861490 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 20:54:04.867227 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 20:54:04.885189 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 20:54:04.887068 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 20:54:04.916196 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 20:54:04.923226 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 20:54:04.929617 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 20:54:04.931544 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 20:54:04.946188 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 20:54:04.968042 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 20:54:04.977328 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 20:54:04.979176 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 20:54:04.980194 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 20:54:04.982342 (MainThread): Parsing macros/etc/query.sql
2021-01-27 20:54:04.983428 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 20:54:04.985200 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 20:54:05.033435 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 20:54:05.049202 (MainThread): Partial parsing not enabled
2021-01-27 20:54:05.090978 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:05.114322 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:05.126524 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:05.377200 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 20:54:05.377883 (MainThread): 
2021-01-27 20:54:05.378235 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:54:05.383141 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 20:54:05.398962 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 20:54:05.399115 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 20:54:05.399207 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 20:54:06.069735 (ThreadPoolExecutor-0_0): subprocess 21244 is still running
2021-01-27 20:54:09.827338 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.43 seconds
2021-01-27 20:54:09.874195 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 20:54:10.404404 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:54:10.415820 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 20:54:10.415997 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 20:54:10.416110 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 20:54:11.034975 (ThreadPoolExecutor-1_0): subprocess 21344 is still running
2021-01-27 20:54:15.009897 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 465 in 4.59 seconds
2021-01-27 20:54:15.474872 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 20:54:15.811784 (MainThread): Using snowflake connection "master".
2021-01-27 20:54:15.812012 (MainThread): On master: BEGIN
2021-01-27 20:54:15.812157 (MainThread): Opening a new connection, currently in state init
2021-01-27 20:54:16.413431 (MainThread): subprocess 24386 is still running
2021-01-27 20:54:20.318374 (MainThread): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 20:54:20.319851 (MainThread): On master: COMMIT
2021-01-27 20:54:20.321353 (MainThread): Using snowflake connection "master".
2021-01-27 20:54:20.321836 (MainThread): On master: COMMIT
2021-01-27 20:54:20.645853 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 20:54:20.647026 (MainThread): On master: Close
2021-01-27 20:54:20.902083 (MainThread): 15:54:20 | Concurrency: 1 threads (target='snowflake')
2021-01-27 20:54:20.902351 (MainThread): 15:54:20 | 
2021-01-27 20:54:20.904557 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:54:20.906911 (Thread-1): 15:54:20 | 1 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 20:54:20.907365 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:20.907550 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:54:20.930574 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:54:20.931158 (Thread-1): finished collecting timing info
2021-01-27 20:54:20.982113 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:20.982290 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:54:20.982395 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:54:22.028741 (Thread-1): subprocess 24488 is still running
2021-01-27 20:54:25.896621 (Thread-1): SQL status: SUCCESS 1 in 4.91 seconds
2021-01-27 20:54:25.969551 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:25.970070 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:54:26.236384 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-27 20:54:26.254558 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:26.255136 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 20:54:26.580819 (Thread-1): SQL status: SUCCESS 3 in 0.33 seconds
2021-01-27 20:54:26.620982 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:26.621160 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 20:54:26.846746 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 20:54:26.865786 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 20:54:26.867774 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:26.867951 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 20:54:27.088161 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 20:54:27.088816 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:27.089573 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed;
2021-01-27 20:54:27.523026 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-27 20:54:27.523871 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:27.524313 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed ("COL1", "COL2", "COL3")
  (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:54:28.695616 (Thread-1): SQL status: SUCCESS 2 in 1.17 seconds
2021-01-27 20:54:28.701731 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 20:54:28.702860 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 20:54:28.703391 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 20:54:29.315601 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-27 20:54:29.335732 (Thread-1): finished collecting timing info
2021-01-27 20:54:29.336226 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 20:54:29.740052 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa4df10-c406-4f85-8a92-2ed0fc9e359a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed45fa1d0>]}
2021-01-27 20:54:29.741787 (Thread-1): 15:54:29 | 1 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 2 in 8.83s]
2021-01-27 20:54:29.742019 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 20:54:29.742246 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:54:29.743726 (Thread-1): 15:54:29 | 2 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 20:54:29.744130 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:29.744274 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:54:29.754410 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:54:29.754790 (Thread-1): finished collecting timing info
2021-01-27 20:54:29.768787 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:29.768964 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:54:29.769084 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:54:30.443025 (Thread-1): subprocess 24596 is still running
2021-01-27 20:54:34.874171 (Thread-1): SQL status: SUCCESS 1 in 5.10 seconds
2021-01-27 20:54:34.898921 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:34.899408 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:54:35.077687 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 20:54:35.105137 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:35.105646 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 20:54:35.435224 (Thread-1): SQL status: SUCCESS 3 in 0.33 seconds
2021-01-27 20:54:35.450849 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:35.451471 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 20:54:35.748305 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 20:54:35.750189 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 20:54:35.751264 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:35.751389 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 20:54:36.056907 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:54:36.057129 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:36.057263 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 20:54:36.933463 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-27 20:54:36.933691 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:36.933807 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:54:39.023038 (Thread-1): SQL status: SUCCESS 2 in 2.09 seconds
2021-01-27 20:54:39.027394 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 20:54:39.027978 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 20:54:39.028280 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 20:54:40.146971 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-27 20:54:40.159839 (Thread-1): finished collecting timing info
2021-01-27 20:54:40.161203 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 20:54:40.467860 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa4df10-c406-4f85-8a92-2ed0fc9e359a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecff80e10>]}
2021-01-27 20:54:40.471166 (Thread-1): 15:54:40 | 2 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 10.72s]
2021-01-27 20:54:40.471486 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 20:54:40.471803 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:54:40.474110 (Thread-1): 15:54:40 | 3 of 3 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 20:54:40.474884 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:40.475086 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:54:40.486545 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:54:40.486982 (Thread-1): finished collecting timing info
2021-01-27 20:54:40.504598 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:40.504877 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 20:54:40.505091 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 20:54:41.121442 (Thread-1): subprocess 24698 is still running
2021-01-27 20:54:44.739576 (Thread-1): SQL status: SUCCESS 1 in 4.23 seconds
2021-01-27 20:54:44.761843 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:44.762526 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:54:45.031557 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-27 20:54:45.055256 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:45.055878 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 20:54:45.269401 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 20:54:45.287459 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:45.287813 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 20:54:45.512212 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 20:54:45.551125 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 20:54:45.552206 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:45.552336 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 20:54:45.744009 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 20:54:45.744292 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:45.744471 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 20:54:47.156947 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-01-27 20:54:47.163210 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 20:54:47.164202 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 20:54:47.164651 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 20:54:47.344447 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 20:54:47.361552 (Thread-1): finished collecting timing info
2021-01-27 20:54:47.362962 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 20:54:47.705234 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa4df10-c406-4f85-8a92-2ed0fc9e359a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ecfffed30>]}
2021-01-27 20:54:47.712825 (Thread-1): 15:54:47 | 3 of 3 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.23s]
2021-01-27 20:54:47.714115 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 20:54:47.817607 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 20:54:47.818782 (MainThread): Using snowflake connection "master".
2021-01-27 20:54:47.819240 (MainThread): On master: BEGIN
2021-01-27 20:54:47.820001 (MainThread): Opening a new connection, currently in state closed
2021-01-27 20:54:48.428808 (MainThread): subprocess 24800 is still running
2021-01-27 20:54:52.137546 (MainThread): SQL status: SUCCESS 1 in 4.32 seconds
2021-01-27 20:54:52.138326 (MainThread): On master: COMMIT
2021-01-27 20:54:52.139288 (MainThread): Using snowflake connection "master".
2021-01-27 20:54:52.139756 (MainThread): On master: COMMIT
2021-01-27 20:54:52.448174 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 20:54:52.448886 (MainThread): On master: Close
2021-01-27 20:54:52.708907 (MainThread): 15:54:52 | 
2021-01-27 20:54:52.709650 (MainThread): 15:54:52 | Finished running 3 snowflake_timetravel_table models in 47.33s.
2021-01-27 20:54:52.710190 (MainThread): Connection 'master' was properly closed.
2021-01-27 20:54:52.710567 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 20:54:52.739361 (MainThread): 
2021-01-27 20:54:52.739605 (MainThread): Completed successfully
2021-01-27 20:54:52.739763 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2021-01-27 20:54:52.740076 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ece76eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ece76e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ece76ef60>]}
2021-01-27 20:54:52.740388 (MainThread): Flushing usage events
2021-01-27 21:19:46.232164 (MainThread): Running with dbt=0.18.1
2021-01-27 21:19:46.685574 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 21:19:46.685893 (MainThread): Tracking: tracking
2021-01-27 21:19:46.686033 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e6b551978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e648f8588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e648f8cc0>]}
2021-01-27 21:19:46.686614 (MainThread): Set downloads directory='/tmp/dbt-downloads-0wxohr9y'
2021-01-27 21:19:46.699196 (MainThread): Installing ../../
2021-01-27 21:19:46.699479 (MainThread):   Creating symlink to local dependency.
2021-01-27 21:19:46.699615 (MainThread):   Installed from <local @ ../../>

2021-01-27 21:19:46.699759 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '1da78354-340e-4169-92e3-d74c1cbf8a5a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e6484a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e6484ae80>]}
2021-01-27 21:19:46.700074 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e6b551978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e648f8cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e648f8be0>]}
2021-01-27 21:19:46.700246 (MainThread): Flushing usage events
2021-01-27 21:19:48.397801 (MainThread): Running with dbt=0.18.1
2021-01-27 21:19:48.853420 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 21:19:48.854289 (MainThread): Tracking: tracking
2021-01-27 21:19:48.854626 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13198cf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13198cf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13198cf940>]}
2021-01-27 21:19:48.898463 (MainThread): Partial parsing not enabled
2021-01-27 21:19:48.899528 (MainThread): Parsing macros/catalog.sql
2021-01-27 21:19:48.902252 (MainThread): Parsing macros/adapters.sql
2021-01-27 21:19:48.936336 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 21:19:48.938049 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 21:19:48.950710 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 21:19:48.953510 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 21:19:48.959210 (MainThread): Parsing macros/core.sql
2021-01-27 21:19:48.964035 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 21:19:48.966228 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 21:19:48.968331 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 21:19:48.971015 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 21:19:48.976080 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 21:19:48.987852 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 21:19:48.995873 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 21:19:49.003185 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 21:19:49.023989 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 21:19:49.026275 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 21:19:49.058405 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 21:19:49.065605 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 21:19:49.072538 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 21:19:49.074528 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 21:19:49.090082 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 21:19:49.112862 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 21:19:49.122881 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 21:19:49.124659 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 21:19:49.125674 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 21:19:49.127870 (MainThread): Parsing macros/etc/query.sql
2021-01-27 21:19:49.129007 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 21:19:49.130819 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 21:19:49.177929 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 21:19:49.194197 (MainThread): Partial parsing not enabled
2021-01-27 21:19:49.235775 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:19:49.259170 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:19:49.271737 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:19:49.284371 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:19:49.296872 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:19:49.543171 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 21:19:49.543936 (MainThread): 
2021-01-27 21:19:49.544259 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:19:49.551475 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 21:19:49.566846 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 21:19:49.566983 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 21:19:49.567067 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 21:19:50.244289 (ThreadPoolExecutor-0_0): subprocess 383 is still running
2021-01-27 21:19:54.365327 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.80 seconds
2021-01-27 21:19:54.404995 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 21:19:54.709980 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:19:54.721630 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:19:54.721799 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 21:19:54.721936 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 21:19:55.341057 (ThreadPoolExecutor-1_0): subprocess 538 is still running
2021-01-27 21:19:59.204810 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.48 seconds
2021-01-27 21:19:59.658278 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 21:19:59.954743 (MainThread): Using snowflake connection "master".
2021-01-27 21:19:59.954942 (MainThread): On master: BEGIN
2021-01-27 21:19:59.955051 (MainThread): Opening a new connection, currently in state init
2021-01-27 21:20:01.044504 (MainThread): subprocess 639 is still running
2021-01-27 21:20:05.214891 (MainThread): SQL status: SUCCESS 1 in 5.26 seconds
2021-01-27 21:20:05.215675 (MainThread): On master: COMMIT
2021-01-27 21:20:05.216445 (MainThread): Using snowflake connection "master".
2021-01-27 21:20:05.216780 (MainThread): On master: COMMIT
2021-01-27 21:20:05.576689 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 21:20:05.577516 (MainThread): On master: Close
2021-01-27 21:20:06.053990 (MainThread): 16:20:06 | Concurrency: 1 threads (target='snowflake')
2021-01-27 21:20:06.054760 (MainThread): 16:20:06 | 
2021-01-27 21:20:06.059558 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:20:06.078003 (Thread-1): 16:20:06 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 21:20:06.079508 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:06.080301 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:20:06.108971 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:20:06.109364 (Thread-1): finished collecting timing info
2021-01-27 21:20:06.158702 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:06.158861 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:20:06.159005 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:20:06.827016 (Thread-1): subprocess 756 is still running
2021-01-27 21:20:10.948025 (Thread-1): SQL status: SUCCESS 1 in 4.79 seconds
2021-01-27 21:20:11.001624 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:11.002287 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:20:11.218469 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 21:20:11.229573 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:11.229959 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 21:20:11.423285 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 21:20:11.459787 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:11.459980 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 21:20:11.741506 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 21:20:11.768834 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:20:11.771019 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:11.771310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 21:20:12.007943 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 21:20:12.008113 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:12.008194 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed;
2021-01-27 21:20:12.461900 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-27 21:20:12.462654 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:12.463024 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed ("COL1", "COL2", "COL3")
  (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:20:13.390581 (Thread-1): SQL status: SUCCESS 2 in 0.93 seconds
2021-01-27 21:20:13.396143 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 21:20:13.396951 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:13.397390 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 21:20:14.121482 (Thread-1): SQL status: SUCCESS 1 in 0.72 seconds
2021-01-27 21:20:14.137982 (Thread-1): finished collecting timing info
2021-01-27 21:20:14.138507 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 21:20:14.462405 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9fbc4c-62f9-4f42-8437-dbcf0ed7e51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1313d3bfd0>]}
2021-01-27 21:20:14.470842 (Thread-1): 16:20:14 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 2 in 8.38s]
2021-01-27 21:20:14.471739 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:20:14.472663 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:20:14.477593 (Thread-1): 16:20:14 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 21:20:14.478574 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:14.478944 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:20:14.493191 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:20:14.493568 (Thread-1): finished collecting timing info
2021-01-27 21:20:14.510447 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:14.510613 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 21:20:14.510706 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:20:15.233191 (Thread-1): subprocess 856 is still running
2021-01-27 21:20:19.859542 (Thread-1): SQL status: SUCCESS 1 in 5.35 seconds
2021-01-27 21:20:19.882680 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:19.883628 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:20:20.525382 (Thread-1): SQL status: SUCCESS 3 in 0.64 seconds
2021-01-27 21:20:20.543327 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:20.543908 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 21:20:20.902789 (Thread-1): SQL status: SUCCESS 4 in 0.36 seconds
2021-01-27 21:20:20.906336 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:20.906460 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 21:20:21.419459 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-27 21:20:21.464707 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:20:21.465632 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:21.465740 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 21:20:21.676478 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 21:20:21.677128 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:21.677606 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 21:20:23.363018 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-01-27 21:20:23.369719 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:20:23.370662 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:23.371129 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:20:23.648097 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 21:20:23.663189 (Thread-1): finished collecting timing info
2021-01-27 21:20:23.664208 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 21:20:23.939364 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9fbc4c-62f9-4f42-8437-dbcf0ed7e51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13137ad518>]}
2021-01-27 21:20:23.948263 (Thread-1): 16:20:23 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 9.46s]
2021-01-27 21:20:23.949205 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:20:23.949850 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:20:23.954475 (Thread-1): 16:20:23 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 21:20:23.955173 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:23.955433 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:20:23.969730 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:20:23.970198 (Thread-1): finished collecting timing info
2021-01-27 21:20:23.986696 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:23.986869 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:20:23.986963 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:20:24.669018 (Thread-1): subprocess 986 is still running
2021-01-27 21:20:28.283133 (Thread-1): SQL status: SUCCESS 1 in 4.30 seconds
2021-01-27 21:20:28.308165 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:28.308831 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:20:28.479994 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-27 21:20:28.484683 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:28.484863 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 21:20:29.050816 (Thread-1): SQL status: SUCCESS 3 in 0.57 seconds
2021-01-27 21:20:29.054662 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:29.054783 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 21:20:29.280557 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 21:20:29.289425 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:20:29.294176 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:29.294866 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 21:20:29.713486 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-27 21:20:29.714158 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:29.714673 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 21:20:30.225802 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-27 21:20:30.226682 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:30.227134 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:20:31.089948 (Thread-1): SQL status: SUCCESS 2 in 0.86 seconds
2021-01-27 21:20:31.095320 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:20:31.096145 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:31.096587 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:20:31.803206 (Thread-1): SQL status: SUCCESS 1 in 0.71 seconds
2021-01-27 21:20:31.806472 (Thread-1): finished collecting timing info
2021-01-27 21:20:31.806845 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 21:20:32.069222 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9fbc4c-62f9-4f42-8437-dbcf0ed7e51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1311f9fe80>]}
2021-01-27 21:20:32.076929 (Thread-1): 16:20:32 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.11s]
2021-01-27 21:20:32.077849 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:20:32.079163 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:20:32.087127 (Thread-1): 16:20:32 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 21:20:32.088203 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:32.088603 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:20:32.114874 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:20:32.117307 (Thread-1): finished collecting timing info
2021-01-27 21:20:32.147141 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:32.147372 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 21:20:32.147537 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:20:32.719512 (Thread-1): subprocess 1084 is still running
2021-01-27 21:20:36.304814 (Thread-1): SQL status: SUCCESS 1 in 4.16 seconds
2021-01-27 21:20:36.329194 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:36.329831 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:20:36.685043 (Thread-1): SQL status: SUCCESS 3 in 0.35 seconds
2021-01-27 21:20:36.689048 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:36.689222 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 21:20:37.085587 (Thread-1): SQL status: SUCCESS 2 in 0.40 seconds
2021-01-27 21:20:37.103073 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:37.103806 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 21:20:37.597588 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 21:20:37.606311 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:20:37.610425 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:37.610997 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 21:20:38.109726 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-27 21:20:38.110576 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:38.111040 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 21:20:39.237180 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-01-27 21:20:39.242824 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:20:39.243631 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:39.244076 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:20:39.409195 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-27 21:20:39.425663 (Thread-1): finished collecting timing info
2021-01-27 21:20:39.427488 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 21:20:39.713618 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9fbc4c-62f9-4f42-8437-dbcf0ed7e51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131380f630>]}
2021-01-27 21:20:39.723138 (Thread-1): 16:20:39 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 7.62s]
2021-01-27 21:20:39.724300 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:20:39.724903 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:20:39.729529 (Thread-1): 16:20:39 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 21:20:39.730340 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:39.730620 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:20:39.745401 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:20:39.745770 (Thread-1): finished collecting timing info
2021-01-27 21:20:39.761912 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:39.762081 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:20:39.762188 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:20:40.412114 (Thread-1): subprocess 1182 is still running
2021-01-27 21:20:44.869659 (Thread-1): SQL status: SUCCESS 1 in 5.11 seconds
2021-01-27 21:20:44.881208 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:44.881429 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:20:45.103531 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 21:20:45.108327 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:45.108544 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 21:20:45.585090 (Thread-1): SQL status: SUCCESS 3 in 0.48 seconds
2021-01-27 21:20:45.603052 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:45.603638 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 21:20:45.872344 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 21:20:45.880767 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:20:45.884819 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:45.885338 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 21:20:46.071465 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 21:20:46.071671 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:46.071781 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 21:20:47.429069 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-27 21:20:47.435095 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:20:47.435932 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:47.436376 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:20:48.246937 (Thread-1): SQL status: SUCCESS 1 in 0.81 seconds
2021-01-27 21:20:48.262693 (Thread-1): finished collecting timing info
2021-01-27 21:20:48.263720 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 21:20:48.528073 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f9fbc4c-62f9-4f42-8437-dbcf0ed7e51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13137d7748>]}
2021-01-27 21:20:48.533687 (Thread-1): 16:20:48 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.80s]
2021-01-27 21:20:48.534182 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:20:48.563672 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:20:48.564169 (MainThread): Using snowflake connection "master".
2021-01-27 21:20:48.564355 (MainThread): On master: BEGIN
2021-01-27 21:20:48.564518 (MainThread): Opening a new connection, currently in state closed
2021-01-27 21:20:49.150957 (MainThread): subprocess 1285 is still running
2021-01-27 21:20:53.161297 (MainThread): SQL status: SUCCESS 1 in 4.60 seconds
2021-01-27 21:20:53.162020 (MainThread): On master: COMMIT
2021-01-27 21:20:53.162775 (MainThread): Using snowflake connection "master".
2021-01-27 21:20:53.163089 (MainThread): On master: COMMIT
2021-01-27 21:20:53.775883 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-01-27 21:20:53.776706 (MainThread): On master: Close
2021-01-27 21:20:54.060760 (MainThread): 16:20:54 | 
2021-01-27 21:20:54.061087 (MainThread): 16:20:54 | Finished running 5 snowflake_timetravel_table models in 64.52s.
2021-01-27 21:20:54.061283 (MainThread): Connection 'master' was properly closed.
2021-01-27 21:20:54.061420 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 21:20:54.108214 (MainThread): 
2021-01-27 21:20:54.108420 (MainThread): Completed successfully
2021-01-27 21:20:54.108541 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 21:20:54.108799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1311f9e9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1311f9e518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1311f9ea58>]}
2021-01-27 21:20:54.109061 (MainThread): Flushing usage events
2021-01-27 21:20:55.821181 (MainThread): Running with dbt=0.18.1
2021-01-27 21:20:56.282972 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-27 21:20:56.283869 (MainThread): Tracking: tracking
2021-01-27 21:20:56.284217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bd38c978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bd38c588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bd38c5c0>]}
2021-01-27 21:20:56.327149 (MainThread): Partial parsing not enabled
2021-01-27 21:20:56.328261 (MainThread): Parsing macros/catalog.sql
2021-01-27 21:20:56.330970 (MainThread): Parsing macros/adapters.sql
2021-01-27 21:20:56.367405 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 21:20:56.369259 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 21:20:56.380303 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 21:20:56.382547 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 21:20:56.387847 (MainThread): Parsing macros/core.sql
2021-01-27 21:20:56.391968 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 21:20:56.393980 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 21:20:56.395782 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 21:20:56.397899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 21:20:56.402194 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 21:20:56.412653 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 21:20:56.419570 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 21:20:56.424989 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 21:20:56.443005 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 21:20:56.444910 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 21:20:56.474431 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 21:20:56.481163 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 21:20:56.487384 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 21:20:56.489379 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 21:20:56.503963 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 21:20:56.528679 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 21:20:56.538232 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 21:20:56.539961 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 21:20:56.540975 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 21:20:56.543138 (MainThread): Parsing macros/etc/query.sql
2021-01-27 21:20:56.544244 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 21:20:56.545966 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 21:20:56.590665 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 21:20:56.605846 (MainThread): Partial parsing not enabled
2021-01-27 21:20:56.648601 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:20:56.673290 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:20:56.687554 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:20:56.701048 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:20:56.714371 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:20:56.972617 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 21:20:56.973716 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-27 21:20:56.973999 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bd17cb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bd17ccf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4bd17ccc0>]}
2021-01-27 21:20:56.974301 (MainThread): Flushing usage events
2021-01-27 21:20:57.775980 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 21:28:12.806813 (MainThread): Running with dbt=0.18.1
2021-01-27 21:28:13.270114 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 21:28:13.270479 (MainThread): Tracking: tracking
2021-01-27 21:28:13.270622 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a74761978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6daf87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6daf8c88>]}
2021-01-27 21:28:13.271191 (MainThread): Set downloads directory='/tmp/dbt-downloads-95vedon6'
2021-01-27 21:28:13.284445 (MainThread): Installing ../../
2021-01-27 21:28:13.284723 (MainThread):   Creating symlink to local dependency.
2021-01-27 21:28:13.284854 (MainThread):   Installed from <local @ ../../>

2021-01-27 21:28:13.284992 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '05de8819-0be0-4926-8aec-281cea6c2c46', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6daf8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6da505f8>]}
2021-01-27 21:28:13.285339 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6daf3dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a74761978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a6daf8c88>]}
2021-01-27 21:28:13.285497 (MainThread): Flushing usage events
2021-01-27 21:28:15.002280 (MainThread): Running with dbt=0.18.1
2021-01-27 21:28:15.476204 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 21:28:15.477082 (MainThread): Tracking: tracking
2021-01-27 21:28:15.477424 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd72d50908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd72d50518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd72d50550>]}
2021-01-27 21:28:15.520992 (MainThread): Partial parsing not enabled
2021-01-27 21:28:15.522083 (MainThread): Parsing macros/catalog.sql
2021-01-27 21:28:15.524880 (MainThread): Parsing macros/adapters.sql
2021-01-27 21:28:15.559414 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 21:28:15.561218 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 21:28:15.572091 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 21:28:15.574507 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 21:28:15.579753 (MainThread): Parsing macros/core.sql
2021-01-27 21:28:15.584262 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 21:28:15.586325 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 21:28:15.588112 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 21:28:15.590228 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 21:28:15.594524 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 21:28:15.605129 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 21:28:15.612248 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 21:28:15.617695 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 21:28:15.635902 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 21:28:15.637879 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 21:28:15.666407 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 21:28:15.673332 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 21:28:15.679501 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 21:28:15.681541 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 21:28:15.696958 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 21:28:15.719305 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 21:28:15.728425 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 21:28:15.730128 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 21:28:15.731113 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 21:28:15.733320 (MainThread): Parsing macros/etc/query.sql
2021-01-27 21:28:15.734359 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 21:28:15.736097 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 21:28:15.781326 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 21:28:15.796805 (MainThread): Partial parsing not enabled
2021-01-27 21:28:15.837933 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:28:15.860721 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:28:15.872815 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:15.884823 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:15.897241 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:28:16.153956 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 21:28:16.154736 (MainThread): 
2021-01-27 21:28:16.155103 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:28:16.162473 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 21:28:16.177091 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 21:28:16.177236 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 21:28:16.177324 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 21:28:16.908347 (ThreadPoolExecutor-0_0): subprocess 4144 is still running
2021-01-27 21:28:21.271540 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.09 seconds
2021-01-27 21:28:21.320350 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 21:28:21.834675 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:28:21.846419 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:28:21.846593 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 21:28:21.846708 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 21:28:22.484230 (ThreadPoolExecutor-1_0): subprocess 4242 is still running
2021-01-27 21:28:28.270741 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 6.42 seconds
2021-01-27 21:28:28.941997 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 21:28:29.506549 (MainThread): Using snowflake connection "master".
2021-01-27 21:28:29.506826 (MainThread): On master: BEGIN
2021-01-27 21:28:29.506993 (MainThread): Opening a new connection, currently in state init
2021-01-27 21:28:30.160411 (MainThread): subprocess 4343 is still running
2021-01-27 21:28:34.782265 (MainThread): SQL status: SUCCESS 1 in 5.28 seconds
2021-01-27 21:28:34.782670 (MainThread): On master: COMMIT
2021-01-27 21:28:34.782935 (MainThread): Using snowflake connection "master".
2021-01-27 21:28:34.783035 (MainThread): On master: COMMIT
2021-01-27 21:28:35.520367 (MainThread): SQL status: SUCCESS 1 in 0.74 seconds
2021-01-27 21:28:35.521297 (MainThread): On master: Close
2021-01-27 21:28:35.978595 (MainThread): 16:28:35 | Concurrency: 1 threads (target='snowflake')
2021-01-27 21:28:35.979565 (MainThread): 16:28:35 | 
2021-01-27 21:28:35.987499 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:28:35.993098 (Thread-1): 16:28:35 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 21:28:35.993868 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:35.994268 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:28:36.021061 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:28:36.021439 (Thread-1): finished collecting timing info
2021-01-27 21:28:36.074403 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:36.074580 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, '100'::int as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:28:36.074683 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:28:37.206870 (Thread-1): subprocess 4445 is still running
2021-01-27 21:28:42.460887 (Thread-1): SQL status: SUCCESS 1 in 6.39 seconds
2021-01-27 21:28:42.483077 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:42.483322 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:28:42.973879 (Thread-1): SQL status: SUCCESS 3 in 0.49 seconds
2021-01-27 21:28:42.987831 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:42.988256 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 21:28:43.490027 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-01-27 21:28:43.527638 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:43.527842 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 21:28:43.998075 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-27 21:28:44.012729 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:28:44.013893 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:44.014030 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 21:28:44.507237 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 21:28:44.507421 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:44.507502 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed;
2021-01-27 21:28:45.256978 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-01-27 21:28:45.257844 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:28:45.258337 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed ("COL1", "COL2", "COL3")
  (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, '100'::int as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:28:45.943014 (Thread-1): Snowflake query id: 0199e5c8-054e-1c30-0000-44a938a07b8a
2021-01-27 21:28:45.943629 (Thread-1): Snowflake error: 100038 (22018): Numeric value 'new' is not recognized
2021-01-27 21:28:45.944579 (Thread-1): finished collecting timing info
2021-01-27 21:28:45.946737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: ROLLBACK
2021-01-27 21:28:46.458938 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 21:28:46.762644 (Thread-1): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  100038 (22018): Numeric value 'new' is not recognized
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 100038 (22018): Numeric value 'new' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 152, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
  100038 (22018): Numeric value 'new' is not recognized
  compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 21:28:46.766515 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72f68a4-61f6-434d-b9fd-2d28127f3ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70d715f8>]}
2021-01-27 21:28:46.770163 (Thread-1): 16:28:46 | 1 of 5 ERROR creating snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [ERROR in 10.77s]
2021-01-27 21:28:46.770516 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:28:46.770870 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:28:46.773310 (Thread-1): 16:28:46 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 21:28:46.773796 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:46.773978 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:28:46.784354 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:28:46.784708 (Thread-1): finished collecting timing info
2021-01-27 21:28:46.799168 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:46.799349 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 21:28:46.799466 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:28:47.436708 (Thread-1): subprocess 4543 is still running
2021-01-27 21:28:51.265173 (Thread-1): SQL status: SUCCESS 1 in 4.47 seconds
2021-01-27 21:28:51.270798 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:51.270964 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:28:51.578147 (Thread-1): SQL status: SUCCESS 3 in 0.31 seconds
2021-01-27 21:28:51.595097 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:51.595465 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 21:28:52.014289 (Thread-1): SQL status: SUCCESS 4 in 0.42 seconds
2021-01-27 21:28:52.032308 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:52.032928 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 21:28:52.333153 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 21:28:52.347811 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:28:52.348750 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:52.348865 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 21:28:52.594658 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 21:28:52.595137 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:52.595398 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 21:28:53.959917 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-27 21:28:53.963673 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:28:53.964147 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:28:53.964333 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:28:54.130999 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 21:28:54.146262 (Thread-1): finished collecting timing info
2021-01-27 21:28:54.146658 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 21:28:54.547725 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72f68a4-61f6-434d-b9fd-2d28127f3ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70d715f8>]}
2021-01-27 21:28:54.555676 (Thread-1): 16:28:54 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 7.77s]
2021-01-27 21:28:54.556624 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:28:54.557648 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:28:54.564368 (Thread-1): 16:28:54 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 21:28:54.565401 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:28:54.565836 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:28:54.581202 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:28:54.581622 (Thread-1): finished collecting timing info
2021-01-27 21:28:54.599048 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:28:54.599210 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:28:54.599308 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:28:55.225002 (Thread-1): subprocess 4640 is still running
2021-01-27 21:28:59.255461 (Thread-1): SQL status: SUCCESS 1 in 4.66 seconds
2021-01-27 21:28:59.284097 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:28:59.284742 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:28:59.486750 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 21:28:59.502752 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:28:59.503113 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 21:28:59.977011 (Thread-1): SQL status: SUCCESS 3 in 0.47 seconds
2021-01-27 21:28:59.985322 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:28:59.985562 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 21:29:00.207070 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 21:29:00.210681 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:29:00.212988 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:29:00.213231 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 21:29:00.687909 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-27 21:29:00.688139 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:29:00.688258 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 21:29:01.304838 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-27 21:29:01.305505 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:29:01.305869 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:29:02.002071 (Thread-1): SQL status: SUCCESS 2 in 0.70 seconds
2021-01-27 21:29:02.008633 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:29:02.009509 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:29:02.009957 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:29:02.544493 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-01-27 21:29:02.547624 (Thread-1): finished collecting timing info
2021-01-27 21:29:02.547984 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 21:29:02.845227 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72f68a4-61f6-434d-b9fd-2d28127f3ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd703c7d30>]}
2021-01-27 21:29:02.857968 (Thread-1): 16:29:02 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.28s]
2021-01-27 21:29:02.858652 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:29:02.859250 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:29:02.862430 (Thread-1): 16:29:02 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 21:29:02.863569 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:02.863838 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:29:02.877145 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:29:02.877512 (Thread-1): finished collecting timing info
2021-01-27 21:29:02.893233 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:02.893416 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 21:29:02.893521 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:29:03.531615 (Thread-1): subprocess 4738 is still running
2021-01-27 21:29:07.753068 (Thread-1): SQL status: SUCCESS 1 in 4.86 seconds
2021-01-27 21:29:07.758284 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:07.758509 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:29:07.962082 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 21:29:07.970901 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:07.971153 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 21:29:08.475493 (Thread-1): SQL status: SUCCESS 2 in 0.50 seconds
2021-01-27 21:29:08.494961 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:08.495562 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 21:29:08.854345 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 21:29:08.866538 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:29:08.870874 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:08.871415 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 21:29:09.294496 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-27 21:29:09.295434 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:09.296641 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 21:29:12.583697 (Thread-1): SQL status: SUCCESS 1 in 3.29 seconds
2021-01-27 21:29:12.585051 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:29:12.585257 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:29:12.585383 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:29:12.745818 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-27 21:29:12.749358 (Thread-1): finished collecting timing info
2021-01-27 21:29:12.749778 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 21:29:13.027891 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72f68a4-61f6-434d-b9fd-2d28127f3ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70371be0>]}
2021-01-27 21:29:13.029376 (Thread-1): 16:29:13 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 10.16s]
2021-01-27 21:29:13.029566 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:29:13.029798 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:29:13.030948 (Thread-1): 16:29:13 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 21:29:13.031330 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:13.031466 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:29:13.040755 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:29:13.041178 (Thread-1): finished collecting timing info
2021-01-27 21:29:13.055539 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:13.055699 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:29:13.055810 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:29:13.802401 (Thread-1): subprocess 4844 is still running
2021-01-27 21:29:18.273094 (Thread-1): SQL status: SUCCESS 1 in 5.22 seconds
2021-01-27 21:29:18.295323 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:18.295683 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:29:18.505837 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 21:29:18.523036 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:18.523712 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 21:29:18.767628 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 21:29:18.785482 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:18.786599 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 21:29:19.247910 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-27 21:29:19.257242 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:29:19.261583 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:19.262103 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 21:29:19.466845 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 21:29:19.467067 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:19.467204 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 21:29:20.656735 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-01-27 21:29:20.660458 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:29:20.661031 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:29:20.661324 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:29:20.837299 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 21:29:20.850287 (Thread-1): finished collecting timing info
2021-01-27 21:29:20.851548 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 21:29:21.379395 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72f68a4-61f6-434d-b9fd-2d28127f3ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70ce6080>]}
2021-01-27 21:29:21.384713 (Thread-1): 16:29:21 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.35s]
2021-01-27 21:29:21.385347 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:29:21.427147 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:29:21.428289 (MainThread): Using snowflake connection "master".
2021-01-27 21:29:21.429836 (MainThread): On master: BEGIN
2021-01-27 21:29:21.430278 (MainThread): Opening a new connection, currently in state closed
2021-01-27 21:29:22.274571 (MainThread): subprocess 4946 is still running
2021-01-27 21:29:26.201697 (MainThread): SQL status: SUCCESS 1 in 4.77 seconds
2021-01-27 21:29:26.202764 (MainThread): On master: COMMIT
2021-01-27 21:29:26.203967 (MainThread): Using snowflake connection "master".
2021-01-27 21:29:26.204443 (MainThread): On master: COMMIT
2021-01-27 21:29:26.908877 (MainThread): SQL status: SUCCESS 1 in 0.70 seconds
2021-01-27 21:29:26.909803 (MainThread): On master: Close
2021-01-27 21:29:27.538454 (MainThread): 16:29:27 | 
2021-01-27 21:29:27.539192 (MainThread): 16:29:27 | Finished running 5 snowflake_timetravel_table models in 71.38s.
2021-01-27 21:29:27.539684 (MainThread): Connection 'master' was properly closed.
2021-01-27 21:29:27.540021 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 21:29:27.576161 (MainThread): 
2021-01-27 21:29:27.576358 (MainThread): Completed with 1 error and 0 warnings:
2021-01-27 21:29:27.576474 (MainThread): 
2021-01-27 21:29:27.576580 (MainThread): Database Error in model snowflake_timetravel_table_integration_tests_column_types_changed (models/snowflake_timetravel_table_integration_tests_column_types_changed.sql)
2021-01-27 21:29:27.576673 (MainThread):   100038 (22018): Numeric value 'new' is not recognized
2021-01-27 21:29:27.576754 (MainThread):   compiled SQL at target/run/snowflake_timetravel_table_integration_tests/models/snowflake_timetravel_table_integration_tests_column_types_changed.sql
2021-01-27 21:29:27.576849 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2021-01-27 21:29:27.577082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70d75390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70d9d198>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd70d86a20>]}
2021-01-27 21:29:27.577335 (MainThread): Flushing usage events
2021-01-27 21:32:18.038651 (MainThread): Running with dbt=0.18.1
2021-01-27 21:32:18.499938 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 21:32:18.500284 (MainThread): Tracking: tracking
2021-01-27 21:32:18.500430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5359216978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53525b8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53525b8c88>]}
2021-01-27 21:32:18.501057 (MainThread): Set downloads directory='/tmp/dbt-downloads-hyqashv4'
2021-01-27 21:32:18.514039 (MainThread): Installing ../../
2021-01-27 21:32:18.514321 (MainThread):   Creating symlink to local dependency.
2021-01-27 21:32:18.514458 (MainThread):   Installed from <local @ ../../>

2021-01-27 21:32:18.514594 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '31a88428-489d-4cf2-8296-fd3385a5d616', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535250e3c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535250e978>]}
2021-01-27 21:32:18.514921 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53525b3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5359216978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53525b8ba8>]}
2021-01-27 21:32:18.515081 (MainThread): Flushing usage events
2021-01-27 21:32:20.259378 (MainThread): Running with dbt=0.18.1
2021-01-27 21:32:20.755783 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 21:32:20.757007 (MainThread): Tracking: tracking
2021-01-27 21:32:20.757548 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397774e908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397774e550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397774e588>]}
2021-01-27 21:32:20.814113 (MainThread): Partial parsing not enabled
2021-01-27 21:32:20.815949 (MainThread): Parsing macros/catalog.sql
2021-01-27 21:32:20.822353 (MainThread): Parsing macros/adapters.sql
2021-01-27 21:32:20.896433 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 21:32:20.898398 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 21:32:20.909911 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 21:32:20.912559 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 21:32:20.918621 (MainThread): Parsing macros/core.sql
2021-01-27 21:32:20.923406 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 21:32:20.925578 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 21:32:20.927568 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 21:32:20.929985 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 21:32:20.934969 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 21:32:20.946091 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 21:32:20.953951 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 21:32:20.960399 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 21:32:20.981596 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 21:32:20.985261 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 21:32:21.021785 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 21:32:21.030401 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 21:32:21.037975 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 21:32:21.040329 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 21:32:21.058942 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 21:32:21.084726 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 21:32:21.095614 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 21:32:21.097680 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 21:32:21.098902 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 21:32:21.101392 (MainThread): Parsing macros/etc/query.sql
2021-01-27 21:32:21.102815 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 21:32:21.104954 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 21:32:21.157488 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 21:32:21.175924 (MainThread): Partial parsing not enabled
2021-01-27 21:32:21.225956 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:32:21.253856 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:32:21.267901 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:21.282077 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:21.296510 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:32:21.551802 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 21:32:21.552548 (MainThread): 
2021-01-27 21:32:21.552945 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:32:21.560381 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 21:32:21.575624 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 21:32:21.575761 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 21:32:21.575840 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 21:32:22.453001 (ThreadPoolExecutor-0_0): subprocess 6304 is still running
2021-01-27 21:32:26.619184 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.04 seconds
2021-01-27 21:32:26.676209 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 21:32:27.657499 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:32:27.667570 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:32:27.667741 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 21:32:27.667842 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 21:32:28.394088 (ThreadPoolExecutor-1_0): subprocess 6408 is still running
2021-01-27 21:32:32.868136 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 5.20 seconds
2021-01-27 21:32:33.321008 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 21:32:33.664521 (MainThread): Using snowflake connection "master".
2021-01-27 21:32:33.664712 (MainThread): On master: BEGIN
2021-01-27 21:32:33.664834 (MainThread): Opening a new connection, currently in state init
2021-01-27 21:32:34.307789 (MainThread): subprocess 6516 is still running
2021-01-27 21:32:38.516728 (MainThread): SQL status: SUCCESS 1 in 4.85 seconds
2021-01-27 21:32:38.517847 (MainThread): On master: COMMIT
2021-01-27 21:32:38.519038 (MainThread): Using snowflake connection "master".
2021-01-27 21:32:38.519753 (MainThread): On master: COMMIT
2021-01-27 21:32:38.812303 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 21:32:38.813274 (MainThread): On master: Close
2021-01-27 21:32:39.340958 (MainThread): 16:32:39 | Concurrency: 1 threads (target='snowflake')
2021-01-27 21:32:39.341803 (MainThread): 16:32:39 | 
2021-01-27 21:32:39.346087 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:32:39.352779 (Thread-1): 16:32:39 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 21:32:39.353711 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:39.354087 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:32:39.399088 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:32:39.399499 (Thread-1): finished collecting timing info
2021-01-27 21:32:39.456835 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:39.457028 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 100::int as col2, 'values'::varchar(20) as col3
union all
select 2, 200, 'values'
  );
2021-01-27 21:32:39.457176 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:32:40.112662 (Thread-1): subprocess 6621 is still running
2021-01-27 21:32:44.148422 (Thread-1): SQL status: SUCCESS 1 in 4.69 seconds
2021-01-27 21:32:44.213256 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:44.213635 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:32:44.639646 (Thread-1): SQL status: SUCCESS 3 in 0.43 seconds
2021-01-27 21:32:44.664836 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:44.666020 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 21:32:44.862672 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 21:32:44.913847 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:44.914140 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 21:32:45.477479 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-27 21:32:45.488049 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:32:45.489401 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:45.489546 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 21:32:45.949860 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-27 21:32:45.950548 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:45.950971 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed;
2021-01-27 21:32:46.413549 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-27 21:32:46.414726 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:46.415413 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed ("COL1", "COL2", "COL3")
  (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 100::int as col2, 'values'::varchar(20) as col3
union all
select 2, 200, 'values'
  );
2021-01-27 21:32:47.506060 (Thread-1): SQL status: SUCCESS 2 in 1.09 seconds
2021-01-27 21:32:47.520315 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 21:32:47.521225 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:32:47.521713 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 21:32:48.327247 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-01-27 21:32:48.351531 (Thread-1): finished collecting timing info
2021-01-27 21:32:48.351999 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 21:32:48.628769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3f7002-ab57-446c-a8f0-e7c1bb6094a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39774e4828>]}
2021-01-27 21:32:48.636915 (Thread-1): 16:32:48 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 2 in 9.27s]
2021-01-27 21:32:48.637926 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:32:48.639000 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:32:48.646084 (Thread-1): 16:32:48 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 21:32:48.647128 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:48.647496 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:32:48.663023 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:32:48.663572 (Thread-1): finished collecting timing info
2021-01-27 21:32:48.679488 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:48.679650 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 21:32:48.679749 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:32:49.352577 (Thread-1): subprocess 6723 is still running
2021-01-27 21:32:53.140942 (Thread-1): SQL status: SUCCESS 1 in 4.46 seconds
2021-01-27 21:32:53.166250 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:53.166810 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:32:53.698056 (Thread-1): SQL status: SUCCESS 3 in 0.53 seconds
2021-01-27 21:32:53.705570 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:53.705790 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 21:32:53.946509 (Thread-1): SQL status: SUCCESS 4 in 0.24 seconds
2021-01-27 21:32:53.953331 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:53.953529 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 21:32:54.365372 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-27 21:32:54.402143 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:32:54.403231 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:54.403359 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 21:32:54.881526 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-27 21:32:54.882144 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:54.882619 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 21:32:58.021460 (Thread-1): SQL status: SUCCESS 1 in 3.14 seconds
2021-01-27 21:32:58.026979 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:32:58.027826 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:32:58.028535 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:32:58.364434 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 21:32:58.386496 (Thread-1): finished collecting timing info
2021-01-27 21:32:58.387719 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 21:32:58.662747 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3f7002-ab57-446c-a8f0-e7c1bb6094a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39756e4198>]}
2021-01-27 21:32:58.670100 (Thread-1): 16:32:58 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 10.01s]
2021-01-27 21:32:58.670996 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:32:58.671956 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:32:58.678391 (Thread-1): 16:32:58 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 21:32:58.679377 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:32:58.679745 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:32:58.695907 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:32:58.696326 (Thread-1): finished collecting timing info
2021-01-27 21:32:58.713273 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:32:58.713434 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:32:58.713529 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:32:59.379566 (Thread-1): subprocess 6820 is still running
2021-01-27 21:33:03.480806 (Thread-1): SQL status: SUCCESS 1 in 4.77 seconds
2021-01-27 21:33:03.503088 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:03.503842 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:33:03.712197 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 21:33:03.727222 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:03.727951 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 21:33:04.019857 (Thread-1): SQL status: SUCCESS 3 in 0.29 seconds
2021-01-27 21:33:04.039215 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:04.039811 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 21:33:04.258873 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 21:33:04.267731 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:33:04.272554 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:04.273096 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 21:33:04.503576 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 21:33:04.504219 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:04.504634 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 21:33:05.120918 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-27 21:33:05.121808 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:05.122543 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:33:06.005595 (Thread-1): SQL status: SUCCESS 2 in 0.88 seconds
2021-01-27 21:33:06.006780 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:33:06.006950 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:06.007031 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:33:06.652988 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-27 21:33:06.658661 (Thread-1): finished collecting timing info
2021-01-27 21:33:06.659421 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 21:33:06.923037 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3f7002-ab57-446c-a8f0-e7c1bb6094a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39756cef28>]}
2021-01-27 21:33:06.931756 (Thread-1): 16:33:06 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.24s]
2021-01-27 21:33:06.932794 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:33:06.933854 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:33:06.942119 (Thread-1): 16:33:06 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 21:33:06.943719 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:06.944299 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:33:06.964437 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:33:06.965088 (Thread-1): finished collecting timing info
2021-01-27 21:33:06.980675 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:06.980834 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 21:33:06.980929 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:33:07.623495 (Thread-1): subprocess 6915 is still running
2021-01-27 21:33:11.502316 (Thread-1): SQL status: SUCCESS 1 in 4.52 seconds
2021-01-27 21:33:11.506947 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:11.507126 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:33:11.874780 (Thread-1): SQL status: SUCCESS 3 in 0.37 seconds
2021-01-27 21:33:11.878576 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:11.878709 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 21:33:12.104123 (Thread-1): SQL status: SUCCESS 2 in 0.23 seconds
2021-01-27 21:33:12.111253 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:12.111472 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 21:33:12.371709 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 21:33:12.374854 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:33:12.376911 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:12.377153 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 21:33:12.573199 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 21:33:12.573440 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:12.573577 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 21:33:14.149853 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-01-27 21:33:14.151225 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:33:14.151425 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:14.151524 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:33:14.295949 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-01-27 21:33:14.309554 (Thread-1): finished collecting timing info
2021-01-27 21:33:14.310654 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 21:33:14.553020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3f7002-ab57-446c-a8f0-e7c1bb6094a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39745f4eb8>]}
2021-01-27 21:33:14.558808 (Thread-1): 16:33:14 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 7.61s]
2021-01-27 21:33:14.559503 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:33:14.560250 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:33:14.565650 (Thread-1): 16:33:14 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 21:33:14.566932 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:14.567271 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:33:14.583955 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:33:14.584366 (Thread-1): finished collecting timing info
2021-01-27 21:33:14.601126 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:14.601284 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:33:14.601390 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:33:15.647769 (Thread-1): subprocess 7019 is still running
2021-01-27 21:33:19.295196 (Thread-1): SQL status: SUCCESS 1 in 4.69 seconds
2021-01-27 21:33:19.320782 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:19.321503 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:33:19.560296 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 21:33:19.577585 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:19.577955 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 21:33:19.767253 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 21:33:19.790411 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:19.790902 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 21:33:20.057327 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 21:33:20.066858 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:33:20.071432 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:20.071988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 21:33:20.273224 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 21:33:20.274012 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:20.274558 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 21:33:22.038066 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-01-27 21:33:22.044594 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:33:22.045430 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:22.045901 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:33:22.204458 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-27 21:33:22.208868 (Thread-1): finished collecting timing info
2021-01-27 21:33:22.209299 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 21:33:22.438596 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b3f7002-ab57-446c-a8f0-e7c1bb6094a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39756ce278>]}
2021-01-27 21:33:22.447078 (Thread-1): 16:33:22 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.87s]
2021-01-27 21:33:22.448044 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:33:22.527326 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:33:22.528404 (MainThread): Using snowflake connection "master".
2021-01-27 21:33:22.528843 (MainThread): On master: BEGIN
2021-01-27 21:33:22.529262 (MainThread): Opening a new connection, currently in state closed
2021-01-27 21:33:23.160531 (MainThread): subprocess 7115 is still running
2021-01-27 21:33:26.929772 (MainThread): SQL status: SUCCESS 1 in 4.40 seconds
2021-01-27 21:33:26.930582 (MainThread): On master: COMMIT
2021-01-27 21:33:26.931361 (MainThread): Using snowflake connection "master".
2021-01-27 21:33:26.931699 (MainThread): On master: COMMIT
2021-01-27 21:33:27.252053 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 21:33:27.252364 (MainThread): On master: Close
2021-01-27 21:33:27.624396 (MainThread): 16:33:27 | 
2021-01-27 21:33:27.624843 (MainThread): 16:33:27 | Finished running 5 snowflake_timetravel_table models in 66.07s.
2021-01-27 21:33:27.625050 (MainThread): Connection 'master' was properly closed.
2021-01-27 21:33:27.625182 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 21:33:27.655676 (MainThread): 
2021-01-27 21:33:27.655937 (MainThread): Completed successfully
2021-01-27 21:33:27.656146 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 21:33:27.656451 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f397566b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39756950f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3975695f98>]}
2021-01-27 21:33:27.656810 (MainThread): Flushing usage events
2021-01-27 21:33:29.365725 (MainThread): Running with dbt=0.18.1
2021-01-27 21:33:29.824425 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-27 21:33:29.825370 (MainThread): Tracking: tracking
2021-01-27 21:33:29.825831 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ae1b8898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ae10b9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ae10b940>]}
2021-01-27 21:33:29.872149 (MainThread): Partial parsing not enabled
2021-01-27 21:33:29.873365 (MainThread): Parsing macros/catalog.sql
2021-01-27 21:33:29.876421 (MainThread): Parsing macros/adapters.sql
2021-01-27 21:33:29.919552 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 21:33:29.921390 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 21:33:29.932565 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 21:33:29.935072 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 21:33:29.943022 (MainThread): Parsing macros/core.sql
2021-01-27 21:33:29.947783 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 21:33:29.949886 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 21:33:29.951786 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 21:33:29.954079 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 21:33:29.958843 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 21:33:29.970270 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 21:33:29.977812 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 21:33:29.983715 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 21:33:30.002480 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 21:33:30.004887 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 21:33:30.035184 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 21:33:30.042683 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 21:33:30.049266 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 21:33:30.051246 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 21:33:30.065428 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 21:33:30.087738 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 21:33:30.096913 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 21:33:30.098681 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 21:33:30.099626 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 21:33:30.101643 (MainThread): Parsing macros/etc/query.sql
2021-01-27 21:33:30.102710 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 21:33:30.104426 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 21:33:30.152014 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 21:33:30.168228 (MainThread): Partial parsing not enabled
2021-01-27 21:33:30.210815 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:33:30.233861 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:33:30.246035 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:33:30.259630 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:33:30.272717 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:33:30.531453 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 21:33:30.532158 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-27 21:33:30.532380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03adefccc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03adefcb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03adefcd30>]}
2021-01-27 21:33:30.532578 (MainThread): Flushing usage events
2021-01-27 21:33:31.092804 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 21:46:07.414423 (MainThread): Running with dbt=0.18.1
2021-01-27 21:46:07.868059 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 21:46:07.868370 (MainThread): Tracking: tracking
2021-01-27 21:46:07.868504 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08113b978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07a4b9588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07a4b3358>]}
2021-01-27 21:46:07.869081 (MainThread): Set downloads directory='/tmp/dbt-downloads-7_n3j56m'
2021-01-27 21:46:07.882182 (MainThread): Installing ../../
2021-01-27 21:46:07.882472 (MainThread):   Creating symlink to local dependency.
2021-01-27 21:46:07.882596 (MainThread):   Installed from <local @ ../../>

2021-01-27 21:46:07.882755 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4f0d1e1-2176-4e17-9947-d6cf6bbec353', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07a40a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07a40aeb8>]}
2021-01-27 21:46:07.883069 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07a4b3dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff08113b978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff07a4b9588>]}
2021-01-27 21:46:07.883250 (MainThread): Flushing usage events
2021-01-27 21:46:09.624966 (MainThread): Running with dbt=0.18.1
2021-01-27 21:46:10.078889 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 21:46:10.079782 (MainThread): Tracking: tracking
2021-01-27 21:46:10.080152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69773b83c8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6977310a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6977310518>]}
2021-01-27 21:46:10.124082 (MainThread): Partial parsing not enabled
2021-01-27 21:46:10.125316 (MainThread): Parsing macros/catalog.sql
2021-01-27 21:46:10.128176 (MainThread): Parsing macros/adapters.sql
2021-01-27 21:46:10.162119 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 21:46:10.163896 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 21:46:10.173989 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 21:46:10.176135 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 21:46:10.180891 (MainThread): Parsing macros/core.sql
2021-01-27 21:46:10.184678 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 21:46:10.186497 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 21:46:10.188133 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 21:46:10.190108 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 21:46:10.194060 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 21:46:10.203792 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 21:46:10.210433 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 21:46:10.215716 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 21:46:10.234088 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 21:46:10.236052 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 21:46:10.268230 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 21:46:10.275439 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 21:46:10.281945 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 21:46:10.284025 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 21:46:10.298228 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 21:46:10.319745 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 21:46:10.329491 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 21:46:10.331253 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 21:46:10.332351 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 21:46:10.334606 (MainThread): Parsing macros/etc/query.sql
2021-01-27 21:46:10.335658 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 21:46:10.337354 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 21:46:10.384289 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 21:46:10.400571 (MainThread): Partial parsing not enabled
2021-01-27 21:46:10.442881 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:10.466206 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:46:10.481409 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:10.507548 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:10.526425 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:46:10.790356 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 21:46:10.791118 (MainThread): 
2021-01-27 21:46:10.791477 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:46:10.798790 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 21:46:10.813611 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 21:46:10.813773 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 21:46:10.813854 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 21:46:11.561597 (ThreadPoolExecutor-0_0): subprocess 11804 is still running
2021-01-27 21:46:15.731786 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.92 seconds
2021-01-27 21:46:15.749045 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 21:46:16.040894 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:46:16.050600 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 21:46:16.050756 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 21:46:16.050854 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 21:46:16.795660 (ThreadPoolExecutor-1_0): subprocess 11906 is still running
2021-01-27 21:46:20.631184 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.58 seconds
2021-01-27 21:46:21.126609 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 21:46:21.728714 (MainThread): Using snowflake connection "master".
2021-01-27 21:46:21.728992 (MainThread): On master: BEGIN
2021-01-27 21:46:21.729153 (MainThread): Opening a new connection, currently in state init
2021-01-27 21:46:22.352784 (MainThread): subprocess 12008 is still running
2021-01-27 21:46:26.089613 (MainThread): SQL status: SUCCESS 1 in 4.36 seconds
2021-01-27 21:46:26.090404 (MainThread): On master: COMMIT
2021-01-27 21:46:26.091181 (MainThread): Using snowflake connection "master".
2021-01-27 21:46:26.091497 (MainThread): On master: COMMIT
2021-01-27 21:46:26.530504 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-27 21:46:26.530937 (MainThread): On master: Close
2021-01-27 21:46:26.870127 (MainThread): 16:46:26 | Concurrency: 1 threads (target='snowflake')
2021-01-27 21:46:26.871100 (MainThread): 16:46:26 | 
2021-01-27 21:46:26.877640 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:46:26.887619 (Thread-1): 16:46:26 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 21:46:26.889095 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:26.889673 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:46:26.960864 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:46:26.961441 (Thread-1): finished collecting timing info
2021-01-27 21:46:27.013496 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:27.013660 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:46:27.013761 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:46:27.651833 (Thread-1): subprocess 12110 is still running
2021-01-27 21:46:31.401699 (Thread-1): SQL status: SUCCESS 1 in 4.39 seconds
2021-01-27 21:46:31.417591 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:31.417774 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:46:31.752187 (Thread-1): SQL status: SUCCESS 3 in 0.33 seconds
2021-01-27 21:46:31.770187 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:31.770567 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 21:46:31.998129 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 21:46:32.036667 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:32.036853 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 21:46:32.283333 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 21:46:32.324666 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 21:46:32.325715 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:32.325854 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 21:46:32.584107 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 21:46:32.585051 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:32.585683 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 21:46:33.603193 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-27 21:46:33.605368 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 21:46:33.605656 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:46:33.605807 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 21:46:33.757806 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-27 21:46:33.770751 (Thread-1): finished collecting timing info
2021-01-27 21:46:33.771156 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 21:46:34.021128 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28877968-de8e-40c1-b9ea-835a8f6abaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69753315f8>]}
2021-01-27 21:46:34.025882 (Thread-1): 16:46:34 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.13s]
2021-01-27 21:46:34.026466 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 21:46:34.027091 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:46:34.031512 (Thread-1): 16:46:34 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 21:46:34.032532 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:34.032933 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:46:34.053625 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:46:34.054086 (Thread-1): finished collecting timing info
2021-01-27 21:46:34.070411 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:34.070574 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 21:46:34.070668 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:46:34.702476 (Thread-1): subprocess 12211 is still running
2021-01-27 21:46:38.890886 (Thread-1): SQL status: SUCCESS 1 in 4.82 seconds
2021-01-27 21:46:38.898945 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:38.899150 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:46:39.309994 (Thread-1): SQL status: SUCCESS 3 in 0.41 seconds
2021-01-27 21:46:39.325326 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:39.325792 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 21:46:39.950122 (Thread-1): SQL status: SUCCESS 4 in 0.62 seconds
2021-01-27 21:46:39.963357 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:39.963818 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 21:46:40.959652 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-27 21:46:40.963976 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 21:46:40.966275 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:40.966611 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 21:46:41.216353 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 21:46:41.216583 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:41.216724 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 21:46:43.158989 (Thread-1): SQL status: SUCCESS 1 in 1.94 seconds
2021-01-27 21:46:43.162668 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:46:43.163060 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:46:43.163265 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 21:46:43.397130 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 21:46:43.412755 (Thread-1): finished collecting timing info
2021-01-27 21:46:43.414613 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 21:46:43.717684 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28877968-de8e-40c1-b9ea-835a8f6abaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69752a6550>]}
2021-01-27 21:46:43.722240 (Thread-1): 16:46:43 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 9.68s]
2021-01-27 21:46:43.722755 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 21:46:43.723363 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:46:43.726727 (Thread-1): 16:46:43 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 21:46:43.727484 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:43.727756 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:46:43.740926 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:46:43.741291 (Thread-1): finished collecting timing info
2021-01-27 21:46:43.758524 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:43.758692 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:46:43.758807 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:46:44.387803 (Thread-1): subprocess 12445 is still running
2021-01-27 21:46:48.165567 (Thread-1): SQL status: SUCCESS 1 in 4.41 seconds
2021-01-27 21:46:48.193332 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:48.193987 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:46:48.379782 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 21:46:48.398965 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:48.399581 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 21:46:49.238726 (Thread-1): SQL status: SUCCESS 3 in 0.84 seconds
2021-01-27 21:46:49.258516 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:49.259125 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 21:46:49.534039 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 21:46:49.571407 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 21:46:49.573010 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:49.573180 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 21:46:49.791627 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 21:46:49.792432 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:49.792878 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 21:46:50.194328 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-27 21:46:50.195396 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:50.195944 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:46:50.721845 (Thread-1): SQL status: SUCCESS 2 in 0.53 seconds
2021-01-27 21:46:50.726835 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:46:50.727328 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:46:50.727574 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 21:46:51.592443 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-27 21:46:51.595507 (Thread-1): finished collecting timing info
2021-01-27 21:46:51.595858 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 21:46:51.880502 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28877968-de8e-40c1-b9ea-835a8f6abaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6975234dd8>]}
2021-01-27 21:46:51.888170 (Thread-1): 16:46:51 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.15s]
2021-01-27 21:46:51.889141 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 21:46:51.890176 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:46:51.897718 (Thread-1): 16:46:51 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 21:46:51.899498 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:46:51.900337 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:46:51.920453 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:46:51.920930 (Thread-1): finished collecting timing info
2021-01-27 21:46:51.937727 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:46:51.937888 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 21:46:51.937990 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:46:52.574915 (Thread-1): subprocess 12595 is still running
2021-01-27 21:46:58.486577 (Thread-1): SQL status: SUCCESS 1 in 6.55 seconds
2021-01-27 21:46:58.510819 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:46:58.511216 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:46:59.153363 (Thread-1): SQL status: SUCCESS 3 in 0.64 seconds
2021-01-27 21:46:59.172434 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:46:59.173274 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 21:46:59.647768 (Thread-1): SQL status: SUCCESS 2 in 0.47 seconds
2021-01-27 21:46:59.665411 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:46:59.665772 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 21:47:00.151881 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 21:47:00.160788 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 21:47:00.164672 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:47:00.165207 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 21:47:00.572670 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-27 21:47:00.572969 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:47:00.573150 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 21:47:01.701750 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-01-27 21:47:01.708332 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:47:01.709191 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:47:01.709643 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 21:47:02.001392 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 21:47:02.015043 (Thread-1): finished collecting timing info
2021-01-27 21:47:02.016842 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 21:47:02.618430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28877968-de8e-40c1-b9ea-835a8f6abaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69741ed358>]}
2021-01-27 21:47:02.620385 (Thread-1): 16:47:02 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 10.72s]
2021-01-27 21:47:02.620660 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 21:47:02.620925 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:47:02.622697 (Thread-1): 16:47:02 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 21:47:02.623186 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:02.623374 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:47:02.635319 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:47:02.635767 (Thread-1): finished collecting timing info
2021-01-27 21:47:02.654070 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:02.654311 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 21:47:02.654462 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 21:47:03.341922 (Thread-1): subprocess 12696 is still running
2021-01-27 21:47:07.252552 (Thread-1): SQL status: SUCCESS 1 in 4.60 seconds
2021-01-27 21:47:07.259926 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:07.260186 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:47:07.478341 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 21:47:07.487077 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:07.487348 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 21:47:07.706085 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 21:47:07.724231 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:07.725310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 21:47:08.547879 (Thread-1): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-27 21:47:08.558488 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 21:47:08.563109 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:08.563821 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 21:47:08.762682 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 21:47:08.763335 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:08.763759 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 21:47:10.107614 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-01-27 21:47:10.113145 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:47:10.114104 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:10.114697 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 21:47:10.302032 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 21:47:10.322710 (Thread-1): finished collecting timing info
2021-01-27 21:47:10.326166 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 21:47:10.579966 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28877968-de8e-40c1-b9ea-835a8f6abaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6975307048>]}
2021-01-27 21:47:10.594600 (Thread-1): 16:47:10 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.95s]
2021-01-27 21:47:10.595680 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 21:47:10.673613 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 21:47:10.674048 (MainThread): Using snowflake connection "master".
2021-01-27 21:47:10.674206 (MainThread): On master: BEGIN
2021-01-27 21:47:10.674406 (MainThread): Opening a new connection, currently in state closed
2021-01-27 21:47:11.331303 (MainThread): subprocess 12793 is still running
2021-01-27 21:47:15.098343 (MainThread): SQL status: SUCCESS 1 in 4.42 seconds
2021-01-27 21:47:15.099494 (MainThread): On master: COMMIT
2021-01-27 21:47:15.100841 (MainThread): Using snowflake connection "master".
2021-01-27 21:47:15.101287 (MainThread): On master: COMMIT
2021-01-27 21:47:15.418509 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 21:47:15.419628 (MainThread): On master: Close
2021-01-27 21:47:15.772420 (MainThread): 16:47:15 | 
2021-01-27 21:47:15.773441 (MainThread): 16:47:15 | Finished running 5 snowflake_timetravel_table models in 64.98s.
2021-01-27 21:47:15.774100 (MainThread): Connection 'master' was properly closed.
2021-01-27 21:47:15.774601 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 21:47:15.876961 (MainThread): 
2021-01-27 21:47:15.877302 (MainThread): Completed successfully
2021-01-27 21:47:15.877547 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 21:47:15.877996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f697534afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6975346080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6975bf8d68>]}
2021-01-27 21:47:15.878491 (MainThread): Flushing usage events
2021-01-27 21:47:17.914413 (MainThread): Running with dbt=0.18.1
2021-01-27 21:47:18.381633 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-27 21:47:18.382511 (MainThread): Tracking: tracking
2021-01-27 21:47:18.382879 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c38cb908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c38cb518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c38cb550>]}
2021-01-27 21:47:18.426678 (MainThread): Partial parsing not enabled
2021-01-27 21:47:18.427728 (MainThread): Parsing macros/catalog.sql
2021-01-27 21:47:18.430540 (MainThread): Parsing macros/adapters.sql
2021-01-27 21:47:18.464998 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 21:47:18.466843 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 21:47:18.477230 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 21:47:18.479450 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 21:47:18.484550 (MainThread): Parsing macros/core.sql
2021-01-27 21:47:18.488565 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 21:47:18.490479 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 21:47:18.492331 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 21:47:18.494464 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 21:47:18.498663 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 21:47:18.508974 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 21:47:18.515786 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 21:47:18.521267 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 21:47:18.539996 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 21:47:18.542031 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 21:47:18.572668 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 21:47:18.580254 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 21:47:18.586637 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 21:47:18.588613 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 21:47:18.603704 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 21:47:18.629950 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 21:47:18.640975 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 21:47:18.642977 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 21:47:18.644127 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 21:47:18.646589 (MainThread): Parsing macros/etc/query.sql
2021-01-27 21:47:18.647851 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 21:47:18.649880 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 21:47:18.697498 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 21:47:18.713856 (MainThread): Partial parsing not enabled
2021-01-27 21:47:18.763340 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 21:47:18.792177 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 21:47:18.806654 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 21:47:18.819394 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 21:47:18.832586 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 21:47:19.101411 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 21:47:19.102592 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-01-27 21:47:19.102920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c36bdcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c36bdcf8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c36bdd30>]}
2021-01-27 21:47:19.103250 (MainThread): Flushing usage events
2021-01-27 21:47:19.649567 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 22:07:42.289372 (MainThread): Running with dbt=0.18.1
2021-01-27 22:07:42.887959 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 22:07:42.888327 (MainThread): Tracking: tracking
2021-01-27 22:07:42.888483 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077712c978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07704b9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07704b9cc0>]}
2021-01-27 22:07:42.889129 (MainThread): Set downloads directory='/tmp/dbt-downloads-blox25bi'
2021-01-27 22:07:42.907781 (MainThread): Installing ../../
2021-01-27 22:07:42.908082 (MainThread):   Creating symlink to local dependency.
2021-01-27 22:07:42.908210 (MainThread):   Installed from <local @ ../../>

2021-01-27 22:07:42.908356 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '3f7a0b9b-7b3d-4433-8743-4f5c4e4744a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077040e358>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077040e860>]}
2021-01-27 22:07:42.908698 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077712c978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07704b3dd8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07704b3be0>]}
2021-01-27 22:07:42.908856 (MainThread): Flushing usage events
2021-01-27 22:07:44.681944 (MainThread): Running with dbt=0.18.1
2021-01-27 22:07:45.142366 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 22:07:45.143353 (MainThread): Tracking: tracking
2021-01-27 22:07:45.143696 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec80b8b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec80b8b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec80b8b588>]}
2021-01-27 22:07:45.185656 (MainThread): Partial parsing not enabled
2021-01-27 22:07:45.186743 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:07:45.189457 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:07:45.222829 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:07:45.224638 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:07:45.234568 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:07:45.236638 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:07:45.241519 (MainThread): Parsing macros/core.sql
2021-01-27 22:07:45.245394 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:07:45.247225 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:07:45.248830 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:07:45.250866 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:07:45.254860 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:07:45.264753 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:07:45.271292 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:07:45.276609 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:07:45.294689 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:07:45.296520 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:07:45.335842 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:07:45.343931 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:07:45.350917 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:07:45.353059 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:07:45.368672 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:07:45.390691 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:07:45.399754 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:07:45.401398 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:07:45.402615 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:07:45.404763 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:07:45.405903 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:07:45.407799 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:07:45.451990 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:07:45.467617 (MainThread): Partial parsing not enabled
2021-01-27 22:07:45.510175 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:07:45.533952 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:07:45.546481 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:07:45.558911 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:07:45.571629 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:07:45.591376 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:07:45.597172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec80a6b4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec809db6d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec809db710>]}
2021-01-27 22:07:45.597410 (MainThread): Flushing usage events
2021-01-27 22:07:46.661739 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 22:07:46.663152 (MainThread): Encountered an error:
2021-01-27 22:07:46.663448 (MainThread): env_var() missing 1 required positional argument: 'var'
2021-01-27 22:07:46.667215 (MainThread): Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 402, in parse_node
    self.render_update(node, config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
TypeError: env_var() missing 1 required positional argument: 'var'

2021-01-27 22:09:27.136899 (MainThread): Running with dbt=0.18.1
2021-01-27 22:09:27.599473 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 22:09:27.600359 (MainThread): Tracking: tracking
2021-01-27 22:09:27.600702 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f8c10898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f8c104a8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f8c104e0>]}
2021-01-27 22:09:27.643411 (MainThread): Partial parsing not enabled
2021-01-27 22:09:27.644602 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:09:27.647561 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:09:27.681949 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:09:27.683727 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:09:27.693840 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:09:27.696011 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:09:27.700991 (MainThread): Parsing macros/core.sql
2021-01-27 22:09:27.705052 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:09:27.707032 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:09:27.708714 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:09:27.710827 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:09:27.715132 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:09:27.725168 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:09:27.731893 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:09:27.737529 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:09:27.755424 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:09:27.757246 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:09:27.787299 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:09:27.794617 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:09:27.801021 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:09:27.803100 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:09:27.817969 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:09:27.839923 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:09:27.848781 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:09:27.850433 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:09:27.851374 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:09:27.853904 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:09:27.855011 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:09:27.856681 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:09:27.902155 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:09:27.917599 (MainThread): Partial parsing not enabled
2021-01-27 22:09:27.960563 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:09:27.985084 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:09:27.997774 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:09:28.010646 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:09:28.023656 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:09:28.043470 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:09:28.049387 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f8aec400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f8a5a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98f8a5a668>]}
2021-01-27 22:09:28.049635 (MainThread): Flushing usage events
2021-01-27 22:09:28.807172 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 22:09:28.809217 (MainThread): Encountered an error:
2021-01-27 22:09:28.809792 (MainThread): Compilation Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  Env var required but not provided: 'TIMESTAMP_AFTER_SEED'
2021-01-27 22:09:28.816621 (MainThread): Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 3, in top-level template code
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/context/base.py", line 275, in env_var
    undefined_error(msg)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 581, in undefined_error
    raise jinja2.exceptions.UndefinedError(msg)
jinja2.exceptions.UndefinedError: Env var required but not provided: 'TIMESTAMP_AFTER_SEED'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/main.py", line 255, in run_from_args
    results = task.run()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 399, in run
    self._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 748, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 349, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 402, in parse_node
    self.render_update(node, config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/parser/base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/clients/jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  Env var required but not provided: 'TIMESTAMP_AFTER_SEED'

2021-01-27 22:11:19.212611 (MainThread): Running with dbt=0.18.1
2021-01-27 22:11:19.727353 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 22:11:19.727678 (MainThread): Tracking: tracking
2021-01-27 22:11:19.727836 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4112223978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410b5b9588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410b5b9cc0>]}
2021-01-27 22:11:19.728441 (MainThread): Set downloads directory='/tmp/dbt-downloads-i1nsbhxg'
2021-01-27 22:11:19.741608 (MainThread): Installing ../../
2021-01-27 22:11:19.741898 (MainThread):   Creating symlink to local dependency.
2021-01-27 22:11:19.742027 (MainThread):   Installed from <local @ ../../>

2021-01-27 22:11:19.742178 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3ca40ac-009e-49a9-b168-99b229a616b2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410b50f390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410b50f828>]}
2021-01-27 22:11:19.742528 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410b5b97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4112223978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f410b5b32b0>]}
2021-01-27 22:11:19.742703 (MainThread): Flushing usage events
2021-01-27 22:11:21.417437 (MainThread): Running with dbt=0.18.1
2021-01-27 22:11:21.884286 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 22:11:21.885144 (MainThread): Tracking: tracking
2021-01-27 22:11:21.885479 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b011d0908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b011d0518>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b011d0550>]}
2021-01-27 22:11:21.927720 (MainThread): Partial parsing not enabled
2021-01-27 22:11:21.929000 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:11:21.931699 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:11:21.975308 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:11:21.977154 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:11:21.987157 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:11:21.989242 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:11:21.994026 (MainThread): Parsing macros/core.sql
2021-01-27 22:11:21.997870 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:11:21.999681 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:11:22.001297 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:11:22.003271 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:11:22.007498 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:11:22.017165 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:11:22.023769 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:11:22.029065 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:11:22.046591 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:11:22.048382 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:11:22.077169 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:11:22.083914 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:11:22.090181 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:11:22.092190 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:11:22.106468 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:11:22.127564 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:11:22.137205 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:11:22.139658 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:11:22.140742 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:11:22.142914 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:11:22.143962 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:11:22.145820 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:11:22.201427 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:11:22.216333 (MainThread): Partial parsing not enabled
2021-01-27 22:11:22.257842 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:22.281618 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:11:22.293790 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:22.305920 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:22.318275 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:11:22.338054 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:22.601540 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:11:22.602335 (MainThread): 
2021-01-27 22:11:22.602679 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:11:22.610079 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 22:11:22.625411 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 22:11:22.625551 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 22:11:22.625632 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 22:11:23.305684 (ThreadPoolExecutor-0_0): subprocess 21202 is still running
2021-01-27 22:11:26.987429 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.36 seconds
2021-01-27 22:11:27.026899 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 22:11:27.396428 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:11:27.405601 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:11:27.405742 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:11:27.405846 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 22:11:28.106498 (ThreadPoolExecutor-1_0): subprocess 21298 is still running
2021-01-27 22:11:31.945691 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.54 seconds
2021-01-27 22:11:32.374698 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:11:32.648841 (MainThread): Using snowflake connection "master".
2021-01-27 22:11:32.649039 (MainThread): On master: BEGIN
2021-01-27 22:11:32.649153 (MainThread): Opening a new connection, currently in state init
2021-01-27 22:11:33.259153 (MainThread): subprocess 21397 is still running
2021-01-27 22:11:37.168529 (MainThread): SQL status: SUCCESS 1 in 4.52 seconds
2021-01-27 22:11:37.168871 (MainThread): On master: COMMIT
2021-01-27 22:11:37.169209 (MainThread): Using snowflake connection "master".
2021-01-27 22:11:37.169348 (MainThread): On master: COMMIT
2021-01-27 22:11:37.451833 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 22:11:37.452362 (MainThread): On master: Close
2021-01-27 22:11:37.953647 (MainThread): 17:11:37 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:11:37.955042 (MainThread): 17:11:37 | 
2021-01-27 22:11:37.963463 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:11:37.972952 (Thread-1): 17:11:37 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 22:11:37.974005 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:37.974415 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:11:38.007476 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:11:38.007864 (Thread-1): finished collecting timing info
2021-01-27 22:11:38.059351 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:38.059544 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:11:38.059647 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:11:38.742919 (Thread-1): subprocess 21504 is still running
2021-01-27 22:11:43.158639 (Thread-1): SQL status: SUCCESS 1 in 5.10 seconds
2021-01-27 22:11:43.226282 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:43.226571 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:11:43.436920 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 22:11:43.454626 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:43.455206 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 22:11:43.670035 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 22:11:43.709804 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:43.710040 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 22:11:43.953894 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 22:11:43.993639 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:11:43.994728 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:43.994866 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 22:11:44.205450 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 22:11:44.205646 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:44.205744 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 22:11:45.568578 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-27 22:11:45.574402 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:11:45.575686 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:11:45.576405 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:11:45.761271 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 22:11:45.802945 (Thread-1): finished collecting timing info
2021-01-27 22:11:45.803431 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 22:11:46.078327 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9884ce-7cde-4855-a048-92c4846eb6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afb6b3588>]}
2021-01-27 22:11:46.085993 (Thread-1): 17:11:46 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 8.10s]
2021-01-27 22:11:46.087006 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:11:46.088012 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:11:46.095197 (Thread-1): 17:11:46 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 22:11:46.096828 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:46.097258 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:11:46.113394 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:11:46.113811 (Thread-1): finished collecting timing info
2021-01-27 22:11:46.130586 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:46.130744 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 22:11:46.130839 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:11:46.784330 (Thread-1): subprocess 21602 is still running
2021-01-27 22:11:50.520516 (Thread-1): SQL status: SUCCESS 1 in 4.39 seconds
2021-01-27 22:11:50.543848 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:50.544498 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:11:50.746711 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 22:11:50.764663 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:50.765492 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 22:11:50.992433 (Thread-1): SQL status: SUCCESS 4 in 0.23 seconds
2021-01-27 22:11:51.018837 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:51.019662 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 22:11:51.231699 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 22:11:51.240888 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:11:51.245455 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:51.246057 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 22:11:51.470836 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 22:11:51.471243 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:51.471490 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 22:11:52.810638 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-01-27 22:11:52.816189 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:11:52.817296 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:11:52.817771 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:11:53.022071 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 22:11:53.038020 (Thread-1): finished collecting timing info
2021-01-27 22:11:53.039842 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 22:11:53.582876 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9884ce-7cde-4855-a048-92c4846eb6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afb123fd0>]}
2021-01-27 22:11:53.584465 (Thread-1): 17:11:53 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 7.49s]
2021-01-27 22:11:53.584708 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:11:53.584941 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:11:53.588816 (Thread-1): 17:11:53 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 22:11:53.589402 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:53.589591 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:11:53.675305 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:11:53.675935 (Thread-1): finished collecting timing info
2021-01-27 22:11:53.695090 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:53.695360 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:11:53.695548 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:11:54.265032 (Thread-1): subprocess 21701 is still running
2021-01-27 22:11:58.282102 (Thread-1): SQL status: SUCCESS 1 in 4.59 seconds
2021-01-27 22:11:58.317933 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:58.318864 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:11:58.528619 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 22:11:58.532390 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:58.532548 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 22:11:58.763526 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 22:11:58.767601 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:58.767764 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 22:11:59.030608 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 22:11:59.038478 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:11:59.039464 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:59.039584 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 22:11:59.333772 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 22:11:59.333933 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:59.334012 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 22:11:59.851504 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-01-27 22:11:59.852286 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:11:59.852682 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:12:00.746761 (Thread-1): SQL status: SUCCESS 2 in 0.89 seconds
2021-01-27 22:12:00.748538 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:12:00.748815 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:12:00.748946 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:12:01.385830 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-27 22:12:01.391495 (Thread-1): finished collecting timing info
2021-01-27 22:12:01.392133 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 22:12:01.675796 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9884ce-7cde-4855-a048-92c4846eb6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afb17e9e8>]}
2021-01-27 22:12:01.678953 (Thread-1): 17:12:01 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.09s]
2021-01-27 22:12:01.679266 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:12:01.679523 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:12:01.681305 (Thread-1): 17:12:01 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 22:12:01.681802 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:01.681974 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:12:01.693158 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:12:01.693850 (Thread-1): finished collecting timing info
2021-01-27 22:12:01.725243 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:01.725471 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 22:12:01.725625 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:12:02.552515 (Thread-1): subprocess 21798 is still running
2021-01-27 22:12:06.223141 (Thread-1): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 22:12:06.230881 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:06.231099 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:12:06.434617 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 22:12:06.439264 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:06.439450 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 22:12:06.694501 (Thread-1): SQL status: SUCCESS 2 in 0.25 seconds
2021-01-27 22:12:06.698697 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:06.698962 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 22:12:06.933769 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 22:12:06.935535 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:12:06.936374 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:06.936489 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 22:12:07.121227 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 22:12:07.121915 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:07.122411 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 22:12:08.962349 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2021-01-27 22:12:08.964546 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:12:08.964835 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:12:08.964975 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:12:09.154722 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 22:12:09.158660 (Thread-1): finished collecting timing info
2021-01-27 22:12:09.159139 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 22:12:09.424493 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9884ce-7cde-4855-a048-92c4846eb6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afb686518>]}
2021-01-27 22:12:09.427004 (Thread-1): 17:12:09 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 7.74s]
2021-01-27 22:12:09.427273 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:12:09.427560 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:12:09.429629 (Thread-1): 17:12:09 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 22:12:09.430358 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:09.430539 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:12:09.447734 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:12:09.448188 (Thread-1): finished collecting timing info
2021-01-27 22:12:09.477962 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:09.478177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:12:09.478341 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:12:10.106977 (Thread-1): subprocess 21897 is still running
2021-01-27 22:12:13.925966 (Thread-1): SQL status: SUCCESS 1 in 4.45 seconds
2021-01-27 22:12:13.933518 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:13.933786 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:12:14.203540 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-27 22:12:14.219806 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:14.220547 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 22:12:14.427136 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 22:12:14.450353 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:14.450720 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 22:12:14.700611 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 22:12:14.711642 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:12:14.717812 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:14.718379 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 22:12:15.379272 (Thread-1): SQL status: SUCCESS 1 in 0.66 seconds
2021-01-27 22:12:15.379923 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:15.380363 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 22:12:16.821183 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-01-27 22:12:16.823578 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:12:16.823898 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:12:16.824060 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:12:16.995870 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 22:12:17.008000 (Thread-1): finished collecting timing info
2021-01-27 22:12:17.009299 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 22:12:17.274594 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9884ce-7cde-4855-a048-92c4846eb6e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b00f0bb00>]}
2021-01-27 22:12:17.281984 (Thread-1): 17:12:17 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.84s]
2021-01-27 22:12:17.282933 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:12:17.340525 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:12:17.341710 (MainThread): Using snowflake connection "master".
2021-01-27 22:12:17.342166 (MainThread): On master: BEGIN
2021-01-27 22:12:17.342710 (MainThread): Opening a new connection, currently in state closed
2021-01-27 22:12:17.990431 (MainThread): subprocess 21993 is still running
2021-01-27 22:12:21.780222 (MainThread): SQL status: SUCCESS 1 in 4.44 seconds
2021-01-27 22:12:21.781077 (MainThread): On master: COMMIT
2021-01-27 22:12:21.782005 (MainThread): Using snowflake connection "master".
2021-01-27 22:12:21.782441 (MainThread): On master: COMMIT
2021-01-27 22:12:22.137943 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 22:12:22.138883 (MainThread): On master: Close
2021-01-27 22:12:22.415206 (MainThread): 17:12:22 | 
2021-01-27 22:12:22.416134 (MainThread): 17:12:22 | Finished running 5 snowflake_timetravel_table models in 59.81s.
2021-01-27 22:12:22.416620 (MainThread): Connection 'master' was properly closed.
2021-01-27 22:12:22.416880 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 22:12:22.446717 (MainThread): 
2021-01-27 22:12:22.446962 (MainThread): Completed successfully
2021-01-27 22:12:22.447161 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 22:12:22.447514 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afb10de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afb69f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9afb69f0b8>]}
2021-01-27 22:12:22.447837 (MainThread): Flushing usage events
2021-01-27 22:21:35.369207 (MainThread): Running with dbt=0.18.1
2021-01-27 22:21:35.822648 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-27 22:21:35.823488 (MainThread): Tracking: tracking
2021-01-27 22:21:35.823835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb4d80a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb4d80a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb4d80a588>]}
2021-01-27 22:21:35.867218 (MainThread): Partial parsing not enabled
2021-01-27 22:21:35.868293 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:21:35.871091 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:21:35.906334 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:21:35.908168 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:21:35.919114 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:21:35.921518 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:21:35.926833 (MainThread): Parsing macros/core.sql
2021-01-27 22:21:35.931030 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:21:35.932932 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:21:35.934655 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:21:35.936830 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:21:35.941391 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:21:35.952524 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:21:35.962389 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:21:35.968454 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:21:35.987636 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:21:35.989796 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:21:36.021554 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:21:36.028967 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:21:36.035449 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:21:36.037444 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:21:36.052180 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:21:36.075179 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:21:36.084597 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:21:36.086381 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:21:36.087431 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:21:36.089627 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:21:36.090835 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:21:36.092847 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:21:36.140207 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:21:36.155585 (MainThread): Partial parsing not enabled
2021-01-27 22:21:36.196299 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:21:36.218942 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:21:36.230888 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:21:36.243016 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:21:36.255030 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:21:36.274960 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:21:36.526023 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:21:36.526768 (MainThread): 
2021-01-27 22:21:36.527118 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:21:36.535960 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:21:36.551573 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:21:36.551713 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:21:36.551801 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-27 22:21:37.239044 (ThreadPoolExecutor-1_0): subprocess 23895 is still running
2021-01-27 22:21:41.765707 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 5.21 seconds
2021-01-27 22:21:42.257040 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:21:42.549761 (MainThread): 17:21:42 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:21:42.550041 (MainThread): 17:21:42 | 
2021-01-27 22:21:42.551819 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:21:42.552063 (Thread-1): 17:21:42 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 22:21:42.552506 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:21:42.552704 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:21:42.575632 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:21:42.576023 (Thread-1): finished collecting timing info
2021-01-27 22:21:42.576860 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:21:42.577000 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 22:21:42.577093 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:21:43.198785 (Thread-1): subprocess 24018 is still running
2021-01-27 22:21:46.803962 (Thread-1): SQL status: SUCCESS 1 in 4.23 seconds
2021-01-27 22:21:46.804279 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:21:46.804476 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-27T22:10:09+00:00'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-27 22:21:47.014807 (Thread-1): Snowflake query id: 0199e5fd-0539-4639-0000-44a938a21bee
2021-01-27 22:21:47.015314 (Thread-1): Snowflake error: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 22:21:47.015875 (Thread-1): finished collecting timing info
2021-01-27 22:21:47.017590 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-27 22:21:47.521443 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 22:21:47.811761 (Thread-1): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 82, in execute
    failed_rows = self.execute_data_test(test)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 45, in execute_data_test
    test.injected_sql, auto_begin=True, fetch=True
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 22:21:47.818723 (Thread-1): 17:21:47 | 1 of 1 ERROR test_snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.27s]
2021-01-27 22:21:47.819375 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:21:47.877675 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:21:47.879223 (MainThread): 17:21:47 | 
2021-01-27 22:21:47.879808 (MainThread): 17:21:47 | Finished running 1 test in 11.35s.
2021-01-27 22:21:47.880369 (MainThread): Connection 'master' was properly closed.
2021-01-27 22:21:47.880742 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 22:21:47.899101 (MainThread): 
2021-01-27 22:21:47.899457 (MainThread): Completed with 1 error and 0 warnings:
2021-01-27 22:21:47.899733 (MainThread): 
2021-01-27 22:21:47.899992 (MainThread): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 22:21:47.900205 (MainThread):   000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 22:21:47.900478 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 22:21:47.900671 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-27 22:21:47.901184 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb47705208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb47705080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb47705400>]}
2021-01-27 22:21:47.901654 (MainThread): Flushing usage events
2021-01-27 22:30:08.189022 (MainThread): Running with dbt=0.18.1
2021-01-27 22:30:08.682964 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 22:30:08.683295 (MainThread): Tracking: tracking
2021-01-27 22:30:08.683443 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1886b9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a11bf8898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a11bf8cf8>]}
2021-01-27 22:30:08.684010 (MainThread): Set downloads directory='/tmp/dbt-downloads-o76a3yox'
2021-01-27 22:30:08.696753 (MainThread): Installing ../../
2021-01-27 22:30:08.697047 (MainThread):   Creating symlink to local dependency.
2021-01-27 22:30:08.697179 (MainThread):   Installed from <local @ ../../>

2021-01-27 22:30:08.697331 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cab3b2a1-4e10-4cd1-bd50-c78c36ed74d9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a11b4a438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a11b4afd0>]}
2021-01-27 22:30:08.697666 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a1886b9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a11bf8e48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a11bf8cf8>]}
2021-01-27 22:30:08.697837 (MainThread): Flushing usage events
2021-01-27 22:30:10.866681 (MainThread): Running with dbt=0.18.1
2021-01-27 22:30:11.340078 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 22:30:11.340925 (MainThread): Tracking: tracking
2021-01-27 22:30:11.341257 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6dd8c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6dd8c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6dd8c588>]}
2021-01-27 22:30:11.384823 (MainThread): Partial parsing not enabled
2021-01-27 22:30:11.385906 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:30:11.388845 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:30:11.422745 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:30:11.424427 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:30:11.434184 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:30:11.436294 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:30:11.441194 (MainThread): Parsing macros/core.sql
2021-01-27 22:30:11.445054 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:30:11.446863 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:30:11.448595 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:30:11.450623 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:30:11.454809 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:30:11.464576 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:30:11.471286 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:30:11.477152 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:30:11.495186 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:30:11.497317 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:30:11.526453 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:30:11.533283 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:30:11.539609 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:30:11.541491 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:30:11.556286 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:30:11.577967 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:30:11.587073 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:30:11.588691 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:30:11.589618 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:30:11.591675 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:30:11.592721 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:30:11.594891 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:30:11.639050 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:30:11.655208 (MainThread): Partial parsing not enabled
2021-01-27 22:30:11.697615 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:11.721210 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:11.733370 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:11.745763 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:11.758283 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:30:11.779412 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:12.037060 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:30:12.037828 (MainThread): 
2021-01-27 22:30:12.038207 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:30:12.047099 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 22:30:12.063105 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 22:30:12.063243 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 22:30:12.063327 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 22:30:12.781241 (ThreadPoolExecutor-0_0): subprocess 28234 is still running
2021-01-27 22:30:16.785827 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.72 seconds
2021-01-27 22:30:16.818488 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 22:30:17.182421 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:30:17.192639 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:30:17.192788 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:30:17.192893 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 22:30:17.820962 (ThreadPoolExecutor-1_0): subprocess 28335 is still running
2021-01-27 22:30:21.764997 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.57 seconds
2021-01-27 22:30:22.281070 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:30:22.561096 (MainThread): Using snowflake connection "master".
2021-01-27 22:30:22.561265 (MainThread): On master: BEGIN
2021-01-27 22:30:22.561365 (MainThread): Opening a new connection, currently in state init
2021-01-27 22:30:23.163617 (MainThread): subprocess 28434 is still running
2021-01-27 22:30:26.997395 (MainThread): SQL status: SUCCESS 1 in 4.44 seconds
2021-01-27 22:30:26.998042 (MainThread): On master: COMMIT
2021-01-27 22:30:26.998725 (MainThread): Using snowflake connection "master".
2021-01-27 22:30:26.999004 (MainThread): On master: COMMIT
2021-01-27 22:30:27.350311 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-27 22:30:27.350751 (MainThread): On master: Close
2021-01-27 22:30:27.630560 (MainThread): 17:30:27 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:30:27.631250 (MainThread): 17:30:27 | 
2021-01-27 22:30:27.636209 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:30:27.643201 (Thread-1): 17:30:27 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 22:30:27.644435 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:27.644961 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:30:27.684760 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:30:27.685136 (Thread-1): finished collecting timing info
2021-01-27 22:30:27.736853 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:27.737018 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:30:27.737122 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:30:28.369274 (Thread-1): subprocess 28543 is still running
2021-01-27 22:30:31.966111 (Thread-1): SQL status: SUCCESS 1 in 4.23 seconds
2021-01-27 22:30:31.988970 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:31.989159 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:30:32.278005 (Thread-1): SQL status: SUCCESS 3 in 0.29 seconds
2021-01-27 22:30:32.309411 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:32.309701 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 22:30:32.861008 (Thread-1): SQL status: SUCCESS 3 in 0.55 seconds
2021-01-27 22:30:32.883475 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:32.883718 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 22:30:33.111867 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 22:30:33.152945 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:30:33.154107 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:33.154263 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 22:30:33.472475 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 22:30:33.472697 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:33.472811 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 22:30:35.010054 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-01-27 22:30:35.016055 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:30:35.016926 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:30:35.017364 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:30:35.187520 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 22:30:35.229104 (Thread-1): finished collecting timing info
2021-01-27 22:30:35.229583 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 22:30:35.601576 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d1dad-9f66-4153-8d2b-9eddb596cec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6c0d3710>]}
2021-01-27 22:30:35.603779 (Thread-1): 17:30:35 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.96s]
2021-01-27 22:30:35.604027 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:30:35.604245 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:30:35.605719 (Thread-1): 17:30:35 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 22:30:35.606092 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:35.606246 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:30:35.615489 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:30:35.615851 (Thread-1): finished collecting timing info
2021-01-27 22:30:35.629900 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:35.630057 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 22:30:35.630153 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:30:36.264096 (Thread-1): subprocess 28666 is still running
2021-01-27 22:30:40.496446 (Thread-1): SQL status: SUCCESS 1 in 4.87 seconds
2021-01-27 22:30:40.500693 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:40.500842 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:30:40.709800 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 22:30:40.724287 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:40.724758 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 22:30:40.938459 (Thread-1): SQL status: SUCCESS 4 in 0.21 seconds
2021-01-27 22:30:40.946778 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:40.946990 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 22:30:41.747995 (Thread-1): SQL status: SUCCESS 1 in 0.80 seconds
2021-01-27 22:30:41.749669 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:30:41.750496 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:41.750598 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 22:30:41.964607 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 22:30:41.965356 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:41.965781 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 22:30:43.829831 (Thread-1): SQL status: SUCCESS 1 in 1.86 seconds
2021-01-27 22:30:43.835319 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:30:43.836237 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:30:43.836689 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:30:44.021862 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 22:30:44.044098 (Thread-1): finished collecting timing info
2021-01-27 22:30:44.045894 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 22:30:44.364788 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d1dad-9f66-4153-8d2b-9eddb596cec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6c114b00>]}
2021-01-27 22:30:44.369055 (Thread-1): 17:30:44 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 8.76s]
2021-01-27 22:30:44.369778 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:30:44.370274 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:30:44.373867 (Thread-1): 17:30:44 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 22:30:44.374551 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:44.374744 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:30:44.452348 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:30:44.453120 (Thread-1): finished collecting timing info
2021-01-27 22:30:44.480484 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:44.480678 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:30:44.480789 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:30:45.094674 (Thread-1): subprocess 28765 is still running
2021-01-27 22:30:48.934579 (Thread-1): SQL status: SUCCESS 1 in 4.45 seconds
2021-01-27 22:30:48.957743 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:48.958491 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:30:49.154292 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 22:30:49.176146 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:49.176771 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 22:30:49.545386 (Thread-1): SQL status: SUCCESS 3 in 0.37 seconds
2021-01-27 22:30:49.552475 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:49.552727 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 22:30:50.058838 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-27 22:30:50.073378 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:30:50.075280 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:50.075443 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 22:30:50.397742 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 22:30:50.397963 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:50.398083 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 22:30:51.081535 (Thread-1): SQL status: SUCCESS 1 in 0.68 seconds
2021-01-27 22:30:51.081833 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:51.081977 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:30:51.758141 (Thread-1): SQL status: SUCCESS 2 in 0.68 seconds
2021-01-27 22:30:51.764114 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:30:51.764951 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:30:51.765392 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:30:52.515103 (Thread-1): SQL status: SUCCESS 1 in 0.75 seconds
2021-01-27 22:30:52.518135 (Thread-1): finished collecting timing info
2021-01-27 22:30:52.518506 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 22:30:52.772378 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d1dad-9f66-4153-8d2b-9eddb596cec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6c17ae80>]}
2021-01-27 22:30:52.780757 (Thread-1): 17:30:52 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.40s]
2021-01-27 22:30:52.782065 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:30:52.783198 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:30:52.790116 (Thread-1): 17:30:52 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 22:30:52.791658 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:52.792063 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:30:52.809036 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:30:52.809500 (Thread-1): finished collecting timing info
2021-01-27 22:30:52.825875 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:52.826034 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 22:30:52.826131 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:30:53.470158 (Thread-1): subprocess 28862 is still running
2021-01-27 22:30:57.538547 (Thread-1): SQL status: SUCCESS 1 in 4.71 seconds
2021-01-27 22:30:57.560380 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:57.560956 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:30:57.796812 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 22:30:57.819658 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:57.820296 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 22:30:58.256383 (Thread-1): SQL status: SUCCESS 2 in 0.44 seconds
2021-01-27 22:30:58.274425 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:58.274784 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 22:30:58.640681 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-27 22:30:58.643973 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:30:58.645267 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:58.645463 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 22:30:58.966311 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-27 22:30:58.966498 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:30:58.966601 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 22:31:00.511760 (Thread-1): SQL status: SUCCESS 1 in 1.54 seconds
2021-01-27 22:31:00.518837 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:31:00.519794 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:31:00.520347 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:31:00.713735 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 22:31:00.731602 (Thread-1): finished collecting timing info
2021-01-27 22:31:00.732699 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 22:31:00.987312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d1dad-9f66-4153-8d2b-9eddb596cec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6c0741d0>]}
2021-01-27 22:31:00.990197 (Thread-1): 17:31:00 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 8.20s]
2021-01-27 22:31:00.990594 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:31:00.990902 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:31:00.993099 (Thread-1): 17:31:00 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 22:31:00.993664 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:00.993867 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:31:01.004450 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:31:01.004802 (Thread-1): finished collecting timing info
2021-01-27 22:31:01.018700 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:01.018925 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:31:01.019052 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:31:01.664206 (Thread-1): subprocess 28965 is still running
2021-01-27 22:31:05.804093 (Thread-1): SQL status: SUCCESS 1 in 4.78 seconds
2021-01-27 22:31:05.831308 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:05.832038 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:31:06.049812 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 22:31:06.066012 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:06.066678 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 22:31:06.286836 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 22:31:06.316076 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:06.316459 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 22:31:06.568502 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 22:31:06.570985 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:31:06.572334 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:06.572490 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 22:31:06.778287 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 22:31:06.778689 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:06.778963 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 22:31:08.360365 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-01-27 22:31:08.375420 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:31:08.376487 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:08.376940 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:31:08.552776 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 22:31:08.569089 (Thread-1): finished collecting timing info
2021-01-27 22:31:08.571509 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 22:31:08.828616 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '923d1dad-9f66-4153-8d2b-9eddb596cec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6c35dd30>]}
2021-01-27 22:31:08.836407 (Thread-1): 17:31:08 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.83s]
2021-01-27 22:31:08.837386 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:31:08.851258 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:31:08.852427 (MainThread): Using snowflake connection "master".
2021-01-27 22:31:08.852881 (MainThread): On master: BEGIN
2021-01-27 22:31:08.853297 (MainThread): Opening a new connection, currently in state closed
2021-01-27 22:31:09.478014 (MainThread): subprocess 29062 is still running
2021-01-27 22:31:13.729728 (MainThread): SQL status: SUCCESS 1 in 4.88 seconds
2021-01-27 22:31:13.731176 (MainThread): On master: COMMIT
2021-01-27 22:31:13.732697 (MainThread): Using snowflake connection "master".
2021-01-27 22:31:13.733395 (MainThread): On master: COMMIT
2021-01-27 22:31:14.225864 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 22:31:14.226422 (MainThread): On master: Close
2021-01-27 22:31:14.488692 (MainThread): 17:31:14 | 
2021-01-27 22:31:14.489120 (MainThread): 17:31:14 | Finished running 5 snowflake_timetravel_table models in 62.45s.
2021-01-27 22:31:14.489377 (MainThread): Connection 'master' was properly closed.
2021-01-27 22:31:14.489510 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 22:31:14.515454 (MainThread): 
2021-01-27 22:31:14.515706 (MainThread): Completed successfully
2021-01-27 22:31:14.515887 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 22:31:14.516176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6c03e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6db2ceb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d6c284a90>]}
2021-01-27 22:31:14.516478 (MainThread): Flushing usage events
2021-01-27 22:31:16.279616 (MainThread): Running with dbt=0.18.1
2021-01-27 22:31:16.727963 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-27 22:31:16.728809 (MainThread): Tracking: tracking
2021-01-27 22:31:16.729155 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f8f4b978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f8f4b588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f8f4b5c0>]}
2021-01-27 22:31:16.771167 (MainThread): Partial parsing not enabled
2021-01-27 22:31:16.772221 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:31:16.775087 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:31:16.813080 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:31:16.814896 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:31:16.825519 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:31:16.827721 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:31:16.832787 (MainThread): Parsing macros/core.sql
2021-01-27 22:31:16.836785 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:31:16.838692 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:31:16.840346 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:31:16.842605 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:31:16.846705 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:31:16.856914 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:31:16.863703 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:31:16.869119 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:31:16.887683 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:31:16.889616 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:31:16.921270 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:31:16.928759 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:31:16.935207 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:31:16.937185 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:31:16.954095 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:31:16.977707 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:31:16.987083 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:31:16.988775 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:31:16.989758 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:31:16.992003 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:31:16.993084 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:31:16.994956 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:31:17.041260 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:31:17.057574 (MainThread): Partial parsing not enabled
2021-01-27 22:31:17.100780 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:31:17.126149 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:31:17.138987 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:31:17.151792 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:31:17.164715 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:31:17.185216 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:31:17.458877 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:31:17.459625 (MainThread): 
2021-01-27 22:31:17.459954 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:31:17.469759 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:31:17.486170 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:31:17.486389 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:31:17.486506 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-27 22:31:18.367592 (ThreadPoolExecutor-1_0): subprocess 29210 is still running
2021-01-27 22:31:22.074246 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.59 seconds
2021-01-27 22:31:22.588364 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:31:22.874734 (MainThread): 17:31:22 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:31:22.875058 (MainThread): 17:31:22 | 
2021-01-27 22:31:22.876839 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:31:22.877150 (Thread-1): 17:31:22 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 22:31:22.877742 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:31:22.877968 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:31:22.908680 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:31:22.909286 (Thread-1): finished collecting timing info
2021-01-27 22:31:22.910427 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:31:22.910535 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 22:31:22.910621 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:31:23.502489 (Thread-1): subprocess 29320 is still running
2021-01-27 22:31:27.149664 (Thread-1): SQL status: SUCCESS 1 in 4.24 seconds
2021-01-27 22:31:27.149922 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:31:27.150049 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-27T22:27:35+00:00'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-27 22:31:27.356674 (Thread-1): Snowflake query id: 0199e607-0587-a1c2-0000-44a938a29a96
2021-01-27 22:31:27.356977 (Thread-1): Snowflake error: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 22:31:27.357374 (Thread-1): finished collecting timing info
2021-01-27 22:31:27.358788 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-27 22:31:27.668618 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 22:31:27.975491 (Thread-1): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 82, in execute
    failed_rows = self.execute_data_test(test)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 45, in execute_data_test
    test.injected_sql, auto_begin=True, fetch=True
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 22:31:27.979074 (Thread-1): 17:31:27 | 1 of 1 ERROR test_snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.10s]
2021-01-27 22:31:27.979348 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:31:27.993007 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:31:27.993618 (MainThread): 17:31:27 | 
2021-01-27 22:31:27.993860 (MainThread): 17:31:27 | Finished running 1 test in 10.53s.
2021-01-27 22:31:27.994022 (MainThread): Connection 'master' was properly closed.
2021-01-27 22:31:27.994127 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 22:31:28.001019 (MainThread): 
2021-01-27 22:31:28.001254 (MainThread): Completed with 1 error and 0 warnings:
2021-01-27 22:31:28.001418 (MainThread): 
2021-01-27 22:31:28.001575 (MainThread): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 22:31:28.001712 (MainThread):   000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 22:31:28.001836 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 22:31:28.001967 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-27 22:31:28.002314 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f80edf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f2e42588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f2e42710>]}
2021-01-27 22:31:28.002691 (MainThread): Flushing usage events
2021-01-27 22:36:57.258463 (MainThread): Running with dbt=0.18.1
2021-01-27 22:36:57.769091 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 22:36:57.769441 (MainThread): Tracking: tracking
2021-01-27 22:36:57.769588 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d20a7d9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19df95c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19df9cf8>]}
2021-01-27 22:36:57.770226 (MainThread): Set downloads directory='/tmp/dbt-downloads-65pfovj9'
2021-01-27 22:36:57.783363 (MainThread): Installing ../../
2021-01-27 22:36:57.783653 (MainThread):   Creating symlink to local dependency.
2021-01-27 22:36:57.783788 (MainThread):   Installed from <local @ ../../>

2021-01-27 22:36:57.783942 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4b685d3-2903-48e5-a9fe-04d0a38ba140', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19d4f470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19d4f940>]}
2021-01-27 22:36:57.784279 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19df3e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19df3c88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d19df9cf8>]}
2021-01-27 22:36:57.784439 (MainThread): Flushing usage events
2021-01-27 22:36:59.602713 (MainThread): Running with dbt=0.18.1
2021-01-27 22:37:00.072872 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 22:37:00.073885 (MainThread): Tracking: tracking
2021-01-27 22:37:00.074396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f544f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f544f5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6f544f5f8>]}
2021-01-27 22:37:00.143859 (MainThread): Partial parsing not enabled
2021-01-27 22:37:00.144899 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:37:00.147548 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:37:00.181202 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:37:00.182914 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:37:00.192970 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:37:00.195164 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:37:00.200065 (MainThread): Parsing macros/core.sql
2021-01-27 22:37:00.204419 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:37:00.206513 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:37:00.208286 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:37:00.210613 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:37:00.215974 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:37:00.227081 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:37:00.234558 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:37:00.240462 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:37:00.259004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:37:00.260943 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:37:00.291407 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:37:00.298780 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:37:00.305269 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:37:00.307231 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:37:00.322567 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:37:00.345083 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:37:00.354638 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:37:00.356369 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:37:00.357422 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:37:00.359747 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:37:00.360934 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:37:00.362911 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:37:00.412112 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:37:00.428257 (MainThread): Partial parsing not enabled
2021-01-27 22:37:00.477005 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:00.502094 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:00.514794 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:00.527185 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:00.539840 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:37:00.559931 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:00.812857 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:37:00.813613 (MainThread): 
2021-01-27 22:37:00.813949 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:37:00.821166 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 22:37:00.837047 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 22:37:00.837197 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 22:37:00.837279 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 22:37:01.563669 (ThreadPoolExecutor-0_0): subprocess 2158 is still running
2021-01-27 22:37:05.180535 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.34 seconds
2021-01-27 22:37:05.226323 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 22:37:05.523488 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:37:05.535682 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:37:05.536733 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:37:05.536989 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 22:37:06.123349 (ThreadPoolExecutor-1_0): subprocess 2265 is still running
2021-01-27 22:37:10.900805 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 5.36 seconds
2021-01-27 22:37:11.330343 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:37:11.606148 (MainThread): Using snowflake connection "master".
2021-01-27 22:37:11.606350 (MainThread): On master: BEGIN
2021-01-27 22:37:11.606454 (MainThread): Opening a new connection, currently in state init
2021-01-27 22:37:12.212253 (MainThread): subprocess 2476 is still running
2021-01-27 22:37:15.976012 (MainThread): SQL status: SUCCESS 1 in 4.37 seconds
2021-01-27 22:37:15.976251 (MainThread): On master: COMMIT
2021-01-27 22:37:15.976499 (MainThread): Using snowflake connection "master".
2021-01-27 22:37:15.976617 (MainThread): On master: COMMIT
2021-01-27 22:37:16.428069 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-27 22:37:16.429074 (MainThread): On master: Close
2021-01-27 22:37:16.673591 (MainThread): 17:37:16 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:37:16.673933 (MainThread): 17:37:16 | 
2021-01-27 22:37:16.676284 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:37:16.679002 (Thread-1): 17:37:16 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 22:37:16.679590 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:16.679936 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:37:16.710958 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:37:16.711379 (Thread-1): finished collecting timing info
2021-01-27 22:37:16.765763 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:16.765924 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:37:16.766020 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:37:17.421698 (Thread-1): subprocess 2780 is still running
2021-01-27 22:37:21.401444 (Thread-1): SQL status: SUCCESS 1 in 4.64 seconds
2021-01-27 22:37:21.454925 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:21.455242 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:37:21.641781 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 22:37:21.655620 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:21.656057 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 22:37:21.840454 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 22:37:21.878296 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:21.878494 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 22:37:22.103875 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 22:37:22.134951 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:37:22.136138 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:22.136278 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 22:37:22.354920 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 22:37:22.355165 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:22.355313 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 22:37:25.953333 (Thread-1): SQL status: SUCCESS 1 in 3.60 seconds
2021-01-27 22:37:25.958937 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:37:25.959598 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:37:25.959952 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:37:26.145329 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 22:37:26.158897 (Thread-1): finished collecting timing info
2021-01-27 22:37:26.159285 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 22:37:26.514464 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac89cdc8-a421-4136-9fe1-9afddee01c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef3278d0>]}
2021-01-27 22:37:26.517450 (Thread-1): 17:37:26 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 9.83s]
2021-01-27 22:37:26.517797 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:37:26.518163 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:37:26.520558 (Thread-1): 17:37:26 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 22:37:26.521106 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:26.521308 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:37:26.532380 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:37:26.532743 (Thread-1): finished collecting timing info
2021-01-27 22:37:26.546830 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:26.547036 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 22:37:26.547142 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:37:27.231960 (Thread-1): subprocess 2880 is still running
2021-01-27 22:37:31.381339 (Thread-1): SQL status: SUCCESS 1 in 4.83 seconds
2021-01-27 22:37:31.419012 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:31.419727 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:37:31.633387 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 22:37:31.652857 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:31.653516 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 22:37:31.840535 (Thread-1): SQL status: SUCCESS 4 in 0.19 seconds
2021-01-27 22:37:31.864046 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:31.864402 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 22:37:32.071582 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 22:37:32.080318 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:37:32.085284 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:32.085880 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 22:37:32.299213 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 22:37:32.300200 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:32.300954 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 22:37:34.058836 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-01-27 22:37:34.060038 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:37:34.060213 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:37:34.060295 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:37:34.221227 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-27 22:37:34.233085 (Thread-1): finished collecting timing info
2021-01-27 22:37:34.233937 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 22:37:34.479822 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac89cdc8-a421-4136-9fe1-9afddee01c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef3b8b00>]}
2021-01-27 22:37:34.482029 (Thread-1): 17:37:34 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 7.96s]
2021-01-27 22:37:34.482449 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:37:34.482711 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:37:34.484859 (Thread-1): 17:37:34 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 22:37:34.485578 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:34.485767 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:37:34.582933 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:37:34.583393 (Thread-1): finished collecting timing info
2021-01-27 22:37:34.603571 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:34.603786 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:37:34.603919 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:37:35.217364 (Thread-1): subprocess 2992 is still running
2021-01-27 22:37:39.129545 (Thread-1): SQL status: SUCCESS 1 in 4.53 seconds
2021-01-27 22:37:39.136170 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:39.136375 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:37:39.324860 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 22:37:39.362336 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:39.362976 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 22:37:39.580111 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 22:37:39.599023 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:39.599622 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 22:37:39.864133 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 22:37:39.872720 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:37:39.873833 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:39.873961 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 22:37:40.077230 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 22:37:40.077395 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:40.077479 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 22:37:40.513738 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-27 22:37:40.514475 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:40.514905 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:37:41.583851 (Thread-1): SQL status: SUCCESS 2 in 1.07 seconds
2021-01-27 22:37:41.589953 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:37:41.590959 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:37:41.591494 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:37:42.049250 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-27 22:37:42.064944 (Thread-1): finished collecting timing info
2021-01-27 22:37:42.066776 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 22:37:42.516124 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac89cdc8-a421-4136-9fe1-9afddee01c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6edaab4a8>]}
2021-01-27 22:37:42.518512 (Thread-1): 17:37:42 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.03s]
2021-01-27 22:37:42.518845 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:37:42.519165 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:37:42.521866 (Thread-1): 17:37:42 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 22:37:42.522512 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:42.522773 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:37:42.540968 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:37:42.541539 (Thread-1): finished collecting timing info
2021-01-27 22:37:42.575647 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:42.575899 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 22:37:42.576211 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:37:43.977340 (Thread-1): subprocess 3088 is still running
2021-01-27 22:37:48.176017 (Thread-1): SQL status: SUCCESS 1 in 5.60 seconds
2021-01-27 22:37:48.198412 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:48.199055 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:37:48.389663 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 22:37:48.407078 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:48.408025 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 22:37:48.597924 (Thread-1): SQL status: SUCCESS 2 in 0.19 seconds
2021-01-27 22:37:48.603237 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:48.603419 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 22:37:49.096008 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 22:37:49.104632 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:37:49.108791 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:49.109333 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 22:37:49.605591 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-27 22:37:49.605758 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:37:49.605841 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 22:38:09.268988 (Thread-1): SQL status: SUCCESS 1 in 19.66 seconds
2021-01-27 22:38:09.274389 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:38:09.275445 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:38:09.275903 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:38:09.513179 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 22:38:09.531119 (Thread-1): finished collecting timing info
2021-01-27 22:38:09.532151 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 22:38:09.819286 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac89cdc8-a421-4136-9fe1-9afddee01c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef3a7128>]}
2021-01-27 22:38:09.827845 (Thread-1): 17:38:09 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 27.29s]
2021-01-27 22:38:09.828811 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:38:09.830038 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:38:09.836310 (Thread-1): 17:38:09 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 22:38:09.837371 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:09.837771 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:38:09.854101 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:38:09.854534 (Thread-1): finished collecting timing info
2021-01-27 22:38:09.870188 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:09.870359 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:38:09.870467 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:38:10.603230 (Thread-1): subprocess 3196 is still running
2021-01-27 22:38:14.577469 (Thread-1): SQL status: SUCCESS 1 in 4.71 seconds
2021-01-27 22:38:14.605604 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:14.606139 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:38:14.772002 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-27 22:38:14.784421 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:14.784856 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 22:38:15.029691 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 22:38:15.055356 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:15.055689 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 22:38:15.301047 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 22:38:15.309573 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:38:15.313829 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:15.314480 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 22:38:15.583839 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 22:38:15.584837 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:15.585847 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 22:38:16.684153 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-01-27 22:38:16.690211 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:38:16.691350 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:16.691794 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:38:16.846285 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-27 22:38:16.851549 (Thread-1): finished collecting timing info
2021-01-27 22:38:16.852177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 22:38:17.105889 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac89cdc8-a421-4136-9fe1-9afddee01c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef3e39e8>]}
2021-01-27 22:38:17.114329 (Thread-1): 17:38:17 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.27s]
2021-01-27 22:38:17.115214 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:38:17.125605 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:38:17.126820 (MainThread): Using snowflake connection "master".
2021-01-27 22:38:17.127304 (MainThread): On master: BEGIN
2021-01-27 22:38:17.127999 (MainThread): Opening a new connection, currently in state closed
2021-01-27 22:38:17.792223 (MainThread): subprocess 3635 is still running
2021-01-27 22:38:21.328032 (MainThread): SQL status: SUCCESS 1 in 4.20 seconds
2021-01-27 22:38:21.329134 (MainThread): On master: COMMIT
2021-01-27 22:38:21.330470 (MainThread): Using snowflake connection "master".
2021-01-27 22:38:21.331085 (MainThread): On master: COMMIT
2021-01-27 22:38:21.641578 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-27 22:38:21.642561 (MainThread): On master: Close
2021-01-27 22:38:21.913201 (MainThread): 17:38:21 | 
2021-01-27 22:38:21.914156 (MainThread): 17:38:21 | Finished running 5 snowflake_timetravel_table models in 81.10s.
2021-01-27 22:38:21.915016 (MainThread): Connection 'master' was properly closed.
2021-01-27 22:38:21.915445 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 22:38:21.945947 (MainThread): 
2021-01-27 22:38:21.946175 (MainThread): Completed successfully
2021-01-27 22:38:21.946347 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 22:38:21.946616 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef90e160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef90eac8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ef90b550>]}
2021-01-27 22:38:21.946919 (MainThread): Flushing usage events
2021-01-27 22:38:23.756730 (MainThread): Running with dbt=0.18.1
2021-01-27 22:38:24.209774 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-27 22:38:24.210661 (MainThread): Tracking: tracking
2021-01-27 22:38:24.211027 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d7efce940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d7efce550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d7efce588>]}
2021-01-27 22:38:24.253013 (MainThread): Partial parsing not enabled
2021-01-27 22:38:24.254066 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:38:24.256845 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:38:24.290732 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:38:24.292790 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:38:24.304668 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:38:24.307185 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:38:24.313150 (MainThread): Parsing macros/core.sql
2021-01-27 22:38:24.319674 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:38:24.322675 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:38:24.324571 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:38:24.326916 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:38:24.331702 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:38:24.348302 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:38:24.356861 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:38:24.363026 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:38:24.383590 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:38:24.385700 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:38:24.416441 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:38:24.424169 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:38:24.430648 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:38:24.432632 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:38:24.449039 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:38:24.472621 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:38:24.482260 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:38:24.485206 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:38:24.486415 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:38:24.488854 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:38:24.490047 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:38:24.492010 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:38:24.546164 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:38:24.564965 (MainThread): Partial parsing not enabled
2021-01-27 22:38:24.624971 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:38:24.652566 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:38:24.668167 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:38:24.684519 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:38:24.699583 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:38:24.726369 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:38:24.985910 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:38:24.986686 (MainThread): 
2021-01-27 22:38:24.987054 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:38:24.995892 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:38:25.015494 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:38:25.015683 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:38:25.016289 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-27 22:38:25.903413 (ThreadPoolExecutor-1_0): subprocess 3787 is still running
2021-01-27 22:38:30.165080 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 5.15 seconds
2021-01-27 22:38:30.612186 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:38:30.893128 (MainThread): 17:38:30 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:38:30.893425 (MainThread): 17:38:30 | 
2021-01-27 22:38:30.895104 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:38:30.895361 (Thread-1): 17:38:30 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 22:38:30.895817 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:38:30.896011 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:38:30.922587 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:38:30.923008 (Thread-1): finished collecting timing info
2021-01-27 22:38:30.923968 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:38:30.924121 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 22:38:30.924220 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:38:31.600596 (Thread-1): subprocess 3893 is still running
2021-01-27 22:38:35.583951 (Thread-1): SQL status: SUCCESS 1 in 4.66 seconds
2021-01-27 22:38:35.584307 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:38:35.584489 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-27T22:34:53+00:00'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-27 22:38:35.835055 (Thread-1): Snowflake query id: 0199e60e-053b-4bb0-0000-44a938a2cb7a
2021-01-27 22:38:35.835235 (Thread-1): Snowflake error: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 22:38:35.835457 (Thread-1): finished collecting timing info
2021-01-27 22:38:35.836341 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-27 22:38:36.501190 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 22:38:36.737149 (Thread-1): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 82, in execute
    failed_rows = self.execute_data_test(test)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 45, in execute_data_test
    test.injected_sql, auto_begin=True, fetch=True
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 22:38:36.739755 (Thread-1): 17:38:36 | 1 of 1 ERROR test_snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 5.84s]
2021-01-27 22:38:36.740025 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:38:36.819783 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:38:36.821161 (MainThread): 17:38:36 | 
2021-01-27 22:38:36.821616 (MainThread): 17:38:36 | Finished running 1 test in 11.83s.
2021-01-27 22:38:36.822017 (MainThread): Connection 'master' was properly closed.
2021-01-27 22:38:36.822317 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 22:38:36.841194 (MainThread): 
2021-01-27 22:38:36.841823 (MainThread): Completed with 1 error and 0 warnings:
2021-01-27 22:38:36.842264 (MainThread): 
2021-01-27 22:38:36.842689 (MainThread): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 22:38:36.843273 (MainThread):   000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 22:38:36.843706 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 22:38:36.844195 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-27 22:38:36.845141 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d7cf044e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d7ceef5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d7ceef780>]}
2021-01-27 22:38:36.846071 (MainThread): Flushing usage events
2021-01-27 22:47:26.776316 (MainThread): Running with dbt=0.18.1
2021-01-27 22:47:27.244107 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 22:47:27.245005 (MainThread): Tracking: tracking
2021-01-27 22:47:27.245371 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086144a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086144a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086144a588>]}
2021-01-27 22:47:27.288433 (MainThread): Partial parsing not enabled
2021-01-27 22:47:27.289550 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:47:27.293051 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:47:27.327846 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:47:27.329562 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:47:27.343715 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:47:27.346355 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:47:27.352076 (MainThread): Parsing macros/core.sql
2021-01-27 22:47:27.356896 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:47:27.359197 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:47:27.361154 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:47:27.363438 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:47:27.368194 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:47:27.380009 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:47:27.388054 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:47:27.394265 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:47:27.414416 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:47:27.416489 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:47:27.447448 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:47:27.454682 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:47:27.466180 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:47:27.469209 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:47:27.487491 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:47:27.513156 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:47:27.523288 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:47:27.525116 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:47:27.526185 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:47:27.528400 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:47:27.529524 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:47:27.531309 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:47:27.575639 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:47:27.600798 (MainThread): Partial parsing not enabled
2021-01-27 22:47:27.675195 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:47:27.704865 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:47:27.718057 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:27.730929 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:27.744564 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:47:27.766016 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:47:28.021884 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:47:28.022786 (MainThread): 
2021-01-27 22:47:28.023139 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:47:28.030707 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 22:47:28.045980 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 22:47:28.046127 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 22:47:28.046210 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 22:47:29.023681 (ThreadPoolExecutor-0_0): subprocess 6141 is still running
2021-01-27 22:47:33.616923 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 5.57 seconds
2021-01-27 22:47:33.691600 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 22:47:34.051986 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:47:34.079063 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:47:34.079420 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:47:34.079681 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 22:47:34.697765 (ThreadPoolExecutor-1_0): subprocess 6249 is still running
2021-01-27 22:47:38.907832 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.83 seconds
2021-01-27 22:47:39.410395 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:47:39.753101 (MainThread): Using snowflake connection "master".
2021-01-27 22:47:39.753303 (MainThread): On master: BEGIN
2021-01-27 22:47:39.753421 (MainThread): Opening a new connection, currently in state init
2021-01-27 22:47:40.376221 (MainThread): subprocess 6362 is still running
2021-01-27 22:47:44.194513 (MainThread): SQL status: SUCCESS 1 in 4.44 seconds
2021-01-27 22:47:44.195865 (MainThread): On master: COMMIT
2021-01-27 22:47:44.196820 (MainThread): Using snowflake connection "master".
2021-01-27 22:47:44.197766 (MainThread): On master: COMMIT
2021-01-27 22:47:44.563166 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-27 22:47:44.564694 (MainThread): On master: Close
2021-01-27 22:47:44.833413 (MainThread): 17:47:44 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:47:44.834525 (MainThread): 17:47:44 | 
2021-01-27 22:47:44.840798 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:47:44.849934 (Thread-1): 17:47:44 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 22:47:44.851714 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:44.852603 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:47:44.917734 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:47:44.918189 (Thread-1): finished collecting timing info
2021-01-27 22:47:44.970632 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:44.970795 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:47:44.970890 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:47:45.883370 (Thread-1): subprocess 6480 is still running
2021-01-27 22:47:50.295429 (Thread-1): SQL status: SUCCESS 1 in 5.32 seconds
2021-01-27 22:47:50.322383 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:50.322654 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:47:50.521819 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-27 22:47:50.532574 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:50.532961 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 22:47:50.727105 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 22:47:50.746704 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:50.746888 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 22:47:51.006557 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 22:47:51.036218 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:47:51.037666 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:51.037826 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 22:47:51.228392 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 22:47:51.229045 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:51.229465 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed;
2021-01-27 22:47:51.731806 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-27 22:47:51.733104 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:51.735633 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed ("COL1", "COL2", "COL3")
  (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:47:52.956839 (Thread-1): SQL status: SUCCESS 2 in 1.22 seconds
2021-01-27 22:47:52.962166 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:47:52.963013 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:47:52.963453 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:47:53.735828 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-01-27 22:47:53.775789 (Thread-1): finished collecting timing info
2021-01-27 22:47:53.776390 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 22:47:54.039387 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3578a1ae-17ae-4e6f-acad-ac45621a32fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085b394fd0>]}
2021-01-27 22:47:54.047139 (Thread-1): 17:47:54 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 2 in 9.19s]
2021-01-27 22:47:54.048019 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:47:54.048957 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:47:54.053891 (Thread-1): 17:47:54 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 22:47:54.054848 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:54.055220 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:47:54.073893 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:47:54.074432 (Thread-1): finished collecting timing info
2021-01-27 22:47:54.093508 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:54.093675 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 22:47:54.093769 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:47:54.693865 (Thread-1): subprocess 6639 is still running
2021-01-27 22:47:58.911127 (Thread-1): SQL status: SUCCESS 1 in 4.82 seconds
2021-01-27 22:47:58.918520 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:58.918689 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:47:59.133675 (Thread-1): SQL status: SUCCESS 4 in 0.21 seconds
2021-01-27 22:47:59.138167 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:59.138350 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 22:47:59.393814 (Thread-1): SQL status: SUCCESS 4 in 0.26 seconds
2021-01-27 22:47:59.402443 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:59.402688 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 22:47:59.625228 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 22:47:59.627067 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:47:59.628077 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:59.628195 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 22:47:59.823148 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 22:47:59.823458 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:47:59.823642 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added;
2021-01-27 22:48:00.349515 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-01-27 22:48:00.349793 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:48:00.349929 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added ("COL1", "COL2", "COL3", "NEWCOL")
  (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 22:48:01.159396 (Thread-1): SQL status: SUCCESS 2 in 0.81 seconds
2021-01-27 22:48:01.165026 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:48:01.165831 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:48:01.166382 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 22:48:01.631522 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-27 22:48:01.642465 (Thread-1): finished collecting timing info
2021-01-27 22:48:01.643604 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 22:48:01.921632 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3578a1ae-17ae-4e6f-acad-ac45621a32fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085b94f080>]}
2021-01-27 22:48:01.930398 (Thread-1): 17:48:01 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 2 in 7.86s]
2021-01-27 22:48:01.931273 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:48:01.932209 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:48:01.937749 (Thread-1): 17:48:01 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 22:48:01.938931 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:01.939310 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:48:02.018202 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:48:02.018652 (Thread-1): finished collecting timing info
2021-01-27 22:48:02.035086 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:02.035307 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:48:02.035426 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:48:02.955991 (Thread-1): subprocess 6739 is still running
2021-01-27 22:48:07.527040 (Thread-1): SQL status: SUCCESS 1 in 5.49 seconds
2021-01-27 22:48:07.548724 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:07.549266 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:48:07.732931 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 22:48:07.750602 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:07.751196 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 22:48:08.116865 (Thread-1): SQL status: SUCCESS 3 in 0.37 seconds
2021-01-27 22:48:08.133980 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:08.134433 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 22:48:08.419047 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 22:48:08.424145 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 22:48:08.426675 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:08.426896 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 22:48:08.843507 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-27 22:48:08.844644 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:08.845402 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 22:48:09.343518 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-27 22:48:09.344293 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:09.344751 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:48:10.160974 (Thread-1): SQL status: SUCCESS 2 in 0.82 seconds
2021-01-27 22:48:10.163389 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:48:10.163723 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:48:10.163901 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 22:48:10.672371 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-27 22:48:10.676137 (Thread-1): finished collecting timing info
2021-01-27 22:48:10.676577 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 22:48:10.919178 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3578a1ae-17ae-4e6f-acad-ac45621a32fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085b3a1128>]}
2021-01-27 22:48:10.921094 (Thread-1): 17:48:10 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.98s]
2021-01-27 22:48:10.921339 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 22:48:10.921549 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:48:10.923059 (Thread-1): 17:48:10 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 22:48:10.923407 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:10.923539 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:48:10.932331 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:48:10.932679 (Thread-1): finished collecting timing info
2021-01-27 22:48:10.947072 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:10.947231 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 22:48:10.947334 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:48:11.540261 (Thread-1): subprocess 6841 is still running
2021-01-27 22:48:15.343569 (Thread-1): SQL status: SUCCESS 1 in 4.40 seconds
2021-01-27 22:48:15.366650 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:15.367021 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:48:15.667170 (Thread-1): SQL status: SUCCESS 2 in 0.30 seconds
2021-01-27 22:48:15.682692 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:15.683056 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 22:48:15.918756 (Thread-1): SQL status: SUCCESS 2 in 0.24 seconds
2021-01-27 22:48:15.935991 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:15.936211 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 22:48:16.198711 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 22:48:16.208082 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 22:48:16.215229 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:16.215607 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 22:48:16.416737 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 22:48:16.416958 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:16.417073 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed;
2021-01-27 22:48:16.839487 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-27 22:48:16.839834 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:16.840020 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed ("COL1", "COL2")
  (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 22:48:17.459928 (Thread-1): SQL status: SUCCESS 2 in 0.62 seconds
2021-01-27 22:48:17.464177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:48:17.464688 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:48:17.465014 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 22:48:18.012563 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-01-27 22:48:18.028405 (Thread-1): finished collecting timing info
2021-01-27 22:48:18.030658 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 22:48:18.320049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3578a1ae-17ae-4e6f-acad-ac45621a32fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085b3b4c88>]}
2021-01-27 22:48:18.322132 (Thread-1): 17:48:18 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 2 in 7.40s]
2021-01-27 22:48:18.322378 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 22:48:18.322662 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:48:18.324157 (Thread-1): 17:48:18 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 22:48:18.324830 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:18.325000 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:48:18.336088 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:48:18.336449 (Thread-1): finished collecting timing info
2021-01-27 22:48:18.349789 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:18.349948 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:48:18.350037 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:48:18.940605 (Thread-1): subprocess 6938 is still running
2021-01-27 22:48:22.866787 (Thread-1): SQL status: SUCCESS 1 in 4.52 seconds
2021-01-27 22:48:22.888905 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:22.889507 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:48:23.359884 (Thread-1): SQL status: SUCCESS 3 in 0.47 seconds
2021-01-27 22:48:23.376785 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:23.377373 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 22:48:23.583254 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 22:48:23.603440 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:23.603693 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 22:48:24.091179 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 22:48:24.099482 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 22:48:24.104450 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:24.104963 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 22:48:24.597644 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 22:48:24.597834 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:24.597938 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed;
2021-01-27 22:48:24.974256 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-27 22:48:24.975056 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:24.975481 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed ("COL1", "COL2RENAMED", "COL3")
  (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:48:26.088027 (Thread-1): SQL status: SUCCESS 2 in 1.11 seconds
2021-01-27 22:48:26.093790 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:48:26.094635 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:48:26.095070 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 22:48:26.857861 (Thread-1): SQL status: SUCCESS 1 in 0.76 seconds
2021-01-27 22:48:26.864095 (Thread-1): finished collecting timing info
2021-01-27 22:48:26.864771 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 22:48:27.161009 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3578a1ae-17ae-4e6f-acad-ac45621a32fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f086007cc50>]}
2021-01-27 22:48:27.163295 (Thread-1): 17:48:27 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 2 in 8.84s]
2021-01-27 22:48:27.163766 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 22:48:27.230707 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:48:27.231090 (MainThread): Using snowflake connection "master".
2021-01-27 22:48:27.231225 (MainThread): On master: BEGIN
2021-01-27 22:48:27.231351 (MainThread): Opening a new connection, currently in state closed
2021-01-27 22:48:27.910119 (MainThread): subprocess 7044 is still running
2021-01-27 22:48:31.421366 (MainThread): SQL status: SUCCESS 1 in 4.19 seconds
2021-01-27 22:48:31.422412 (MainThread): On master: COMMIT
2021-01-27 22:48:31.423448 (MainThread): Using snowflake connection "master".
2021-01-27 22:48:31.423873 (MainThread): On master: COMMIT
2021-01-27 22:48:31.712738 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 22:48:31.713975 (MainThread): On master: Close
2021-01-27 22:48:32.048099 (MainThread): 17:48:32 | 
2021-01-27 22:48:32.048389 (MainThread): 17:48:32 | Finished running 5 snowflake_timetravel_table models in 64.02s.
2021-01-27 22:48:32.048546 (MainThread): Connection 'master' was properly closed.
2021-01-27 22:48:32.048649 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 22:48:32.074011 (MainThread): 
2021-01-27 22:48:32.074232 (MainThread): Completed successfully
2021-01-27 22:48:32.074420 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 22:48:32.074771 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f085b3bada0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0859aaaf28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0859af99e8>]}
2021-01-27 22:48:32.075136 (MainThread): Flushing usage events
2021-01-27 22:59:27.370064 (MainThread): Running with dbt=0.18.1
2021-01-27 22:59:27.824347 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 22:59:27.824663 (MainThread): Tracking: tracking
2021-01-27 22:59:27.824798 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eed0bd9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee6438cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee6438be0>]}
2021-01-27 22:59:27.825348 (MainThread): Set downloads directory='/tmp/dbt-downloads-sd1kq078'
2021-01-27 22:59:27.837709 (MainThread): Installing ../../
2021-01-27 22:59:27.837964 (MainThread):   Creating symlink to local dependency.
2021-01-27 22:59:27.838084 (MainThread):   Installed from <local @ ../../>

2021-01-27 22:59:27.838231 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '564bcc17-7240-4f1f-8e08-1e5c116695a5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee638c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee638c710>]}
2021-01-27 22:59:27.838721 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eed0bd9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee6438be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee6438a58>]}
2021-01-27 22:59:27.838886 (MainThread): Flushing usage events
2021-01-27 22:59:29.538579 (MainThread): Running with dbt=0.18.1
2021-01-27 22:59:29.984667 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 22:59:29.985473 (MainThread): Tracking: tracking
2021-01-27 22:59:29.985785 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb1e0c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb1e0c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb1e0c550>]}
2021-01-27 22:59:30.030805 (MainThread): Partial parsing not enabled
2021-01-27 22:59:30.031837 (MainThread): Parsing macros/catalog.sql
2021-01-27 22:59:30.034496 (MainThread): Parsing macros/adapters.sql
2021-01-27 22:59:30.068898 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 22:59:30.070683 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 22:59:30.083548 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 22:59:30.085861 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 22:59:30.090894 (MainThread): Parsing macros/core.sql
2021-01-27 22:59:30.094972 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 22:59:30.096835 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 22:59:30.098448 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 22:59:30.100543 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 22:59:30.104610 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 22:59:30.114558 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 22:59:30.121235 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 22:59:30.126872 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 22:59:30.144849 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 22:59:30.146853 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 22:59:30.177339 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 22:59:30.184564 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 22:59:30.190990 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 22:59:30.193128 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 22:59:30.208793 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 22:59:30.231436 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 22:59:30.240880 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 22:59:30.242702 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 22:59:30.243895 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 22:59:30.246089 (MainThread): Parsing macros/etc/query.sql
2021-01-27 22:59:30.247169 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 22:59:30.249140 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 22:59:30.297650 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 22:59:30.313639 (MainThread): Partial parsing not enabled
2021-01-27 22:59:30.355505 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:59:30.379094 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 22:59:30.391244 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:30.403468 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:30.416360 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 22:59:30.437635 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 22:59:30.697913 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 22:59:30.698682 (MainThread): 
2021-01-27 22:59:30.699041 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 22:59:30.706781 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 22:59:30.722784 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 22:59:30.722933 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 22:59:30.723019 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 22:59:31.435053 (ThreadPoolExecutor-0_0): subprocess 9523 is still running
2021-01-27 22:59:35.076733 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.35 seconds
2021-01-27 22:59:35.104461 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 22:59:35.397971 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:59:35.408766 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 22:59:35.408991 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 22:59:35.409269 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 22:59:36.013033 (ThreadPoolExecutor-1_0): subprocess 9624 is still running
2021-01-27 22:59:39.963081 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.55 seconds
2021-01-27 22:59:40.512451 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 22:59:40.823586 (MainThread): Using snowflake connection "master".
2021-01-27 22:59:40.823757 (MainThread): On master: BEGIN
2021-01-27 22:59:40.823855 (MainThread): Opening a new connection, currently in state init
2021-01-27 22:59:41.478721 (MainThread): subprocess 9732 is still running
2021-01-27 22:59:45.213358 (MainThread): SQL status: SUCCESS 1 in 4.39 seconds
2021-01-27 22:59:45.213720 (MainThread): On master: COMMIT
2021-01-27 22:59:45.214093 (MainThread): Using snowflake connection "master".
2021-01-27 22:59:45.214428 (MainThread): On master: COMMIT
2021-01-27 22:59:45.833748 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-27 22:59:45.834093 (MainThread): On master: Close
2021-01-27 22:59:46.349477 (MainThread): 17:59:46 | Concurrency: 1 threads (target='snowflake')
2021-01-27 22:59:46.349726 (MainThread): 17:59:46 | 
2021-01-27 22:59:46.351144 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:59:46.353101 (Thread-1): 17:59:46 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 22:59:46.353583 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:46.353756 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:59:46.374731 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:59:46.375125 (Thread-1): finished collecting timing info
2021-01-27 22:59:46.431940 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:46.432119 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 22:59:46.432217 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:59:47.577862 (Thread-1): subprocess 9833 is still running
2021-01-27 22:59:51.425150 (Thread-1): SQL status: SUCCESS 1 in 4.99 seconds
2021-01-27 22:59:51.470396 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:51.470738 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:59:51.649282 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 22:59:51.664288 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:51.664855 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 22:59:51.897896 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-27 22:59:51.927879 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:51.928067 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 22:59:52.165773 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 22:59:52.204301 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 22:59:52.205322 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:52.205445 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 22:59:52.396308 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 22:59:52.396977 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:52.397482 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 22:59:53.562575 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-01-27 22:59:53.566622 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:59:53.567167 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 22:59:53.567437 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 22:59:53.720808 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-27 22:59:53.757117 (Thread-1): finished collecting timing info
2021-01-27 22:59:53.757578 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 22:59:54.027561 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98f4c66-ba79-45d3-a631-7904e050257f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb0106978>]}
2021-01-27 22:59:54.035512 (Thread-1): 17:59:54 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.67s]
2021-01-27 22:59:54.036444 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 22:59:54.037426 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:59:54.044668 (Thread-1): 17:59:54 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 22:59:54.045673 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:54.046050 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:59:54.062413 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:59:54.062925 (Thread-1): finished collecting timing info
2021-01-27 22:59:54.078752 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:54.078918 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 22:59:54.079012 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 22:59:54.765756 (Thread-1): subprocess 9936 is still running
2021-01-27 22:59:58.425032 (Thread-1): SQL status: SUCCESS 1 in 4.35 seconds
2021-01-27 22:59:58.451051 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:58.451696 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 22:59:58.709964 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-27 22:59:58.732819 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:58.733461 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 22:59:59.023080 (Thread-1): SQL status: SUCCESS 4 in 0.29 seconds
2021-01-27 22:59:59.044296 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:59.044740 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 22:59:59.269345 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 22:59:59.278045 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 22:59:59.282474 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:59.283007 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 22:59:59.504990 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 22:59:59.505629 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 22:59:59.506071 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 23:00:00.855416 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-01-27 23:00:00.856686 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 23:00:00.856905 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:00:00.856997 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 23:00:01.038446 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 23:00:01.054038 (Thread-1): finished collecting timing info
2021-01-27 23:00:01.056047 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 23:00:01.390282 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98f4c66-ba79-45d3-a631-7904e050257f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb0194b00>]}
2021-01-27 23:00:01.398076 (Thread-1): 18:00:01 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 7.34s]
2021-01-27 23:00:01.399095 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:00:01.400095 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:00:01.407499 (Thread-1): 18:00:01 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 23:00:01.408454 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:01.408825 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:00:01.494519 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 23:00:01.495014 (Thread-1): finished collecting timing info
2021-01-27 23:00:01.512126 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:01.512311 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:00:01.512421 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:00:02.193224 (Thread-1): subprocess 10038 is still running
2021-01-27 23:00:06.421841 (Thread-1): SQL status: SUCCESS 1 in 4.91 seconds
2021-01-27 23:00:06.442331 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:06.442856 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:00:06.702372 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-27 23:00:06.719828 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:06.720183 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 23:00:07.168816 (Thread-1): SQL status: SUCCESS 3 in 0.45 seconds
2021-01-27 23:00:07.172504 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:07.172640 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 23:00:07.425569 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 23:00:07.450710 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 23:00:07.452165 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:07.452338 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 23:00:07.714953 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 23:00:07.716088 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:07.716744 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 23:00:08.258411 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-27 23:00:08.258651 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:08.258762 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:00:08.815986 (Thread-1): SQL status: SUCCESS 2 in 0.56 seconds
2021-01-27 23:00:08.818907 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 23:00:08.819330 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:00:08.819554 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 23:00:09.445690 (Thread-1): SQL status: SUCCESS 1 in 0.63 seconds
2021-01-27 23:00:09.451196 (Thread-1): finished collecting timing info
2021-01-27 23:00:09.451790 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 23:00:10.051804 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98f4c66-ba79-45d3-a631-7904e050257f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb00842b0>]}
2021-01-27 23:00:10.053474 (Thread-1): 18:00:10 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.64s]
2021-01-27 23:00:10.053823 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:00:10.054059 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:00:10.055727 (Thread-1): 18:00:10 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 23:00:10.056212 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:10.056367 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:00:10.066432 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 23:00:10.066828 (Thread-1): finished collecting timing info
2021-01-27 23:00:10.083112 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:10.083305 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 23:00:10.083407 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:00:10.681568 (Thread-1): subprocess 10138 is still running
2021-01-27 23:00:15.116730 (Thread-1): SQL status: SUCCESS 1 in 5.03 seconds
2021-01-27 23:00:15.138508 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:15.139208 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:00:15.829188 (Thread-1): SQL status: SUCCESS 3 in 0.69 seconds
2021-01-27 23:00:15.833362 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:15.833538 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 23:00:16.078750 (Thread-1): SQL status: SUCCESS 2 in 0.25 seconds
2021-01-27 23:00:16.083163 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:16.083350 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 23:00:16.345339 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 23:00:16.348057 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 23:00:16.349490 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:16.349675 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 23:00:16.625173 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 23:00:16.625589 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:16.625850 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 23:00:17.896675 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-01-27 23:00:17.902562 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 23:00:17.903370 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:00:17.903809 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 23:00:18.072381 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 23:00:18.081848 (Thread-1): finished collecting timing info
2021-01-27 23:00:18.083671 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 23:00:18.395423 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98f4c66-ba79-45d3-a631-7904e050257f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb0332588>]}
2021-01-27 23:00:18.405288 (Thread-1): 18:00:18 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 8.34s]
2021-01-27 23:00:18.406475 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:00:18.407451 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:00:18.413430 (Thread-1): 18:00:18 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 23:00:18.414375 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:18.414748 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:00:18.430321 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 23:00:18.430791 (Thread-1): finished collecting timing info
2021-01-27 23:00:18.446504 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:18.446672 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:00:18.446817 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:00:19.297952 (Thread-1): subprocess 10242 is still running
2021-01-27 23:00:24.069651 (Thread-1): SQL status: SUCCESS 1 in 5.62 seconds
2021-01-27 23:00:24.088992 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:24.089528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:00:24.278984 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 23:00:24.292384 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:24.292886 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 23:00:24.598311 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-27 23:00:24.618654 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:24.619172 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 23:00:24.919890 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-27 23:00:24.928165 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 23:00:24.932421 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:24.932957 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 23:00:25.323241 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-27 23:00:25.324241 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:25.325001 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 23:00:27.085767 (Thread-1): SQL status: SUCCESS 1 in 1.76 seconds
2021-01-27 23:00:27.086966 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 23:00:27.087131 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:00:27.087213 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 23:00:27.293045 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 23:00:27.296796 (Thread-1): finished collecting timing info
2021-01-27 23:00:27.297293 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 23:00:27.618638 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98f4c66-ba79-45d3-a631-7904e050257f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb0332588>]}
2021-01-27 23:00:27.621704 (Thread-1): 18:00:27 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 9.20s]
2021-01-27 23:00:27.622032 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:00:27.678540 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 23:00:27.678897 (MainThread): Using snowflake connection "master".
2021-01-27 23:00:27.679055 (MainThread): On master: BEGIN
2021-01-27 23:00:27.679163 (MainThread): Opening a new connection, currently in state closed
2021-01-27 23:00:28.429149 (MainThread): subprocess 10342 is still running
2021-01-27 23:00:32.685776 (MainThread): SQL status: SUCCESS 1 in 5.01 seconds
2021-01-27 23:00:32.687165 (MainThread): On master: COMMIT
2021-01-27 23:00:32.688359 (MainThread): Using snowflake connection "master".
2021-01-27 23:00:32.688825 (MainThread): On master: COMMIT
2021-01-27 23:00:33.160395 (MainThread): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-27 23:00:33.161552 (MainThread): On master: Close
2021-01-27 23:00:33.921808 (MainThread): 18:00:33 | 
2021-01-27 23:00:33.922850 (MainThread): 18:00:33 | Finished running 5 snowflake_timetravel_table models in 63.22s.
2021-01-27 23:00:33.923548 (MainThread): Connection 'master' was properly closed.
2021-01-27 23:00:33.924264 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 23:00:33.964747 (MainThread): 
2021-01-27 23:00:33.964951 (MainThread): Completed successfully
2021-01-27 23:00:33.965090 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 23:00:33.965328 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb02e0978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb014ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bb0285eb8>]}
2021-01-27 23:00:33.965583 (MainThread): Flushing usage events
2021-01-27 23:03:09.711385 (MainThread): Running with dbt=0.18.1
2021-01-27 23:03:10.173321 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 23:03:10.173718 (MainThread): Tracking: tracking
2021-01-27 23:03:10.173856 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fc4e79e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f5879898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f5879cf8>]}
2021-01-27 23:03:10.174433 (MainThread): Set downloads directory='/tmp/dbt-downloads-fw3sodn0'
2021-01-27 23:03:10.186564 (MainThread): Installing ../../
2021-01-27 23:03:10.186812 (MainThread):   Creating symlink to local dependency.
2021-01-27 23:03:10.186931 (MainThread):   Installed from <local @ ../../>

2021-01-27 23:03:10.187060 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0b98cce-7679-4e0c-87db-6c78a8e7162f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f57c9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f57c9470>]}
2021-01-27 23:03:10.187372 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02fc4e79e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f5879f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02f5879c18>]}
2021-01-27 23:03:10.187522 (MainThread): Flushing usage events
2021-01-27 23:03:11.897386 (MainThread): Running with dbt=0.18.1
2021-01-27 23:03:12.356533 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 23:03:12.357464 (MainThread): Tracking: tracking
2021-01-27 23:03:12.357884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368e119b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368e115c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff368e115f8>]}
2021-01-27 23:03:12.406185 (MainThread): Partial parsing not enabled
2021-01-27 23:03:12.407268 (MainThread): Parsing macros/catalog.sql
2021-01-27 23:03:12.410246 (MainThread): Parsing macros/adapters.sql
2021-01-27 23:03:12.449323 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 23:03:12.451171 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 23:03:12.463358 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 23:03:12.465914 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 23:03:12.471779 (MainThread): Parsing macros/core.sql
2021-01-27 23:03:12.476410 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 23:03:12.478506 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 23:03:12.480501 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 23:03:12.482768 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 23:03:12.487290 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 23:03:12.498235 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 23:03:12.506402 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 23:03:12.514003 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 23:03:12.545448 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 23:03:12.547635 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 23:03:12.579968 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 23:03:12.587963 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 23:03:12.594633 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 23:03:12.596740 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 23:03:12.611748 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 23:03:12.633884 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 23:03:12.645367 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 23:03:12.647217 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 23:03:12.648237 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 23:03:12.650582 (MainThread): Parsing macros/etc/query.sql
2021-01-27 23:03:12.651775 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 23:03:12.653593 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 23:03:12.700508 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 23:03:12.717571 (MainThread): Partial parsing not enabled
2021-01-27 23:03:12.762203 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:12.786036 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:03:12.798387 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:12.810627 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:12.823177 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:03:12.844889 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:13.097871 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 23:03:13.098707 (MainThread): 
2021-01-27 23:03:13.099075 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 23:03:13.106525 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 23:03:13.124981 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 23:03:13.125132 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 23:03:13.125256 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 23:03:13.871593 (ThreadPoolExecutor-0_0): subprocess 17993 is still running
2021-01-27 23:03:17.472263 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.35 seconds
2021-01-27 23:03:17.487527 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 23:03:17.778928 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 23:03:17.790146 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 23:03:17.790323 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 23:03:17.790437 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 23:03:18.387086 (ThreadPoolExecutor-1_0): subprocess 18093 is still running
2021-01-27 23:03:22.807386 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 5.02 seconds
2021-01-27 23:03:23.314158 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 23:03:23.857899 (MainThread): Using snowflake connection "master".
2021-01-27 23:03:23.858137 (MainThread): On master: BEGIN
2021-01-27 23:03:23.858266 (MainThread): Opening a new connection, currently in state init
2021-01-27 23:03:24.676190 (MainThread): subprocess 18193 is still running
2021-01-27 23:03:29.769087 (MainThread): SQL status: SUCCESS 1 in 5.91 seconds
2021-01-27 23:03:29.769333 (MainThread): On master: COMMIT
2021-01-27 23:03:29.769539 (MainThread): Using snowflake connection "master".
2021-01-27 23:03:29.769619 (MainThread): On master: COMMIT
2021-01-27 23:03:30.482122 (MainThread): SQL status: SUCCESS 1 in 0.71 seconds
2021-01-27 23:03:30.483043 (MainThread): On master: Close
2021-01-27 23:03:31.201870 (MainThread): 18:03:31 | Concurrency: 1 threads (target='snowflake')
2021-01-27 23:03:31.203000 (MainThread): 18:03:31 | 
2021-01-27 23:03:31.208852 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:03:31.214666 (Thread-1): 18:03:31 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 23:03:31.215804 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:31.216294 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:03:31.252146 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 23:03:31.252535 (Thread-1): finished collecting timing info
2021-01-27 23:03:31.302516 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:31.302673 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:03:31.302764 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:03:32.155037 (Thread-1): subprocess 18295 is still running
2021-01-27 23:03:35.937823 (Thread-1): SQL status: SUCCESS 1 in 4.63 seconds
2021-01-27 23:03:36.013939 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:36.014756 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:03:36.654286 (Thread-1): SQL status: SUCCESS 3 in 0.64 seconds
2021-01-27 23:03:36.672667 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:36.673267 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 23:03:36.914533 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-27 23:03:36.929495 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:36.929671 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 23:03:37.198051 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-27 23:03:37.230681 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 23:03:37.231921 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:37.232053 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 23:03:37.565862 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-27 23:03:37.566058 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:37.566159 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 23:03:40.755045 (Thread-1): SQL status: SUCCESS 1 in 3.19 seconds
2021-01-27 23:03:40.757395 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 23:03:40.758832 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:03:40.759079 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 23:03:41.040467 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-27 23:03:41.079983 (Thread-1): finished collecting timing info
2021-01-27 23:03:41.080420 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 23:03:41.401214 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a814db48-e22f-43d9-8527-13d80c12eb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff362cc5518>]}
2021-01-27 23:03:41.406808 (Thread-1): 18:03:41 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 10.18s]
2021-01-27 23:03:41.407311 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:03:41.408100 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:03:41.411000 (Thread-1): 18:03:41 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 23:03:41.411753 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:41.412022 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:03:41.425103 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 23:03:41.425487 (Thread-1): finished collecting timing info
2021-01-27 23:03:41.440566 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:41.440816 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 23:03:41.440955 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:03:42.208142 (Thread-1): subprocess 18398 is still running
2021-01-27 23:03:46.082329 (Thread-1): SQL status: SUCCESS 1 in 4.64 seconds
2021-01-27 23:03:46.103818 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:46.104429 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:03:46.989527 (Thread-1): SQL status: SUCCESS 3 in 0.88 seconds
2021-01-27 23:03:46.993942 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:46.994139 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 23:03:47.257790 (Thread-1): SQL status: SUCCESS 4 in 0.26 seconds
2021-01-27 23:03:47.263032 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:47.263202 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 23:03:47.656943 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-27 23:03:47.664813 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 23:03:47.668367 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:47.668968 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 23:03:48.256102 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-27 23:03:48.256300 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:48.256401 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 23:03:50.172033 (Thread-1): SQL status: SUCCESS 1 in 1.92 seconds
2021-01-27 23:03:50.178294 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 23:03:50.179446 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:03:50.180037 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 23:03:50.412450 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-27 23:03:50.427774 (Thread-1): finished collecting timing info
2021-01-27 23:03:50.429793 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 23:03:50.837305 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a814db48-e22f-43d9-8527-13d80c12eb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3632d34a8>]}
2021-01-27 23:03:50.838813 (Thread-1): 18:03:50 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 9.43s]
2021-01-27 23:03:50.839019 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:03:50.839219 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:03:50.840662 (Thread-1): 18:03:50 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 23:03:50.841028 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:50.841161 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:03:50.909729 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 23:03:50.910121 (Thread-1): finished collecting timing info
2021-01-27 23:03:50.926853 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:50.927046 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:03:50.927146 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:03:51.730038 (Thread-1): subprocess 18508 is still running
2021-01-27 23:03:55.987029 (Thread-1): SQL status: SUCCESS 1 in 5.06 seconds
2021-01-27 23:03:55.999166 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:55.999541 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:03:56.271034 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-27 23:03:56.280100 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:56.280436 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 23:03:56.530282 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-27 23:03:56.548578 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:56.549235 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 23:03:57.067254 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-01-27 23:03:57.098827 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 23:03:57.100792 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:57.101017 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 23:03:57.444282 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 23:03:57.444946 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:57.445456 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 23:03:57.987554 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-27 23:03:57.988031 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:57.988278 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:03:59.707373 (Thread-1): SQL status: SUCCESS 2 in 1.72 seconds
2021-01-27 23:03:59.713038 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 23:03:59.713842 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:03:59.714305 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 23:04:00.339756 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-27 23:04:00.356262 (Thread-1): finished collecting timing info
2021-01-27 23:04:00.358129 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 23:04:01.274622 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a814db48-e22f-43d9-8527-13d80c12eb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff362dbb6d8>]}
2021-01-27 23:04:01.288447 (Thread-1): 18:04:01 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 10.43s]
2021-01-27 23:04:01.289572 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:04:01.290585 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:04:01.295535 (Thread-1): 18:04:01 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 23:04:01.296555 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:01.296923 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:04:01.313102 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 23:04:01.313516 (Thread-1): finished collecting timing info
2021-01-27 23:04:01.338176 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:01.338372 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 23:04:01.338472 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:04:02.087224 (Thread-1): subprocess 18607 is still running
2021-01-27 23:04:07.327693 (Thread-1): SQL status: SUCCESS 1 in 5.99 seconds
2021-01-27 23:04:07.341661 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:07.342024 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:04:08.260458 (Thread-1): SQL status: SUCCESS 3 in 0.92 seconds
2021-01-27 23:04:08.277054 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:08.277655 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 23:04:08.620709 (Thread-1): SQL status: SUCCESS 2 in 0.34 seconds
2021-01-27 23:04:08.638568 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:08.639168 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 23:04:09.899452 (Thread-1): SQL status: SUCCESS 1 in 1.26 seconds
2021-01-27 23:04:09.901444 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 23:04:09.902388 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:09.902516 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 23:04:10.291660 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-27 23:04:10.292498 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:10.293767 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 23:04:14.249734 (Thread-1): SQL status: SUCCESS 1 in 3.96 seconds
2021-01-27 23:04:14.254794 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 23:04:14.255594 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:14.255972 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 23:04:14.444583 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 23:04:14.447928 (Thread-1): finished collecting timing info
2021-01-27 23:04:14.448322 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 23:04:15.085670 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a814db48-e22f-43d9-8527-13d80c12eb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3632d0668>]}
2021-01-27 23:04:15.093853 (Thread-1): 18:04:15 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 13.79s]
2021-01-27 23:04:15.094792 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:04:15.095772 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:04:15.100286 (Thread-1): 18:04:15 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 23:04:15.101900 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:15.102315 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:04:15.117248 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 23:04:15.117672 (Thread-1): finished collecting timing info
2021-01-27 23:04:15.134436 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:15.134621 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:04:15.134719 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:04:15.880245 (Thread-1): subprocess 18717 is still running
2021-01-27 23:04:19.927040 (Thread-1): SQL status: SUCCESS 1 in 4.79 seconds
2021-01-27 23:04:19.938308 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:19.938525 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:04:20.112318 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-27 23:04:20.125957 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:20.126352 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 23:04:20.335786 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-27 23:04:20.357806 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:20.358164 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 23:04:20.648351 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-27 23:04:20.659025 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 23:04:20.663778 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:20.664306 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 23:04:21.094463 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-27 23:04:21.095112 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:21.095541 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 23:04:23.474678 (Thread-1): SQL status: SUCCESS 1 in 2.38 seconds
2021-01-27 23:04:23.481143 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 23:04:23.482161 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:23.482659 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 23:04:23.639816 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-27 23:04:23.654963 (Thread-1): finished collecting timing info
2021-01-27 23:04:23.656725 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 23:04:24.048627 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a814db48-e22f-43d9-8527-13d80c12eb4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3633126a0>]}
2021-01-27 23:04:24.050252 (Thread-1): 18:04:24 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.95s]
2021-01-27 23:04:24.050464 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:04:24.149823 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 23:04:24.150119 (MainThread): Using snowflake connection "master".
2021-01-27 23:04:24.150210 (MainThread): On master: BEGIN
2021-01-27 23:04:24.150311 (MainThread): Opening a new connection, currently in state closed
2021-01-27 23:04:24.760679 (MainThread): subprocess 18816 is still running
2021-01-27 23:04:28.649794 (MainThread): SQL status: SUCCESS 1 in 4.50 seconds
2021-01-27 23:04:28.650825 (MainThread): On master: COMMIT
2021-01-27 23:04:28.652024 (MainThread): Using snowflake connection "master".
2021-01-27 23:04:28.652545 (MainThread): On master: COMMIT
2021-01-27 23:04:29.154927 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-27 23:04:29.156183 (MainThread): On master: Close
2021-01-27 23:04:29.462536 (MainThread): 18:04:29 | 
2021-01-27 23:04:29.463122 (MainThread): 18:04:29 | Finished running 5 snowflake_timetravel_table models in 76.36s.
2021-01-27 23:04:29.463498 (MainThread): Connection 'master' was properly closed.
2021-01-27 23:04:29.463725 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 23:04:29.492045 (MainThread): 
2021-01-27 23:04:29.492351 (MainThread): Completed successfully
2021-01-27 23:04:29.492541 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 23:04:29.492868 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff362cc5320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3632a6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff363258e80>]}
2021-01-27 23:04:29.493229 (MainThread): Flushing usage events
2021-01-27 23:04:31.455577 (MainThread): Running with dbt=0.18.1
2021-01-27 23:04:31.917909 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-27 23:04:31.918858 (MainThread): Tracking: tracking
2021-01-27 23:04:31.919256 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269724f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269724f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269724f588>]}
2021-01-27 23:04:31.984900 (MainThread): Partial parsing not enabled
2021-01-27 23:04:31.986031 (MainThread): Parsing macros/catalog.sql
2021-01-27 23:04:31.988990 (MainThread): Parsing macros/adapters.sql
2021-01-27 23:04:32.039652 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 23:04:32.044078 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 23:04:32.070862 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 23:04:32.076841 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 23:04:32.089595 (MainThread): Parsing macros/core.sql
2021-01-27 23:04:32.099335 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 23:04:32.101609 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 23:04:32.103727 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 23:04:32.106298 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 23:04:32.111444 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 23:04:32.123336 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 23:04:32.131983 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 23:04:32.138698 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 23:04:32.161259 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 23:04:32.163822 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 23:04:32.200207 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 23:04:32.209258 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 23:04:32.217317 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 23:04:32.220309 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 23:04:32.238967 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 23:04:32.266506 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 23:04:32.282671 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 23:04:32.287397 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 23:04:32.290233 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 23:04:32.296510 (MainThread): Parsing macros/etc/query.sql
2021-01-27 23:04:32.299375 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 23:04:32.304145 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 23:04:32.400677 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 23:04:32.419919 (MainThread): Partial parsing not enabled
2021-01-27 23:04:32.473628 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:04:32.502063 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:04:32.517627 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:04:32.537305 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:04:32.552244 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:04:32.585331 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:04:32.864840 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 23:04:32.865631 (MainThread): 
2021-01-27 23:04:32.865996 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 23:04:32.875886 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 23:04:32.891439 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 23:04:32.891583 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 23:04:32.891670 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-27 23:04:33.854744 (ThreadPoolExecutor-1_0): subprocess 18975 is still running
2021-01-27 23:04:37.545323 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.65 seconds
2021-01-27 23:04:38.111068 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 23:04:38.454287 (MainThread): 18:04:38 | Concurrency: 1 threads (target='snowflake')
2021-01-27 23:04:38.454539 (MainThread): 18:04:38 | 
2021-01-27 23:04:38.455812 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:04:38.456050 (Thread-1): 18:04:38 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 23:04:38.456411 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:04:38.456572 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:04:38.479751 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 23:04:38.480137 (Thread-1): finished collecting timing info
2021-01-27 23:04:38.480968 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:04:38.481066 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 23:04:38.481149 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:04:39.160290 (Thread-1): subprocess 19075 is still running
2021-01-27 23:04:43.254446 (Thread-1): SQL status: SUCCESS 1 in 4.77 seconds
2021-01-27 23:04:43.255206 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:04:43.255572 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-27T23:00:01.495429Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-27 23:04:45.143062 (Thread-1): Snowflake query id: 0199e628-058b-dbc3-0000-44a938a3a016
2021-01-27 23:04:45.143276 (Thread-1): Snowflake error: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 23:04:45.143535 (Thread-1): finished collecting timing info
2021-01-27 23:04:45.144397 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-27 23:04:45.517811 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 23:04:45.823681 (Thread-1): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 161, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/cursor.py", line 596, in execute
    errvalue)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/snowflake/connector/errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 82, in execute
    failed_rows = self.execute_data_test(test)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/task/test.py", line 45, in execute_data_test
    test.injected_sql, auto_begin=True, fetch=True
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    fetch=fetch
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/sql/connections.py", line 86, in add_query
    return connection, cursor
  File "/usr/lib/python3.6/contextlib.py", line 99, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/warehouse-transforms/lib/python3.6/site-packages/dbt/adapters/snowflake/connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 23:04:45.827165 (Thread-1): 18:04:45 | 1 of 1 ERROR test_snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 7.37s]
2021-01-27 23:04:45.827544 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:04:45.884114 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 23:04:45.884849 (MainThread): 18:04:45 | 
2021-01-27 23:04:45.885089 (MainThread): 18:04:45 | Finished running 1 test in 13.02s.
2021-01-27 23:04:45.885284 (MainThread): Connection 'master' was properly closed.
2021-01-27 23:04:45.885422 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-27 23:04:45.897188 (MainThread): 
2021-01-27 23:04:45.897468 (MainThread): Completed with 1 error and 0 warnings:
2021-01-27 23:04:45.897649 (MainThread): 
2021-01-27 23:04:45.897834 (MainThread): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-27 23:04:45.898065 (MainThread):   000707 (02000): Time travel data is not available for table SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_COLUMNS_NO_CHANGE. The requested time is either beyond the allowed time travel period or before the object creation time.
2021-01-27 23:04:45.898209 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-27 23:04:45.898374 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-27 23:04:45.898781 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2696f55e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f269df4c9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2695191dd8>]}
2021-01-27 23:04:45.899176 (MainThread): Flushing usage events
2021-01-27 23:12:42.793745 (MainThread): Running with dbt=0.18.1
2021-01-27 23:12:43.267456 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-27 23:12:43.267787 (MainThread): Tracking: tracking
2021-01-27 23:12:43.267931 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f732f226940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73285b8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73285b8c88>]}
2021-01-27 23:12:43.268519 (MainThread): Set downloads directory='/tmp/dbt-downloads-je5no0nc'
2021-01-27 23:12:43.281420 (MainThread): Installing ../../
2021-01-27 23:12:43.281707 (MainThread):   Creating symlink to local dependency.
2021-01-27 23:12:43.281834 (MainThread):   Installed from <local @ ../../>

2021-01-27 23:12:43.281978 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f261bb4d-eeb3-4902-9da9-5fdef6f5213e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f732850b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f732850b7f0>]}
2021-01-27 23:12:43.282325 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73285b3f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f732f226940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73285b8c88>]}
2021-01-27 23:12:43.282507 (MainThread): Flushing usage events
2021-01-27 23:12:44.987264 (MainThread): Running with dbt=0.18.1
2021-01-27 23:12:45.466426 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-27 23:12:45.467281 (MainThread): Tracking: tracking
2021-01-27 23:12:45.467652 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c03673e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c035ce668>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c035ce5c0>]}
2021-01-27 23:12:45.509927 (MainThread): Partial parsing not enabled
2021-01-27 23:12:45.511048 (MainThread): Parsing macros/catalog.sql
2021-01-27 23:12:45.513819 (MainThread): Parsing macros/adapters.sql
2021-01-27 23:12:45.549601 (MainThread): Parsing macros/materializations/view.sql
2021-01-27 23:12:45.551519 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-27 23:12:45.562256 (MainThread): Parsing macros/materializations/merge.sql
2021-01-27 23:12:45.564627 (MainThread): Parsing macros/materializations/table.sql
2021-01-27 23:12:45.569718 (MainThread): Parsing macros/core.sql
2021-01-27 23:12:45.573803 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-27 23:12:45.575749 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-27 23:12:45.577477 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-27 23:12:45.579565 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-27 23:12:45.583754 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-27 23:12:45.594238 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-27 23:12:45.601277 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-27 23:12:45.606989 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-27 23:12:45.624947 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-27 23:12:45.627054 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-27 23:12:45.656946 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-27 23:12:45.666287 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-27 23:12:45.673694 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-27 23:12:45.675787 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-27 23:12:45.691707 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-27 23:12:45.713994 (MainThread): Parsing macros/etc/datetime.sql
2021-01-27 23:12:45.723619 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-27 23:12:45.725324 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-27 23:12:45.726524 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-27 23:12:45.728821 (MainThread): Parsing macros/etc/query.sql
2021-01-27 23:12:45.729944 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-27 23:12:45.731723 (MainThread): Parsing macros/adapters/common.sql
2021-01-27 23:12:45.779763 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-27 23:12:45.795754 (MainThread): Partial parsing not enabled
2021-01-27 23:12:45.837700 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:12:45.861212 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:12:45.873469 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:12:45.885839 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:12:45.898559 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:12:45.920257 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:12:46.185160 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-27 23:12:46.185912 (MainThread): 
2021-01-27 23:12:46.186233 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 23:12:46.193834 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-27 23:12:46.209978 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-27 23:12:46.210126 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-27 23:12:46.210226 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-27 23:12:47.105858 (ThreadPoolExecutor-0_0): subprocess 20853 is still running
2021-01-27 23:12:50.784019 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.57 seconds
2021-01-27 23:12:50.831686 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-27 23:12:51.301878 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 23:12:51.312868 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-27 23:12:51.313016 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-27 23:12:51.313111 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-27 23:12:51.928235 (ThreadPoolExecutor-1_0): subprocess 20951 is still running
2021-01-27 23:12:55.441843 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.13 seconds
2021-01-27 23:12:55.937317 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-27 23:12:56.227732 (MainThread): Using snowflake connection "master".
2021-01-27 23:12:56.227989 (MainThread): On master: BEGIN
2021-01-27 23:12:56.228124 (MainThread): Opening a new connection, currently in state init
2021-01-27 23:12:56.875796 (MainThread): subprocess 21047 is still running
2021-01-27 23:13:00.381449 (MainThread): SQL status: SUCCESS 1 in 4.15 seconds
2021-01-27 23:13:00.382465 (MainThread): On master: COMMIT
2021-01-27 23:13:00.383741 (MainThread): Using snowflake connection "master".
2021-01-27 23:13:00.384357 (MainThread): On master: COMMIT
2021-01-27 23:13:00.723768 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-27 23:13:00.724558 (MainThread): On master: Close
2021-01-27 23:13:00.980857 (MainThread): 18:13:00 | Concurrency: 1 threads (target='snowflake')
2021-01-27 23:13:00.981321 (MainThread): 18:13:00 | 
2021-01-27 23:13:00.984360 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:13:00.989320 (Thread-1): 18:13:00 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-27 23:13:00.990124 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:00.990500 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:13:01.026727 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 23:13:01.027098 (Thread-1): finished collecting timing info
2021-01-27 23:13:01.077681 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:01.077839 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:13:01.077937 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:13:01.692872 (Thread-1): subprocess 21152 is still running
2021-01-27 23:13:05.896589 (Thread-1): SQL status: SUCCESS 1 in 4.82 seconds
2021-01-27 23:13:05.917511 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:05.917762 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:13:06.107207 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 23:13:06.111736 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:06.111945 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-27 23:13:06.335584 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-27 23:13:06.349023 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:06.349185 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-27 23:13:06.564485 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-27 23:13:06.577874 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-27 23:13:06.578881 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:06.578986 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-27 23:13:06.759862 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-27 23:13:06.760315 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:06.760586 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 23:13:08.195834 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-01-27 23:13:08.210951 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 23:13:08.212096 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-27 23:13:08.212675 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-27 23:13:08.405373 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 23:13:08.445614 (Thread-1): finished collecting timing info
2021-01-27 23:13:08.446121 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-27 23:13:08.721798 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70d73a0-89b0-40c8-b64f-6a20f7b56044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c014b0780>]}
2021-01-27 23:13:08.724340 (Thread-1): 18:13:08 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.73s]
2021-01-27 23:13:08.724660 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-27 23:13:08.725015 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:13:08.727063 (Thread-1): 18:13:08 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-27 23:13:08.728054 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:08.728289 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:13:08.743284 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 23:13:08.743824 (Thread-1): finished collecting timing info
2021-01-27 23:13:08.764422 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:08.764578 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-27 23:13:08.764672 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:13:09.381714 (Thread-1): subprocess 24630 is still running
2021-01-27 23:13:13.637106 (Thread-1): SQL status: SUCCESS 1 in 4.87 seconds
2021-01-27 23:13:13.671892 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:13.672894 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:13:13.859512 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 23:13:13.880241 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:13.881004 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-27 23:13:14.064193 (Thread-1): SQL status: SUCCESS 4 in 0.18 seconds
2021-01-27 23:13:14.086818 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:14.087730 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-27 23:13:14.351789 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-27 23:13:14.354846 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-27 23:13:14.356511 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:14.356682 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-27 23:13:14.557421 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-27 23:13:14.557587 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:14.557671 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-27 23:13:15.531131 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-27 23:13:15.536587 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 23:13:15.537394 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-27 23:13:15.537820 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-27 23:13:15.693151 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-27 23:13:15.708615 (Thread-1): finished collecting timing info
2021-01-27 23:13:15.710988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-27 23:13:15.970740 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70d73a0-89b0-40c8-b64f-6a20f7b56044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0153f9e8>]}
2021-01-27 23:13:15.978834 (Thread-1): 18:13:15 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 7.24s]
2021-01-27 23:13:15.979737 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-27 23:13:15.980810 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:13:15.985656 (Thread-1): 18:13:15 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-27 23:13:15.986638 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:15.987008 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:13:16.065078 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 23:13:16.065529 (Thread-1): finished collecting timing info
2021-01-27 23:13:16.081895 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:16.082059 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:13:16.082165 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:13:16.706898 (Thread-1): subprocess 24742 is still running
2021-01-27 23:13:20.868884 (Thread-1): SQL status: SUCCESS 1 in 4.79 seconds
2021-01-27 23:13:20.887834 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:20.888367 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:13:21.436618 (Thread-1): SQL status: SUCCESS 3 in 0.55 seconds
2021-01-27 23:13:21.448420 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:21.448859 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-27 23:13:22.036049 (Thread-1): SQL status: SUCCESS 3 in 0.59 seconds
2021-01-27 23:13:22.043346 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:22.043562 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-27 23:13:22.283528 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-27 23:13:22.293091 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-27 23:13:22.294208 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:22.294357 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-27 23:13:22.546717 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 23:13:22.546887 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:22.546969 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-27 23:13:23.278625 (Thread-1): SQL status: SUCCESS 1 in 0.73 seconds
2021-01-27 23:13:23.278855 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:23.278960 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:13:24.101687 (Thread-1): SQL status: SUCCESS 2 in 0.82 seconds
2021-01-27 23:13:24.107282 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 23:13:24.108139 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-27 23:13:24.108580 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-27 23:13:24.597673 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-27 23:13:24.601650 (Thread-1): finished collecting timing info
2021-01-27 23:13:24.602141 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-27 23:13:24.865865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70d73a0-89b0-40c8-b64f-6a20f7b56044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c00444780>]}
2021-01-27 23:13:24.870870 (Thread-1): 18:13:24 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 8.88s]
2021-01-27 23:13:24.871352 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-27 23:13:24.871823 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:13:24.875086 (Thread-1): 18:13:24 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-27 23:13:24.876063 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:24.876314 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:13:24.889017 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 23:13:24.889466 (Thread-1): finished collecting timing info
2021-01-27 23:13:24.907196 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:24.907370 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-27 23:13:24.907475 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:13:25.486377 (Thread-1): subprocess 24844 is still running
2021-01-27 23:13:29.114849 (Thread-1): SQL status: SUCCESS 1 in 4.21 seconds
2021-01-27 23:13:29.119853 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:29.120028 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:13:29.304644 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-27 23:13:29.310184 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:29.310392 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-27 23:13:29.533998 (Thread-1): SQL status: SUCCESS 2 in 0.22 seconds
2021-01-27 23:13:29.537833 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:29.538036 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-27 23:13:29.791692 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 23:13:29.799319 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-27 23:13:29.802744 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:29.803174 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-27 23:13:29.995149 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 23:13:29.995716 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:29.996069 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-27 23:13:31.603442 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-01-27 23:13:31.609296 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 23:13:31.610144 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-27 23:13:31.610664 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-27 23:13:31.778636 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-27 23:13:31.794999 (Thread-1): finished collecting timing info
2021-01-27 23:13:31.796843 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-27 23:13:32.080330 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70d73a0-89b0-40c8-b64f-6a20f7b56044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c01a85ac8>]}
2021-01-27 23:13:32.087924 (Thread-1): 18:13:32 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 7.20s]
2021-01-27 23:13:32.088765 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-27 23:13:32.089746 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:13:32.096760 (Thread-1): 18:13:32 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-27 23:13:32.097687 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:32.098270 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:13:32.113747 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 23:13:32.114284 (Thread-1): finished collecting timing info
2021-01-27 23:13:32.130341 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:32.130515 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-27 23:13:32.130615 (Thread-1): Opening a new connection, currently in state closed
2021-01-27 23:13:32.788475 (Thread-1): subprocess 24942 is still running
2021-01-27 23:13:37.234823 (Thread-1): SQL status: SUCCESS 1 in 5.10 seconds
2021-01-27 23:13:37.258989 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:37.259310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:13:38.006276 (Thread-1): SQL status: SUCCESS 3 in 0.75 seconds
2021-01-27 23:13:38.012875 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:38.013095 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-27 23:13:38.198719 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-27 23:13:38.203845 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:38.204004 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-27 23:13:38.455680 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-27 23:13:38.457775 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-27 23:13:38.458822 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:38.458956 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-27 23:13:38.647355 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-27 23:13:38.647644 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:38.647853 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-27 23:13:40.277750 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-01-27 23:13:40.282892 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 23:13:40.283739 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-27 23:13:40.284582 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-27 23:13:40.497797 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-27 23:13:40.500723 (Thread-1): finished collecting timing info
2021-01-27 23:13:40.501054 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-27 23:13:40.844479 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70d73a0-89b0-40c8-b64f-6a20f7b56044', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c01af0ba8>]}
2021-01-27 23:13:40.851857 (Thread-1): 18:13:40 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.74s]
2021-01-27 23:13:40.852764 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-27 23:13:40.862110 (MainThread): Acquiring new snowflake connection "master".
2021-01-27 23:13:40.863833 (MainThread): Using snowflake connection "master".
2021-01-27 23:13:40.864573 (MainThread): On master: BEGIN
2021-01-27 23:13:40.865145 (MainThread): Opening a new connection, currently in state closed
2021-01-27 23:13:41.537440 (MainThread): subprocess 25042 is still running
2021-01-27 23:13:45.172204 (MainThread): SQL status: SUCCESS 1 in 4.31 seconds
2021-01-27 23:13:45.173592 (MainThread): On master: COMMIT
2021-01-27 23:13:45.175236 (MainThread): Using snowflake connection "master".
2021-01-27 23:13:45.176021 (MainThread): On master: COMMIT
2021-01-27 23:13:45.731842 (MainThread): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-27 23:13:45.732137 (MainThread): On master: Close
2021-01-27 23:13:46.037620 (MainThread): 18:13:46 | 
2021-01-27 23:13:46.038624 (MainThread): 18:13:46 | Finished running 5 snowflake_timetravel_table models in 59.85s.
2021-01-27 23:13:46.039403 (MainThread): Connection 'master' was properly closed.
2021-01-27 23:13:46.040034 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-27 23:13:46.076907 (MainThread): 
2021-01-27 23:13:46.077097 (MainThread): Completed successfully
2021-01-27 23:13:46.077218 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-27 23:13:46.077459 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0157c7b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c0157c780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c015304e0>]}
2021-01-27 23:13:46.077719 (MainThread): Flushing usage events
2021-01-28 16:10:26.120796 (MainThread): Running with dbt=0.18.1
2021-01-28 16:10:26.597744 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 16:10:26.600255 (MainThread): Tracking: tracking
2021-01-28 16:10:26.600482 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf76e59898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf701f8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf701f8c88>]}
2021-01-28 16:10:26.601295 (MainThread): Set downloads directory='/tmp/dbt-downloads-4t677iam'
2021-01-28 16:10:26.618870 (MainThread): Installing ../../
2021-01-28 16:10:26.619534 (MainThread):   Creating symlink to local dependency.
2021-01-28 16:10:26.619674 (MainThread):   Installed from <local @ ../../>

2021-01-28 16:10:26.619845 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '872b9ceb-a2d7-4e8b-82a1-29cee3930afa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70150828>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70150400>]}
2021-01-28 16:10:26.620202 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf76e59898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf76e59240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf701f8550>]}
2021-01-28 16:10:26.620373 (MainThread): Flushing usage events
2021-01-28 16:10:28.272913 (MainThread): Running with dbt=0.18.1
2021-01-28 16:10:28.715770 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 16:10:28.716581 (MainThread): Tracking: tracking
2021-01-28 16:10:28.716921 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950398b978>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950398b588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950398b5c0>]}
2021-01-28 16:10:28.758303 (MainThread): Partial parsing not enabled
2021-01-28 16:10:28.759363 (MainThread): Parsing macros/catalog.sql
2021-01-28 16:10:28.762145 (MainThread): Parsing macros/adapters.sql
2021-01-28 16:10:28.800492 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 16:10:28.802312 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 16:10:28.812836 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 16:10:28.815159 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 16:10:28.820091 (MainThread): Parsing macros/core.sql
2021-01-28 16:10:28.823975 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 16:10:28.825806 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 16:10:28.827446 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 16:10:28.829408 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 16:10:28.833380 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 16:10:28.843165 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:10:28.849633 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 16:10:28.854884 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 16:10:28.872869 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 16:10:28.874785 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 16:10:28.903843 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:10:28.910803 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:10:28.917107 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 16:10:28.918934 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 16:10:28.933155 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:10:28.955072 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 16:10:28.964262 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 16:10:28.966068 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 16:10:28.967195 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 16:10:28.969290 (MainThread): Parsing macros/etc/query.sql
2021-01-28 16:10:28.970626 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 16:10:28.973328 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 16:10:29.020533 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 16:10:29.036961 (MainThread): Partial parsing not enabled
2021-01-28 16:10:29.086988 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:10:29.111451 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:10:29.126340 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:29.139039 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:10:29.151896 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:10:29.174823 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:10:29.438836 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 16:10:29.439722 (MainThread): 
2021-01-28 16:10:29.440082 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 16:10:29.447451 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 16:10:29.462121 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 16:10:29.462270 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 16:10:29.462350 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 16:10:30.369128 (ThreadPoolExecutor-0_0): subprocess 6502 is still running
2021-01-28 16:10:34.083296 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.62 seconds
2021-01-28 16:10:34.111640 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 16:10:34.374792 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 16:10:34.397373 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 16:10:34.397994 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 16:10:34.398161 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 16:10:35.029014 (ThreadPoolExecutor-1_0): subprocess 6656 is still running
2021-01-28 16:10:39.224675 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.83 seconds
2021-01-28 16:10:39.942419 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 16:10:40.322199 (MainThread): Using snowflake connection "master".
2021-01-28 16:10:40.322420 (MainThread): On master: BEGIN
2021-01-28 16:10:40.322545 (MainThread): Opening a new connection, currently in state init
2021-01-28 16:10:41.055643 (MainThread): subprocess 6763 is still running
2021-01-28 16:10:46.161393 (MainThread): SQL status: SUCCESS 1 in 5.84 seconds
2021-01-28 16:10:46.162857 (MainThread): On master: COMMIT
2021-01-28 16:10:46.164527 (MainThread): Using snowflake connection "master".
2021-01-28 16:10:46.165135 (MainThread): On master: COMMIT
2021-01-28 16:10:46.437573 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-28 16:10:46.439213 (MainThread): On master: Close
2021-01-28 16:10:46.748566 (MainThread): 11:10:46 | Concurrency: 1 threads (target='snowflake')
2021-01-28 16:10:46.749650 (MainThread): 11:10:46 | 
2021-01-28 16:10:46.757640 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 16:10:46.767389 (Thread-1): 11:10:46 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 16:10:46.769368 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:46.770211 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 16:10:46.839435 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 16:10:46.842148 (Thread-1): finished collecting timing info
2021-01-28 16:10:46.897095 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:46.897251 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 16:10:46.897343 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:10:47.628239 (Thread-1): subprocess 6876 is still running
2021-01-28 16:10:51.962786 (Thread-1): SQL status: SUCCESS 1 in 5.07 seconds
2021-01-28 16:10:51.979730 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:51.979923 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 16:10:52.361264 (Thread-1): SQL status: SUCCESS 3 in 0.38 seconds
2021-01-28 16:10:52.369309 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:52.369558 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 16:10:52.667982 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-28 16:10:52.684830 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:52.685130 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 16:10:52.966804 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 16:10:53.008377 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 16:10:53.011659 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:53.011795 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 16:10:54.423369 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-01-28 16:10:54.423536 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:54.423621 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 16:10:58.556917 (Thread-1): SQL status: SUCCESS 1 in 4.13 seconds
2021-01-28 16:10:58.564514 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 16:10:58.565456 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:10:58.565888 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 16:10:58.904376 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-28 16:10:58.970600 (Thread-1): finished collecting timing info
2021-01-28 16:10:58.971646 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 16:10:59.286203 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259db704-c526-47d5-a69c-2b450269886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950190f898>]}
2021-01-28 16:10:59.293475 (Thread-1): 11:10:59 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 12.52s]
2021-01-28 16:10:59.294587 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 16:10:59.295645 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 16:10:59.304973 (Thread-1): 11:10:59 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 16:10:59.307883 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:10:59.309677 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 16:10:59.346698 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 16:10:59.347223 (Thread-1): finished collecting timing info
2021-01-28 16:10:59.364147 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:10:59.364319 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 16:10:59.364423 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:11:00.066478 (Thread-1): subprocess 6972 is still running
2021-01-28 16:11:06.172236 (Thread-1): SQL status: SUCCESS 1 in 6.81 seconds
2021-01-28 16:11:06.201304 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:11:06.201997 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 16:11:06.522058 (Thread-1): SQL status: SUCCESS 3 in 0.32 seconds
2021-01-28 16:11:06.542543 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:11:06.550270 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 16:11:06.833341 (Thread-1): SQL status: SUCCESS 4 in 0.28 seconds
2021-01-28 16:11:06.869562 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:11:06.869954 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 16:11:07.375478 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-28 16:11:07.378197 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 16:11:07.379859 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:11:07.380052 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 16:11:07.635003 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 16:11:07.635651 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:11:07.636064 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 16:11:11.712265 (Thread-1): SQL status: SUCCESS 1 in 4.08 seconds
2021-01-28 16:11:11.732013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 16:11:11.733357 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:11:11.734101 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 16:11:12.025010 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-28 16:11:12.028940 (Thread-1): finished collecting timing info
2021-01-28 16:11:12.029416 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 16:11:12.388851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259db704-c526-47d5-a69c-2b450269886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9501904eb8>]}
2021-01-28 16:11:12.391146 (Thread-1): 11:11:12 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 13.08s]
2021-01-28 16:11:12.391428 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 16:11:12.391658 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 16:11:12.393061 (Thread-1): 11:11:12 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 16:11:12.393466 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:12.393604 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 16:11:12.497788 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 16:11:12.498267 (Thread-1): finished collecting timing info
2021-01-28 16:11:12.561744 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:12.561988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 16:11:12.562159 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:11:13.179825 (Thread-1): subprocess 7081 is still running
2021-01-28 16:11:19.716125 (Thread-1): SQL status: SUCCESS 1 in 7.15 seconds
2021-01-28 16:11:19.748866 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:19.750123 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 16:11:19.961441 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-28 16:11:19.984519 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:19.985160 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 16:11:20.740922 (Thread-1): SQL status: SUCCESS 3 in 0.76 seconds
2021-01-28 16:11:20.746546 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:20.746741 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 16:11:20.964372 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 16:11:21.038758 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 16:11:21.041336 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:21.041617 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 16:11:21.631960 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-28 16:11:21.632237 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:21.632390 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 16:11:22.056898 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-28 16:11:22.057802 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:22.058285 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 16:11:22.651352 (Thread-1): SQL status: SUCCESS 2 in 0.59 seconds
2021-01-28 16:11:22.653543 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 16:11:22.653875 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:11:22.654026 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 16:11:23.862618 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-01-28 16:11:23.868991 (Thread-1): finished collecting timing info
2021-01-28 16:11:23.869720 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 16:11:24.164057 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259db704-c526-47d5-a69c-2b450269886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebfde320>]}
2021-01-28 16:11:24.168018 (Thread-1): 11:11:24 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 11.77s]
2021-01-28 16:11:24.168629 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 16:11:24.169031 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 16:11:24.172698 (Thread-1): 11:11:24 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 16:11:24.173657 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:24.174143 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 16:11:24.198012 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 16:11:24.198605 (Thread-1): finished collecting timing info
2021-01-28 16:11:24.218238 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:24.218413 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 16:11:24.218520 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:11:25.045815 (Thread-1): subprocess 7341 is still running
2021-01-28 16:11:30.437191 (Thread-1): SQL status: SUCCESS 1 in 6.22 seconds
2021-01-28 16:11:30.453686 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:30.454148 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 16:11:30.691305 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-28 16:11:30.715146 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:30.715627 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 16:11:31.286396 (Thread-1): SQL status: SUCCESS 2 in 0.57 seconds
2021-01-28 16:11:31.301914 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:31.302438 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 16:11:31.543676 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-28 16:11:31.546631 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 16:11:31.548174 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:31.548359 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 16:11:31.962981 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-28 16:11:31.963660 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:31.964089 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 16:11:33.025261 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-28 16:11:33.030901 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 16:11:33.031708 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:11:33.032139 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 16:11:33.292869 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 16:11:33.307736 (Thread-1): finished collecting timing info
2021-01-28 16:11:33.308721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 16:11:33.823020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259db704-c526-47d5-a69c-2b450269886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9501e74c50>]}
2021-01-28 16:11:33.830303 (Thread-1): 11:11:33 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 9.65s]
2021-01-28 16:11:33.831167 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 16:11:33.832133 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 16:11:33.839178 (Thread-1): 11:11:33 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 16:11:33.840880 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:33.841549 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 16:11:33.862719 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 16:11:33.863307 (Thread-1): finished collecting timing info
2021-01-28 16:11:33.878749 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:33.878908 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 16:11:33.879002 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:11:34.493910 (Thread-1): subprocess 7445 is still running
2021-01-28 16:11:38.485438 (Thread-1): SQL status: SUCCESS 1 in 4.61 seconds
2021-01-28 16:11:38.494650 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:38.494921 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 16:11:38.798825 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-28 16:11:38.808844 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:38.809089 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 16:11:39.645935 (Thread-1): SQL status: SUCCESS 3 in 0.84 seconds
2021-01-28 16:11:39.667111 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:39.667614 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 16:11:40.063817 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-28 16:11:40.066811 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 16:11:40.067700 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:40.067815 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 16:11:40.335361 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-28 16:11:40.335545 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:40.335634 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 16:11:41.380846 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-28 16:11:41.385624 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 16:11:41.386314 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:11:41.386688 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 16:11:41.892544 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-28 16:11:41.907233 (Thread-1): finished collecting timing info
2021-01-28 16:11:41.908664 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 16:11:42.293760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '259db704-c526-47d5-a69c-2b450269886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9501e779b0>]}
2021-01-28 16:11:42.300922 (Thread-1): 11:11:42 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.45s]
2021-01-28 16:11:42.301745 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 16:11:42.334749 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 16:11:42.336254 (MainThread): Using snowflake connection "master".
2021-01-28 16:11:42.336913 (MainThread): On master: BEGIN
2021-01-28 16:11:42.337505 (MainThread): Opening a new connection, currently in state closed
2021-01-28 16:11:42.970504 (MainThread): subprocess 7544 is still running
2021-01-28 16:11:46.900047 (MainThread): SQL status: SUCCESS 1 in 4.56 seconds
2021-01-28 16:11:46.901448 (MainThread): On master: COMMIT
2021-01-28 16:11:46.903085 (MainThread): Using snowflake connection "master".
2021-01-28 16:11:46.903862 (MainThread): On master: COMMIT
2021-01-28 16:11:47.729330 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-28 16:11:47.730273 (MainThread): On master: Close
2021-01-28 16:11:48.116069 (MainThread): 11:11:48 | 
2021-01-28 16:11:48.116459 (MainThread): 11:11:48 | Finished running 5 snowflake_timetravel_table models in 78.68s.
2021-01-28 16:11:48.116655 (MainThread): Connection 'master' was properly closed.
2021-01-28 16:11:48.116767 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 16:11:48.142272 (MainThread): 
2021-01-28 16:11:48.142486 (MainThread): Completed successfully
2021-01-28 16:11:48.142655 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 16:11:48.142993 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebfde908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ebfcf438>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95018f12b0>]}
2021-01-28 16:11:48.143373 (MainThread): Flushing usage events
2021-01-28 16:19:00.009476 (MainThread): Running with dbt=0.18.1
2021-01-28 16:19:00.462893 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-28 16:19:00.463725 (MainThread): Tracking: tracking
2021-01-28 16:19:00.464053 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052468c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052468c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f052468c588>]}
2021-01-28 16:19:00.508269 (MainThread): Partial parsing not enabled
2021-01-28 16:19:00.509352 (MainThread): Parsing macros/catalog.sql
2021-01-28 16:19:00.512089 (MainThread): Parsing macros/adapters.sql
2021-01-28 16:19:00.545959 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 16:19:00.547719 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 16:19:00.557350 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 16:19:00.559430 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 16:19:00.564121 (MainThread): Parsing macros/core.sql
2021-01-28 16:19:00.567957 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 16:19:00.569717 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 16:19:00.571242 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 16:19:00.573362 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 16:19:00.577363 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 16:19:00.587216 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 16:19:00.593785 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 16:19:00.599019 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 16:19:00.616359 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 16:19:00.618693 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 16:19:00.649411 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 16:19:00.659153 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 16:19:00.666977 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 16:19:00.669255 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 16:19:00.684892 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 16:19:00.707747 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 16:19:00.716891 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 16:19:00.718792 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 16:19:00.719768 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 16:19:00.721834 (MainThread): Parsing macros/etc/query.sql
2021-01-28 16:19:00.722890 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 16:19:00.724593 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 16:19:00.772123 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 16:19:00.787455 (MainThread): Partial parsing not enabled
2021-01-28 16:19:00.828050 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:19:00.851696 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 16:19:00.863531 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 16:19:00.875634 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 16:19:00.888061 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 16:19:00.908761 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:19:01.172863 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 16:19:01.173675 (MainThread): 
2021-01-28 16:19:01.174041 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 16:19:01.185047 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 16:19:01.200934 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 16:19:01.201129 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 16:19:01.201220 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-28 16:19:01.905102 (ThreadPoolExecutor-1_0): subprocess 9297 is still running
2021-01-28 16:19:05.682683 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.48 seconds
2021-01-28 16:19:06.243923 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 16:19:06.537003 (MainThread): 11:19:06 | Concurrency: 1 threads (target='snowflake')
2021-01-28 16:19:06.537341 (MainThread): 11:19:06 | 
2021-01-28 16:19:06.539315 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 16:19:06.539608 (Thread-1): 11:19:06 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 16:19:06.540097 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:19:06.540324 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 16:19:06.568606 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 16:19:06.570717 (Thread-1): finished collecting timing info
2021-01-28 16:19:06.571528 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:19:06.571621 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 16:19:06.571701 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 16:19:07.234807 (Thread-1): subprocess 9422 is still running
2021-01-28 16:19:11.352475 (Thread-1): SQL status: SUCCESS 1 in 4.78 seconds
2021-01-28 16:19:11.352738 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 16:19:11.352885 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-28T16:11:12.498788Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-28 16:19:11.744026 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-28 16:19:11.746619 (Thread-1): finished collecting timing info
2021-01-28 16:19:11.748836 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-28 16:19:12.044257 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 16:19:12.369209 (Thread-1): 11:19:12 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 5.83s]
2021-01-28 16:19:12.370075 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 16:19:12.462269 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 16:19:12.462693 (MainThread): 11:19:12 | 
2021-01-28 16:19:12.462849 (MainThread): 11:19:12 | Finished running 1 test in 11.29s.
2021-01-28 16:19:12.462966 (MainThread): Connection 'master' was properly closed.
2021-01-28 16:19:12.463042 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-28 16:19:12.469159 (MainThread): 
2021-01-28 16:19:12.469364 (MainThread): Completed successfully
2021-01-28 16:19:12.469492 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-28 16:19:12.469760 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051e638940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051e582a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051e5824a8>]}
2021-01-28 16:19:12.470039 (MainThread): Flushing usage events
2021-01-28 17:18:43.353053 (MainThread): Running with dbt=0.18.1
2021-01-28 17:18:43.798607 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 17:18:43.798933 (MainThread): Tracking: tracking
2021-01-28 17:18:43.799074 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b1002a9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b093b87b8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b093b8cc0>]}
2021-01-28 17:18:43.799599 (MainThread): Set downloads directory='/tmp/dbt-downloads-43_hnc2f'
2021-01-28 17:18:43.811457 (MainThread): Installing ../../
2021-01-28 17:18:43.811701 (MainThread):   Creating symlink to local dependency.
2021-01-28 17:18:43.811825 (MainThread):   Installed from <local @ ../../>

2021-01-28 17:18:43.811951 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '385c87aa-c356-4eda-bca2-9d537b1a1a70', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0930a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b0930af98>]}
2021-01-28 17:18:43.812262 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b093b3c18>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b1002a9e8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b093b8cc0>]}
2021-01-28 17:18:43.812414 (MainThread): Flushing usage events
2021-01-28 17:18:45.467889 (MainThread): Running with dbt=0.18.1
2021-01-28 17:18:45.967019 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 17:18:45.968178 (MainThread): Tracking: tracking
2021-01-28 17:18:45.968768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfd4e5f8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfd4e5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bfd4e668>]}
2021-01-28 17:18:46.026353 (MainThread): Partial parsing not enabled
2021-01-28 17:18:46.027396 (MainThread): Parsing macros/catalog.sql
2021-01-28 17:18:46.030034 (MainThread): Parsing macros/adapters.sql
2021-01-28 17:18:46.066235 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 17:18:46.068054 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 17:18:46.078482 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 17:18:46.080725 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 17:18:46.086375 (MainThread): Parsing macros/core.sql
2021-01-28 17:18:46.093250 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 17:18:46.095420 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 17:18:46.097271 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 17:18:46.099530 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 17:18:46.104186 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 17:18:46.114954 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 17:18:46.121908 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 17:18:46.127435 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 17:18:46.148119 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 17:18:46.150211 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 17:18:46.180222 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 17:18:46.187084 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 17:18:46.193091 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 17:18:46.194930 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 17:18:46.208947 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 17:18:46.229518 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 17:18:46.238241 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 17:18:46.239977 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 17:18:46.240906 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 17:18:46.242893 (MainThread): Parsing macros/etc/query.sql
2021-01-28 17:18:46.243914 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 17:18:46.245604 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 17:18:46.288335 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 17:18:46.302936 (MainThread): Partial parsing not enabled
2021-01-28 17:18:46.341743 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:18:46.363274 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:18:46.374519 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:18:46.385594 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:18:46.396816 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:18:46.415504 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:18:46.666525 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 17:18:46.667331 (MainThread): 
2021-01-28 17:18:46.667696 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 17:18:46.674535 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 17:18:46.688794 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 17:18:46.688928 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 17:18:46.689010 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 17:18:47.376952 (ThreadPoolExecutor-0_0): subprocess 19346 is still running
2021-01-28 17:18:50.920237 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 4.23 seconds
2021-01-28 17:18:50.957895 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 17:18:51.272047 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 17:18:51.288444 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 17:18:51.288766 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 17:18:51.289013 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 17:18:52.101801 (ThreadPoolExecutor-1_0): subprocess 19447 is still running
2021-01-28 17:18:55.825648 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 4.54 seconds
2021-01-28 17:18:56.379891 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 17:18:56.665879 (MainThread): Using snowflake connection "master".
2021-01-28 17:18:56.666052 (MainThread): On master: BEGIN
2021-01-28 17:18:56.666145 (MainThread): Opening a new connection, currently in state init
2021-01-28 17:18:57.298970 (MainThread): subprocess 19546 is still running
2021-01-28 17:19:00.977099 (MainThread): SQL status: SUCCESS 1 in 4.31 seconds
2021-01-28 17:19:00.977375 (MainThread): On master: COMMIT
2021-01-28 17:19:00.977621 (MainThread): Using snowflake connection "master".
2021-01-28 17:19:00.977718 (MainThread): On master: COMMIT
2021-01-28 17:19:01.250333 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-28 17:19:01.250567 (MainThread): On master: Close
2021-01-28 17:19:01.593207 (MainThread): 12:19:01 | Concurrency: 1 threads (target='snowflake')
2021-01-28 17:19:01.593977 (MainThread): 12:19:01 | 
2021-01-28 17:19:01.599164 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 17:19:01.606304 (Thread-1): 12:19:01 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 17:19:01.607586 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:01.608139 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 17:19:01.640001 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 17:19:01.640385 (Thread-1): finished collecting timing info
2021-01-28 17:19:01.692483 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:01.692667 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 17:19:01.692767 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 17:19:02.279211 (Thread-1): subprocess 19656 is still running
2021-01-28 17:19:06.644475 (Thread-1): SQL status: SUCCESS 1 in 4.95 seconds
2021-01-28 17:19:06.706449 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:06.706671 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 17:19:06.905353 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 17:19:06.908981 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:06.909141 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 17:19:07.118395 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-28 17:19:07.139864 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:07.140091 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 17:19:07.374890 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 17:19:07.486324 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 17:19:07.487411 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:07.487548 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 17:19:07.718854 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 17:19:07.719020 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:07.719102 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 17:19:08.932793 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-01-28 17:19:08.933988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 17:19:08.934165 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 17:19:08.934279 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 17:19:09.105586 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-28 17:19:09.122940 (Thread-1): finished collecting timing info
2021-01-28 17:19:09.123410 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 17:19:09.367325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf4f8120-ec18-4f90-b783-31459cd8f4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7be23f240>]}
2021-01-28 17:19:09.369481 (Thread-1): 12:19:09 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.76s]
2021-01-28 17:19:09.369782 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 17:19:09.370068 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 17:19:09.372061 (Thread-1): 12:19:09 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 17:19:09.372565 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:09.372747 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 17:19:09.383767 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 17:19:09.384191 (Thread-1): finished collecting timing info
2021-01-28 17:19:09.400146 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:09.400336 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 17:19:09.400498 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 17:19:09.981497 (Thread-1): subprocess 19752 is still running
2021-01-28 17:19:13.858979 (Thread-1): SQL status: SUCCESS 1 in 4.46 seconds
2021-01-28 17:19:13.882603 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:13.883382 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 17:19:14.220323 (Thread-1): SQL status: SUCCESS 3 in 0.34 seconds
2021-01-28 17:19:14.238982 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:14.239567 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 17:19:14.466944 (Thread-1): SQL status: SUCCESS 4 in 0.23 seconds
2021-01-28 17:19:14.472838 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:14.473053 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 17:19:14.757869 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 17:19:14.761190 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 17:19:14.762879 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:14.763072 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 17:19:14.962337 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 17:19:14.962979 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:14.963393 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 17:19:16.122996 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-01-28 17:19:16.128494 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 17:19:16.129288 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 17:19:16.129721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 17:19:16.294945 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-28 17:19:16.309671 (Thread-1): finished collecting timing info
2021-01-28 17:19:16.311489 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 17:19:16.579215 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf4f8120-ec18-4f90-b783-31459cd8f4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bc4064a8>]}
2021-01-28 17:19:16.586522 (Thread-1): 12:19:16 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 7.20s]
2021-01-28 17:19:16.587647 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 17:19:16.588692 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 17:19:16.594450 (Thread-1): 12:19:16 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 17:19:16.595443 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:16.595818 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 17:19:16.675342 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 17:19:16.675832 (Thread-1): finished collecting timing info
2021-01-28 17:19:16.697008 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:16.697172 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 17:19:16.697279 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 17:19:17.343073 (Thread-1): subprocess 19848 is still running
2021-01-28 17:19:20.963717 (Thread-1): SQL status: SUCCESS 1 in 4.27 seconds
2021-01-28 17:19:20.978206 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:20.978645 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 17:19:21.174037 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 17:19:21.189519 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:21.189915 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 17:19:21.392149 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 17:19:21.403392 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:21.403697 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 17:19:21.653776 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 17:19:21.681577 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 17:19:21.683710 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:21.683957 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 17:19:21.881961 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 17:19:21.882583 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:21.882940 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 17:19:22.277147 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-28 17:19:22.277818 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:22.278180 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 17:19:23.060848 (Thread-1): SQL status: SUCCESS 2 in 0.78 seconds
2021-01-28 17:19:23.063277 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 17:19:23.063540 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 17:19:23.063668 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 17:19:23.582585 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-01-28 17:19:23.601320 (Thread-1): finished collecting timing info
2021-01-28 17:19:23.602651 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 17:19:23.923287 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf4f8120-ec18-4f90-b783-31459cd8f4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bc3ac550>]}
2021-01-28 17:19:23.930794 (Thread-1): 12:19:23 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 7.33s]
2021-01-28 17:19:23.931692 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 17:19:23.932573 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 17:19:23.939647 (Thread-1): 12:19:23 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 17:19:23.941350 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:23.942014 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 17:19:23.979739 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 17:19:23.980369 (Thread-1): finished collecting timing info
2021-01-28 17:19:23.998166 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:23.998342 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 17:19:23.998448 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 17:19:24.666382 (Thread-1): subprocess 19948 is still running
2021-01-28 17:19:28.288200 (Thread-1): SQL status: SUCCESS 1 in 4.29 seconds
2021-01-28 17:19:28.306941 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:28.307477 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 17:19:28.500518 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 17:19:28.513900 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:28.514418 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 17:19:28.715913 (Thread-1): SQL status: SUCCESS 2 in 0.20 seconds
2021-01-28 17:19:28.730520 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:28.731143 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 17:19:28.946900 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 17:19:28.953680 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 17:19:28.956907 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:28.957539 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 17:19:29.154096 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 17:19:29.154783 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:29.155200 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 17:19:30.318801 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-01-28 17:19:30.324258 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 17:19:30.325048 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 17:19:30.325484 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 17:19:30.543691 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 17:19:30.558913 (Thread-1): finished collecting timing info
2021-01-28 17:19:30.560706 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 17:19:30.827168 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf4f8120-ec18-4f90-b783-31459cd8f4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7bdcee198>]}
2021-01-28 17:19:30.834494 (Thread-1): 12:19:30 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 6.88s]
2021-01-28 17:19:30.835430 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 17:19:30.836452 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 17:19:30.843483 (Thread-1): 12:19:30 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 17:19:30.845245 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:30.846050 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 17:19:30.863495 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 17:19:30.863992 (Thread-1): finished collecting timing info
2021-01-28 17:19:30.879745 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:30.879914 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 17:19:30.880020 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 17:19:31.553768 (Thread-1): subprocess 20045 is still running
2021-01-28 17:19:35.538070 (Thread-1): SQL status: SUCCESS 1 in 4.66 seconds
2021-01-28 17:19:35.559341 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:35.559719 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 17:19:36.943173 (Thread-1): SQL status: SUCCESS 3 in 1.38 seconds
2021-01-28 17:19:36.946699 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:36.946846 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 17:19:37.178606 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-28 17:19:37.193131 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:37.193441 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 17:19:37.457375 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 17:19:37.459039 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 17:19:37.459819 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:37.459914 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 17:19:37.653178 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 17:19:37.654176 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:37.655009 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 17:19:38.764877 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-01-28 17:19:38.770809 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 17:19:38.771925 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 17:19:38.772466 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 17:19:39.183286 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-28 17:19:39.199150 (Thread-1): finished collecting timing info
2021-01-28 17:19:39.200978 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 17:19:39.577880 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf4f8120-ec18-4f90-b783-31459cd8f4eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7be1c4c18>]}
2021-01-28 17:19:39.580353 (Thread-1): 12:19:39 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 8.73s]
2021-01-28 17:19:39.580601 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 17:19:39.610041 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 17:19:39.610528 (MainThread): Using snowflake connection "master".
2021-01-28 17:19:39.610747 (MainThread): On master: BEGIN
2021-01-28 17:19:39.610914 (MainThread): Opening a new connection, currently in state closed
2021-01-28 17:19:40.282272 (MainThread): subprocess 20339 is still running
2021-01-28 17:19:44.077264 (MainThread): SQL status: SUCCESS 1 in 4.47 seconds
2021-01-28 17:19:44.077537 (MainThread): On master: COMMIT
2021-01-28 17:19:44.077770 (MainThread): Using snowflake connection "master".
2021-01-28 17:19:44.077873 (MainThread): On master: COMMIT
2021-01-28 17:19:44.369908 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-28 17:19:44.370161 (MainThread): On master: Close
2021-01-28 17:19:44.663660 (MainThread): 12:19:44 | 
2021-01-28 17:19:44.664129 (MainThread): 12:19:44 | Finished running 5 snowflake_timetravel_table models in 58.00s.
2021-01-28 17:19:44.664425 (MainThread): Connection 'master' was properly closed.
2021-01-28 17:19:44.664604 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 17:19:44.703488 (MainThread): 
2021-01-28 17:19:44.703693 (MainThread): Completed successfully
2021-01-28 17:19:44.703812 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 17:19:44.704064 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7be214b38>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7be226d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7be226c50>]}
2021-01-28 17:19:44.704322 (MainThread): Flushing usage events
2021-01-28 20:15:51.437017 (MainThread): Running with dbt=0.18.1
2021-01-28 20:15:52.138040 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 20:15:52.138665 (MainThread): Tracking: tracking
2021-01-28 20:15:52.138887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7309923df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731070e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73098c36d0>]}
2021-01-28 20:15:52.139493 (MainThread): Set downloads directory='/tmp/dbt-downloads-tkmm6t1t'
2021-01-28 20:15:52.153525 (MainThread): Installing ../../
2021-01-28 20:15:52.153857 (MainThread):   Creating symlink to local dependency.
2021-01-28 20:15:52.153987 (MainThread):   Installed from <local @ ../../>

2021-01-28 20:15:52.154151 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd70bf7aa-4d0a-4de7-9359-14a2c36d9a0e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f730993dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73098cca00>]}
2021-01-28 20:15:52.154529 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7309923df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73098cc130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73098cc310>]}
2021-01-28 20:15:52.154726 (MainThread): Flushing usage events
2021-01-28 20:15:55.742372 (MainThread): Running with dbt=0.18.1
2021-01-28 20:15:56.326292 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 20:15:56.327349 (MainThread): Tracking: tracking
2021-01-28 20:15:56.327869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1864204580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f186b03c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f186420c670>]}
2021-01-28 20:15:56.391311 (MainThread): Partial parsing not enabled
2021-01-28 20:15:56.393969 (MainThread): Parsing macros/catalog.sql
2021-01-28 20:15:56.400416 (MainThread): Parsing macros/adapters.sql
2021-01-28 20:15:56.445513 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 20:15:56.447874 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 20:15:56.461536 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 20:15:56.464764 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 20:15:56.473449 (MainThread): Parsing macros/core.sql
2021-01-28 20:15:56.479018 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 20:15:56.481492 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 20:15:56.483680 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 20:15:56.487282 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 20:15:56.494506 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 20:15:56.514339 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 20:15:56.523735 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 20:15:56.531943 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 20:15:56.579545 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 20:15:56.582092 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 20:15:56.620643 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 20:15:56.629138 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 20:15:56.637395 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 20:15:56.639856 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 20:15:56.657082 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 20:15:56.686455 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 20:15:56.699087 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 20:15:56.701389 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 20:15:56.702609 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 20:15:56.704967 (MainThread): Parsing macros/etc/query.sql
2021-01-28 20:15:56.706339 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 20:15:56.708420 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 20:15:56.769544 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 20:15:56.789604 (MainThread): Partial parsing not enabled
2021-01-28 20:15:56.884230 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:15:56.924575 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:15:56.942560 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:15:56.969214 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:15:56.999161 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:15:57.052464 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:15:57.430181 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 20:15:57.431513 (MainThread): 
2021-01-28 20:15:57.432132 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 20:15:57.440135 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 20:15:57.459629 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 20:15:57.459875 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 20:15:57.460030 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 20:15:58.555109 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.09 seconds
2021-01-28 20:15:58.619489 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 20:15:58.978569 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 20:15:58.992762 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 20:15:58.992956 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 20:15:58.993095 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 20:16:00.369401 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.38 seconds
2021-01-28 20:16:00.846391 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 20:16:01.191671 (MainThread): Using snowflake connection "master".
2021-01-28 20:16:01.192288 (MainThread): On master: BEGIN
2021-01-28 20:16:01.192776 (MainThread): Opening a new connection, currently in state init
2021-01-28 20:16:02.860087 (MainThread): SQL status: SUCCESS 1 in 1.67 seconds
2021-01-28 20:16:02.860331 (MainThread): On master: COMMIT
2021-01-28 20:16:02.860583 (MainThread): Using snowflake connection "master".
2021-01-28 20:16:02.860693 (MainThread): On master: COMMIT
2021-01-28 20:16:03.376216 (MainThread): SQL status: SUCCESS 1 in 0.52 seconds
2021-01-28 20:16:03.376593 (MainThread): On master: Close
2021-01-28 20:16:03.888513 (MainThread): 15:16:03 | Concurrency: 1 threads (target='snowflake')
2021-01-28 20:16:03.889933 (MainThread): 15:16:03 | 
2021-01-28 20:16:03.899306 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:16:03.906582 (Thread-1): 15:16:03 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 20:16:03.908382 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:03.909231 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:16:03.957739 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 20:16:03.958239 (Thread-1): finished collecting timing info
2021-01-28 20:16:04.026996 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:04.027161 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:16:04.027263 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:16:05.729014 (Thread-1): SQL status: SUCCESS 1 in 1.70 seconds
2021-01-28 20:16:05.766316 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:05.766500 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:16:06.071141 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-28 20:16:06.092247 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:06.093076 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 20:16:06.548778 (Thread-1): SQL status: SUCCESS 3 in 0.45 seconds
2021-01-28 20:16:06.636174 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:06.636548 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 20:16:06.894978 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 20:16:06.909832 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 20:16:06.910816 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:06.910926 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 20:16:07.125898 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 20:16:07.126077 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:07.126165 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 20:16:09.585712 (Thread-1): SQL status: SUCCESS 1 in 2.46 seconds
2021-01-28 20:16:09.588087 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 20:16:09.588452 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:16:09.588623 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 20:16:09.834878 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 20:16:09.876792 (Thread-1): finished collecting timing info
2021-01-28 20:16:09.877175 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 20:16:10.159949 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad493dde-122b-4845-bac6-cf60fceb1519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185e51ba60>]}
2021-01-28 20:16:10.167818 (Thread-1): 15:16:10 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 6.25s]
2021-01-28 20:16:10.168384 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:16:10.168870 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:16:10.173129 (Thread-1): 15:16:10 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 20:16:10.174163 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:10.174652 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:16:10.193107 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 20:16:10.193547 (Thread-1): finished collecting timing info
2021-01-28 20:16:10.208886 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:10.209044 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 20:16:10.209251 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:16:11.205453 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-28 20:16:11.208388 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:11.208530 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:16:11.427480 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-28 20:16:11.430923 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:11.431058 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 20:16:11.920854 (Thread-1): SQL status: SUCCESS 4 in 0.49 seconds
2021-01-28 20:16:11.931297 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:11.931669 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 20:16:13.952181 (Thread-1): SQL status: SUCCESS 1 in 2.02 seconds
2021-01-28 20:16:13.956792 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 20:16:13.959981 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:13.960337 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 20:16:14.748941 (Thread-1): SQL status: SUCCESS 1 in 0.79 seconds
2021-01-28 20:16:14.749508 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:14.749871 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 20:16:16.180673 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-01-28 20:16:16.184433 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 20:16:16.185318 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:16:16.185788 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 20:16:16.464588 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 20:16:16.481425 (Thread-1): finished collecting timing info
2021-01-28 20:16:16.482737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 20:16:16.798125 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad493dde-122b-4845-bac6-cf60fceb1519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185e4c4520>]}
2021-01-28 20:16:16.801713 (Thread-1): 15:16:16 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 6.62s]
2021-01-28 20:16:16.802233 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:16:16.802863 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:16:16.806069 (Thread-1): 15:16:16 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 20:16:16.806861 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:16.807154 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:16:16.822623 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 20:16:16.823075 (Thread-1): finished collecting timing info
2021-01-28 20:16:16.839295 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:16.839467 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:16:16.839573 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:16:17.843845 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-28 20:16:17.846497 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:17.846615 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:16:18.056082 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-28 20:16:18.066766 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:18.067056 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 20:16:18.398631 (Thread-1): SQL status: SUCCESS 3 in 0.33 seconds
2021-01-28 20:16:18.419676 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:18.419942 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 20:16:18.720577 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-28 20:16:18.742701 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 20:16:18.745050 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:18.745256 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 20:16:19.207359 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-28 20:16:19.207565 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:19.207672 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 20:16:19.654750 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-28 20:16:19.655272 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:19.655569 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:16:20.508838 (Thread-1): SQL status: SUCCESS 2 in 0.85 seconds
2021-01-28 20:16:20.509832 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 20:16:20.510001 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:16:20.510082 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 20:16:21.051529 (Thread-1): SQL status: SUCCESS 1 in 0.54 seconds
2021-01-28 20:16:21.062550 (Thread-1): finished collecting timing info
2021-01-28 20:16:21.063538 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 20:16:21.365149 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad493dde-122b-4845-bac6-cf60fceb1519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185cc40670>]}
2021-01-28 20:16:21.368853 (Thread-1): 15:16:21 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.56s]
2021-01-28 20:16:21.369570 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:16:21.370040 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:16:21.375457 (Thread-1): 15:16:21 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 20:16:21.376260 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:21.376525 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:16:21.397443 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 20:16:21.398435 (Thread-1): finished collecting timing info
2021-01-28 20:16:21.430439 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:21.430651 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 20:16:21.430832 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:16:22.595679 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-01-28 20:16:22.601983 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:22.602396 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:16:23.035944 (Thread-1): SQL status: SUCCESS 3 in 0.43 seconds
2021-01-28 20:16:23.055598 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:23.055988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 20:16:23.543459 (Thread-1): SQL status: SUCCESS 2 in 0.49 seconds
2021-01-28 20:16:23.550019 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:23.550273 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 20:16:23.852591 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-28 20:16:23.856379 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 20:16:23.859282 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:23.859703 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 20:16:24.161437 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-28 20:16:24.161957 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:24.162197 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 20:16:25.402625 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-01-28 20:16:25.407363 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 20:16:25.408312 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:16:25.408791 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 20:16:25.703932 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-28 20:16:25.706779 (Thread-1): finished collecting timing info
2021-01-28 20:16:25.707125 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 20:16:25.963515 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad493dde-122b-4845-bac6-cf60fceb1519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185cca5bb0>]}
2021-01-28 20:16:25.965734 (Thread-1): 15:16:25 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.59s]
2021-01-28 20:16:25.966080 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:16:25.966389 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:16:25.969204 (Thread-1): 15:16:25 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 20:16:25.969804 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:25.970046 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:16:25.982412 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 20:16:25.982916 (Thread-1): finished collecting timing info
2021-01-28 20:16:26.000081 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:26.000264 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:16:26.000370 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:16:27.332931 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-01-28 20:16:27.336899 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:27.337082 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:16:27.852879 (Thread-1): SQL status: SUCCESS 3 in 0.52 seconds
2021-01-28 20:16:27.856584 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:27.856721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 20:16:28.257564 (Thread-1): SQL status: SUCCESS 3 in 0.40 seconds
2021-01-28 20:16:28.273846 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:28.274253 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 20:16:28.519774 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 20:16:28.521055 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 20:16:28.521880 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:28.521974 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 20:16:28.726427 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 20:16:28.726823 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:28.727066 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 20:16:29.914855 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-01-28 20:16:29.916157 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 20:16:29.916495 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:16:29.916659 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 20:16:30.122994 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 20:16:30.127466 (Thread-1): finished collecting timing info
2021-01-28 20:16:30.127975 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 20:16:30.435903 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad493dde-122b-4845-bac6-cf60fceb1519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185e4f85b0>]}
2021-01-28 20:16:30.437940 (Thread-1): 15:16:30 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.47s]
2021-01-28 20:16:30.438235 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:16:30.439925 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 20:16:30.440183 (MainThread): Using snowflake connection "master".
2021-01-28 20:16:30.440293 (MainThread): On master: BEGIN
2021-01-28 20:16:30.440399 (MainThread): Opening a new connection, currently in state closed
2021-01-28 20:16:31.376374 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-28 20:16:31.376706 (MainThread): On master: COMMIT
2021-01-28 20:16:31.376998 (MainThread): Using snowflake connection "master".
2021-01-28 20:16:31.377163 (MainThread): On master: COMMIT
2021-01-28 20:16:31.718283 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-28 20:16:31.718552 (MainThread): On master: Close
2021-01-28 20:16:32.517167 (MainThread): 15:16:32 | 
2021-01-28 20:16:32.517692 (MainThread): 15:16:32 | Finished running 5 snowflake_timetravel_table models in 35.09s.
2021-01-28 20:16:32.518201 (MainThread): Connection 'master' was properly closed.
2021-01-28 20:16:32.518493 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 20:16:32.555960 (MainThread): 
2021-01-28 20:16:32.556148 (MainThread): Completed successfully
2021-01-28 20:16:32.556273 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 20:16:32.556487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185e4fa4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185e4fa190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f185e4fad00>]}
2021-01-28 20:16:32.556715 (MainThread): Flushing usage events
2021-01-28 20:17:23.775971 (MainThread): Running with dbt=0.19.0
2021-01-28 20:17:24.319399 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 20:17:24.319727 (MainThread): Tracking: tracking
2021-01-28 20:17:24.319893 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cf556610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d787afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cf563b50>]}
2021-01-28 20:17:24.320475 (MainThread): Set downloads directory='/tmp/dbt-downloads-kmy6gyjb'
2021-01-28 20:17:24.332114 (MainThread): Installing ../../
2021-01-28 20:17:24.332393 (MainThread):   Creating symlink to local dependency.
2021-01-28 20:17:24.332519 (MainThread):   Installed from <local @ ../../>

2021-01-28 20:17:24.332667 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '3f38b19b-00d7-4b59-a87d-5f6ec9b0d7ec', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cf563fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cf5639d0>]}
2021-01-28 20:17:24.333018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cf556610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0d787afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0cf4f3e80>]}
2021-01-28 20:17:24.333225 (MainThread): Flushing usage events
2021-01-28 20:17:26.097436 (MainThread): Running with dbt=0.19.0
2021-01-28 20:17:26.669460 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 20:17:26.670577 (MainThread): Tracking: tracking
2021-01-28 20:17:26.671194 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cc321a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d2054490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cc2b2820>]}
2021-01-28 20:17:26.736336 (MainThread): Partial parsing not enabled
2021-01-28 20:17:26.738038 (MainThread): Parsing macros/catalog.sql
2021-01-28 20:17:26.741273 (MainThread): Parsing macros/adapters.sql
2021-01-28 20:17:26.779588 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 20:17:26.782048 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 20:17:26.792578 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 20:17:26.794833 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 20:17:26.801591 (MainThread): Parsing macros/core.sql
2021-01-28 20:17:26.806191 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 20:17:26.808174 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 20:17:26.809869 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 20:17:26.812232 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 20:17:26.816516 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 20:17:26.826822 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 20:17:26.835355 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 20:17:26.841062 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 20:17:26.862165 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 20:17:26.864253 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 20:17:26.902808 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 20:17:26.912404 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 20:17:26.921047 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 20:17:26.923379 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 20:17:26.941037 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 20:17:26.968367 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 20:17:26.978350 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 20:17:26.980125 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 20:17:26.981260 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 20:17:26.983466 (MainThread): Parsing macros/etc/query.sql
2021-01-28 20:17:26.984578 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 20:17:26.986358 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 20:17:27.038640 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 20:17:27.054833 (MainThread): Partial parsing not enabled
2021-01-28 20:17:27.104163 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:27.129689 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:27.141753 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:27.154534 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:27.167033 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:17:27.187184 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:27.347078 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea13ce6-ecd3-4bc7-8d0a-814247dc3561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cb0097c0>]}
2021-01-28 20:17:27.384074 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-28 20:17:27.384953 (MainThread): 
2021-01-28 20:17:27.385280 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 20:17:27.392091 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 20:17:27.408200 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 20:17:27.408350 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 20:17:27.408446 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 20:17:29.184034 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.78 seconds
2021-01-28 20:17:29.204290 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 20:17:29.483570 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 20:17:29.494187 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 20:17:29.494367 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 20:17:29.494484 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 20:17:30.811594 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.32 seconds
2021-01-28 20:17:31.212489 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 20:17:32.177207 (MainThread): Using snowflake connection "master".
2021-01-28 20:17:32.177384 (MainThread): On master: BEGIN
2021-01-28 20:17:32.177491 (MainThread): Opening a new connection, currently in state init
2021-01-28 20:17:33.573193 (MainThread): SQL status: SUCCESS 1 in 1.40 seconds
2021-01-28 20:17:33.573984 (MainThread): On master: COMMIT
2021-01-28 20:17:33.574907 (MainThread): Using snowflake connection "master".
2021-01-28 20:17:33.575463 (MainThread): On master: COMMIT
2021-01-28 20:17:34.106545 (MainThread): SQL status: SUCCESS 1 in 0.53 seconds
2021-01-28 20:17:34.106962 (MainThread): On master: Close
2021-01-28 20:17:34.408257 (MainThread): 15:17:34 | Concurrency: 1 threads (target='snowflake')
2021-01-28 20:17:34.408928 (MainThread): 15:17:34 | 
2021-01-28 20:17:34.412069 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:17:34.414600 (Thread-1): 15:17:34 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 20:17:34.415149 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:34.415362 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:17:34.444218 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 20:17:34.444587 (Thread-1): finished collecting timing info
2021-01-28 20:17:34.495890 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:34.496124 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:17:34.496259 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:17:36.103481 (Thread-1): SQL status: SUCCESS 1 in 1.61 seconds
2021-01-28 20:17:36.119242 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:36.119416 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:17:36.295611 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-28 20:17:36.309230 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:36.309440 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 20:17:36.788792 (Thread-1): SQL status: SUCCESS 3 in 0.48 seconds
2021-01-28 20:17:36.809759 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:36.809925 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 20:17:37.273943 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-28 20:17:37.306564 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 20:17:37.307611 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:37.307721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 20:17:37.583211 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 20:17:37.584136 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:37.584629 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 20:17:40.754060 (Thread-1): SQL status: SUCCESS 1 in 3.17 seconds
2021-01-28 20:17:40.755625 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 20:17:40.756291 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 20:17:40.756425 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 20:17:41.061031 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-28 20:17:41.080440 (Thread-1): finished collecting timing info
2021-01-28 20:17:41.080858 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 20:17:41.585805 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea13ce6-ecd3-4bc7-8d0a-814247dc3561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cb1d66d0>]}
2021-01-28 20:17:41.590506 (Thread-1): 15:17:41 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.17s]
2021-01-28 20:17:41.590925 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 20:17:41.591309 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:17:41.594465 (Thread-1): 15:17:41 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 20:17:41.595103 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:41.595358 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:17:41.606630 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 20:17:41.607043 (Thread-1): finished collecting timing info
2021-01-28 20:17:41.624422 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:41.624617 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 20:17:41.624722 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:17:42.569037 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-28 20:17:42.579509 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:42.579846 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:17:42.983541 (Thread-1): SQL status: SUCCESS 3 in 0.40 seconds
2021-01-28 20:17:42.993809 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:42.994126 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 20:17:43.193857 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-28 20:17:43.209774 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:43.210318 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 20:17:43.423035 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 20:17:43.425271 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 20:17:43.426795 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:43.427024 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 20:17:43.649424 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 20:17:43.650165 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:43.650725 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 20:17:44.925902 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-01-28 20:17:44.927500 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 20:17:44.927878 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 20:17:44.928906 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 20:17:46.029642 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-01-28 20:17:46.045907 (Thread-1): finished collecting timing info
2021-01-28 20:17:46.047287 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 20:17:46.317372 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea13ce6-ecd3-4bc7-8d0a-814247dc3561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c84cb8b0>]}
2021-01-28 20:17:46.319845 (Thread-1): 15:17:46 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.72s]
2021-01-28 20:17:46.320169 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 20:17:46.320493 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:17:46.322603 (Thread-1): 15:17:46 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 20:17:46.323220 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:46.323429 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:17:46.337993 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 20:17:46.338498 (Thread-1): finished collecting timing info
2021-01-28 20:17:46.355527 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:46.355700 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:17:46.355813 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:17:47.880602 (Thread-1): SQL status: SUCCESS 1 in 1.52 seconds
2021-01-28 20:17:47.890801 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:47.891207 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:17:48.113122 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-28 20:17:48.123490 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:48.123708 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 20:17:48.368008 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-28 20:17:48.373720 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:48.373943 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 20:17:48.656964 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 20:17:48.669764 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 20:17:48.671138 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:48.671275 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 20:17:49.009873 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-28 20:17:49.010052 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:49.010157 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 20:17:49.456735 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-28 20:17:49.457108 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:49.457300 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:17:50.346626 (Thread-1): SQL status: SUCCESS 2 in 0.89 seconds
2021-01-28 20:17:50.347766 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 20:17:50.347961 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 20:17:50.348055 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 20:17:51.372185 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-28 20:17:51.392106 (Thread-1): finished collecting timing info
2021-01-28 20:17:51.392895 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 20:17:51.661722 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea13ce6-ecd3-4bc7-8d0a-814247dc3561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c852fd60>]}
2021-01-28 20:17:51.665203 (Thread-1): 15:17:51 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.34s]
2021-01-28 20:17:51.665706 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 20:17:51.666184 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:17:51.668754 (Thread-1): 15:17:51 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 20:17:51.669473 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:51.669702 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:17:51.681218 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 20:17:51.681779 (Thread-1): finished collecting timing info
2021-01-28 20:17:51.699909 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:51.700089 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 20:17:51.700204 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:17:53.764109 (Thread-1): SQL status: SUCCESS 1 in 2.06 seconds
2021-01-28 20:17:53.782351 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:53.782726 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:17:54.068021 (Thread-1): SQL status: SUCCESS 3 in 0.28 seconds
2021-01-28 20:17:54.078130 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:54.078512 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 20:17:54.581114 (Thread-1): SQL status: SUCCESS 2 in 0.50 seconds
2021-01-28 20:17:54.594745 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:54.595071 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 20:17:55.705944 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-01-28 20:17:55.710712 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 20:17:55.712957 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:55.713378 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 20:17:56.220163 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-28 20:17:56.220789 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:56.222721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 20:17:57.860286 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-01-28 20:17:57.866574 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 20:17:57.867483 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 20:17:57.867926 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 20:17:58.033183 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-28 20:17:58.043295 (Thread-1): finished collecting timing info
2021-01-28 20:17:58.044385 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 20:17:58.344760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea13ce6-ecd3-4bc7-8d0a-814247dc3561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50c84b95e0>]}
2021-01-28 20:17:58.346347 (Thread-1): 15:17:58 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 6.68s]
2021-01-28 20:17:58.346555 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 20:17:58.346739 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:17:58.348095 (Thread-1): 15:17:58 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 20:17:58.348839 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:17:58.349046 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:17:58.358810 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 20:17:58.359237 (Thread-1): finished collecting timing info
2021-01-28 20:17:58.374760 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:17:58.374961 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 20:17:58.375079 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 20:17:59.398881 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-28 20:17:59.403190 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:17:59.403381 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:17:59.666881 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-28 20:17:59.681819 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:17:59.682400 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 20:17:59.903701 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-28 20:17:59.919798 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:17:59.920396 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 20:18:00.252358 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-28 20:18:00.256709 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 20:18:00.259648 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:18:00.260019 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 20:18:00.498203 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-28 20:18:00.498987 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:18:00.500031 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 20:18:01.490710 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-28 20:18:01.491768 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 20:18:01.491926 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 20:18:01.492023 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 20:18:01.666455 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-28 20:18:01.673564 (Thread-1): finished collecting timing info
2021-01-28 20:18:01.674370 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 20:18:01.940947 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea13ce6-ecd3-4bc7-8d0a-814247dc3561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cafc0700>]}
2021-01-28 20:18:01.945250 (Thread-1): 15:18:01 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.59s]
2021-01-28 20:18:01.945851 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 20:18:01.949443 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 20:18:01.950740 (MainThread): Using snowflake connection "master".
2021-01-28 20:18:01.951136 (MainThread): On master: BEGIN
2021-01-28 20:18:01.951582 (MainThread): Opening a new connection, currently in state closed
2021-01-28 20:18:03.070593 (MainThread): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-28 20:18:03.071020 (MainThread): On master: COMMIT
2021-01-28 20:18:03.071476 (MainThread): Using snowflake connection "master".
2021-01-28 20:18:03.071736 (MainThread): On master: COMMIT
2021-01-28 20:18:03.890843 (MainThread): SQL status: SUCCESS 1 in 0.82 seconds
2021-01-28 20:18:03.891495 (MainThread): On master: Close
2021-01-28 20:18:04.155393 (MainThread): 15:18:04 | 
2021-01-28 20:18:04.155772 (MainThread): 15:18:04 | Finished running 5 snowflake_timetravel_table models in 36.77s.
2021-01-28 20:18:04.156011 (MainThread): Connection 'master' was properly closed.
2021-01-28 20:18:04.156174 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 20:18:04.206029 (MainThread): 
2021-01-28 20:18:04.206249 (MainThread): Completed successfully
2021-01-28 20:18:04.206429 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 20:18:04.206669 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cb10e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50caf6c1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50cb0097c0>]}
2021-01-28 20:18:04.206901 (MainThread): Flushing usage events
2021-01-28 22:18:29.095781 (MainThread): Running with dbt=0.18.1
2021-01-28 22:18:29.640625 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 22:18:29.641233 (MainThread): Tracking: tracking
2021-01-28 22:18:29.641447 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4bf2e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac52ce8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4bec6370>]}
2021-01-28 22:18:29.642092 (MainThread): Set downloads directory='/tmp/dbt-downloads-f7mao7f9'
2021-01-28 22:18:29.654033 (MainThread): Installing ../../
2021-01-28 22:18:29.654368 (MainThread):   Creating symlink to local dependency.
2021-01-28 22:18:29.654498 (MainThread):   Installed from <local @ ../../>

2021-01-28 22:18:29.654664 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '500913e7-690e-48eb-b0f9-61d583dbead1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4bec6ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4bec6670>]}
2021-01-28 22:18:29.655009 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4bf2e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac52ce8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac4bec6f10>]}
2021-01-28 22:18:29.655177 (MainThread): Flushing usage events
2021-01-28 22:18:31.340179 (MainThread): Running with dbt=0.18.1
2021-01-28 22:18:31.864750 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 22:18:31.868283 (MainThread): Tracking: tracking
2021-01-28 22:18:31.868675 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75f409340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa76622c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75f40d580>]}
2021-01-28 22:18:31.912381 (MainThread): Partial parsing not enabled
2021-01-28 22:18:31.913565 (MainThread): Parsing macros/catalog.sql
2021-01-28 22:18:31.916847 (MainThread): Parsing macros/adapters.sql
2021-01-28 22:18:31.955229 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 22:18:31.957154 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 22:18:31.969169 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 22:18:31.971641 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 22:18:31.978779 (MainThread): Parsing macros/core.sql
2021-01-28 22:18:31.983584 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 22:18:31.985801 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 22:18:31.987779 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 22:18:31.990102 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 22:18:31.994769 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 22:18:32.005999 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 22:18:32.014992 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 22:18:32.021166 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 22:18:32.043675 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 22:18:32.045878 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 22:18:32.081096 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 22:18:32.088671 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 22:18:32.096291 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 22:18:32.098484 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 22:18:32.115387 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 22:18:32.140195 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 22:18:32.152445 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 22:18:32.154418 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 22:18:32.155538 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 22:18:32.157902 (MainThread): Parsing macros/etc/query.sql
2021-01-28 22:18:32.159344 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 22:18:32.161680 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 22:18:32.217712 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 22:18:32.239347 (MainThread): Partial parsing not enabled
2021-01-28 22:18:32.285541 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:32.310846 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:32.322613 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:32.334930 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:32.347196 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:18:32.367652 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:32.562518 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 22:18:32.563438 (MainThread): 
2021-01-28 22:18:32.563806 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:18:32.570757 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 22:18:32.587641 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 22:18:32.587822 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 22:18:32.587925 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 22:18:34.473214 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.89 seconds
2021-01-28 22:18:34.498104 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 22:18:34.816088 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:18:34.826144 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:18:34.826346 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 22:18:34.826472 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 22:18:35.789308 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 0.96 seconds
2021-01-28 22:18:36.208338 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 22:18:36.521147 (MainThread): Using snowflake connection "master".
2021-01-28 22:18:36.521313 (MainThread): On master: BEGIN
2021-01-28 22:18:36.521431 (MainThread): Opening a new connection, currently in state init
2021-01-28 22:18:37.427891 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-28 22:18:37.428251 (MainThread): On master: COMMIT
2021-01-28 22:18:37.428611 (MainThread): Using snowflake connection "master".
2021-01-28 22:18:37.428778 (MainThread): On master: COMMIT
2021-01-28 22:18:37.707985 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 22:18:37.708722 (MainThread): On master: Close
2021-01-28 22:18:37.963482 (MainThread): 17:18:37 | Concurrency: 1 threads (target='snowflake')
2021-01-28 22:18:37.963918 (MainThread): 17:18:37 | 
2021-01-28 22:18:37.967207 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:18:37.969883 (Thread-1): 17:18:37 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 22:18:37.970646 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:37.970937 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:18:38.002637 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:18:38.003014 (Thread-1): finished collecting timing info
2021-01-28 22:18:38.054805 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:38.054970 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:18:38.055067 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:18:39.150747 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-01-28 22:18:39.186449 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:39.186639 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:18:39.386490 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 22:18:39.397630 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:39.397968 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 22:18:39.897410 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-01-28 22:18:39.922721 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:39.922884 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 22:18:40.170001 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 22:18:40.183440 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:18:40.184543 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:40.184669 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 22:18:40.372548 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 22:18:40.373413 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:40.373883 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:18:41.945908 (Thread-1): SQL status: SUCCESS 1 in 1.57 seconds
2021-01-28 22:18:41.948070 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:18:41.948518 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:18:41.948729 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:18:42.113989 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-28 22:18:42.142283 (Thread-1): finished collecting timing info
2021-01-28 22:18:42.142699 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 22:18:42.442001 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f4c894-9c7b-427e-8544-d6e774a79d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75d759dc0>]}
2021-01-28 22:18:42.444017 (Thread-1): 17:18:42 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.47s]
2021-01-28 22:18:42.444307 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:18:42.444537 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:18:42.446373 (Thread-1): 17:18:42 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 22:18:42.446866 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:42.447034 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:18:42.459357 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:18:42.459861 (Thread-1): finished collecting timing info
2021-01-28 22:18:42.475175 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:42.475653 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 22:18:42.476030 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:18:43.481939 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-28 22:18:43.487312 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:43.487526 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:18:43.682031 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:18:43.686131 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:43.686301 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 22:18:44.238590 (Thread-1): SQL status: SUCCESS 4 in 0.55 seconds
2021-01-28 22:18:44.246927 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:44.247166 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 22:18:44.478389 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 22:18:44.483127 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:18:44.485381 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:44.485718 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 22:18:44.712349 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 22:18:44.712621 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:44.712770 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 22:18:46.422031 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-01-28 22:18:46.423482 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:18:46.423695 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:18:46.423802 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:18:46.612274 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 22:18:46.618694 (Thread-1): finished collecting timing info
2021-01-28 22:18:46.619487 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 22:18:46.902515 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f4c894-9c7b-427e-8544-d6e774a79d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75d737f10>]}
2021-01-28 22:18:46.905127 (Thread-1): 17:18:46 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.46s]
2021-01-28 22:18:46.905453 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:18:46.905765 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:18:46.908074 (Thread-1): 17:18:46 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 22:18:46.909077 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:46.909514 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:18:46.924292 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:18:46.924720 (Thread-1): finished collecting timing info
2021-01-28 22:18:46.945070 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:46.945255 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:18:46.945380 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:18:47.952054 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-28 22:18:47.956938 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:47.957163 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:18:48.134054 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-28 22:18:48.138635 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:48.138776 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 22:18:48.788802 (Thread-1): SQL status: SUCCESS 3 in 0.65 seconds
2021-01-28 22:18:48.810234 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:48.810628 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 22:18:49.307575 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-28 22:18:49.322907 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:18:49.324015 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:49.324134 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 22:18:49.533806 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 22:18:49.533978 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:49.534070 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 22:18:49.986447 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-28 22:18:49.986718 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:49.986865 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:18:51.195664 (Thread-1): SQL status: SUCCESS 2 in 1.21 seconds
2021-01-28 22:18:51.201443 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:18:51.202386 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:18:51.202796 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:18:51.946588 (Thread-1): SQL status: SUCCESS 1 in 0.74 seconds
2021-01-28 22:18:51.952637 (Thread-1): finished collecting timing info
2021-01-28 22:18:51.953339 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 22:18:52.196731 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f4c894-9c7b-427e-8544-d6e774a79d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75c6eabe0>]}
2021-01-28 22:18:52.199684 (Thread-1): 17:18:52 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.29s]
2021-01-28 22:18:52.200039 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:18:52.200349 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:18:52.202841 (Thread-1): 17:18:52 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 22:18:52.203589 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:52.203828 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:18:52.218811 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:18:52.219262 (Thread-1): finished collecting timing info
2021-01-28 22:18:52.238764 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:52.238935 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 22:18:52.239039 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:18:53.312761 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-28 22:18:53.321265 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:53.321678 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:18:53.827925 (Thread-1): SQL status: SUCCESS 3 in 0.51 seconds
2021-01-28 22:18:53.846453 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:53.847221 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 22:18:54.143763 (Thread-1): SQL status: SUCCESS 2 in 0.30 seconds
2021-01-28 22:18:54.156635 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:54.159090 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 22:18:54.539653 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-28 22:18:54.541665 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:18:54.546949 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:54.547180 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 22:18:57.879605 (Thread-1): SQL status: SUCCESS 1 in 3.33 seconds
2021-01-28 22:18:57.880002 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:57.880262 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 22:18:58.900018 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-28 22:18:58.905609 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:18:58.906488 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:18:58.906985 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:18:59.155176 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 22:18:59.159120 (Thread-1): finished collecting timing info
2021-01-28 22:18:59.160618 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 22:18:59.425136 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f4c894-9c7b-427e-8544-d6e774a79d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75d770580>]}
2021-01-28 22:18:59.428471 (Thread-1): 17:18:59 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 7.22s]
2021-01-28 22:18:59.428943 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:18:59.429337 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:18:59.432036 (Thread-1): 17:18:59 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 22:18:59.433220 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:18:59.433667 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:18:59.464863 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:18:59.465294 (Thread-1): finished collecting timing info
2021-01-28 22:18:59.479855 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:18:59.480022 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:18:59.480123 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:19:00.469587 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-28 22:19:00.479829 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:19:00.480178 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:19:00.678155 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 22:19:00.688212 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:19:00.688541 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 22:19:00.932623 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-28 22:19:00.951356 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:19:00.951632 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 22:19:01.216057 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 22:19:01.217448 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:19:01.218384 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:19:01.218490 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 22:19:01.424715 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 22:19:01.425228 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:19:01.425546 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:19:02.786651 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-28 22:19:02.790721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:19:02.791366 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:19:02.791694 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:19:02.994420 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:19:03.006508 (Thread-1): finished collecting timing info
2021-01-28 22:19:03.007625 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 22:19:03.277943 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3f4c894-9c7b-427e-8544-d6e774a79d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75c69aa60>]}
2021-01-28 22:19:03.280410 (Thread-1): 17:19:03 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.84s]
2021-01-28 22:19:03.280756 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:19:03.282924 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:19:03.283396 (MainThread): Using snowflake connection "master".
2021-01-28 22:19:03.283579 (MainThread): On master: BEGIN
2021-01-28 22:19:03.283757 (MainThread): Opening a new connection, currently in state closed
2021-01-28 22:19:04.457139 (MainThread): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-28 22:19:04.457521 (MainThread): On master: COMMIT
2021-01-28 22:19:04.457975 (MainThread): Using snowflake connection "master".
2021-01-28 22:19:04.459063 (MainThread): On master: COMMIT
2021-01-28 22:19:04.747193 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-28 22:19:04.747963 (MainThread): On master: Close
2021-01-28 22:19:05.016005 (MainThread): 17:19:05 | 
2021-01-28 22:19:05.016479 (MainThread): 17:19:05 | Finished running 5 snowflake_timetravel_table models in 32.45s.
2021-01-28 22:19:05.016830 (MainThread): Connection 'master' was properly closed.
2021-01-28 22:19:05.017079 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 22:19:05.044086 (MainThread): 
2021-01-28 22:19:05.044344 (MainThread): Completed successfully
2021-01-28 22:19:05.044484 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 22:19:05.044715 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75d71e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75d71e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa75d71e3d0>]}
2021-01-28 22:19:05.044959 (MainThread): Flushing usage events
2021-01-28 22:19:50.579701 (MainThread): Running with dbt=0.19.0
2021-01-28 22:19:51.102793 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 22:19:51.103111 (MainThread): Tracking: tracking
2021-01-28 22:19:51.103263 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9bfef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa533feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9bffba90>]}
2021-01-28 22:19:51.103800 (MainThread): Set downloads directory='/tmp/dbt-downloads-qsvd_te6'
2021-01-28 22:19:51.114769 (MainThread): Installing ../../
2021-01-28 22:19:51.115061 (MainThread):   Creating symlink to local dependency.
2021-01-28 22:19:51.115194 (MainThread):   Installed from <local @ ../../>

2021-01-28 22:19:51.115348 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '21d01abd-dd52-449d-8d24-5dbe4373567a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9bffbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9bffbe50>]}
2021-01-28 22:19:51.115684 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9bfef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8aa533feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9bf8bdf0>]}
2021-01-28 22:19:51.115846 (MainThread): Flushing usage events
2021-01-28 22:19:52.968983 (MainThread): Running with dbt=0.19.0
2021-01-28 22:19:53.499826 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 22:19:53.500710 (MainThread): Tracking: tracking
2021-01-28 22:19:53.501050 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621ed8e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6224abb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621ed1f730>]}
2021-01-28 22:19:53.543589 (MainThread): Partial parsing not enabled
2021-01-28 22:19:53.544739 (MainThread): Parsing macros/catalog.sql
2021-01-28 22:19:53.547995 (MainThread): Parsing macros/adapters.sql
2021-01-28 22:19:53.585332 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 22:19:53.587204 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 22:19:53.599960 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 22:19:53.602464 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 22:19:53.609833 (MainThread): Parsing macros/core.sql
2021-01-28 22:19:53.614920 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 22:19:53.617026 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 22:19:53.618876 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 22:19:53.621205 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 22:19:53.624634 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 22:19:53.635169 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 22:19:53.643682 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 22:19:53.649780 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 22:19:53.672241 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 22:19:53.675290 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 22:19:53.716942 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 22:19:53.726054 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 22:19:53.733598 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 22:19:53.735934 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 22:19:53.752989 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 22:19:53.781433 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 22:19:53.793914 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 22:19:53.796057 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 22:19:53.797200 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 22:19:53.799637 (MainThread): Parsing macros/etc/query.sql
2021-01-28 22:19:53.800920 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 22:19:53.802994 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 22:19:53.855974 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 22:19:53.873835 (MainThread): Partial parsing not enabled
2021-01-28 22:19:53.920462 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:19:53.944748 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:19:53.957798 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:19:53.969998 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:19:53.982318 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:19:54.003230 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:19:54.165245 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee6390e1-886d-41a5-8a53-bbce0b01f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621d9456a0>]}
2021-01-28 22:19:54.201412 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-28 22:19:54.202298 (MainThread): 
2021-01-28 22:19:54.202661 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:19:54.210239 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 22:19:54.227008 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 22:19:54.227163 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 22:19:54.227261 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 22:19:55.511639 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.28 seconds
2021-01-28 22:19:55.523513 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 22:19:55.797545 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:19:55.808188 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:19:55.808371 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 22:19:55.808487 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 22:19:57.001529 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.19 seconds
2021-01-28 22:19:57.401338 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 22:19:57.799193 (MainThread): Using snowflake connection "master".
2021-01-28 22:19:57.799499 (MainThread): On master: BEGIN
2021-01-28 22:19:57.799749 (MainThread): Opening a new connection, currently in state init
2021-01-28 22:19:58.696396 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-28 22:19:58.697101 (MainThread): On master: COMMIT
2021-01-28 22:19:58.697710 (MainThread): Using snowflake connection "master".
2021-01-28 22:19:58.698049 (MainThread): On master: COMMIT
2021-01-28 22:19:59.017465 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-28 22:19:59.018154 (MainThread): On master: Close
2021-01-28 22:19:59.323727 (MainThread): 17:19:59 | Concurrency: 1 threads (target='snowflake')
2021-01-28 22:19:59.324501 (MainThread): 17:19:59 | 
2021-01-28 22:19:59.330546 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:19:59.334190 (Thread-1): 17:19:59 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 22:19:59.335150 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:19:59.335524 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:19:59.358654 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:19:59.359056 (Thread-1): finished collecting timing info
2021-01-28 22:19:59.414825 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:19:59.414981 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:19:59.415082 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:20:00.387114 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-28 22:20:00.404561 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:20:00.404776 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:20:00.586393 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-28 22:20:00.599192 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:20:00.599634 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 22:20:00.954777 (Thread-1): SQL status: SUCCESS 3 in 0.35 seconds
2021-01-28 22:20:00.982135 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:20:00.982343 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 22:20:01.413529 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-28 22:20:01.446375 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:20:01.447659 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:20:01.447828 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 22:20:01.925065 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-28 22:20:01.925541 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:20:01.925858 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:20:03.667410 (Thread-1): SQL status: SUCCESS 1 in 1.74 seconds
2021-01-28 22:20:03.670152 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:20:03.670638 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:20:03.670887 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:20:04.060469 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-28 22:20:04.080910 (Thread-1): finished collecting timing info
2021-01-28 22:20:04.081336 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 22:20:04.352537 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6390e1-886d-41a5-8a53-bbce0b01f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621ec76400>]}
2021-01-28 22:20:04.356780 (Thread-1): 17:20:04 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 5.02s]
2021-01-28 22:20:04.357178 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:20:04.357537 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:20:04.360899 (Thread-1): 17:20:04 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 22:20:04.361847 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:04.362052 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:20:04.371857 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:20:04.372227 (Thread-1): finished collecting timing info
2021-01-28 22:20:04.391114 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:04.391292 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 22:20:04.391397 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:20:05.750444 (Thread-1): SQL status: SUCCESS 1 in 1.36 seconds
2021-01-28 22:20:05.758427 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:05.758779 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:20:06.235494 (Thread-1): SQL status: SUCCESS 3 in 0.48 seconds
2021-01-28 22:20:06.249936 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:06.250298 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 22:20:06.457913 (Thread-1): SQL status: SUCCESS 4 in 0.21 seconds
2021-01-28 22:20:06.476544 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:06.476897 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 22:20:06.952056 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-28 22:20:06.958149 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:20:06.963713 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:06.964186 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 22:20:07.366348 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-28 22:20:07.366645 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:07.366844 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 22:20:09.010959 (Thread-1): SQL status: SUCCESS 1 in 1.64 seconds
2021-01-28 22:20:09.014295 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:20:09.014822 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:20:09.015086 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:20:09.200693 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 22:20:09.214529 (Thread-1): finished collecting timing info
2021-01-28 22:20:09.215284 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 22:20:09.529072 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6390e1-886d-41a5-8a53-bbce0b01f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621ec24d60>]}
2021-01-28 22:20:09.531675 (Thread-1): 17:20:09 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 5.17s]
2021-01-28 22:20:09.531951 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:20:09.532181 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:20:09.533793 (Thread-1): 17:20:09 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 22:20:09.534725 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:09.536618 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:20:09.549021 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:20:09.549396 (Thread-1): finished collecting timing info
2021-01-28 22:20:09.565264 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:09.565434 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:20:09.565556 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:20:10.593955 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-28 22:20:10.599683 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:10.599918 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:20:10.815431 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-28 22:20:10.822782 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:10.823013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 22:20:11.015087 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:20:11.026928 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:11.027471 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 22:20:11.269236 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-28 22:20:11.288841 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:20:11.290557 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:11.290835 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 22:20:11.491700 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:20:11.492361 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:11.492799 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 22:20:11.928620 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-28 22:20:11.929525 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:11.930316 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:20:12.574822 (Thread-1): SQL status: SUCCESS 2 in 0.64 seconds
2021-01-28 22:20:12.578202 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:20:12.578916 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:20:12.579357 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:20:13.249964 (Thread-1): SQL status: SUCCESS 1 in 0.67 seconds
2021-01-28 22:20:13.258805 (Thread-1): finished collecting timing info
2021-01-28 22:20:13.259331 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 22:20:13.575750 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6390e1-886d-41a5-8a53-bbce0b01f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621c1b3fa0>]}
2021-01-28 22:20:13.577346 (Thread-1): 17:20:13 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.04s]
2021-01-28 22:20:13.577544 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:20:13.577721 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:20:13.579024 (Thread-1): 17:20:13 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 22:20:13.579668 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:13.579820 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:20:13.589031 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:20:13.589485 (Thread-1): finished collecting timing info
2021-01-28 22:20:13.604305 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:13.604468 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 22:20:13.604576 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:20:14.615038 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-28 22:20:14.620223 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:14.620464 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:20:14.855700 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-28 22:20:14.871124 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:14.871383 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 22:20:15.060747 (Thread-1): SQL status: SUCCESS 2 in 0.19 seconds
2021-01-28 22:20:15.066485 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:15.066746 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 22:20:15.315391 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 22:20:15.322111 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:20:15.328087 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:15.328978 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 22:20:15.587805 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 22:20:15.588492 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:15.589022 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 22:20:16.745015 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-01-28 22:20:16.751105 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:20:16.751704 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:20:16.751898 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:20:16.912870 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-28 22:20:16.928656 (Thread-1): finished collecting timing info
2021-01-28 22:20:16.930390 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 22:20:17.212153 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6390e1-886d-41a5-8a53-bbce0b01f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621c156130>]}
2021-01-28 22:20:17.221670 (Thread-1): 17:20:17 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 3.63s]
2021-01-28 22:20:17.222998 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:20:17.224331 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:20:17.230185 (Thread-1): 17:20:17 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 22:20:17.230975 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:17.231201 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:20:17.243926 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:20:17.244350 (Thread-1): finished collecting timing info
2021-01-28 22:20:17.260768 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:17.260931 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:20:17.261031 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:20:18.214695 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-28 22:20:18.224051 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:18.224444 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:20:18.421007 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 22:20:18.424957 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:18.425095 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 22:20:18.822513 (Thread-1): SQL status: SUCCESS 3 in 0.40 seconds
2021-01-28 22:20:18.829935 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:18.830188 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 22:20:19.332904 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-28 22:20:19.334285 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:20:19.335165 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:19.335276 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 22:20:19.545479 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 22:20:19.545819 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:19.546030 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:20:20.950460 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-01-28 22:20:20.956233 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:20:20.957389 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:20:20.958106 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:20:21.155087 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:20:21.166881 (Thread-1): finished collecting timing info
2021-01-28 22:20:21.167448 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 22:20:24.659651 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee6390e1-886d-41a5-8a53-bbce0b01f70b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621da69940>]}
2021-01-28 22:20:24.666757 (Thread-1): 17:20:24 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 7.43s]
2021-01-28 22:20:24.667599 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:20:24.671962 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:20:24.672604 (MainThread): Using snowflake connection "master".
2021-01-28 22:20:24.672887 (MainThread): On master: BEGIN
2021-01-28 22:20:24.673178 (MainThread): Opening a new connection, currently in state closed
2021-01-28 22:20:25.566771 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-28 22:20:25.566989 (MainThread): On master: COMMIT
2021-01-28 22:20:25.567177 (MainThread): Using snowflake connection "master".
2021-01-28 22:20:25.567279 (MainThread): On master: COMMIT
2021-01-28 22:20:25.888979 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-28 22:20:25.889244 (MainThread): On master: Close
2021-01-28 22:20:26.168842 (MainThread): 17:20:26 | 
2021-01-28 22:20:26.169567 (MainThread): 17:20:26 | Finished running 5 snowflake_timetravel_table models in 31.97s.
2021-01-28 22:20:26.170347 (MainThread): Connection 'master' was properly closed.
2021-01-28 22:20:26.170775 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 22:20:26.237480 (MainThread): 
2021-01-28 22:20:26.237657 (MainThread): Completed successfully
2021-01-28 22:20:26.237816 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 22:20:26.238172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621ec5a820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621d99d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621ec2fdf0>]}
2021-01-28 22:20:26.238479 (MainThread): Flushing usage events
2021-01-28 22:28:43.788174 (MainThread): Running with dbt=0.18.1
2021-01-28 22:28:44.340047 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 22:28:44.340379 (MainThread): Tracking: tracking
2021-01-28 22:28:44.340534 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a6e3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb814b8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a6836d0>]}
2021-01-28 22:28:44.341094 (MainThread): Set downloads directory='/tmp/dbt-downloads-sbwox5qm'
2021-01-28 22:28:44.354081 (MainThread): Installing ../../
2021-01-28 22:28:44.354399 (MainThread):   Creating symlink to local dependency.
2021-01-28 22:28:44.354531 (MainThread):   Installed from <local @ ../../>

2021-01-28 22:28:44.354688 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '018f9e51-f4d9-4218-9c5c-8761dec5f27f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a6fdee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a68ca00>]}
2021-01-28 22:28:44.355050 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a6e3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a68c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb7a68c310>]}
2021-01-28 22:28:44.355213 (MainThread): Flushing usage events
2021-01-28 22:28:46.113445 (MainThread): Running with dbt=0.18.1
2021-01-28 22:28:46.640322 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 22:28:46.641135 (MainThread): Tracking: tracking
2021-01-28 22:28:46.641454 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe2284520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe90b9460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe228c670>]}
2021-01-28 22:28:46.681867 (MainThread): Partial parsing not enabled
2021-01-28 22:28:46.683036 (MainThread): Parsing macros/catalog.sql
2021-01-28 22:28:46.685920 (MainThread): Parsing macros/adapters.sql
2021-01-28 22:28:46.723429 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 22:28:46.725246 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 22:28:46.738231 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 22:28:46.740695 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 22:28:46.746836 (MainThread): Parsing macros/core.sql
2021-01-28 22:28:46.751428 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 22:28:46.753515 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 22:28:46.755335 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 22:28:46.757516 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 22:28:46.760860 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 22:28:46.772944 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 22:28:46.781951 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 22:28:46.788263 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 22:28:46.809615 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 22:28:46.811771 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 22:28:46.847041 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 22:28:46.855354 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 22:28:46.865211 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 22:28:46.867611 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 22:28:46.887222 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 22:28:46.915388 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 22:28:46.926740 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 22:28:46.928790 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 22:28:46.929947 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 22:28:46.932280 (MainThread): Parsing macros/etc/query.sql
2021-01-28 22:28:46.933567 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 22:28:46.935650 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 22:28:47.004134 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 22:28:47.034982 (MainThread): Partial parsing not enabled
2021-01-28 22:28:47.082131 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:28:47.106578 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:28:47.118806 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:47.130005 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:47.141005 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:28:47.162698 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:28:47.358049 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 22:28:47.358969 (MainThread): 
2021-01-28 22:28:47.359324 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:28:47.367623 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 22:28:47.384955 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 22:28:47.385122 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 22:28:47.385224 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 22:28:48.385427 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.00 seconds
2021-01-28 22:28:48.406014 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 22:28:48.686367 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:28:48.696265 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:28:48.696433 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 22:28:48.696549 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 22:28:49.761885 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.07 seconds
2021-01-28 22:28:50.195471 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 22:28:50.518412 (MainThread): Using snowflake connection "master".
2021-01-28 22:28:50.518608 (MainThread): On master: BEGIN
2021-01-28 22:28:50.518739 (MainThread): Opening a new connection, currently in state init
2021-01-28 22:28:51.411442 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-28 22:28:51.412624 (MainThread): On master: COMMIT
2021-01-28 22:28:51.413875 (MainThread): Using snowflake connection "master".
2021-01-28 22:28:51.414733 (MainThread): On master: COMMIT
2021-01-28 22:28:51.690512 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-28 22:28:51.690707 (MainThread): On master: Close
2021-01-28 22:28:51.959003 (MainThread): 17:28:51 | Concurrency: 1 threads (target='snowflake')
2021-01-28 22:28:51.959925 (MainThread): 17:28:51 | 
2021-01-28 22:28:51.966937 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:28:51.970323 (Thread-1): 17:28:51 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 22:28:51.971070 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:51.971370 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:28:52.001436 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:28:52.001821 (Thread-1): finished collecting timing info
2021-01-28 22:28:52.057240 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:52.057398 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:28:52.057498 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:28:53.356329 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-01-28 22:28:53.384481 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:53.384650 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:28:53.878044 (Thread-1): SQL status: SUCCESS 3 in 0.49 seconds
2021-01-28 22:28:53.887946 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:53.888339 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 22:28:54.142709 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-28 22:28:54.175436 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:54.175623 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 22:28:54.493277 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-28 22:28:54.525436 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:28:54.526894 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:54.527155 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 22:28:54.785496 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 22:28:54.786167 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:54.786940 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:28:55.945091 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-01-28 22:28:55.947327 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:28:55.947668 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:28:55.947843 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:28:56.105254 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-28 22:28:56.153177 (Thread-1): finished collecting timing info
2021-01-28 22:28:56.153798 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 22:28:56.532590 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f580ad-7fa2-43f0-97a2-b08ed8871bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe1fe5130>]}
2021-01-28 22:28:56.545474 (Thread-1): 17:28:56 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.56s]
2021-01-28 22:28:56.547270 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:28:56.548866 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:28:56.557733 (Thread-1): 17:28:56 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 22:28:56.560245 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:56.560839 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:28:56.599466 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:28:56.600312 (Thread-1): finished collecting timing info
2021-01-28 22:28:56.618589 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:56.618783 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 22:28:56.618922 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:28:57.824134 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-01-28 22:28:57.829314 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:57.829561 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:28:58.019942 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:28:58.029624 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:58.030063 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 22:28:58.231880 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-28 22:28:58.237604 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:58.237802 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 22:28:58.505680 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-28 22:28:58.510196 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:28:58.514722 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:58.515294 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 22:28:58.745124 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 22:28:58.745620 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:58.745941 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 22:28:59.715698 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-28 22:28:59.721329 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:28:59.722339 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:28:59.722880 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:28:59.902752 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-28 22:28:59.908213 (Thread-1): finished collecting timing info
2021-01-28 22:28:59.908843 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 22:29:00.146151 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f580ad-7fa2-43f0-97a2-b08ed8871bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe05b8160>]}
2021-01-28 22:29:00.150728 (Thread-1): 17:29:00 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.59s]
2021-01-28 22:29:00.151204 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:29:00.151811 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:29:00.158293 (Thread-1): 17:29:00 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 22:29:00.159170 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:00.159485 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:29:00.172111 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:29:00.172568 (Thread-1): finished collecting timing info
2021-01-28 22:29:00.187347 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:00.187504 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:29:00.187605 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:29:01.156762 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-28 22:29:01.181806 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:01.182134 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:29:01.375237 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:29:01.381535 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:01.381804 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 22:29:01.575081 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:29:01.590336 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:01.590577 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 22:29:01.826434 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-28 22:29:01.837207 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:29:01.838504 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:01.838643 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 22:29:02.022399 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-28 22:29:02.022636 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:02.022772 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 22:29:02.423174 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-28 22:29:02.423777 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:02.424084 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:29:03.141696 (Thread-1): SQL status: SUCCESS 2 in 0.72 seconds
2021-01-28 22:29:03.144190 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:29:03.144694 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:03.144988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:29:03.651298 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-28 22:29:03.654109 (Thread-1): finished collecting timing info
2021-01-28 22:29:03.654489 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 22:29:03.889635 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f580ad-7fa2-43f0-97a2-b08ed8871bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe0504670>]}
2021-01-28 22:29:03.891094 (Thread-1): 17:29:03 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 3.73s]
2021-01-28 22:29:03.891303 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:29:03.891488 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:29:03.892849 (Thread-1): 17:29:03 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 22:29:03.893277 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:03.893415 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:29:03.902229 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:29:03.902692 (Thread-1): finished collecting timing info
2021-01-28 22:29:03.917422 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:03.917658 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 22:29:03.917817 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:29:05.090182 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-28 22:29:05.099241 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:05.099669 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:29:06.111222 (Thread-1): SQL status: SUCCESS 3 in 1.01 seconds
2021-01-28 22:29:06.125859 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:06.126246 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 22:29:06.334794 (Thread-1): SQL status: SUCCESS 2 in 0.21 seconds
2021-01-28 22:29:06.353686 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:06.354037 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 22:29:07.041149 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-01-28 22:29:07.046570 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:29:07.048415 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:07.048878 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 22:29:07.545054 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-28 22:29:07.546738 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:07.547070 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 22:29:08.874372 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-01-28 22:29:08.876511 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:29:08.876861 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:08.877037 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:29:09.033935 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-28 22:29:09.038701 (Thread-1): finished collecting timing info
2021-01-28 22:29:09.039053 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 22:29:09.745296 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f580ad-7fa2-43f0-97a2-b08ed8871bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe05829d0>]}
2021-01-28 22:29:09.747626 (Thread-1): 17:29:09 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 5.85s]
2021-01-28 22:29:09.747896 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:29:09.748121 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:29:09.750271 (Thread-1): 17:29:09 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 22:29:09.750788 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:09.750918 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:29:09.758681 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:29:09.759096 (Thread-1): finished collecting timing info
2021-01-28 22:29:09.774412 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:09.774595 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:29:09.774704 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:29:10.812017 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-28 22:29:10.824200 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:10.824616 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:29:11.259702 (Thread-1): SQL status: SUCCESS 3 in 0.43 seconds
2021-01-28 22:29:11.276988 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:11.277295 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 22:29:11.472536 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 22:29:11.481249 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:11.481574 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 22:29:11.742247 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 22:29:11.750550 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:29:11.755452 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:11.756188 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 22:29:12.110164 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-28 22:29:12.110703 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:12.111093 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:29:13.217215 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-01-28 22:29:13.219259 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:29:13.219613 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:13.219777 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:29:13.388024 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-28 22:29:13.392098 (Thread-1): finished collecting timing info
2021-01-28 22:29:13.392410 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 22:29:13.659229 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6f580ad-7fa2-43f0-97a2-b08ed8871bd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe21ce5e0>]}
2021-01-28 22:29:13.660607 (Thread-1): 17:29:13 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.91s]
2021-01-28 22:29:13.660857 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:29:13.662383 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:29:13.662723 (MainThread): Using snowflake connection "master".
2021-01-28 22:29:13.662834 (MainThread): On master: BEGIN
2021-01-28 22:29:13.662928 (MainThread): Opening a new connection, currently in state closed
2021-01-28 22:29:14.640508 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-28 22:29:14.640993 (MainThread): On master: COMMIT
2021-01-28 22:29:14.641489 (MainThread): Using snowflake connection "master".
2021-01-28 22:29:14.641763 (MainThread): On master: COMMIT
2021-01-28 22:29:14.967712 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-28 22:29:14.968414 (MainThread): On master: Close
2021-01-28 22:29:15.687836 (MainThread): 17:29:15 | 
2021-01-28 22:29:15.688651 (MainThread): 17:29:15 | Finished running 5 snowflake_timetravel_table models in 28.33s.
2021-01-28 22:29:15.689157 (MainThread): Connection 'master' was properly closed.
2021-01-28 22:29:15.689421 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 22:29:15.734201 (MainThread): 
2021-01-28 22:29:15.734418 (MainThread): Completed successfully
2021-01-28 22:29:15.734576 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 22:29:15.734842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe0508340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe0557220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe05d9e20>]}
2021-01-28 22:29:15.735049 (MainThread): Flushing usage events
2021-01-28 22:29:50.737539 (MainThread): Running with dbt=0.19.0
2021-01-28 22:29:51.274175 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 22:29:51.274494 (MainThread): Tracking: tracking
2021-01-28 22:29:51.274646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38912df550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3899603fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38912eb4c0>]}
2021-01-28 22:29:51.275226 (MainThread): Set downloads directory='/tmp/dbt-downloads-jecpnjmm'
2021-01-28 22:29:51.288450 (MainThread): Installing ../../
2021-01-28 22:29:51.288825 (MainThread):   Creating symlink to local dependency.
2021-01-28 22:29:51.288956 (MainThread):   Installed from <local @ ../../>

2021-01-28 22:29:51.289129 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ba9fab0-fce0-40d6-9cfa-b9d8dec5b130', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38912ebdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38912eb550>]}
2021-01-28 22:29:51.289509 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38912df550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38912ebee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38912ebb50>]}
2021-01-28 22:29:51.289674 (MainThread): Flushing usage events
2021-01-28 22:29:53.060994 (MainThread): Running with dbt=0.19.0
2021-01-28 22:29:53.612736 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 22:29:53.613589 (MainThread): Tracking: tracking
2021-01-28 22:29:53.614026 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4e361a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec54094490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4e2f2820>]}
2021-01-28 22:29:53.654811 (MainThread): Partial parsing not enabled
2021-01-28 22:29:53.655945 (MainThread): Parsing macros/catalog.sql
2021-01-28 22:29:53.659251 (MainThread): Parsing macros/adapters.sql
2021-01-28 22:29:53.697693 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 22:29:53.699676 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 22:29:53.710435 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 22:29:53.712702 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 22:29:53.719661 (MainThread): Parsing macros/core.sql
2021-01-28 22:29:53.724439 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 22:29:53.726481 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 22:29:53.728298 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 22:29:53.730644 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 22:29:53.735496 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 22:29:53.746653 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 22:29:53.754964 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 22:29:53.761750 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 22:29:53.784262 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 22:29:53.786478 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 22:29:53.825836 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 22:29:53.835225 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 22:29:53.842977 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 22:29:53.845590 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 22:29:53.864437 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 22:29:53.893573 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 22:29:53.904893 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 22:29:53.906917 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 22:29:53.908083 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 22:29:53.910569 (MainThread): Parsing macros/etc/query.sql
2021-01-28 22:29:53.911904 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 22:29:53.914175 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 22:29:53.977277 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 22:29:53.996849 (MainThread): Partial parsing not enabled
2021-01-28 22:29:54.072295 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:54.101614 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:29:54.114257 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:29:54.127626 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:29:54.139759 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:29:54.162951 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:29:54.347174 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5c4c785-1e47-4dad-8726-73a0a55dba28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4d03fa00>]}
2021-01-28 22:29:54.390757 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-28 22:29:54.391782 (MainThread): 
2021-01-28 22:29:54.392367 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:29:54.402128 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 22:29:54.434117 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 22:29:54.434337 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 22:29:54.434485 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 22:29:55.459763 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.03 seconds
2021-01-28 22:29:55.483097 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 22:29:56.502999 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:29:56.514916 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:29:56.515116 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 22:29:56.515283 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 22:29:57.464127 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 0.95 seconds
2021-01-28 22:29:57.874695 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 22:29:58.372591 (MainThread): Using snowflake connection "master".
2021-01-28 22:29:58.372752 (MainThread): On master: BEGIN
2021-01-28 22:29:58.372852 (MainThread): Opening a new connection, currently in state init
2021-01-28 22:29:59.218184 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-28 22:29:59.219091 (MainThread): On master: COMMIT
2021-01-28 22:29:59.219899 (MainThread): Using snowflake connection "master".
2021-01-28 22:29:59.220630 (MainThread): On master: COMMIT
2021-01-28 22:29:59.641340 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-28 22:29:59.641799 (MainThread): On master: Close
2021-01-28 22:29:59.898192 (MainThread): 17:29:59 | Concurrency: 1 threads (target='snowflake')
2021-01-28 22:29:59.898870 (MainThread): 17:29:59 | 
2021-01-28 22:29:59.903784 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:29:59.907971 (Thread-1): 17:29:59 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 22:29:59.909298 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:29:59.909813 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:29:59.936885 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:29:59.937304 (Thread-1): finished collecting timing info
2021-01-28 22:29:59.988498 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:29:59.988671 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:29:59.988783 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:30:01.384067 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-01-28 22:30:01.414104 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:30:01.414310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:30:01.623489 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-28 22:30:01.631648 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:30:01.631924 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 22:30:01.871650 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-28 22:30:01.889093 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:30:01.889264 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 22:30:02.147835 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-28 22:30:02.161333 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:30:02.162277 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:30:02.162380 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 22:30:03.985545 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-01-28 22:30:03.986104 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:30:03.986547 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:30:05.270313 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-28 22:30:05.276791 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:30:05.277668 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:30:05.278130 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:30:09.101177 (Thread-1): SQL status: SUCCESS 1 in 3.82 seconds
2021-01-28 22:30:09.120805 (Thread-1): finished collecting timing info
2021-01-28 22:30:09.121137 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 22:30:09.481802 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c4c785-1e47-4dad-8726-73a0a55dba28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4e23b6d0>]}
2021-01-28 22:30:09.489388 (Thread-1): 17:30:09 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 9.57s]
2021-01-28 22:30:09.490571 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:30:09.491754 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:30:09.499883 (Thread-1): 17:30:09 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 22:30:09.502009 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:09.502855 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:30:09.519174 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:30:09.519778 (Thread-1): finished collecting timing info
2021-01-28 22:30:09.536720 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:09.536889 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 22:30:09.537002 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:30:11.376011 (Thread-1): SQL status: SUCCESS 1 in 1.84 seconds
2021-01-28 22:30:11.387649 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:11.388105 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:30:11.589562 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 22:30:11.602155 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:11.602745 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 22:30:11.949113 (Thread-1): SQL status: SUCCESS 4 in 0.35 seconds
2021-01-28 22:30:11.962371 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:11.962709 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 22:30:12.199351 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-28 22:30:12.202729 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:30:12.205209 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:12.205492 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 22:30:13.880272 (Thread-1): SQL status: SUCCESS 1 in 1.67 seconds
2021-01-28 22:30:13.880675 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:13.880949 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 22:30:15.018796 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-01-28 22:30:15.022054 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:30:15.022832 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:30:15.023252 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:30:15.203558 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-28 22:30:15.210816 (Thread-1): finished collecting timing info
2021-01-28 22:30:15.211700 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 22:30:15.465712 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c4c785-1e47-4dad-8726-73a0a55dba28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec45d158b0>]}
2021-01-28 22:30:15.467602 (Thread-1): 17:30:15 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 5.96s]
2021-01-28 22:30:15.467835 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:30:15.468001 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:30:15.469491 (Thread-1): 17:30:15 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 22:30:15.469891 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:15.470010 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:30:15.477183 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:30:15.477659 (Thread-1): finished collecting timing info
2021-01-28 22:30:15.491444 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:15.491603 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:30:15.491705 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:30:17.922274 (Thread-1): SQL status: SUCCESS 1 in 2.43 seconds
2021-01-28 22:30:17.931598 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:17.931942 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:30:18.149200 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-28 22:30:18.157911 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:18.158155 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 22:30:18.362007 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 22:30:18.367434 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:18.367625 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 22:30:18.792648 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-28 22:30:18.815960 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:30:18.819195 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:18.819511 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 22:30:19.013975 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 22:30:19.014457 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:19.014722 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 22:30:19.424927 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-28 22:30:19.425427 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:19.425685 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:30:20.095745 (Thread-1): SQL status: SUCCESS 2 in 0.67 seconds
2021-01-28 22:30:20.097552 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:30:20.097867 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:30:20.098166 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:30:20.749277 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-01-28 22:30:20.757012 (Thread-1): finished collecting timing info
2021-01-28 22:30:20.757665 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 22:30:21.057734 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c4c785-1e47-4dad-8726-73a0a55dba28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec45d53ca0>]}
2021-01-28 22:30:21.061819 (Thread-1): 17:30:21 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.59s]
2021-01-28 22:30:21.062276 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:30:21.062657 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:30:21.065367 (Thread-1): 17:30:21 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 22:30:21.066580 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:21.066890 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:30:21.082322 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:30:21.082964 (Thread-1): finished collecting timing info
2021-01-28 22:30:21.099367 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:21.099537 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 22:30:21.099650 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:30:22.446064 (Thread-1): SQL status: SUCCESS 1 in 1.35 seconds
2021-01-28 22:30:22.452313 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:22.452741 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:30:22.676380 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-28 22:30:22.684478 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:22.684735 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 22:30:22.879442 (Thread-1): SQL status: SUCCESS 2 in 0.19 seconds
2021-01-28 22:30:22.883707 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:22.883895 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 22:30:23.324165 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-28 22:30:23.325433 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:30:23.326288 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:23.326395 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 22:30:23.560416 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 22:30:23.560866 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:23.561145 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 22:30:24.639765 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-01-28 22:30:24.646338 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:30:24.647435 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:30:24.648065 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:30:24.800113 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-28 22:30:24.813678 (Thread-1): finished collecting timing info
2021-01-28 22:30:24.814436 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 22:30:25.085060 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c4c785-1e47-4dad-8726-73a0a55dba28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4d01cca0>]}
2021-01-28 22:30:25.092013 (Thread-1): 17:30:25 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.02s]
2021-01-28 22:30:25.093034 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:30:25.093721 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:30:25.098079 (Thread-1): 17:30:25 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 22:30:25.098783 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:25.099011 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:30:25.116410 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:30:25.116849 (Thread-1): finished collecting timing info
2021-01-28 22:30:25.138836 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:25.139016 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:30:25.139125 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:30:26.385498 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-01-28 22:30:26.400589 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:26.401311 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:30:26.582537 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-28 22:30:26.590963 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:26.591195 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 22:30:26.809097 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-28 22:30:26.826241 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:26.826592 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 22:30:27.058544 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 22:30:27.064875 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:30:27.069487 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:27.070350 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 22:30:27.279101 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 22:30:27.279859 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:27.280343 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:30:28.432711 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-01-28 22:30:28.437519 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:30:28.437900 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:30:28.438051 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:30:28.637734 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:30:28.641403 (Thread-1): finished collecting timing info
2021-01-28 22:30:28.641806 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 22:30:28.894524 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5c4c785-1e47-4dad-8726-73a0a55dba28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4d1dcee0>]}
2021-01-28 22:30:28.896023 (Thread-1): 17:30:28 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.80s]
2021-01-28 22:30:28.896255 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:30:28.897939 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:30:28.898286 (MainThread): Using snowflake connection "master".
2021-01-28 22:30:28.898414 (MainThread): On master: BEGIN
2021-01-28 22:30:28.898514 (MainThread): Opening a new connection, currently in state closed
2021-01-28 22:30:29.728027 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-28 22:30:29.728206 (MainThread): On master: COMMIT
2021-01-28 22:30:29.728353 (MainThread): Using snowflake connection "master".
2021-01-28 22:30:29.728431 (MainThread): On master: COMMIT
2021-01-28 22:30:30.019097 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-28 22:30:30.019484 (MainThread): On master: Close
2021-01-28 22:30:30.266805 (MainThread): 17:30:30 | 
2021-01-28 22:30:30.267108 (MainThread): 17:30:30 | Finished running 5 snowflake_timetravel_table models in 35.87s.
2021-01-28 22:30:30.267294 (MainThread): Connection 'master' was properly closed.
2021-01-28 22:30:30.267416 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 22:30:30.320447 (MainThread): 
2021-01-28 22:30:30.320632 (MainThread): Completed successfully
2021-01-28 22:30:30.320764 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 22:30:30.320979 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4e2729a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4d12a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec4cfa3100>]}
2021-01-28 22:30:30.321179 (MainThread): Flushing usage events
2021-01-28 22:37:37.093771 (MainThread): Running with dbt=0.18.1
2021-01-28 22:37:37.608834 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 22:37:37.609153 (MainThread): Tracking: tracking
2021-01-28 22:37:37.609299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88991372b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889fec52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88990ca400>]}
2021-01-28 22:37:37.609881 (MainThread): Set downloads directory='/tmp/dbt-downloads-mmj67k4g'
2021-01-28 22:37:37.621520 (MainThread): Installing ../../
2021-01-28 22:37:37.621806 (MainThread):   Creating symlink to local dependency.
2021-01-28 22:37:37.621934 (MainThread):   Installed from <local @ ../../>

2021-01-28 22:37:37.622077 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f04086b0-080d-42c3-8d09-796ade0c777a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88990caa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88990cadc0>]}
2021-01-28 22:37:37.622419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88991372b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f889fec52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88990cd2b0>]}
2021-01-28 22:37:37.622584 (MainThread): Flushing usage events
2021-01-28 22:37:39.314097 (MainThread): Running with dbt=0.18.1
2021-01-28 22:37:39.842683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 22:37:39.843717 (MainThread): Tracking: tracking
2021-01-28 22:37:39.844211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b7a493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44be85b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b7a4d550>]}
2021-01-28 22:37:39.909207 (MainThread): Partial parsing not enabled
2021-01-28 22:37:39.910917 (MainThread): Parsing macros/catalog.sql
2021-01-28 22:37:39.915898 (MainThread): Parsing macros/adapters.sql
2021-01-28 22:37:39.956053 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 22:37:39.957874 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 22:37:39.970057 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 22:37:39.972544 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 22:37:39.978281 (MainThread): Parsing macros/core.sql
2021-01-28 22:37:39.982841 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 22:37:39.985400 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 22:37:39.987381 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 22:37:39.989653 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 22:37:39.992883 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 22:37:40.005142 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 22:37:40.013414 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 22:37:40.019563 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 22:37:40.040183 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 22:37:40.042284 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 22:37:40.078286 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 22:37:40.087913 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 22:37:40.095400 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 22:37:40.097568 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 22:37:40.114921 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 22:37:40.139999 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 22:37:40.150517 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 22:37:40.152912 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 22:37:40.154046 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 22:37:40.156354 (MainThread): Parsing macros/etc/query.sql
2021-01-28 22:37:40.157541 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 22:37:40.159420 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 22:37:40.213018 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 22:37:40.230560 (MainThread): Partial parsing not enabled
2021-01-28 22:37:40.275680 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:40.301702 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:37:40.313132 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:40.325003 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:40.336528 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:37:40.356375 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:40.545246 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-28 22:37:40.546135 (MainThread): 
2021-01-28 22:37:40.546552 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:37:40.553854 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 22:37:40.569613 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 22:37:40.569762 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 22:37:40.569858 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 22:37:41.713259 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.14 seconds
2021-01-28 22:37:41.734348 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 22:37:42.013799 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:37:42.024555 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:37:42.024713 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 22:37:42.024816 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 22:37:43.067659 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.04 seconds
2021-01-28 22:37:43.481836 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 22:37:43.753336 (MainThread): Using snowflake connection "master".
2021-01-28 22:37:43.753497 (MainThread): On master: BEGIN
2021-01-28 22:37:43.753592 (MainThread): Opening a new connection, currently in state init
2021-01-28 22:37:44.682685 (MainThread): SQL status: SUCCESS 1 in 0.93 seconds
2021-01-28 22:37:44.682979 (MainThread): On master: COMMIT
2021-01-28 22:37:44.683227 (MainThread): Using snowflake connection "master".
2021-01-28 22:37:44.683361 (MainThread): On master: COMMIT
2021-01-28 22:37:45.039086 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-28 22:37:45.039438 (MainThread): On master: Close
2021-01-28 22:37:45.338783 (MainThread): 17:37:45 | Concurrency: 1 threads (target='snowflake')
2021-01-28 22:37:45.339109 (MainThread): 17:37:45 | 
2021-01-28 22:37:45.342169 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:37:45.344353 (Thread-1): 17:37:45 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 22:37:45.345047 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:45.345274 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:37:45.376689 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:37:45.377054 (Thread-1): finished collecting timing info
2021-01-28 22:37:45.426460 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:45.426621 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:37:45.426733 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:37:46.381827 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-01-28 22:37:46.408880 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:46.409053 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:37:46.595879 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:37:46.601261 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:46.601457 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 22:37:47.235135 (Thread-1): SQL status: SUCCESS 3 in 0.63 seconds
2021-01-28 22:37:47.278448 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:47.278639 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 22:37:47.633141 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-28 22:37:47.649552 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:37:47.650760 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:47.650923 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 22:37:47.845411 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 22:37:47.845808 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:47.846057 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:37:52.571167 (Thread-1): SQL status: SUCCESS 1 in 4.72 seconds
2021-01-28 22:37:52.574516 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:37:52.575111 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:37:52.575352 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:37:52.745630 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-28 22:37:52.760253 (Thread-1): finished collecting timing info
2021-01-28 22:37:52.760693 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 22:37:53.024718 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3588410a-5aef-4831-9c04-4a8b478a7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b79a0460>]}
2021-01-28 22:37:53.028428 (Thread-1): 17:37:53 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 7.68s]
2021-01-28 22:37:53.028895 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:37:53.029366 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:37:53.033064 (Thread-1): 17:37:53 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 22:37:53.034163 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:53.034612 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:37:53.054830 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:37:53.055296 (Thread-1): finished collecting timing info
2021-01-28 22:37:53.070819 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:53.070979 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 22:37:53.071091 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:37:54.107734 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-28 22:37:54.115657 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:54.115979 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:37:54.310830 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:37:54.317240 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:54.317475 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 22:37:54.817892 (Thread-1): SQL status: SUCCESS 4 in 0.50 seconds
2021-01-28 22:37:54.823496 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:54.823717 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 22:37:55.330621 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-28 22:37:55.333240 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:37:55.335441 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:55.335752 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 22:37:55.544813 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 22:37:55.545535 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:55.546026 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 22:37:56.764702 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-01-28 22:37:56.767450 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:37:56.767983 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:37:56.768297 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:37:56.935622 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-28 22:37:56.945994 (Thread-1): finished collecting timing info
2021-01-28 22:37:56.947018 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 22:37:57.198749 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3588410a-5aef-4831-9c04-4a8b478a7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b5d51730>]}
2021-01-28 22:37:57.201284 (Thread-1): 17:37:57 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.16s]
2021-01-28 22:37:57.201538 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:37:57.201759 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:37:57.203295 (Thread-1): 17:37:57 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 22:37:57.203899 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:57.204049 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:37:57.216583 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:37:57.217025 (Thread-1): finished collecting timing info
2021-01-28 22:37:57.238012 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:57.238248 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:37:57.238394 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:37:58.406055 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-28 22:37:58.420048 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:58.420470 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:37:58.594892 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-28 22:37:58.599834 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:58.600086 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 22:37:58.856801 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-28 22:37:58.865169 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:58.865427 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 22:37:59.098666 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 22:37:59.126365 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:37:59.128199 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:59.128539 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 22:37:59.327039 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:37:59.327658 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:59.328153 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 22:37:59.734542 (Thread-1): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-28 22:37:59.735074 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:37:59.735339 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:38:00.526262 (Thread-1): SQL status: SUCCESS 2 in 0.79 seconds
2021-01-28 22:38:00.532785 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:38:00.533313 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:00.533569 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:38:01.128938 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-01-28 22:38:01.135717 (Thread-1): finished collecting timing info
2021-01-28 22:38:01.136555 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 22:38:01.378342 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3588410a-5aef-4831-9c04-4a8b478a7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b45272b0>]}
2021-01-28 22:38:01.381445 (Thread-1): 17:38:01 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.17s]
2021-01-28 22:38:01.381823 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:38:01.382197 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:38:01.385237 (Thread-1): 17:38:01 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 22:38:01.386152 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:01.386517 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:38:01.401442 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:38:01.401842 (Thread-1): finished collecting timing info
2021-01-28 22:38:01.418529 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:01.418707 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 22:38:01.418816 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:38:02.396398 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-28 22:38:02.399694 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:02.399858 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:38:02.586782 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:38:02.590923 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:02.591105 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 22:38:02.851615 (Thread-1): SQL status: SUCCESS 2 in 0.26 seconds
2021-01-28 22:38:02.855725 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:02.855883 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 22:38:03.073688 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 22:38:03.075208 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:38:03.076066 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:03.076170 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 22:38:03.278163 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:38:03.278390 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:03.278505 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 22:38:04.342959 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-28 22:38:04.346961 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:38:04.347586 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:04.347912 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:38:04.568247 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 22:38:04.579959 (Thread-1): finished collecting timing info
2021-01-28 22:38:04.580931 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 22:38:04.874823 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3588410a-5aef-4831-9c04-4a8b478a7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b5d3b1c0>]}
2021-01-28 22:38:04.877963 (Thread-1): 17:38:04 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 3.49s]
2021-01-28 22:38:04.878289 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:38:04.878594 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:38:04.880623 (Thread-1): 17:38:04 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 22:38:04.881433 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:04.881650 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:38:04.897398 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:38:04.897763 (Thread-1): finished collecting timing info
2021-01-28 22:38:04.914047 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:04.914222 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:38:04.914332 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:38:05.957934 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-28 22:38:05.966877 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:05.967291 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:38:06.175818 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-28 22:38:06.193068 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:06.193429 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 22:38:06.379018 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:38:06.387993 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:06.388378 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 22:38:06.620051 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-28 22:38:06.624655 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:38:06.627359 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:06.627597 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 22:38:06.845183 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 22:38:06.845378 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:06.845486 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:38:07.990053 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-01-28 22:38:07.991121 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:38:07.991286 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:07.991371 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:38:08.319645 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-28 22:38:08.322401 (Thread-1): finished collecting timing info
2021-01-28 22:38:08.322713 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 22:38:08.669709 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3588410a-5aef-4831-9c04-4a8b478a7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b5d74490>]}
2021-01-28 22:38:08.675197 (Thread-1): 17:38:08 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.79s]
2021-01-28 22:38:08.675983 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:38:08.680583 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:38:08.681526 (MainThread): Using snowflake connection "master".
2021-01-28 22:38:08.681984 (MainThread): On master: BEGIN
2021-01-28 22:38:08.682436 (MainThread): Opening a new connection, currently in state closed
2021-01-28 22:38:11.091894 (MainThread): SQL status: SUCCESS 1 in 2.41 seconds
2021-01-28 22:38:11.092476 (MainThread): On master: COMMIT
2021-01-28 22:38:11.092984 (MainThread): Using snowflake connection "master".
2021-01-28 22:38:11.093382 (MainThread): On master: COMMIT
2021-01-28 22:38:12.033455 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-28 22:38:12.033872 (MainThread): On master: Close
2021-01-28 22:38:12.353947 (MainThread): 17:38:12 | 
2021-01-28 22:38:12.354722 (MainThread): 17:38:12 | Finished running 5 snowflake_timetravel_table models in 31.81s.
2021-01-28 22:38:12.355264 (MainThread): Connection 'master' was properly closed.
2021-01-28 22:38:12.355649 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 22:38:12.398612 (MainThread): 
2021-01-28 22:38:12.398795 (MainThread): Completed successfully
2021-01-28 22:38:12.398913 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 22:38:12.399114 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b5d46910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b5d465b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44b5d559d0>]}
2021-01-28 22:38:12.399315 (MainThread): Flushing usage events
2021-01-28 22:38:41.683141 (MainThread): Running with dbt=0.19.0
2021-01-28 22:38:42.233455 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-28 22:38:42.233779 (MainThread): Tracking: tracking
2021-01-28 22:38:42.233944 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b0463070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b8782eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b046ca60>]}
2021-01-28 22:38:42.234495 (MainThread): Set downloads directory='/tmp/dbt-downloads-u7_jrj5o'
2021-01-28 22:38:42.246141 (MainThread): Installing ../../
2021-01-28 22:38:42.246445 (MainThread):   Creating symlink to local dependency.
2021-01-28 22:38:42.246575 (MainThread):   Installed from <local @ ../../>

2021-01-28 22:38:42.246726 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '144f1790-f815-4023-bdac-6f9b5dd0b252', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af3ce5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af3cecd0>]}
2021-01-28 22:38:42.247067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17b0463070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af3ce280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17af3ce460>]}
2021-01-28 22:38:42.247233 (MainThread): Flushing usage events
2021-01-28 22:38:44.025672 (MainThread): Running with dbt=0.19.0
2021-01-28 22:38:44.552865 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-28 22:38:44.553933 (MainThread): Tracking: tracking
2021-01-28 22:38:44.554395 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4df7178e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e5443580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4df6a7700>]}
2021-01-28 22:38:44.595688 (MainThread): Partial parsing not enabled
2021-01-28 22:38:44.596874 (MainThread): Parsing macros/catalog.sql
2021-01-28 22:38:44.599861 (MainThread): Parsing macros/adapters.sql
2021-01-28 22:38:44.638194 (MainThread): Parsing macros/materializations/view.sql
2021-01-28 22:38:44.640270 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-28 22:38:44.651889 (MainThread): Parsing macros/materializations/merge.sql
2021-01-28 22:38:44.655197 (MainThread): Parsing macros/materializations/table.sql
2021-01-28 22:38:44.661668 (MainThread): Parsing macros/core.sql
2021-01-28 22:38:44.666477 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-28 22:38:44.668604 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-28 22:38:44.670492 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-28 22:38:44.672748 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-28 22:38:44.676135 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-28 22:38:44.687142 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-28 22:38:44.695108 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-28 22:38:44.700895 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-28 22:38:44.722512 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-28 22:38:44.724613 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-28 22:38:44.764712 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-28 22:38:44.774769 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-28 22:38:44.782220 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-28 22:38:44.784429 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-28 22:38:44.800917 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-28 22:38:44.827242 (MainThread): Parsing macros/etc/datetime.sql
2021-01-28 22:38:44.837466 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-28 22:38:44.839626 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-28 22:38:44.841008 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-28 22:38:44.844018 (MainThread): Parsing macros/etc/query.sql
2021-01-28 22:38:44.845975 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-28 22:38:44.849067 (MainThread): Parsing macros/adapters/common.sql
2021-01-28 22:38:44.906821 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-28 22:38:44.923546 (MainThread): Partial parsing not enabled
2021-01-28 22:38:44.973409 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:44.999484 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:38:45.013249 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:45.025473 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:45.036882 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:38:45.058652 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:45.212988 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f5d8aa1-fafd-4457-89e2-407872ae8223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4de2e41f0>]}
2021-01-28 22:38:45.248915 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-28 22:38:45.249847 (MainThread): 
2021-01-28 22:38:45.250207 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:38:45.257938 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-28 22:38:45.275767 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-28 22:38:45.275924 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-28 22:38:45.276028 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-28 22:38:46.335140 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.06 seconds
2021-01-28 22:38:46.356600 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-28 22:38:46.646755 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:38:46.657153 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-28 22:38:46.657312 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-28 22:38:46.657410 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-28 22:38:47.792973 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.14 seconds
2021-01-28 22:38:48.201989 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-28 22:38:48.486306 (MainThread): Using snowflake connection "master".
2021-01-28 22:38:48.486500 (MainThread): On master: BEGIN
2021-01-28 22:38:48.486617 (MainThread): Opening a new connection, currently in state init
2021-01-28 22:38:49.347384 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-28 22:38:49.347747 (MainThread): On master: COMMIT
2021-01-28 22:38:49.348062 (MainThread): Using snowflake connection "master".
2021-01-28 22:38:49.348216 (MainThread): On master: COMMIT
2021-01-28 22:38:49.708944 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-28 22:38:49.709698 (MainThread): On master: Close
2021-01-28 22:38:49.961619 (MainThread): 17:38:49 | Concurrency: 1 threads (target='snowflake')
2021-01-28 22:38:49.962653 (MainThread): 17:38:49 | 
2021-01-28 22:38:49.970303 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:38:49.973618 (Thread-1): 17:38:49 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-28 22:38:49.974439 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:49.974728 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:38:50.000026 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:38:50.000404 (Thread-1): finished collecting timing info
2021-01-28 22:38:50.053035 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:50.053200 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:38:50.053336 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:38:51.008744 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-01-28 22:38:51.026900 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:51.027088 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:38:51.454979 (Thread-1): SQL status: SUCCESS 3 in 0.43 seconds
2021-01-28 22:38:51.468975 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:51.469324 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-28 22:38:51.958153 (Thread-1): SQL status: SUCCESS 3 in 0.49 seconds
2021-01-28 22:38:51.981329 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:51.981482 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-28 22:38:52.470144 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-28 22:38:52.491172 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-28 22:38:52.492712 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:52.492879 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-28 22:38:52.681169 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-28 22:38:52.681345 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:52.681427 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:38:53.672226 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-28 22:38:53.674962 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:38:53.675480 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-28 22:38:53.675733 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-28 22:38:53.896071 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-28 22:38:53.926136 (Thread-1): finished collecting timing info
2021-01-28 22:38:53.926467 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-28 22:38:54.291902 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5d8aa1-fafd-4457-89e2-407872ae8223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4de3cd550>]}
2021-01-28 22:38:54.294999 (Thread-1): 17:38:54 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.32s]
2021-01-28 22:38:54.295288 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-28 22:38:54.295480 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:38:54.296830 (Thread-1): 17:38:54 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-28 22:38:54.297525 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:54.297669 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:38:54.308133 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:38:54.308501 (Thread-1): finished collecting timing info
2021-01-28 22:38:54.321241 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:54.321402 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-28 22:38:54.321503 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:38:55.444475 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-28 22:38:55.456295 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:55.456655 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:38:55.738268 (Thread-1): SQL status: SUCCESS 3 in 0.28 seconds
2021-01-28 22:38:55.745456 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:55.745685 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-28 22:38:55.941959 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-28 22:38:55.948056 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:55.948255 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-28 22:38:56.273489 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-28 22:38:56.274865 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-28 22:38:56.275754 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:56.275855 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-28 22:38:56.480706 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:38:56.480975 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:56.481125 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-28 22:38:57.528330 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-01-28 22:38:57.529382 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:38:57.529552 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-28 22:38:57.529636 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-28 22:38:57.831109 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-28 22:38:57.835648 (Thread-1): finished collecting timing info
2021-01-28 22:38:57.836139 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-28 22:38:58.069444 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5d8aa1-fafd-4457-89e2-407872ae8223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4dc12b070>]}
2021-01-28 22:38:58.071533 (Thread-1): 17:38:58 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.77s]
2021-01-28 22:38:58.071793 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-28 22:38:58.072178 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:38:58.074028 (Thread-1): 17:38:58 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-28 22:38:58.074583 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:58.074760 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:38:58.086151 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:38:58.086652 (Thread-1): finished collecting timing info
2021-01-28 22:38:58.103579 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:58.104097 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:38:58.104299 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:38:59.178134 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-28 22:38:59.185095 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:59.185361 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:38:59.387027 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-28 22:38:59.401582 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:59.402009 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-28 22:38:59.617828 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-28 22:38:59.627458 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:59.627832 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-28 22:38:59.873177 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-28 22:38:59.891441 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-28 22:38:59.894089 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:38:59.894333 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-28 22:39:00.161566 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-28 22:39:00.162305 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:39:00.162908 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-28 22:39:00.563299 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-28 22:39:00.563979 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:39:00.565872 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:39:01.045091 (Thread-1): SQL status: SUCCESS 2 in 0.48 seconds
2021-01-28 22:39:01.046861 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:39:01.047138 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-28 22:39:01.047281 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-28 22:39:01.523913 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-28 22:39:01.534955 (Thread-1): finished collecting timing info
2021-01-28 22:39:01.536050 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-28 22:39:01.792001 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5d8aa1-fafd-4457-89e2-407872ae8223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4dc128790>]}
2021-01-28 22:39:01.795609 (Thread-1): 17:39:01 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 3.72s]
2021-01-28 22:39:01.796053 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-28 22:39:01.796452 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:39:01.799338 (Thread-1): 17:39:01 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-28 22:39:01.800451 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:01.800698 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:39:01.813688 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:39:01.814104 (Thread-1): finished collecting timing info
2021-01-28 22:39:01.830982 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:01.831175 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-28 22:39:01.831291 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:39:02.906761 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-01-28 22:39:02.909728 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:02.909892 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:39:03.346372 (Thread-1): SQL status: SUCCESS 3 in 0.44 seconds
2021-01-28 22:39:03.353869 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:03.354159 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-28 22:39:03.538909 (Thread-1): SQL status: SUCCESS 2 in 0.18 seconds
2021-01-28 22:39:03.543243 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:03.543422 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-28 22:39:03.758149 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-28 22:39:03.759580 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-28 22:39:03.760430 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:03.760542 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-28 22:39:03.961605 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-28 22:39:03.961776 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:03.961860 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-28 22:39:05.002143 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-28 22:39:05.005913 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:39:05.006431 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-28 22:39:05.006679 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-28 22:39:05.158570 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-28 22:39:05.174341 (Thread-1): finished collecting timing info
2021-01-28 22:39:05.175066 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-28 22:39:05.448106 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5d8aa1-fafd-4457-89e2-407872ae8223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4de5dd3a0>]}
2021-01-28 22:39:05.450038 (Thread-1): 17:39:05 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 3.65s]
2021-01-28 22:39:05.450310 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-28 22:39:05.450607 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:39:05.452088 (Thread-1): 17:39:05 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-28 22:39:05.452529 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:05.452695 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:39:05.461264 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:39:05.461688 (Thread-1): finished collecting timing info
2021-01-28 22:39:05.474843 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:05.475003 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-28 22:39:05.475103 (Thread-1): Opening a new connection, currently in state closed
2021-01-28 22:39:06.601825 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-01-28 22:39:06.607199 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:06.607436 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:39:06.799511 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-28 22:39:06.809188 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:06.809532 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-28 22:39:07.321019 (Thread-1): SQL status: SUCCESS 3 in 0.51 seconds
2021-01-28 22:39:07.330365 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:07.330618 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-28 22:39:07.838514 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-28 22:39:07.847690 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-28 22:39:07.851311 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:07.851737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-28 22:39:08.345302 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-28 22:39:08.345822 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:08.346150 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-28 22:39:09.777304 (Thread-1): SQL status: SUCCESS 1 in 1.43 seconds
2021-01-28 22:39:09.779830 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:39:09.780231 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-28 22:39:09.780449 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-28 22:39:09.930403 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-28 22:39:09.935338 (Thread-1): finished collecting timing info
2021-01-28 22:39:09.935869 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-28 22:39:10.221461 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f5d8aa1-fafd-4457-89e2-407872ae8223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4de3d9250>]}
2021-01-28 22:39:10.229244 (Thread-1): 17:39:10 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.77s]
2021-01-28 22:39:10.230117 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-28 22:39:10.235800 (MainThread): Acquiring new snowflake connection "master".
2021-01-28 22:39:10.236814 (MainThread): Using snowflake connection "master".
2021-01-28 22:39:10.237274 (MainThread): On master: BEGIN
2021-01-28 22:39:10.237759 (MainThread): Opening a new connection, currently in state closed
2021-01-28 22:39:11.217596 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-28 22:39:11.218468 (MainThread): On master: COMMIT
2021-01-28 22:39:11.219384 (MainThread): Using snowflake connection "master".
2021-01-28 22:39:11.219837 (MainThread): On master: COMMIT
2021-01-28 22:39:11.720038 (MainThread): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-28 22:39:11.720398 (MainThread): On master: Close
2021-01-28 22:39:12.005020 (MainThread): 17:39:12 | 
2021-01-28 22:39:12.005274 (MainThread): 17:39:12 | Finished running 5 snowflake_timetravel_table models in 26.75s.
2021-01-28 22:39:12.005436 (MainThread): Connection 'master' was properly closed.
2021-01-28 22:39:12.005523 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-28 22:39:12.049205 (MainThread): 
2021-01-28 22:39:12.049387 (MainThread): Completed successfully
2021-01-28 22:39:12.049554 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-28 22:39:12.049844 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4de5dba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4de5dd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4de4ecd90>]}
2021-01-28 22:39:12.050093 (MainThread): Flushing usage events
2021-01-29 17:16:51.979229 (MainThread): Running with dbt=0.19.0
2021-01-29 17:16:52.482180 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, selector_name=None, single_threaded=True, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='list', write_json=True)
2021-01-29 17:16:52.483193 (MainThread): Tracking: do not track
2021-01-29 17:16:52.517409 (MainThread): Partial parsing not enabled
2021-01-29 17:16:52.518523 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:16:52.521417 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:16:52.557436 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:16:52.559117 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:16:52.569304 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:16:52.571536 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:16:52.576600 (MainThread): Parsing macros/core.sql
2021-01-29 17:16:52.580814 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:16:52.582586 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:16:52.584131 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:16:52.586128 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:16:52.588911 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:16:52.599132 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:16:52.608974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:16:52.615671 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:16:52.634879 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:16:52.636787 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:16:52.670214 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:16:52.677186 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:16:52.683213 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:16:52.685045 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:16:52.699276 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:16:52.720857 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:16:52.729880 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:16:52.731468 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:16:52.732382 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:16:52.734344 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:16:52.735360 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:16:52.737005 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:16:52.782778 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:16:52.797687 (MainThread): Partial parsing not enabled
2021-01-29 17:16:52.840195 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:16:52.867326 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:16:52.878469 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:16:52.889740 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:16:52.900921 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:16:52.920471 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:16:53.123000 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:16:53.123790 (MainThread): Flushing usage events
2021-01-29 17:16:53.123965 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:17:27.089344 (MainThread): Running with dbt=0.19.0
2021-01-29 17:17:27.557180 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=['snowflake_timetravel_table_integration_tests.data_test.test_snowflake_timetravel_table_integration_tests_columns_no_change'], selector_name=None, single_threaded=True, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='list', write_json=True)
2021-01-29 17:17:27.557857 (MainThread): Tracking: do not track
2021-01-29 17:17:27.592212 (MainThread): Partial parsing not enabled
2021-01-29 17:17:27.593369 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:17:27.597512 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:17:27.633934 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:17:27.635664 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:17:27.645775 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:17:27.647843 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:17:27.652727 (MainThread): Parsing macros/core.sql
2021-01-29 17:17:27.656801 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:17:27.658490 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:17:27.660023 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:17:27.661961 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:17:27.664694 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:17:27.674311 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:17:27.680857 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:17:27.685798 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:17:27.703609 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:17:27.705358 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:17:27.738855 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:17:27.745677 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:17:27.751762 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:17:27.753579 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:17:27.768037 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:17:27.789260 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:17:27.798020 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:17:27.800122 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:17:27.801148 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:17:27.803184 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:17:27.804219 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:17:27.805994 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:17:27.851232 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:17:27.866121 (MainThread): Partial parsing not enabled
2021-01-29 17:17:27.906844 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:17:27.927589 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:17:27.937836 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:17:27.948308 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:17:27.958695 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:17:27.977140 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:17:28.139359 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:17:28.139886 (MainThread): Flushing usage events
2021-01-29 17:17:28.140044 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:17:37.943839 (MainThread): Running with dbt=0.19.0
2021-01-29 17:17:38.404532 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=['data_test.test_snowflake_timetravel_table_integration_tests_columns_no_change'], selector_name=None, single_threaded=True, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='list', write_json=True)
2021-01-29 17:17:38.405198 (MainThread): Tracking: do not track
2021-01-29 17:17:38.439991 (MainThread): Partial parsing not enabled
2021-01-29 17:17:38.441099 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:17:38.443964 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:17:38.479230 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:17:38.480956 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:17:38.491140 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:17:38.493341 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:17:38.498732 (MainThread): Parsing macros/core.sql
2021-01-29 17:17:38.503031 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:17:38.504898 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:17:38.507583 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:17:38.509851 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:17:38.513024 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:17:38.523904 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:17:38.531053 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:17:38.536389 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:17:38.554966 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:17:38.556800 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:17:38.590474 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:17:38.597367 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:17:38.603421 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:17:38.605305 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:17:38.619599 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:17:38.641237 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:17:38.650274 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:17:38.651884 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:17:38.652849 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:17:38.654761 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:17:38.655777 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:17:38.657427 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:17:38.701810 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:17:38.716701 (MainThread): Partial parsing not enabled
2021-01-29 17:17:38.753466 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:17:38.773375 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:17:38.782988 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:17:38.792977 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:17:38.803196 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:17:38.822455 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:17:38.985522 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:17:38.986032 (MainThread): Flushing usage events
2021-01-29 17:17:38.986213 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:17:44.649036 (MainThread): Running with dbt=0.19.0
2021-01-29 17:17:45.112504 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], selector_name=None, single_threaded=True, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='list', write_json=True)
2021-01-29 17:17:45.113173 (MainThread): Tracking: do not track
2021-01-29 17:17:45.148490 (MainThread): Partial parsing not enabled
2021-01-29 17:17:45.149685 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:17:45.152569 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:17:45.188984 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:17:45.190720 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:17:45.201189 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:17:45.203428 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:17:45.208708 (MainThread): Parsing macros/core.sql
2021-01-29 17:17:45.212986 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:17:45.214774 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:17:45.216345 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:17:45.218325 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:17:45.221248 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:17:45.230459 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:17:45.237481 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:17:45.242581 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:17:45.263938 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:17:45.265994 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:17:45.302059 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:17:45.309390 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:17:45.315577 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:17:45.317423 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:17:45.332032 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:17:45.354446 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:17:45.364459 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:17:45.366406 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:17:45.367466 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:17:45.369718 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:17:45.370819 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:17:45.372605 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:17:45.418707 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:17:45.434222 (MainThread): Partial parsing not enabled
2021-01-29 17:17:45.472764 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:17:45.494994 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:17:45.506090 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:17:45.517394 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:17:45.528233 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:17:45.547397 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:17:45.713384 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:17:45.713992 (MainThread): Flushing usage events
2021-01-29 17:17:45.714148 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:19:20.939444 (MainThread): Running with dbt=0.18.1
2021-01-29 17:19:21.413319 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 17:19:21.413630 (MainThread): Tracking: tracking
2021-01-29 17:19:21.413783 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445cf7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44ca72040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445c8a280>]}
2021-01-29 17:19:21.414343 (MainThread): Set downloads directory='/tmp/dbt-downloads-8w8z6cbv'
2021-01-29 17:19:21.424229 (MainThread): Installing ../../
2021-01-29 17:19:21.424485 (MainThread):   Creating symlink to local dependency.
2021-01-29 17:19:21.424601 (MainThread):   Installed from <local @ ../../>

2021-01-29 17:19:21.424777 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cefc3f73-03f6-4048-81cd-07c6063730d6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445c8a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445c8a490>]}
2021-01-29 17:19:21.425079 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445cf7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445c8ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe445c8d1f0>]}
2021-01-29 17:19:21.425228 (MainThread): Flushing usage events
2021-01-29 17:19:23.020075 (MainThread): Running with dbt=0.18.1
2021-01-29 17:19:23.552107 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 17:19:23.552866 (MainThread): Tracking: tracking
2021-01-29 17:19:23.553173 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983eb4c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f984597e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983eb4e4f0>]}
2021-01-29 17:19:23.588668 (MainThread): Partial parsing not enabled
2021-01-29 17:19:23.589850 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:19:23.592773 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:19:23.627879 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:19:23.629587 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:19:23.641038 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:19:23.643303 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:19:23.648428 (MainThread): Parsing macros/core.sql
2021-01-29 17:19:23.652337 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:19:23.654136 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:19:23.655712 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:19:23.657683 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:19:23.660531 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:19:23.669699 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:19:23.676239 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:19:23.681297 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:19:23.699995 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:19:23.702874 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:19:23.735323 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:19:23.742411 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:19:23.748647 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:19:23.750474 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:19:23.764796 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:19:23.785855 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:19:23.794491 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:19:23.796078 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:19:23.797023 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:19:23.798942 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:19:23.799949 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:19:23.801597 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:19:23.846350 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:19:23.861025 (MainThread): Partial parsing not enabled
2021-01-29 17:19:23.899974 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:23.921135 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:23.931459 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:23.941858 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:23.952382 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:23.970153 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:24.136729 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 17:19:24.137544 (MainThread): 
2021-01-29 17:19:24.137872 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:19:24.143808 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 17:19:24.158203 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 17:19:24.158345 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 17:19:24.158439 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 17:19:25.168447 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.01 seconds
2021-01-29 17:19:25.199852 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 17:19:25.501247 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:19:25.511296 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:19:25.511450 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:19:25.511553 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 17:19:26.516303 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.00 seconds
2021-01-29 17:19:26.866273 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:19:27.215981 (MainThread): Using snowflake connection "master".
2021-01-29 17:19:27.216182 (MainThread): On master: BEGIN
2021-01-29 17:19:27.216309 (MainThread): Opening a new connection, currently in state init
2021-01-29 17:19:28.120666 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-29 17:19:28.121435 (MainThread): On master: COMMIT
2021-01-29 17:19:28.122176 (MainThread): Using snowflake connection "master".
2021-01-29 17:19:28.122600 (MainThread): On master: COMMIT
2021-01-29 17:19:28.553352 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-29 17:19:28.553808 (MainThread): On master: Close
2021-01-29 17:19:29.020904 (MainThread): 12:19:29 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:19:29.021201 (MainThread): 12:19:29 | 
2021-01-29 17:19:29.023853 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:19:29.025659 (Thread-1): 12:19:29 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 17:19:29.026117 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:29.026294 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:19:29.052555 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:19:29.053151 (Thread-1): finished collecting timing info
2021-01-29 17:19:29.103630 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:29.103819 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:19:29.103918 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:19:30.132148 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 17:19:30.170274 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:30.170499 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:19:30.370213 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 17:19:30.386937 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:30.387508 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 17:19:31.309590 (Thread-1): SQL status: SUCCESS 3 in 0.92 seconds
2021-01-29 17:19:31.349137 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:31.349346 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 17:19:31.991385 (Thread-1): SQL status: SUCCESS 1 in 0.64 seconds
2021-01-29 17:19:32.033579 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:19:32.034636 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:32.034782 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 17:19:32.254344 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-29 17:19:32.255007 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:32.257834 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:19:34.520425 (Thread-1): SQL status: SUCCESS 1 in 2.26 seconds
2021-01-29 17:19:34.522187 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:19:34.522428 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:19:34.522577 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:19:34.798368 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-29 17:19:34.841453 (Thread-1): finished collecting timing info
2021-01-29 17:19:34.841850 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 17:19:35.558486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70838f13-55d5-4ae8-b69e-7070f9677a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983cead820>]}
2021-01-29 17:19:35.560565 (Thread-1): 12:19:35 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 6.53s]
2021-01-29 17:19:35.560818 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:19:35.561052 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:19:35.562624 (Thread-1): 12:19:35 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 17:19:35.563114 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:35.563284 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:19:35.575335 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:19:35.575785 (Thread-1): finished collecting timing info
2021-01-29 17:19:35.591337 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:35.591533 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 17:19:35.591661 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:19:36.669581 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-01-29 17:19:36.673659 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:36.673821 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:19:36.948943 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-29 17:19:36.965018 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:36.965565 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 17:19:37.279810 (Thread-1): SQL status: SUCCESS 4 in 0.31 seconds
2021-01-29 17:19:37.297191 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:37.297916 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 17:19:37.583816 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-29 17:19:37.589994 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:19:37.594429 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:37.594931 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 17:19:37.854120 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-29 17:19:37.854788 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:37.855209 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 17:19:39.419421 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-01-29 17:19:39.424245 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:19:39.425407 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:19:39.425886 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:19:39.617766 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:19:39.629380 (Thread-1): finished collecting timing info
2021-01-29 17:19:39.630704 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 17:19:39.925796 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70838f13-55d5-4ae8-b69e-7070f9677a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983ce684f0>]}
2021-01-29 17:19:39.932702 (Thread-1): 12:19:39 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.36s]
2021-01-29 17:19:39.933532 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:19:39.934263 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:19:39.939600 (Thread-1): 12:19:39 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:19:39.941797 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:39.942393 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:19:39.959922 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:19:39.960423 (Thread-1): finished collecting timing info
2021-01-29 17:19:39.975907 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:39.976063 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:19:39.976165 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:19:40.960486 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-29 17:19:40.973081 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:40.973626 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:19:41.282924 (Thread-1): SQL status: SUCCESS 3 in 0.31 seconds
2021-01-29 17:19:41.298094 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:41.298644 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 17:19:41.529425 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-29 17:19:41.550492 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:41.551068 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 17:19:41.841702 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-29 17:19:41.872894 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:19:41.875624 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:41.875824 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:19:42.088242 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 17:19:42.089081 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:42.089628 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 17:19:42.563897 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-29 17:19:42.564177 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:42.565711 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:19:43.731181 (Thread-1): SQL status: SUCCESS 2 in 1.17 seconds
2021-01-29 17:19:43.732617 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:19:43.732881 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:19:43.733005 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:19:44.418720 (Thread-1): SQL status: SUCCESS 1 in 0.69 seconds
2021-01-29 17:19:44.429633 (Thread-1): finished collecting timing info
2021-01-29 17:19:44.430971 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:19:44.733239 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70838f13-55d5-4ae8-b69e-7070f9677a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983c625c40>]}
2021-01-29 17:19:44.735168 (Thread-1): 12:19:44 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.79s]
2021-01-29 17:19:44.735451 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:19:44.735696 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:19:44.737259 (Thread-1): 12:19:44 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 17:19:44.737987 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:44.738167 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:19:44.750729 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:19:44.751255 (Thread-1): finished collecting timing info
2021-01-29 17:19:44.766519 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:44.766719 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 17:19:44.766842 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:19:45.717342 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 17:19:45.721190 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:45.721319 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:19:45.953868 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-29 17:19:45.970687 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:45.971257 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 17:19:46.176374 (Thread-1): SQL status: SUCCESS 2 in 0.20 seconds
2021-01-29 17:19:46.192393 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:46.192974 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 17:19:46.426345 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 17:19:46.432451 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:19:46.436460 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:46.437014 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 17:19:46.634746 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 17:19:46.635383 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:46.635808 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 17:19:48.317625 (Thread-1): SQL status: SUCCESS 1 in 1.68 seconds
2021-01-29 17:19:48.323576 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:19:48.324408 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:19:48.324883 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:19:48.490216 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 17:19:48.501845 (Thread-1): finished collecting timing info
2021-01-29 17:19:48.503206 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 17:19:48.765711 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70838f13-55d5-4ae8-b69e-7070f9677a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983ce94dc0>]}
2021-01-29 17:19:48.768247 (Thread-1): 12:19:48 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.03s]
2021-01-29 17:19:48.768475 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:19:48.768628 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:19:48.769817 (Thread-1): 12:19:48 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 17:19:48.770156 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:48.770266 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:19:48.777112 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:19:48.777431 (Thread-1): finished collecting timing info
2021-01-29 17:19:48.789698 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:48.789853 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:19:48.789966 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:19:49.810301 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 17:19:49.822773 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:49.823299 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:19:50.036213 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-29 17:19:50.063394 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:50.063692 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 17:19:50.259811 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 17:19:50.276239 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:50.276803 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 17:19:50.506406 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 17:19:50.512481 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:19:50.516868 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:50.517373 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 17:19:50.707817 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:19:50.708467 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:50.708920 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:19:53.468867 (Thread-1): SQL status: SUCCESS 1 in 2.76 seconds
2021-01-29 17:19:53.469864 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:19:53.470029 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:19:53.470112 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:19:53.659601 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:19:53.670495 (Thread-1): finished collecting timing info
2021-01-29 17:19:53.671802 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 17:19:53.948029 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70838f13-55d5-4ae8-b69e-7070f9677a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983cead130>]}
2021-01-29 17:19:53.954111 (Thread-1): 12:19:53 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 5.18s]
2021-01-29 17:19:53.954937 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:19:53.959936 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:19:53.960997 (MainThread): Using snowflake connection "master".
2021-01-29 17:19:53.961458 (MainThread): On master: BEGIN
2021-01-29 17:19:53.961919 (MainThread): Opening a new connection, currently in state closed
2021-01-29 17:19:54.852822 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-29 17:19:54.853546 (MainThread): On master: COMMIT
2021-01-29 17:19:54.854287 (MainThread): Using snowflake connection "master".
2021-01-29 17:19:54.854697 (MainThread): On master: COMMIT
2021-01-29 17:19:55.270782 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-29 17:19:55.271522 (MainThread): On master: Close
2021-01-29 17:19:55.554436 (MainThread): 12:19:55 | 
2021-01-29 17:19:55.555466 (MainThread): 12:19:55 | Finished running 5 snowflake_timetravel_table models in 31.42s.
2021-01-29 17:19:55.556363 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:19:55.556943 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-29 17:19:55.597397 (MainThread): 
2021-01-29 17:19:55.597572 (MainThread): Completed successfully
2021-01-29 17:19:55.597688 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-29 17:19:55.597884 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983ce4f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983ce4fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f983ce4f250>]}
2021-01-29 17:19:55.598082 (MainThread): Flushing usage events
2021-01-29 17:20:27.463144 (MainThread): Running with dbt=0.19.0
2021-01-29 17:20:27.953078 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 17:20:27.953395 (MainThread): Tracking: tracking
2021-01-29 17:20:27.953549 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53509580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5b7b8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53512a00>]}
2021-01-29 17:20:27.954165 (MainThread): Set downloads directory='/tmp/dbt-downloads-14t74qw4'
2021-01-29 17:20:27.965362 (MainThread): Installing ../../
2021-01-29 17:20:27.965637 (MainThread):   Creating symlink to local dependency.
2021-01-29 17:20:27.965778 (MainThread):   Installed from <local @ ../../>

2021-01-29 17:20:27.965924 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '4e42b6fd-35c3-4f3f-aca6-42df98a8b882', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53512df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53512dc0>]}
2021-01-29 17:20:27.966250 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53509580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5b7b8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda534a1d60>]}
2021-01-29 17:20:27.966413 (MainThread): Flushing usage events
2021-01-29 17:20:29.628238 (MainThread): Running with dbt=0.19.0
2021-01-29 17:20:30.112017 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 17:20:30.112769 (MainThread): Tracking: tracking
2021-01-29 17:20:30.113094 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9e7c18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fa44ed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9e7516a0>]}
2021-01-29 17:20:30.168820 (MainThread): Partial parsing not enabled
2021-01-29 17:20:30.170450 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:20:30.175608 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:20:30.237484 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:20:30.240461 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:20:30.260792 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:20:30.263047 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:20:30.268107 (MainThread): Parsing macros/core.sql
2021-01-29 17:20:30.272212 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:20:30.274011 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:20:30.275617 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:20:30.277581 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:20:30.280616 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:20:30.290947 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:20:30.299307 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:20:30.304623 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:20:30.324360 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:20:30.326353 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:20:30.362095 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:20:30.369343 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:20:30.375730 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:20:30.377658 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:20:30.392950 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:20:30.415548 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:20:30.424852 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:20:30.426554 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:20:30.427536 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:20:30.429576 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:20:30.430643 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:20:30.432399 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:20:30.479302 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:20:30.495561 (MainThread): Partial parsing not enabled
2021-01-29 17:20:30.536259 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:30.560917 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:30.573702 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:30.586735 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:30.597758 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:30.617238 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:30.750365 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1dd10f0-2b47-4cef-8c71-815b2c22e7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9d3e9160>]}
2021-01-29 17:20:30.782386 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:20:30.783280 (MainThread): 
2021-01-29 17:20:30.783644 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:20:30.789866 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 17:20:30.804248 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 17:20:30.804394 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 17:20:30.804483 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 17:20:32.117399 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.31 seconds
2021-01-29 17:20:32.131287 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 17:20:32.447676 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:20:32.461629 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:20:32.461842 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:20:32.462005 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 17:20:33.386060 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 0.92 seconds
2021-01-29 17:20:33.735529 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:20:34.146789 (MainThread): Using snowflake connection "master".
2021-01-29 17:20:34.146991 (MainThread): On master: BEGIN
2021-01-29 17:20:34.147114 (MainThread): Opening a new connection, currently in state init
2021-01-29 17:20:35.083283 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-29 17:20:35.083470 (MainThread): On master: COMMIT
2021-01-29 17:20:35.083634 (MainThread): Using snowflake connection "master".
2021-01-29 17:20:35.083719 (MainThread): On master: COMMIT
2021-01-29 17:20:35.565534 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-29 17:20:35.565726 (MainThread): On master: Close
2021-01-29 17:20:35.842622 (MainThread): 12:20:35 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:20:35.843672 (MainThread): 12:20:35 | 
2021-01-29 17:20:35.850420 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:20:35.858919 (Thread-1): 12:20:35 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 17:20:35.860548 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:35.861253 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:20:35.895312 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:20:35.895695 (Thread-1): finished collecting timing info
2021-01-29 17:20:35.944637 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:35.944812 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:20:35.944914 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:20:36.967415 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 17:20:36.998725 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:36.998915 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:20:37.221807 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 17:20:37.239519 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:37.240115 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 17:20:37.491189 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-29 17:20:37.533450 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:37.533662 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 17:20:37.756246 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-29 17:20:37.770089 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:20:37.771071 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:37.771181 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 17:20:38.019928 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:20:38.020170 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:38.020303 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:20:39.315481 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-01-29 17:20:39.317055 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:20:39.317296 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:20:39.317426 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:20:39.489335 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 17:20:39.517054 (Thread-1): finished collecting timing info
2021-01-29 17:20:39.517523 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 17:20:39.837488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1dd10f0-2b47-4cef-8c71-815b2c22e7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9e68a370>]}
2021-01-29 17:20:39.839410 (Thread-1): 12:20:39 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 3.98s]
2021-01-29 17:20:39.839636 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:20:39.839848 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:20:39.841497 (Thread-1): 12:20:39 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 17:20:39.841961 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:39.842110 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:20:39.851329 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:20:39.851715 (Thread-1): finished collecting timing info
2021-01-29 17:20:39.865313 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:39.865461 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 17:20:39.865574 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:20:40.813939 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 17:20:40.826757 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:40.827318 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:20:41.018476 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 17:20:41.033843 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:41.034422 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 17:20:41.230595 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-29 17:20:41.248044 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:41.248615 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 17:20:41.494490 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:20:41.500795 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:20:41.505298 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:41.505821 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 17:20:41.714683 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 17:20:41.715515 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:41.716056 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 17:20:43.192400 (Thread-1): SQL status: SUCCESS 1 in 1.48 seconds
2021-01-29 17:20:43.197272 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:20:43.198085 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:20:43.198525 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:20:43.596831 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-01-29 17:20:43.608635 (Thread-1): finished collecting timing info
2021-01-29 17:20:43.609934 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 17:20:44.232213 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1dd10f0-2b47-4cef-8c71-815b2c22e7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9c047460>]}
2021-01-29 17:20:44.238317 (Thread-1): 12:20:44 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.39s]
2021-01-29 17:20:44.239043 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:20:44.239775 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:20:44.245610 (Thread-1): 12:20:44 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:20:44.247804 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:44.248623 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:20:44.266651 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:20:44.267162 (Thread-1): finished collecting timing info
2021-01-29 17:20:44.282779 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:44.282947 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:20:44.283047 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:20:45.937706 (Thread-1): SQL status: SUCCESS 1 in 1.65 seconds
2021-01-29 17:20:45.950710 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:45.951300 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:20:46.226677 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-29 17:20:46.243643 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:46.244207 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 17:20:46.480314 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-29 17:20:46.500078 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:46.500700 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 17:20:46.744085 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 17:20:46.751044 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:20:46.752035 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:46.752130 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:20:46.961059 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 17:20:46.962164 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:46.962974 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 17:20:47.423722 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-29 17:20:47.424547 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:47.425043 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:20:48.643147 (Thread-1): SQL status: SUCCESS 2 in 1.22 seconds
2021-01-29 17:20:48.644173 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:20:48.644340 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:20:48.644422 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:20:49.534007 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-01-29 17:20:49.546079 (Thread-1): finished collecting timing info
2021-01-29 17:20:49.547414 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:20:49.821372 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1dd10f0-2b47-4cef-8c71-815b2c22e7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9c07c790>]}
2021-01-29 17:20:49.827500 (Thread-1): 12:20:49 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.57s]
2021-01-29 17:20:49.828381 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:20:49.829226 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:20:49.835354 (Thread-1): 12:20:49 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 17:20:49.837121 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:49.837926 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:20:49.858937 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:20:49.859516 (Thread-1): finished collecting timing info
2021-01-29 17:20:49.873858 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:49.874013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 17:20:49.874111 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:20:50.899733 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 17:20:50.912038 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:50.912585 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:20:51.099108 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 17:20:51.116384 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:51.116978 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 17:20:51.425771 (Thread-1): SQL status: SUCCESS 2 in 0.31 seconds
2021-01-29 17:20:51.441614 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:51.442169 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 17:20:51.999254 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-29 17:20:52.011732 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:20:52.015929 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:52.016478 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 17:20:52.457727 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-29 17:20:52.458692 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:52.459524 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 17:20:53.635839 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-29 17:20:53.637443 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:20:53.637719 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:20:53.637859 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:20:53.786705 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-29 17:20:53.791011 (Thread-1): finished collecting timing info
2021-01-29 17:20:53.791419 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 17:20:54.175644 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1dd10f0-2b47-4cef-8c71-815b2c22e7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9d4afa00>]}
2021-01-29 17:20:54.182287 (Thread-1): 12:20:54 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.34s]
2021-01-29 17:20:54.183143 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:20:54.183923 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:20:54.188626 (Thread-1): 12:20:54 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 17:20:54.189559 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:54.189869 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:20:54.204972 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:20:54.205368 (Thread-1): finished collecting timing info
2021-01-29 17:20:54.218319 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:54.218469 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:20:54.218582 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:20:55.598651 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-01-29 17:20:55.611411 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:55.612270 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:20:55.825659 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-29 17:20:55.842597 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:55.843203 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 17:20:56.213846 (Thread-1): SQL status: SUCCESS 3 in 0.37 seconds
2021-01-29 17:20:56.236115 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:56.236782 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 17:20:56.476329 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 17:20:56.483330 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:20:56.486961 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:56.487259 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 17:20:56.756870 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-29 17:20:56.757129 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:56.757283 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:20:58.207130 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-01-29 17:20:58.214623 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:20:58.215746 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:20:58.216354 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:20:58.456482 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 17:20:58.471098 (Thread-1): finished collecting timing info
2021-01-29 17:20:58.473184 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 17:20:58.792497 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1dd10f0-2b47-4cef-8c71-815b2c22e7f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9c010d60>]}
2021-01-29 17:20:58.799400 (Thread-1): 12:20:58 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.60s]
2021-01-29 17:20:58.800301 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:20:58.806042 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:20:58.807005 (MainThread): Using snowflake connection "master".
2021-01-29 17:20:58.807447 (MainThread): On master: BEGIN
2021-01-29 17:20:58.807886 (MainThread): Opening a new connection, currently in state closed
2021-01-29 17:21:00.075608 (MainThread): SQL status: SUCCESS 1 in 1.27 seconds
2021-01-29 17:21:00.076333 (MainThread): On master: COMMIT
2021-01-29 17:21:00.077092 (MainThread): Using snowflake connection "master".
2021-01-29 17:21:00.077517 (MainThread): On master: COMMIT
2021-01-29 17:21:00.443388 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-29 17:21:00.443862 (MainThread): On master: Close
2021-01-29 17:21:00.819573 (MainThread): 12:21:00 | 
2021-01-29 17:21:00.820376 (MainThread): 12:21:00 | Finished running 5 snowflake_timetravel_table models in 30.04s.
2021-01-29 17:21:00.820951 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:21:00.821352 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-29 17:21:00.890900 (MainThread): 
2021-01-29 17:21:00.891070 (MainThread): Completed successfully
2021-01-29 17:21:00.891187 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-29 17:21:00.891384 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9e65ed60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9d3d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9d48fe80>]}
2021-01-29 17:21:00.891571 (MainThread): Flushing usage events
2021-01-29 17:27:05.138838 (MainThread): Running with dbt=0.18.1
2021-01-29 17:27:05.630241 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 17:27:05.630615 (MainThread): Tracking: tracking
2021-01-29 17:27:05.630810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a8dbea30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90afb53070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a8d4a3a0>]}
2021-01-29 17:27:05.633183 (MainThread): Set downloads directory='/tmp/dbt-downloads-pccvrgts'
2021-01-29 17:27:05.647379 (MainThread): Installing ../../
2021-01-29 17:27:05.647661 (MainThread):   Creating symlink to local dependency.
2021-01-29 17:27:05.647789 (MainThread):   Installed from <local @ ../../>

2021-01-29 17:27:05.647939 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a301f39-9a7b-4c12-9281-db0d097f7354', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a8d4a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a8d4ab50>]}
2021-01-29 17:27:05.648270 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90afb53070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a8d4a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a8d4af70>]}
2021-01-29 17:27:05.648431 (MainThread): Flushing usage events
2021-01-29 17:27:07.375832 (MainThread): Running with dbt=0.18.1
2021-01-29 17:27:07.856524 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 17:27:07.857182 (MainThread): Tracking: tracking
2021-01-29 17:27:07.857482 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e330a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ea1152b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e330f4c0>]}
2021-01-29 17:27:07.893832 (MainThread): Partial parsing not enabled
2021-01-29 17:27:07.894973 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:27:07.897881 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:27:07.934443 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:27:07.936285 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:27:07.947721 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:27:07.950091 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:27:07.955416 (MainThread): Parsing macros/core.sql
2021-01-29 17:27:07.959424 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:27:07.961287 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:27:07.962952 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:27:07.965006 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:27:07.967878 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:27:07.977432 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:27:07.984130 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:27:07.989195 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:27:08.005625 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:27:08.007355 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:27:08.037248 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:27:08.044150 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:27:08.050132 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:27:08.051908 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:27:08.066435 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:27:08.089089 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:27:08.097921 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:27:08.099498 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:27:08.100405 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:27:08.102318 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:27:08.103340 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:27:08.106321 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:27:08.156604 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:27:08.171516 (MainThread): Partial parsing not enabled
2021-01-29 17:27:08.208437 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:08.230582 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:08.242121 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:08.252996 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:08.263795 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:08.282952 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:08.448467 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 17:27:08.449323 (MainThread): 
2021-01-29 17:27:08.449656 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:27:08.455541 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 17:27:08.469836 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 17:27:08.469978 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 17:27:08.470063 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 17:27:09.529727 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.06 seconds
2021-01-29 17:27:09.561546 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 17:27:09.868758 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:27:09.883375 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:27:09.883615 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:27:09.883802 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 17:27:10.822277 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 0.94 seconds
2021-01-29 17:27:11.164927 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:27:11.483717 (MainThread): Using snowflake connection "master".
2021-01-29 17:27:11.483961 (MainThread): On master: BEGIN
2021-01-29 17:27:11.484118 (MainThread): Opening a new connection, currently in state init
2021-01-29 17:27:12.474688 (MainThread): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-29 17:27:12.475406 (MainThread): On master: COMMIT
2021-01-29 17:27:12.476127 (MainThread): Using snowflake connection "master".
2021-01-29 17:27:12.476553 (MainThread): On master: COMMIT
2021-01-29 17:27:12.818167 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-29 17:27:12.818927 (MainThread): On master: Close
2021-01-29 17:27:13.132388 (MainThread): 12:27:13 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:27:13.133288 (MainThread): 12:27:13 | 
2021-01-29 17:27:13.141662 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:27:13.149703 (Thread-1): 12:27:13 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 17:27:13.151399 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:13.152021 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:27:13.193471 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:27:13.193863 (Thread-1): finished collecting timing info
2021-01-29 17:27:13.242442 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:13.242608 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:27:13.242732 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:27:14.275898 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 17:27:14.315270 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:14.315484 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:27:14.499923 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-29 17:27:14.509208 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:14.509432 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 17:27:14.753427 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-29 17:27:14.795508 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:14.795718 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 17:27:15.043835 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:27:15.085610 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:27:15.086832 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:15.086957 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 17:27:15.329762 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 17:27:15.330020 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:15.330156 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:27:16.673789 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-01-29 17:27:16.678639 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:27:16.679426 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:27:16.679865 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:27:16.870614 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:27:16.914459 (Thread-1): finished collecting timing info
2021-01-29 17:27:16.914847 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 17:27:17.318430 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9ffd017-c441-4830-8c61-644c84903ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e326e400>]}
2021-01-29 17:27:17.325086 (Thread-1): 12:27:17 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.17s]
2021-01-29 17:27:17.326403 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:27:17.327751 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:27:17.339979 (Thread-1): 12:27:17 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 17:27:17.341098 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:17.341473 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:27:17.357048 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:27:17.357493 (Thread-1): finished collecting timing info
2021-01-29 17:27:17.371733 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:17.371906 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 17:27:17.372004 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:27:18.999079 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-01-29 17:27:19.011505 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:19.012055 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:27:19.372634 (Thread-1): SQL status: SUCCESS 3 in 0.36 seconds
2021-01-29 17:27:19.386978 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:19.387265 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 17:27:19.628024 (Thread-1): SQL status: SUCCESS 4 in 0.24 seconds
2021-01-29 17:27:19.651330 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:19.651980 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 17:27:19.988187 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-29 17:27:19.994321 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:27:19.998576 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:19.999073 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 17:27:20.231167 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 17:27:20.231836 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:20.232261 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 17:27:21.646008 (Thread-1): SQL status: SUCCESS 1 in 1.41 seconds
2021-01-29 17:27:21.650651 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:27:21.650895 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:27:21.651009 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:27:21.808421 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 17:27:21.820440 (Thread-1): finished collecting timing info
2021-01-29 17:27:21.821839 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 17:27:22.092569 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9ffd017-c441-4830-8c61-644c84903ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e1653b20>]}
2021-01-29 17:27:22.098761 (Thread-1): 12:27:22 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.75s]
2021-01-29 17:27:22.099521 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:27:22.100207 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:27:22.105766 (Thread-1): 12:27:22 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:27:22.107956 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:22.108539 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:27:22.130024 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:27:22.130544 (Thread-1): finished collecting timing info
2021-01-29 17:27:22.145878 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:22.146030 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:27:22.146128 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:27:23.191280 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-29 17:27:23.204032 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:23.204584 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:27:23.490857 (Thread-1): SQL status: SUCCESS 3 in 0.29 seconds
2021-01-29 17:27:23.506250 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:23.506845 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 17:27:23.730387 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 17:27:23.757780 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:23.758154 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 17:27:24.274699 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-01-29 17:27:24.307423 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:27:24.311000 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:24.311268 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:27:25.092521 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-01-29 17:27:25.093362 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:25.093894 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 17:27:25.669344 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-29 17:27:25.669963 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:25.670431 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:27:26.630022 (Thread-1): SQL status: SUCCESS 2 in 0.96 seconds
2021-01-29 17:27:26.635557 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:27:26.636428 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:27:26.637026 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:27:27.235003 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-01-29 17:27:27.238749 (Thread-1): finished collecting timing info
2021-01-29 17:27:27.239184 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:27:27.504078 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9ffd017-c441-4830-8c61-644c84903ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e05ee190>]}
2021-01-29 17:27:27.510583 (Thread-1): 12:27:27 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.40s]
2021-01-29 17:27:27.511472 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:27:27.512203 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:27:27.517558 (Thread-1): 12:27:27 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 17:27:27.519629 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:27.520178 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:27:27.548361 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:27:27.549455 (Thread-1): finished collecting timing info
2021-01-29 17:27:27.572264 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:27.572441 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 17:27:27.572551 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:27:28.601560 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 17:27:28.614034 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:28.614561 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:27:28.847329 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-29 17:27:28.863999 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:28.864573 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 17:27:29.066782 (Thread-1): SQL status: SUCCESS 2 in 0.20 seconds
2021-01-29 17:27:29.084032 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:29.084592 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 17:27:29.339512 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:27:29.345649 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:27:29.349731 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:29.350330 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 17:27:29.540798 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:27:29.541467 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:29.541929 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 17:27:31.090224 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-01-29 17:27:31.091809 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:27:31.092047 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:27:31.092177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:27:31.296493 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 17:27:31.308250 (Thread-1): finished collecting timing info
2021-01-29 17:27:31.310071 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 17:27:31.684769 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9ffd017-c441-4830-8c61-644c84903ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e05e9040>]}
2021-01-29 17:27:31.691991 (Thread-1): 12:27:31 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.16s]
2021-01-29 17:27:31.692785 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:27:31.693515 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:27:31.696813 (Thread-1): 12:27:31 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 17:27:31.697691 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:31.698008 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:27:31.711143 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:27:31.711580 (Thread-1): finished collecting timing info
2021-01-29 17:27:31.726184 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:31.726413 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:27:31.726544 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:27:32.722026 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-29 17:27:32.734734 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:32.735272 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:27:32.956697 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 17:27:32.974012 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:32.974592 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 17:27:33.231720 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-29 17:27:33.248303 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:33.248902 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 17:27:33.532036 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-29 17:27:33.538676 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:27:33.539961 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:33.540117 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 17:27:33.731865 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:27:33.732592 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:33.733066 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:27:35.686583 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-01-29 17:27:35.691414 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:27:35.692216 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:27:35.692691 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:27:35.854744 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 17:27:35.867255 (Thread-1): finished collecting timing info
2021-01-29 17:27:35.868585 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 17:27:36.147647 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9ffd017-c441-4830-8c61-644c84903ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e058f580>]}
2021-01-29 17:27:36.153685 (Thread-1): 12:27:36 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.45s]
2021-01-29 17:27:36.154468 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:27:36.159594 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:27:36.160575 (MainThread): Using snowflake connection "master".
2021-01-29 17:27:36.161105 (MainThread): On master: BEGIN
2021-01-29 17:27:36.161555 (MainThread): Opening a new connection, currently in state closed
2021-01-29 17:27:37.180378 (MainThread): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 17:27:37.181134 (MainThread): On master: COMMIT
2021-01-29 17:27:37.181856 (MainThread): Using snowflake connection "master".
2021-01-29 17:27:37.182275 (MainThread): On master: COMMIT
2021-01-29 17:27:37.515975 (MainThread): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-29 17:27:37.516186 (MainThread): On master: Close
2021-01-29 17:27:37.780150 (MainThread): 12:27:37 | 
2021-01-29 17:27:37.781182 (MainThread): 12:27:37 | Finished running 5 snowflake_timetravel_table models in 29.33s.
2021-01-29 17:27:37.781747 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:27:37.782130 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-29 17:27:37.823472 (MainThread): 
2021-01-29 17:27:37.823660 (MainThread): Completed successfully
2021-01-29 17:27:37.823792 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-29 17:27:37.824003 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e1607760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e1607070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89e1656160>]}
2021-01-29 17:27:37.824226 (MainThread): Flushing usage events
2021-01-29 17:28:09.944301 (MainThread): Running with dbt=0.19.0
2021-01-29 17:28:10.413819 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 17:28:10.414108 (MainThread): Tracking: tracking
2021-01-29 17:28:10.414250 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913f0be430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f914736d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913f0c89d0>]}
2021-01-29 17:28:10.414830 (MainThread): Set downloads directory='/tmp/dbt-downloads-xs5xrec6'
2021-01-29 17:28:10.425590 (MainThread): Installing ../../
2021-01-29 17:28:10.425861 (MainThread):   Creating symlink to local dependency.
2021-01-29 17:28:10.425982 (MainThread):   Installed from <local @ ../../>

2021-01-29 17:28:10.426123 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '766afd33-fa75-4f43-96b9-339bc9854284', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913f05b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913f05bc10>]}
2021-01-29 17:28:10.426473 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913f0be430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913f05b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f913f05b3d0>]}
2021-01-29 17:28:10.426632 (MainThread): Flushing usage events
2021-01-29 17:28:12.350495 (MainThread): Running with dbt=0.19.0
2021-01-29 17:28:12.842556 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 17:28:12.845116 (MainThread): Tracking: tracking
2021-01-29 17:28:12.845595 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a093c7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0f0f35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a09353670>]}
2021-01-29 17:28:12.909217 (MainThread): Partial parsing not enabled
2021-01-29 17:28:12.910903 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:28:12.914070 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:28:12.950010 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:28:12.951780 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:28:12.962622 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:28:12.965079 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:28:12.970647 (MainThread): Parsing macros/core.sql
2021-01-29 17:28:12.975355 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:28:12.977412 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:28:12.979217 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:28:12.981419 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:28:12.984725 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:28:12.995035 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:28:13.002473 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:28:13.008258 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:28:13.028217 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:28:13.030151 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:28:13.067128 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:28:13.074371 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:28:13.081184 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:28:13.083313 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:28:13.098658 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:28:13.122052 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:28:13.131648 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:28:13.133372 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:28:13.134349 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:28:13.136300 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:28:13.137348 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:28:13.139298 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:28:13.186847 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:28:13.204426 (MainThread): Partial parsing not enabled
2021-01-29 17:28:13.246994 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:13.269439 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:13.280482 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:13.291696 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:13.302772 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:13.322197 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:13.467264 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48a386ab-ed15-4439-85ba-f2f479453bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a080cec70>]}
2021-01-29 17:28:13.504800 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:28:13.505644 (MainThread): 
2021-01-29 17:28:13.505977 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:28:13.512837 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 17:28:13.528597 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 17:28:13.528758 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 17:28:13.528867 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 17:28:14.532658 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.00 seconds
2021-01-29 17:28:14.567240 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 17:28:14.878005 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:28:14.890866 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:28:14.891025 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:28:14.891131 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 17:28:15.841891 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 0.95 seconds
2021-01-29 17:28:16.199393 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:28:16.539683 (MainThread): Using snowflake connection "master".
2021-01-29 17:28:16.539859 (MainThread): On master: BEGIN
2021-01-29 17:28:16.539958 (MainThread): Opening a new connection, currently in state init
2021-01-29 17:28:17.444394 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-29 17:28:17.445162 (MainThread): On master: COMMIT
2021-01-29 17:28:17.445924 (MainThread): Using snowflake connection "master".
2021-01-29 17:28:17.446340 (MainThread): On master: COMMIT
2021-01-29 17:28:17.748109 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-29 17:28:17.749038 (MainThread): On master: Close
2021-01-29 17:28:18.040223 (MainThread): 12:28:18 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:28:18.041275 (MainThread): 12:28:18 | 
2021-01-29 17:28:18.049223 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:28:18.055437 (Thread-1): 12:28:18 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 17:28:18.057055 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:18.057749 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:28:18.091177 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:28:18.091541 (Thread-1): finished collecting timing info
2021-01-29 17:28:18.139551 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:18.139714 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:28:18.139815 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:28:19.255047 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-29 17:28:19.290796 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:19.291048 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:28:19.555799 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-01-29 17:28:19.568790 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:19.569054 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 17:28:19.768142 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 17:28:19.803505 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:19.803704 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 17:28:20.033164 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 17:28:20.073246 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:28:20.074427 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:20.074556 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 17:28:20.278243 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 17:28:20.278905 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:20.279337 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:28:21.833920 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-01-29 17:28:21.839242 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:28:21.840109 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:28:21.840626 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:28:22.014542 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 17:28:22.040057 (Thread-1): finished collecting timing info
2021-01-29 17:28:22.040398 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 17:28:22.427857 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a386ab-ed15-4439-85ba-f2f479453bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a080aed30>]}
2021-01-29 17:28:22.434404 (Thread-1): 12:28:22 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.37s]
2021-01-29 17:28:22.435226 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:28:22.435929 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:28:22.440254 (Thread-1): 12:28:22 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 17:28:22.441624 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:22.441968 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:28:22.454912 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:28:22.455322 (Thread-1): finished collecting timing info
2021-01-29 17:28:22.469232 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:22.469400 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 17:28:22.469502 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:28:23.424578 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 17:28:23.440966 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:23.441325 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:28:23.752862 (Thread-1): SQL status: SUCCESS 3 in 0.31 seconds
2021-01-29 17:28:23.767878 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:23.768442 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 17:28:23.973803 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-29 17:28:23.991125 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:23.991710 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 17:28:24.208607 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-29 17:28:24.211978 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:28:24.214387 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:24.214605 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 17:28:24.431698 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-29 17:28:24.432705 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:24.433464 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 17:28:25.605581 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-29 17:28:25.610394 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:28:25.611197 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:28:25.611635 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:28:25.904499 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-29 17:28:25.918249 (Thread-1): finished collecting timing info
2021-01-29 17:28:25.919569 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 17:28:26.220302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a386ab-ed15-4439-85ba-f2f479453bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a00db5cd0>]}
2021-01-29 17:28:26.226516 (Thread-1): 12:28:26 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.78s]
2021-01-29 17:28:26.227286 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:28:26.227985 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:28:26.233296 (Thread-1): 12:28:26 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:28:26.235441 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:26.236012 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:28:26.253871 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:28:26.254366 (Thread-1): finished collecting timing info
2021-01-29 17:28:26.268760 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:26.268924 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:28:26.269027 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:28:27.214992 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 17:28:27.227868 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:27.228424 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:28:27.438634 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-29 17:28:27.463268 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:27.463894 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 17:28:27.653397 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 17:28:27.670200 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:27.670749 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 17:28:27.987743 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-29 17:28:28.021535 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:28:28.024645 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:28.024983 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:28:28.267997 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 17:28:28.268666 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:28.269177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 17:28:28.725900 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-29 17:28:28.726899 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:28.727723 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:28:29.545029 (Thread-1): SQL status: SUCCESS 2 in 0.82 seconds
2021-01-29 17:28:29.549785 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:28:29.550635 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:28:29.551076 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:28:30.064990 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-29 17:28:30.076673 (Thread-1): finished collecting timing info
2021-01-29 17:28:30.077967 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:28:30.363110 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a386ab-ed15-4439-85ba-f2f479453bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a00daffd0>]}
2021-01-29 17:28:30.376314 (Thread-1): 12:28:30 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.13s]
2021-01-29 17:28:30.380196 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:28:30.381059 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:28:30.385520 (Thread-1): 12:28:30 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 17:28:30.386430 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:30.386761 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:28:30.400689 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:28:30.401103 (Thread-1): finished collecting timing info
2021-01-29 17:28:30.414605 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:30.414781 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 17:28:30.414887 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:28:31.486574 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-29 17:28:31.489569 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:31.489715 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:28:31.900565 (Thread-1): SQL status: SUCCESS 3 in 0.41 seconds
2021-01-29 17:28:31.903999 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:31.904141 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 17:28:32.227065 (Thread-1): SQL status: SUCCESS 2 in 0.32 seconds
2021-01-29 17:28:32.232258 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:32.232445 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 17:28:32.493925 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-29 17:28:32.502231 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:28:32.506390 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:32.506909 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 17:28:33.085776 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-29 17:28:33.086436 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:33.086864 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 17:28:34.156954 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-29 17:28:34.159513 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:28:34.159721 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:28:34.159826 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:28:34.515686 (Thread-1): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-29 17:28:34.528980 (Thread-1): finished collecting timing info
2021-01-29 17:28:34.530244 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 17:28:35.140805 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a386ab-ed15-4439-85ba-f2f479453bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0924f820>]}
2021-01-29 17:28:35.146898 (Thread-1): 12:28:35 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.75s]
2021-01-29 17:28:35.147633 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:28:35.148394 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:28:35.154172 (Thread-1): 12:28:35 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 17:28:35.155656 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:35.156196 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:28:35.176080 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:28:35.176573 (Thread-1): finished collecting timing info
2021-01-29 17:28:35.191025 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:35.191205 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:28:35.191305 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:28:36.534100 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-01-29 17:28:36.548162 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:36.548839 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:28:36.777668 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-29 17:28:36.789681 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:36.789946 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 17:28:37.160064 (Thread-1): SQL status: SUCCESS 3 in 0.37 seconds
2021-01-29 17:28:37.177140 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:37.177706 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 17:28:37.417433 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 17:28:37.423581 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:28:37.427892 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:37.428403 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 17:28:37.688385 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-29 17:28:37.689076 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:37.689501 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:28:38.743736 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-01-29 17:28:38.748541 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:28:38.749425 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:28:38.749869 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:28:38.920619 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 17:28:38.932348 (Thread-1): finished collecting timing info
2021-01-29 17:28:38.933657 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 17:28:39.288177 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a386ab-ed15-4439-85ba-f2f479453bf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a09249eb0>]}
2021-01-29 17:28:39.289736 (Thread-1): 12:28:39 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.13s]
2021-01-29 17:28:39.290012 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:28:39.291511 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:28:39.291762 (MainThread): Using snowflake connection "master".
2021-01-29 17:28:39.291875 (MainThread): On master: BEGIN
2021-01-29 17:28:39.291992 (MainThread): Opening a new connection, currently in state closed
2021-01-29 17:28:40.296858 (MainThread): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-29 17:28:40.297621 (MainThread): On master: COMMIT
2021-01-29 17:28:40.298374 (MainThread): Using snowflake connection "master".
2021-01-29 17:28:40.298798 (MainThread): On master: COMMIT
2021-01-29 17:28:40.792115 (MainThread): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-29 17:28:40.792922 (MainThread): On master: Close
2021-01-29 17:28:41.077917 (MainThread): 12:28:41 | 
2021-01-29 17:28:41.078785 (MainThread): 12:28:41 | Finished running 5 snowflake_timetravel_table models in 27.57s.
2021-01-29 17:28:41.079447 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:28:41.079902 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-29 17:28:41.144042 (MainThread): 
2021-01-29 17:28:41.144213 (MainThread): Completed successfully
2021-01-29 17:28:41.144331 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-29 17:28:41.144524 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a092c7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a080ce790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a0809eb20>]}
2021-01-29 17:28:41.144714 (MainThread): Flushing usage events
2021-01-29 17:33:02.217131 (MainThread): Running with dbt=0.19.0
2021-01-29 17:33:02.693059 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 17:33:02.694026 (MainThread): Tracking: tracking
2021-01-29 17:33:02.694479 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c817de5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7ba3eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7ba3ef40>]}
2021-01-29 17:33:02.751175 (MainThread): Partial parsing not enabled
2021-01-29 17:33:02.752374 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:33:02.755507 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:33:02.790307 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:33:02.791997 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:33:02.802207 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:33:02.804394 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:33:02.809561 (MainThread): Parsing macros/core.sql
2021-01-29 17:33:02.813813 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:33:02.815585 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:33:02.817186 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:33:02.819120 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:33:02.822040 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:33:02.831276 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:33:02.838075 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:33:02.843228 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:33:02.862078 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:33:02.863872 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:33:02.897338 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:33:02.904385 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:33:02.910764 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:33:02.912599 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:33:02.926911 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:33:02.948966 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:33:02.957802 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:33:02.959592 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:33:02.960642 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:33:02.962687 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:33:02.963714 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:33:02.965508 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:33:03.010736 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:33:03.025849 (MainThread): Partial parsing not enabled
2021-01-29 17:33:03.066069 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:03.088798 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:33:03.099260 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:33:03.110073 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:33:03.120815 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:33:03.139509 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:03.270650 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e9ed85d-4559-4345-9caa-0b541e2b2279', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a7e3130>]}
2021-01-29 17:33:03.302582 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:33:03.303417 (MainThread): 
2021-01-29 17:33:03.303755 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:33:03.310963 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:33:03.324863 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:33:03.325006 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:33:03.325092 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 17:33:04.684136 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.36 seconds
2021-01-29 17:33:05.023415 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:33:05.324671 (MainThread): 12:33:05 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:33:05.325018 (MainThread): 12:33:05 | 
2021-01-29 17:33:05.327225 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:33:05.327474 (Thread-1): 12:33:05 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:33:05.327842 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:05.328003 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:33:05.351047 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:33:05.351466 (Thread-1): finished collecting timing info
2021-01-29 17:33:05.352788 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:05.352933 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:33:05.353045 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:33:06.202937 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-29 17:33:06.203629 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:06.204065 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => 'ERROR'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 17:33:06.423482 (Thread-1): Snowflake query id: 0199f01d-058c-3fa9-0000-44a938e8bd06
2021-01-29 17:33:06.424058 (Thread-1): Snowflake error: 001015 (22023): SQL compilation error:
argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
2021-01-29 17:33:06.424798 (Thread-1): finished collecting timing info
2021-01-29 17:33:06.426192 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 17:33:06.797554 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:33:07.142244 (Thread-1): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001015 (22023): SQL compilation error:
  argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001015 (22023): SQL compilation error:
argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/test.py", line 83, in execute
    failed_rows = self.execute_data_test(test)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/test.py", line 45, in execute_data_test
    res, table = self.adapter.execute(
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001015 (22023): SQL compilation error:
  argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-29 17:33:07.150789 (Thread-1): 12:33:07 | 1 of 1 ERROR test_snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 1.82s]
2021-01-29 17:33:07.151626 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:33:07.157923 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:33:07.159360 (MainThread): 12:33:07 | 
2021-01-29 17:33:07.160119 (MainThread): 12:33:07 | Finished running 1 test in 3.86s.
2021-01-29 17:33:07.160811 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:33:07.161249 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:33:07.226298 (MainThread): 
2021-01-29 17:33:07.226474 (MainThread): Completed with 1 error and 0 warnings:
2021-01-29 17:33:07.226657 (MainThread): 
2021-01-29 17:33:07.226779 (MainThread): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-29 17:33:07.226885 (MainThread):   001015 (22023): SQL compilation error:
2021-01-29 17:33:07.226981 (MainThread):   argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
2021-01-29 17:33:07.227075 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-29 17:33:07.227180 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-29 17:33:07.227419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a771700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a6fad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c7a782040>]}
2021-01-29 17:33:07.227632 (MainThread): Flushing usage events
2021-01-29 17:33:17.752254 (MainThread): Running with dbt=0.19.0
2021-01-29 17:33:18.220160 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 17:33:18.220931 (MainThread): Tracking: do not track
2021-01-29 17:33:18.256836 (MainThread): Partial parsing not enabled
2021-01-29 17:33:18.257959 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:33:18.260919 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:33:18.297458 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:33:18.299168 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:33:18.309511 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:33:18.311635 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:33:18.316825 (MainThread): Parsing macros/core.sql
2021-01-29 17:33:18.321076 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:33:18.322928 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:33:18.324554 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:33:18.326631 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:33:18.329462 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:33:18.338594 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:33:18.345186 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:33:18.350179 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:33:18.368923 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:33:18.370730 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:33:18.404230 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:33:18.411376 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:33:18.417552 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:33:18.419403 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:33:18.434130 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:33:18.456028 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:33:18.465227 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:33:18.466929 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:33:18.467872 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:33:18.469889 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:33:18.470916 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:33:18.472581 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:33:18.519056 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:33:18.534937 (MainThread): Partial parsing not enabled
2021-01-29 17:33:18.573400 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:18.595520 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:33:18.606266 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:33:18.617012 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:33:18.627745 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:33:18.646744 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:18.822941 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:33:18.823694 (MainThread): 
2021-01-29 17:33:18.824041 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:33:18.831176 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:33:18.845416 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:33:18.845560 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:33:18.845649 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 17:33:20.064209 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.22 seconds
2021-01-29 17:33:20.409808 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:33:20.769549 (MainThread): 12:33:20 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:33:20.769834 (MainThread): 12:33:20 | 
2021-01-29 17:33:20.771792 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:33:20.771993 (Thread-1): 12:33:20 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:33:20.772329 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:20.772485 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:33:20.794643 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:33:20.795023 (Thread-1): finished collecting timing info
2021-01-29 17:33:20.795889 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:20.796006 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:33:20.796099 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:33:21.801004 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-29 17:33:21.801685 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:33:21.802122 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => 'ERROR'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 17:33:22.040068 (Thread-1): Snowflake query id: 0199f01d-050b-19e6-0000-44a938e8a872
2021-01-29 17:33:22.040666 (Thread-1): Snowflake error: 001015 (22023): SQL compilation error:
argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
2021-01-29 17:33:22.041283 (Thread-1): finished collecting timing info
2021-01-29 17:33:22.042659 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 17:33:22.342219 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:33:22.683511 (Thread-1): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001015 (22023): SQL compilation error:
  argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 162, in exception_handler
    yield
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/snowflake/connector/cursor.py", line 603, in execute
    Error.errorhandler_wrapper(self.connection, self,
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/snowflake/connector/errors.py", line 125, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/snowflake/connector/errors.py", line 85, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001015 (22023): SQL compilation error:
argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/test.py", line 83, in execute
    failed_rows = self.execute_data_test(test)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/task/test.py", line 45, in execute_data_test
    res, table = self.adapter.execute(
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 314, in add_query
    connection, cursor = super().add_query(
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/tsankey/tmp/pyenv/versions/3.8.7/envs/warehouse-transforms-int-387/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 179, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
  001015 (22023): SQL compilation error:
  argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
  compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-29 17:33:22.692592 (Thread-1): 12:33:22 | 1 of 1 ERROR test_snowflake_timetravel_table_integration_tests_columns_no_change [ERROR in 1.92s]
2021-01-29 17:33:22.693593 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:33:22.700284 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:33:22.702882 (MainThread): 12:33:22 | 
2021-01-29 17:33:22.703989 (MainThread): 12:33:22 | Finished running 1 test in 3.88s.
2021-01-29 17:33:22.704990 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:33:22.705712 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:33:22.770902 (MainThread): 
2021-01-29 17:33:22.771069 (MainThread): Completed with 1 error and 0 warnings:
2021-01-29 17:33:22.771212 (MainThread): 
2021-01-29 17:33:22.771337 (MainThread): Database Error in test test_snowflake_timetravel_table_integration_tests_columns_no_change (tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql)
2021-01-29 17:33:22.771446 (MainThread):   001015 (22023): SQL compilation error:
2021-01-29 17:33:22.771547 (MainThread):   argument TIMESTAMP to function AT needs to be constant, found 'CAST('ERROR' AS TIMESTAMP_TZ(9))'
2021-01-29 17:33:22.771642 (MainThread):   compiled SQL at target/compiled/snowflake_timetravel_table_integration_tests/tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
2021-01-29 17:33:22.771749 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-01-29 17:33:22.771982 (MainThread): Flushing usage events
2021-01-29 17:34:33.981763 (MainThread): Running with dbt=0.18.1
2021-01-29 17:34:34.473893 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 17:34:34.474191 (MainThread): Tracking: tracking
2021-01-29 17:34:34.474332 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676f63e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe67dd3e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676f034c0>]}
2021-01-29 17:34:34.474976 (MainThread): Set downloads directory='/tmp/dbt-downloads-o02b35ry'
2021-01-29 17:34:34.485548 (MainThread): Installing ../../
2021-01-29 17:34:34.485808 (MainThread):   Creating symlink to local dependency.
2021-01-29 17:34:34.485929 (MainThread):   Installed from <local @ ../../>

2021-01-29 17:34:34.486070 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '3cae9ecc-b022-456f-9dfc-fa1386b1e8f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676f0c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676f03af0>]}
2021-01-29 17:34:34.486413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676f63e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676f7df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe676f0c100>]}
2021-01-29 17:34:34.486566 (MainThread): Flushing usage events
2021-01-29 17:34:36.161186 (MainThread): Running with dbt=0.18.1
2021-01-29 17:34:36.637031 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 17:34:36.637803 (MainThread): Tracking: tracking
2021-01-29 17:34:36.638105 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fea44490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6405857430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fea4c640>]}
2021-01-29 17:34:36.673585 (MainThread): Partial parsing not enabled
2021-01-29 17:34:36.674775 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:34:36.677661 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:34:36.715131 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:34:36.717435 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:34:36.729006 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:34:36.731369 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:34:36.736615 (MainThread): Parsing macros/core.sql
2021-01-29 17:34:36.740629 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:34:36.742497 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:34:36.744297 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:34:36.746367 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:34:36.749351 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:34:36.759199 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:34:36.765829 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:34:36.770850 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:34:36.787335 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:34:36.789125 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:34:36.820186 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:34:36.827095 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:34:36.833110 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:34:36.834915 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:34:36.849303 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:34:36.870821 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:34:36.879669 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:34:36.881301 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:34:36.882213 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:34:36.884131 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:34:36.885154 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:34:36.886798 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:34:36.931524 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:34:36.946271 (MainThread): Partial parsing not enabled
2021-01-29 17:34:36.982221 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:37.003125 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:34:37.012868 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:37.022755 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:37.032657 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:34:37.052084 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:37.212825 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 17:34:37.214052 (MainThread): 
2021-01-29 17:34:37.214414 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:34:37.221028 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 17:34:37.236124 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 17:34:37.236270 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 17:34:37.236362 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 17:34:38.858344 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.62 seconds
2021-01-29 17:34:38.888696 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 17:34:39.256652 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:34:39.267794 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:34:39.268004 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:34:39.268212 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 17:34:41.124449 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.86 seconds
2021-01-29 17:34:41.489359 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:34:41.863163 (MainThread): Using snowflake connection "master".
2021-01-29 17:34:41.863397 (MainThread): On master: BEGIN
2021-01-29 17:34:41.863548 (MainThread): Opening a new connection, currently in state init
2021-01-29 17:34:42.777126 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-29 17:34:42.777845 (MainThread): On master: COMMIT
2021-01-29 17:34:42.778571 (MainThread): Using snowflake connection "master".
2021-01-29 17:34:42.778990 (MainThread): On master: COMMIT
2021-01-29 17:34:43.959581 (MainThread): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-29 17:34:43.960707 (MainThread): On master: Close
2021-01-29 17:34:44.577847 (MainThread): 12:34:44 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:34:44.578815 (MainThread): 12:34:44 | 
2021-01-29 17:34:44.586751 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:34:44.593339 (Thread-1): 12:34:44 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 17:34:44.594925 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:44.595543 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:34:44.641840 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:34:44.642243 (Thread-1): finished collecting timing info
2021-01-29 17:34:44.690109 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:44.690269 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:34:44.690366 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:34:45.660133 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-29 17:34:45.700675 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:45.700905 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:34:45.877886 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-29 17:34:45.894722 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:45.895303 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 17:34:46.196336 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-29 17:34:46.241048 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:46.241227 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 17:34:46.490199 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:34:46.536241 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:34:46.537465 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:46.537596 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 17:34:46.720363 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 17:34:46.721090 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:46.721525 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:34:49.573422 (Thread-1): SQL status: SUCCESS 1 in 2.85 seconds
2021-01-29 17:34:49.574836 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:34:49.575058 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:34:49.575164 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:34:49.729904 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-29 17:34:49.745174 (Thread-1): finished collecting timing info
2021-01-29 17:34:49.745587 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 17:34:50.029300 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b5f1-d3aa-4d0d-8077-80a817d94626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fcd99520>]}
2021-01-29 17:34:50.030721 (Thread-1): 12:34:50 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 5.43s]
2021-01-29 17:34:50.030902 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:34:50.031088 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:34:50.032600 (Thread-1): 12:34:50 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 17:34:50.033038 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:50.033159 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:34:50.043701 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:34:50.044149 (Thread-1): finished collecting timing info
2021-01-29 17:34:50.068277 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:50.068544 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 17:34:50.068755 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:34:51.081114 (Thread-1): SQL status: SUCCESS 1 in 1.01 seconds
2021-01-29 17:34:51.085393 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:51.085611 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:34:51.268994 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-29 17:34:51.272291 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:51.272437 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 17:34:51.467750 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-29 17:34:51.474228 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:51.474427 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 17:34:51.698068 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-29 17:34:51.700294 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:34:51.702065 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:51.702230 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 17:34:51.884483 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 17:34:51.884698 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:51.884858 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 17:34:53.449149 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-01-29 17:34:53.450219 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:34:53.450408 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:34:53.450492 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:34:53.617981 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 17:34:53.620418 (Thread-1): finished collecting timing info
2021-01-29 17:34:53.620713 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 17:34:53.866510 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b5f1-d3aa-4d0d-8077-80a817d94626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fcd424f0>]}
2021-01-29 17:34:53.868748 (Thread-1): 12:34:53 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.83s]
2021-01-29 17:34:53.869038 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:34:53.869279 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:34:53.871430 (Thread-1): 12:34:53 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:34:53.871966 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:53.872094 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:34:53.882777 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:34:53.883140 (Thread-1): finished collecting timing info
2021-01-29 17:34:53.900201 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:53.900402 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:34:53.900520 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:34:55.516549 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-01-29 17:34:55.520932 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:55.521127 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:34:55.709199 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 17:34:55.714459 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:55.714664 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 17:34:55.985056 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-29 17:34:56.002899 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:56.003113 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 17:34:56.512145 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-29 17:34:56.525940 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:34:56.528026 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:56.528246 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:34:57.446320 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-29 17:34:57.446542 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:57.446675 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 17:34:58.014733 (Thread-1): SQL status: SUCCESS 1 in 0.57 seconds
2021-01-29 17:34:58.015022 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:58.015178 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:34:58.752514 (Thread-1): SQL status: SUCCESS 2 in 0.74 seconds
2021-01-29 17:34:58.754164 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:34:58.754425 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:34:58.754545 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:34:59.356113 (Thread-1): SQL status: SUCCESS 1 in 0.60 seconds
2021-01-29 17:34:59.361192 (Thread-1): finished collecting timing info
2021-01-29 17:34:59.361898 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:34:59.780411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b5f1-d3aa-4d0d-8077-80a817d94626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fc526f70>]}
2021-01-29 17:34:59.782569 (Thread-1): 12:34:59 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.91s]
2021-01-29 17:34:59.782968 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:34:59.783227 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:34:59.785193 (Thread-1): 12:34:59 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 17:34:59.785635 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:34:59.785763 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:34:59.794989 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:34:59.795512 (Thread-1): finished collecting timing info
2021-01-29 17:34:59.812535 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:34:59.812816 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 17:34:59.813004 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:35:01.358212 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-01-29 17:35:01.364180 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:01.364433 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:35:02.286342 (Thread-1): SQL status: SUCCESS 3 in 0.92 seconds
2021-01-29 17:35:02.322064 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:02.323474 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 17:35:02.566864 (Thread-1): SQL status: SUCCESS 2 in 0.24 seconds
2021-01-29 17:35:02.574774 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:02.575082 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 17:35:02.789289 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 17:35:02.793250 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:35:02.807191 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:02.807427 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 17:35:03.575684 (Thread-1): SQL status: SUCCESS 1 in 0.77 seconds
2021-01-29 17:35:03.576349 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:03.576867 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 17:35:04.764036 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-01-29 17:35:04.765702 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:35:04.766023 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:04.766164 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:35:04.954538 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:35:04.956920 (Thread-1): finished collecting timing info
2021-01-29 17:35:04.957190 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 17:35:05.240147 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b5f1-d3aa-4d0d-8077-80a817d94626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fcda6700>]}
2021-01-29 17:35:05.249504 (Thread-1): 12:35:05 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 5.45s]
2021-01-29 17:35:05.250688 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:35:05.251481 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:35:05.262129 (Thread-1): 12:35:05 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 17:35:05.264442 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:05.265917 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:35:05.301384 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:35:05.301889 (Thread-1): finished collecting timing info
2021-01-29 17:35:05.318853 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:05.319076 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:35:05.319198 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:35:06.312638 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-29 17:35:06.317206 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:06.317472 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:35:06.496632 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-29 17:35:06.512829 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:06.513182 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 17:35:06.764154 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-01-29 17:35:06.773270 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:06.773507 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 17:35:07.020073 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:35:07.026613 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:35:07.031033 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:07.031543 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 17:35:07.307541 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-29 17:35:07.308184 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:07.308608 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:35:08.523041 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-01-29 17:35:08.527996 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:35:08.528818 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:08.529260 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:35:08.777892 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:35:08.811165 (Thread-1): finished collecting timing info
2021-01-29 17:35:08.812493 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 17:35:09.213643 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aad6b5f1-d3aa-4d0d-8077-80a817d94626', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fc51cdc0>]}
2021-01-29 17:35:09.215763 (Thread-1): 12:35:09 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.95s]
2021-01-29 17:35:09.215961 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:35:09.217210 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:35:09.217425 (MainThread): Using snowflake connection "master".
2021-01-29 17:35:09.217508 (MainThread): On master: BEGIN
2021-01-29 17:35:09.217591 (MainThread): Opening a new connection, currently in state closed
2021-01-29 17:35:10.078577 (MainThread): SQL status: SUCCESS 1 in 0.86 seconds
2021-01-29 17:35:10.079433 (MainThread): On master: COMMIT
2021-01-29 17:35:10.082289 (MainThread): Using snowflake connection "master".
2021-01-29 17:35:10.083088 (MainThread): On master: COMMIT
2021-01-29 17:35:10.477038 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-29 17:35:10.477801 (MainThread): On master: Close
2021-01-29 17:35:10.776006 (MainThread): 12:35:10 | 
2021-01-29 17:35:10.776828 (MainThread): 12:35:10 | Finished running 5 snowflake_timetravel_table models in 33.56s.
2021-01-29 17:35:10.777540 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:35:10.777949 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-29 17:35:10.812722 (MainThread): 
2021-01-29 17:35:10.813005 (MainThread): Completed successfully
2021-01-29 17:35:10.813181 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-29 17:35:10.813460 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fcd76eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fcd99b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fcd99ac0>]}
2021-01-29 17:35:10.813713 (MainThread): Flushing usage events
2021-01-29 17:35:12.695976 (MainThread): Running with dbt=0.18.1
2021-01-29 17:35:13.272434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 17:35:13.273264 (MainThread): Tracking: do not track
2021-01-29 17:35:13.312882 (MainThread): Partial parsing not enabled
2021-01-29 17:35:13.315003 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:35:13.321427 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:35:13.356963 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:35:13.358681 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:35:13.370318 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:35:13.372715 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:35:13.378345 (MainThread): Parsing macros/core.sql
2021-01-29 17:35:13.382630 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:35:13.384628 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:35:13.386402 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:35:13.388646 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:35:13.391815 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:35:13.402044 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:35:13.409152 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:35:13.414690 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:35:13.432600 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:35:13.434639 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:35:13.473863 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:35:13.482621 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:35:13.491750 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:35:13.494470 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:35:13.512617 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:35:13.540708 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:35:13.551455 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:35:13.553436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:35:13.554687 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:35:13.557117 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:35:13.558370 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:35:13.560379 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:35:13.611104 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:35:13.627005 (MainThread): Partial parsing not enabled
2021-01-29 17:35:13.667493 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:35:13.691002 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:13.702131 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:13.713098 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:35:13.724078 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:13.743115 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:35:13.946771 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 17:35:13.947538 (MainThread): 
2021-01-29 17:35:13.947865 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:35:13.956093 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:35:13.980095 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:35:13.980251 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:35:13.980343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 17:35:16.124667 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 2.14 seconds
2021-01-29 17:35:16.621868 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:35:17.028034 (MainThread): 12:35:17 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:35:17.028430 (MainThread): 12:35:17 | 
2021-01-29 17:35:17.032557 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:35:17.032801 (Thread-1): 12:35:17 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:35:17.033190 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:35:17.033336 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:35:17.055460 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:35:17.055828 (Thread-1): finished collecting timing info
2021-01-29 17:35:17.056776 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:35:17.056883 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:35:17.056991 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:35:17.966195 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-01-29 17:35:17.966898 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:35:17.967328 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T17:34:53.883406Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 17:35:18.548783 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-01-29 17:35:18.551320 (Thread-1): finished collecting timing info
2021-01-29 17:35:18.552816 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 17:35:18.852828 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:35:20.071096 (Thread-1): 12:35:20 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 3.04s]
2021-01-29 17:35:20.071905 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:35:20.077692 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:35:20.079280 (MainThread): 12:35:20 | 
2021-01-29 17:35:20.080050 (MainThread): 12:35:20 | Finished running 1 test in 6.13s.
2021-01-29 17:35:20.081390 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:35:20.083674 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:35:20.102781 (MainThread): 
2021-01-29 17:35:20.103466 (MainThread): Completed successfully
2021-01-29 17:35:20.103950 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 17:35:20.104444 (MainThread): Flushing usage events
2021-01-29 17:35:48.219659 (MainThread): Running with dbt=0.19.0
2021-01-29 17:35:48.700055 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 17:35:48.700384 (MainThread): Tracking: tracking
2021-01-29 17:35:48.700525 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5bdba6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a640dff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5bdc6670>]}
2021-01-29 17:35:48.703635 (MainThread): Set downloads directory='/tmp/dbt-downloads-_akv2k7z'
2021-01-29 17:35:48.714922 (MainThread): Installing ../../
2021-01-29 17:35:48.715211 (MainThread):   Creating symlink to local dependency.
2021-01-29 17:35:48.715339 (MainThread):   Installed from <local @ ../../>

2021-01-29 17:35:48.715502 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ce51bfeb-0b7d-44bc-b7ea-d9ea361471d1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5bd53280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5bd53970>]}
2021-01-29 17:35:48.715857 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5bdba6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5bd53370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5bd53550>]}
2021-01-29 17:35:48.716017 (MainThread): Flushing usage events
2021-01-29 17:35:50.353805 (MainThread): Running with dbt=0.19.0
2021-01-29 17:35:50.825010 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 17:35:50.825776 (MainThread): Tracking: tracking
2021-01-29 17:35:50.826119 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63ed79a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc644aaa460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63ed087f0>]}
2021-01-29 17:35:50.862843 (MainThread): Partial parsing not enabled
2021-01-29 17:35:50.864035 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:35:50.867156 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:35:50.901532 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:35:50.903179 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:35:50.913099 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:35:50.915364 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:35:50.920462 (MainThread): Parsing macros/core.sql
2021-01-29 17:35:50.924637 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:35:50.926431 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:35:50.927971 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:35:50.930069 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:35:50.932960 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:35:50.942477 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:35:50.949309 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:35:50.954644 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:35:50.972502 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:35:50.974306 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:35:51.007500 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:35:51.014305 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:35:51.020284 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:35:51.022069 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:35:51.036475 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:35:51.058035 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:35:51.067943 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:35:51.069703 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:35:51.070698 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:35:51.072789 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:35:51.074085 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:35:51.076110 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:35:51.146761 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:35:51.164589 (MainThread): Partial parsing not enabled
2021-01-29 17:35:51.208918 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:35:51.231402 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:35:51.242127 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:51.252921 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:35:51.263306 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:35:51.281705 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:35:51.414207 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d8ea12b-092f-4935-8c53-75427f8d6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63d9214f0>]}
2021-01-29 17:35:51.446312 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:35:51.447190 (MainThread): 
2021-01-29 17:35:51.447524 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:35:51.453491 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 17:35:51.467352 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 17:35:51.467491 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 17:35:51.467579 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 17:35:52.939235 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.47 seconds
2021-01-29 17:35:52.960097 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 17:35:53.264869 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:35:53.280035 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:35:53.280264 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:35:53.280437 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 17:35:54.199233 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 0.92 seconds
2021-01-29 17:35:54.554031 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:35:54.977054 (MainThread): Using snowflake connection "master".
2021-01-29 17:35:54.977285 (MainThread): On master: BEGIN
2021-01-29 17:35:54.977440 (MainThread): Opening a new connection, currently in state init
2021-01-29 17:35:56.065522 (MainThread): SQL status: SUCCESS 1 in 1.09 seconds
2021-01-29 17:35:56.066249 (MainThread): On master: COMMIT
2021-01-29 17:35:56.066994 (MainThread): Using snowflake connection "master".
2021-01-29 17:35:56.067177 (MainThread): On master: COMMIT
2021-01-29 17:35:56.343580 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-29 17:35:56.343766 (MainThread): On master: Close
2021-01-29 17:35:56.667296 (MainThread): 12:35:56 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:35:56.668382 (MainThread): 12:35:56 | 
2021-01-29 17:35:56.676707 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:35:56.683197 (Thread-1): 12:35:56 | 1 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 17:35:56.685007 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:56.685718 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:35:56.729229 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:35:56.729603 (Thread-1): finished collecting timing info
2021-01-29 17:35:56.778087 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:56.778285 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:35:56.778381 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:35:57.845102 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-29 17:35:57.888925 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:57.889145 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:35:58.094805 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-29 17:35:58.111551 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:58.112098 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 17:35:58.307944 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 17:35:58.350928 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:58.351147 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 17:35:58.725305 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-29 17:35:58.766713 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 17:35:58.767923 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:58.768073 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 17:35:58.995454 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 17:35:58.996102 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:35:58.996518 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:36:00.372605 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-01-29 17:36:00.381411 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:36:00.382764 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:36:00.383553 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 17:36:00.544050 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 17:36:00.640221 (Thread-1): finished collecting timing info
2021-01-29 17:36:00.640911 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 17:36:00.947995 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d8ea12b-092f-4935-8c53-75427f8d6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63ec74670>]}
2021-01-29 17:36:00.949329 (Thread-1): 12:36:00 | 1 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.26s]
2021-01-29 17:36:00.949503 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 17:36:00.949677 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:36:00.950917 (Thread-1): 12:36:00 | 2 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 17:36:00.951266 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:00.951390 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:36:00.959121 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:36:00.959518 (Thread-1): finished collecting timing info
2021-01-29 17:36:00.977208 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:00.977507 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 17:36:00.977670 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:36:01.970823 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-29 17:36:01.973496 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:01.973608 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:36:02.280540 (Thread-1): SQL status: SUCCESS 3 in 0.31 seconds
2021-01-29 17:36:02.295783 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:02.296356 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 17:36:02.544331 (Thread-1): SQL status: SUCCESS 4 in 0.25 seconds
2021-01-29 17:36:02.547670 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:02.547815 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 17:36:02.834782 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-01-29 17:36:02.840861 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 17:36:02.845318 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:02.845840 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 17:36:03.095551 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:36:03.096384 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:03.097021 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 17:36:04.222175 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-29 17:36:04.223336 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:36:04.224403 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:04.224502 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 17:36:04.405482 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 17:36:04.417802 (Thread-1): finished collecting timing info
2021-01-29 17:36:04.419198 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 17:36:04.792407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d8ea12b-092f-4935-8c53-75427f8d6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63c172fa0>]}
2021-01-29 17:36:04.798519 (Thread-1): 12:36:04 | 2 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.84s]
2021-01-29 17:36:04.799364 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 17:36:04.800132 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:36:04.806311 (Thread-1): 12:36:04 | 3 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:36:04.807935 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:04.808481 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:36:04.829328 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:36:04.829883 (Thread-1): finished collecting timing info
2021-01-29 17:36:04.844783 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:04.844951 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:36:04.845113 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:36:05.904134 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-29 17:36:05.908803 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:05.909013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:36:06.088190 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-29 17:36:06.104923 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:06.105494 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 17:36:06.330067 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 17:36:06.351161 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:06.352197 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 17:36:06.561231 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 17:36:06.592236 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:36:06.594267 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:06.594487 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:36:07.772379 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-29 17:36:07.773082 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:07.773504 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 17:36:08.223488 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-29 17:36:08.224641 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:08.225461 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:36:08.947572 (Thread-1): SQL status: SUCCESS 2 in 0.72 seconds
2021-01-29 17:36:08.952322 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:36:08.953159 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:08.953603 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 17:36:10.754160 (Thread-1): SQL status: SUCCESS 1 in 1.80 seconds
2021-01-29 17:36:10.757779 (Thread-1): finished collecting timing info
2021-01-29 17:36:10.758195 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:36:11.105134 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d8ea12b-092f-4935-8c53-75427f8d6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63c173a60>]}
2021-01-29 17:36:11.112414 (Thread-1): 12:36:11 | 3 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 6.30s]
2021-01-29 17:36:11.113272 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:36:11.113967 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:36:11.119317 (Thread-1): 12:36:11 | 4 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 17:36:11.121546 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:11.122115 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:36:11.145060 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:36:11.145611 (Thread-1): finished collecting timing info
2021-01-29 17:36:11.161392 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:11.161656 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 17:36:11.161812 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:36:12.129174 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-29 17:36:12.133307 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:12.133472 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:36:12.328504 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 17:36:12.345055 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:12.345617 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 17:36:12.622843 (Thread-1): SQL status: SUCCESS 2 in 0.28 seconds
2021-01-29 17:36:12.646485 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:12.646892 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 17:36:12.953607 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-29 17:36:12.955200 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 17:36:12.956180 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:12.956300 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 17:36:13.210866 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 17:36:13.211546 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:13.211969 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 17:36:14.360579 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-01-29 17:36:14.365511 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:36:14.366317 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:14.366756 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 17:36:14.539838 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 17:36:14.542219 (Thread-1): finished collecting timing info
2021-01-29 17:36:14.542476 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 17:36:14.871755 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d8ea12b-092f-4935-8c53-75427f8d6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63c11e1c0>]}
2021-01-29 17:36:14.878169 (Thread-1): 12:36:14 | 4 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 3.75s]
2021-01-29 17:36:14.878923 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 17:36:14.879623 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:36:14.888497 (Thread-1): 12:36:14 | 5 of 5 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 17:36:14.890888 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:14.891618 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:36:14.909097 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:36:14.909633 (Thread-1): finished collecting timing info
2021-01-29 17:36:14.924355 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:14.924527 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 17:36:14.924631 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:36:15.996115 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-29 17:36:16.010891 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:16.011481 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:36:16.210376 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 17:36:16.228217 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:16.228840 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 17:36:16.494853 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-01-29 17:36:16.523979 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:16.524361 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 17:36:16.732719 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 17:36:16.739067 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 17:36:16.743410 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:16.743910 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 17:36:16.929673 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 17:36:16.930297 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:16.930546 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 17:36:18.011454 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-01-29 17:36:18.016809 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:36:18.017666 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:18.018109 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 17:36:18.191509 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 17:36:18.205557 (Thread-1): finished collecting timing info
2021-01-29 17:36:18.207151 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 17:36:18.470368 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d8ea12b-092f-4935-8c53-75427f8d6e04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63c14b610>]}
2021-01-29 17:36:18.476805 (Thread-1): 12:36:18 | 5 of 5 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.58s]
2021-01-29 17:36:18.477717 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 17:36:18.483305 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:36:18.484271 (MainThread): Using snowflake connection "master".
2021-01-29 17:36:18.484721 (MainThread): On master: BEGIN
2021-01-29 17:36:18.485259 (MainThread): Opening a new connection, currently in state closed
2021-01-29 17:36:19.473316 (MainThread): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-29 17:36:19.474060 (MainThread): On master: COMMIT
2021-01-29 17:36:19.475026 (MainThread): Using snowflake connection "master".
2021-01-29 17:36:19.475476 (MainThread): On master: COMMIT
2021-01-29 17:36:19.753381 (MainThread): SQL status: SUCCESS 1 in 0.28 seconds
2021-01-29 17:36:19.754125 (MainThread): On master: Close
2021-01-29 17:36:20.030024 (MainThread): 12:36:20 | 
2021-01-29 17:36:20.030734 (MainThread): 12:36:20 | Finished running 5 snowflake_timetravel_table models in 28.58s.
2021-01-29 17:36:20.031267 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:36:20.031669 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
2021-01-29 17:36:20.083019 (MainThread): 
2021-01-29 17:36:20.083200 (MainThread): Completed successfully
2021-01-29 17:36:20.083318 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2021-01-29 17:36:20.083510 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63db50c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63db2ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc63d9177f0>]}
2021-01-29 17:36:20.083696 (MainThread): Flushing usage events
2021-01-29 17:36:21.983501 (MainThread): Running with dbt=0.19.0
2021-01-29 17:36:22.474927 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 17:36:22.475727 (MainThread): Tracking: do not track
2021-01-29 17:36:22.513496 (MainThread): Partial parsing not enabled
2021-01-29 17:36:22.514652 (MainThread): Parsing macros/catalog.sql
2021-01-29 17:36:22.517756 (MainThread): Parsing macros/adapters.sql
2021-01-29 17:36:22.553132 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 17:36:22.554819 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 17:36:22.564955 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 17:36:22.567201 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 17:36:22.572311 (MainThread): Parsing macros/core.sql
2021-01-29 17:36:22.576416 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 17:36:22.578239 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 17:36:22.579840 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 17:36:22.582350 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 17:36:22.585261 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 17:36:22.595053 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 17:36:22.602454 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 17:36:22.607845 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 17:36:22.626043 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 17:36:22.627827 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 17:36:22.662564 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 17:36:22.669485 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 17:36:22.675575 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 17:36:22.677420 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 17:36:22.692270 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 17:36:22.714449 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 17:36:22.723994 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 17:36:22.725760 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 17:36:22.726744 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 17:36:22.728793 (MainThread): Parsing macros/etc/query.sql
2021-01-29 17:36:22.729883 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 17:36:22.731639 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 17:36:22.776219 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 17:36:22.791254 (MainThread): Partial parsing not enabled
2021-01-29 17:36:22.828786 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:22.849327 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 17:36:22.859262 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 17:36:22.869586 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 17:36:22.880174 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 17:36:22.899059 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:23.063951 (MainThread): Found 5 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 17:36:23.064667 (MainThread): 
2021-01-29 17:36:23.065014 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:36:23.072508 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:36:23.086475 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 17:36:23.086642 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 17:36:23.086728 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 17:36:24.163703 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 467 in 1.08 seconds
2021-01-29 17:36:24.509814 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 17:36:24.799202 (MainThread): 12:36:24 | Concurrency: 1 threads (target='snowflake')
2021-01-29 17:36:24.799516 (MainThread): 12:36:24 | 
2021-01-29 17:36:24.801670 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:36:24.801915 (Thread-1): 12:36:24 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 17:36:24.802352 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:24.802535 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:36:24.832477 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 17:36:24.832925 (Thread-1): finished collecting timing info
2021-01-29 17:36:24.833899 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:24.834010 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 17:36:24.834122 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 17:36:25.715953 (Thread-1): SQL status: SUCCESS 1 in 0.88 seconds
2021-01-29 17:36:25.716667 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 17:36:25.717158 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T17:36:04.830366Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 17:36:27.345203 (Thread-1): SQL status: SUCCESS 1 in 1.63 seconds
2021-01-29 17:36:27.348590 (Thread-1): finished collecting timing info
2021-01-29 17:36:27.350109 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 17:36:27.777398 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 17:36:28.060126 (Thread-1): 12:36:28 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 3.26s]
2021-01-29 17:36:28.060491 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 17:36:28.062648 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 17:36:28.063271 (MainThread): 12:36:28 | 
2021-01-29 17:36:28.063526 (MainThread): 12:36:28 | Finished running 1 test in 5.00s.
2021-01-29 17:36:28.063729 (MainThread): Connection 'master' was properly closed.
2021-01-29 17:36:28.063882 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 17:36:28.103405 (MainThread): 
2021-01-29 17:36:28.103626 (MainThread): Completed successfully
2021-01-29 17:36:28.103740 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 17:36:28.103927 (MainThread): Flushing usage events
2021-01-29 18:49:11.568969 (MainThread): Running with dbt=0.18.1
2021-01-29 18:49:12.047887 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 18:49:12.048209 (MainThread): Tracking: tracking
2021-01-29 18:49:12.048346 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36d0b72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa373e3a2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36d04a490>]}
2021-01-29 18:49:12.048967 (MainThread): Set downloads directory='/tmp/dbt-downloads-9q6w9s0y'
2021-01-29 18:49:12.058955 (MainThread): Installing ../../
2021-01-29 18:49:12.059220 (MainThread):   Creating symlink to local dependency.
2021-01-29 18:49:12.059337 (MainThread):   Installed from <local @ ../../>

2021-01-29 18:49:12.059476 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '9a7c32d9-a563-4599-ab76-276c927128f7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36d04a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36d04a4f0>]}
2021-01-29 18:49:12.059780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36d0b72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36d04de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36d04d1f0>]}
2021-01-29 18:49:12.059965 (MainThread): Flushing usage events
2021-01-29 18:49:13.700248 (MainThread): Running with dbt=0.18.1
2021-01-29 18:49:14.229735 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 18:49:14.230533 (MainThread): Tracking: tracking
2021-01-29 18:49:14.230846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed72c49370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed79a7a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed72c4d550>]}
2021-01-29 18:49:14.274128 (MainThread): Partial parsing not enabled
2021-01-29 18:49:14.275233 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:49:14.278135 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:49:14.313332 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:49:14.315126 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:49:14.326160 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:49:14.328451 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:49:14.333657 (MainThread): Parsing macros/core.sql
2021-01-29 18:49:14.337688 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:49:14.339520 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:49:14.341149 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:49:14.343165 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:49:14.346054 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:49:14.355230 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:49:14.361629 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:49:14.366652 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:49:14.383392 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:49:14.385178 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:49:14.416072 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:49:14.423265 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:49:14.430239 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:49:14.432163 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:49:14.446691 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:49:14.471354 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:49:14.480739 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:49:14.482684 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:49:14.483737 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:49:14.485951 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:49:14.487152 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:49:14.489071 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:49:14.535913 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:49:14.550901 (MainThread): Partial parsing not enabled
2021-01-29 18:49:14.591803 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:14.613499 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:14.624088 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:14.634340 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:49:14.644640 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:14.654806 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:49:14.665092 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:14.683235 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:14.849104 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 18:49:14.849986 (MainThread): 
2021-01-29 18:49:14.850310 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:49:14.858592 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 18:49:14.872852 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 18:49:14.872993 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 18:49:14.873086 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 18:49:15.981758 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.11 seconds
2021-01-29 18:49:16.016836 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 18:49:16.333973 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:49:16.344701 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:49:16.344878 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:49:16.344994 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 18:49:17.275595 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 0.93 seconds
2021-01-29 18:49:17.660550 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:49:17.954954 (MainThread): Using snowflake connection "master".
2021-01-29 18:49:17.955169 (MainThread): On master: BEGIN
2021-01-29 18:49:17.955301 (MainThread): Opening a new connection, currently in state init
2021-01-29 18:49:18.795137 (MainThread): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-29 18:49:18.795920 (MainThread): On master: COMMIT
2021-01-29 18:49:18.796654 (MainThread): Using snowflake connection "master".
2021-01-29 18:49:18.797141 (MainThread): On master: COMMIT
2021-01-29 18:49:19.139636 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-29 18:49:19.140387 (MainThread): On master: Close
2021-01-29 18:49:19.405699 (MainThread): 13:49:19 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:49:19.406607 (MainThread): 13:49:19 | 
2021-01-29 18:49:19.414744 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:49:19.421239 (Thread-1): 13:49:19 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 18:49:19.422879 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:19.423517 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:49:19.466081 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:49:19.466448 (Thread-1): finished collecting timing info
2021-01-29 18:49:19.516447 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:19.516614 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:49:19.516762 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:20.486650 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-29 18:49:20.519847 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:20.520061 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:49:20.693415 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-29 18:49:20.699765 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:20.699983 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 18:49:20.893330 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 18:49:20.905351 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:20.905510 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 18:49:21.131359 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 18:49:21.176225 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:49:21.177439 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:21.177573 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 18:49:21.358030 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 18:49:21.358705 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:21.359137 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:49:22.637906 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-29 18:49:22.639181 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:49:22.639392 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:22.639530 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:49:22.793983 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-29 18:49:22.837738 (Thread-1): finished collecting timing info
2021-01-29 18:49:22.838130 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 18:49:23.130534 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366e6f2f-919b-4537-8bf1-751765f462df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed70f971c0>]}
2021-01-29 18:49:23.136776 (Thread-1): 13:49:23 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 3.71s]
2021-01-29 18:49:23.137519 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:49:23.138293 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:49:23.144211 (Thread-1): 13:49:23 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 18:49:23.145751 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:23.146300 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:49:23.165108 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:49:23.165780 (Thread-1): finished collecting timing info
2021-01-29 18:49:23.181312 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:23.181490 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 18:49:23.181609 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:24.158763 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-29 18:49:24.172367 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:24.172952 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:49:24.413594 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-29 18:49:24.428365 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:24.428969 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 18:49:24.633101 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-29 18:49:24.650173 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:24.650731 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 18:49:24.961000 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-29 18:49:24.963866 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:49:24.965045 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:24.965193 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 18:49:25.210829 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 18:49:25.211609 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:25.212264 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 18:49:26.190363 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-29 18:49:26.195184 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:49:26.195955 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:26.196458 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:49:26.364979 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:49:26.376059 (Thread-1): finished collecting timing info
2021-01-29 18:49:26.377382 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 18:49:26.657850 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366e6f2f-919b-4537-8bf1-751765f462df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed70f52ac0>]}
2021-01-29 18:49:26.663989 (Thread-1): 13:49:26 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.51s]
2021-01-29 18:49:26.664787 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:49:26.665513 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:49:26.670840 (Thread-1): 13:49:26 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:49:26.673099 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:26.673694 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:49:26.695934 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:49:26.696606 (Thread-1): finished collecting timing info
2021-01-29 18:49:26.712908 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:26.713078 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:49:26.713177 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:28.840653 (Thread-1): SQL status: SUCCESS 1 in 2.13 seconds
2021-01-29 18:49:28.845707 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:28.845928 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:49:29.040912 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 18:49:29.055776 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:29.056342 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 18:49:29.245564 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 18:49:29.262593 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:29.263163 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 18:49:29.493830 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 18:49:29.526764 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:49:29.528495 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:29.528652 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:49:30.009839 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-29 18:49:30.010115 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:30.010263 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 18:49:30.933730 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-29 18:49:30.934558 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:30.935013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:49:31.748916 (Thread-1): SQL status: SUCCESS 2 in 0.81 seconds
2021-01-29 18:49:31.755572 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:49:31.756596 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:31.757202 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:49:32.596111 (Thread-1): SQL status: SUCCESS 1 in 0.84 seconds
2021-01-29 18:49:32.608645 (Thread-1): finished collecting timing info
2021-01-29 18:49:32.610005 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:49:32.876538 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366e6f2f-919b-4537-8bf1-751765f462df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed7071a370>]}
2021-01-29 18:49:32.877931 (Thread-1): 13:49:32 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 6.20s]
2021-01-29 18:49:32.878115 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:49:32.878266 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:49:32.879383 (Thread-1): 13:49:32 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 18:49:32.879722 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:32.879847 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:49:32.888241 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:49:32.888616 (Thread-1): finished collecting timing info
2021-01-29 18:49:32.901186 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:32.901369 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 18:49:32.901482 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:33.839057 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-01-29 18:49:33.851822 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:33.852390 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:49:34.306127 (Thread-1): SQL status: SUCCESS 3 in 0.45 seconds
2021-01-29 18:49:34.312260 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:34.312491 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 18:49:34.554101 (Thread-1): SQL status: SUCCESS 2 in 0.24 seconds
2021-01-29 18:49:34.570375 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:34.570891 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 18:49:34.900453 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-29 18:49:34.906604 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:49:34.910643 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:34.911145 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 18:49:35.844765 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-01-29 18:49:35.845448 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:35.845877 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 18:49:36.866002 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 18:49:36.868329 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:49:36.868728 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:36.868976 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:49:37.043630 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:49:37.056363 (Thread-1): finished collecting timing info
2021-01-29 18:49:37.057781 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 18:49:37.694118 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366e6f2f-919b-4537-8bf1-751765f462df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed706c6940>]}
2021-01-29 18:49:37.700969 (Thread-1): 13:49:37 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.81s]
2021-01-29 18:49:37.701745 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:49:37.702462 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:49:37.708991 (Thread-1): 13:49:37 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 18:49:37.710556 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:37.711110 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:49:37.729021 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:49:37.729628 (Thread-1): finished collecting timing info
2021-01-29 18:49:37.745369 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:37.745528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:49:37.745640 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:38.812563 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-29 18:49:38.816866 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:38.817056 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:49:39.132533 (Thread-1): SQL status: SUCCESS 3 in 0.32 seconds
2021-01-29 18:49:39.149759 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:39.150350 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 18:49:39.390523 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-29 18:49:39.407518 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:39.408087 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 18:49:39.841009 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-29 18:49:39.847354 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:49:39.851704 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:39.852386 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 18:49:40.275683 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-29 18:49:40.276389 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:40.276854 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:49:41.578089 (Thread-1): SQL status: SUCCESS 1 in 1.30 seconds
2021-01-29 18:49:41.582888 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:49:41.583665 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:41.584103 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:49:41.770457 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 18:49:41.782764 (Thread-1): finished collecting timing info
2021-01-29 18:49:41.784059 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 18:49:42.088047 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366e6f2f-919b-4537-8bf1-751765f462df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed706bbe50>]}
2021-01-29 18:49:42.094229 (Thread-1): 13:49:42 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.38s]
2021-01-29 18:49:42.094962 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:49:42.095636 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:49:42.100901 (Thread-1): 13:49:42 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-01-29 18:49:42.103808 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:49:42.104418 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:49:42.123192 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:49:42.123659 (Thread-1): finished collecting timing info
2021-01-29 18:49:42.136510 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:49:42.137375 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:49:42.137476 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-01-29 18:49:42.137567 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:43.316377 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-29 18:49:43.316583 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:49:43.316699 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:49:44.492564 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-01-29 18:49:44.498169 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:49:44.499133 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:49:44.499897 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:49:44.957448 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-29 18:49:44.968570 (Thread-1): finished collecting timing info
2021-01-29 18:49:44.970009 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-01-29 18:49:45.272003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366e6f2f-919b-4537-8bf1-751765f462df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed70f978e0>]}
2021-01-29 18:49:45.278159 (Thread-1): 13:49:45 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 3.17s]
2021-01-29 18:49:45.278916 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:49:45.279602 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:49:45.284859 (Thread-1): 13:49:45 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-01-29 18:49:45.287016 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:49:45.287596 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:49:45.310419 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:49:45.310916 (Thread-1): finished collecting timing info
2021-01-29 18:49:45.323430 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-01-29 18:49:45.327930 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:49:45.328067 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-01-29 18:49:45.328180 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:46.597014 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-01-29 18:49:46.603757 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:49:46.607669 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:49:46.608166 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-01-29 18:49:47.112595 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-29 18:49:47.113290 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:49:47.113725 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:49:48.130782 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 18:49:48.135774 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:49:48.136566 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:49:48.137174 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:49:48.363311 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-01-29 18:49:48.375065 (Thread-1): finished collecting timing info
2021-01-29 18:49:48.376380 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-01-29 18:49:48.640413 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '366e6f2f-919b-4537-8bf1-751765f462df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed706cd6d0>]}
2021-01-29 18:49:48.646623 (Thread-1): 13:49:48 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.35s]
2021-01-29 18:49:48.647496 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:49:48.651077 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:49:48.651645 (MainThread): Using snowflake connection "master".
2021-01-29 18:49:48.651894 (MainThread): On master: BEGIN
2021-01-29 18:49:48.652142 (MainThread): Opening a new connection, currently in state closed
2021-01-29 18:49:49.723748 (MainThread): SQL status: SUCCESS 1 in 1.07 seconds
2021-01-29 18:49:49.723975 (MainThread): On master: COMMIT
2021-01-29 18:49:49.724213 (MainThread): Using snowflake connection "master".
2021-01-29 18:49:49.724314 (MainThread): On master: COMMIT
2021-01-29 18:49:50.020401 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-29 18:49:50.021211 (MainThread): On master: Close
2021-01-29 18:49:50.295487 (MainThread): 13:49:50 | 
2021-01-29 18:49:50.295731 (MainThread): 13:49:50 | Finished running 7 snowflake_timetravel_table models in 35.45s.
2021-01-29 18:49:50.295936 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:49:50.296059 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-01-29 18:49:50.323914 (MainThread): 
2021-01-29 18:49:50.324238 (MainThread): Completed successfully
2021-01-29 18:49:50.324411 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-29 18:49:50.324686 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed706cd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed706cd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed706cd070>]}
2021-01-29 18:49:50.324989 (MainThread): Flushing usage events
2021-01-29 18:49:52.216170 (MainThread): Running with dbt=0.18.1
2021-01-29 18:49:52.690995 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 18:49:52.691755 (MainThread): Tracking: do not track
2021-01-29 18:49:52.727269 (MainThread): Partial parsing not enabled
2021-01-29 18:49:52.728457 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:49:52.731338 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:49:52.765986 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:49:52.767667 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:49:52.778644 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:49:52.780887 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:49:52.786056 (MainThread): Parsing macros/core.sql
2021-01-29 18:49:52.789928 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:49:52.791722 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:49:52.793277 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:49:52.795196 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:49:52.798005 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:49:52.807023 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:49:52.813352 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:49:52.818311 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:49:52.834940 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:49:52.836697 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:49:52.866396 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:49:52.873138 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:49:52.879278 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:49:52.881236 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:49:52.895568 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:49:52.916867 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:49:52.926032 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:49:52.927671 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:49:52.928695 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:49:52.930653 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:49:52.931671 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:49:52.933344 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:49:52.979707 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:49:52.995067 (MainThread): Partial parsing not enabled
2021-01-29 18:49:53.035235 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:53.057437 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:49:53.067915 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:49:53.078246 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:49:53.088605 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:49:53.098902 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:49:53.109570 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:49:53.127898 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:53.295438 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 18:49:53.296183 (MainThread): 
2021-01-29 18:49:53.296466 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:49:53.305710 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:49:53.319873 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:49:53.320003 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:49:53.320092 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 18:49:54.384467 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.06 seconds
2021-01-29 18:49:54.750331 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:49:55.053707 (MainThread): 13:49:55 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:49:55.053978 (MainThread): 13:49:55 | 
2021-01-29 18:49:55.056361 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:49:55.056582 (Thread-1): 13:49:55 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:49:55.056969 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:55.057094 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:49:55.077639 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:49:55.078029 (Thread-1): finished collecting timing info
2021-01-29 18:49:55.078845 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:55.078935 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:49:55.079024 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:49:56.121120 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-29 18:49:56.121816 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:49:56.122246 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T18:49:26.697158Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 18:49:56.633418 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-29 18:49:56.635317 (Thread-1): finished collecting timing info
2021-01-29 18:49:56.641920 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 18:49:57.163691 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:49:57.437086 (Thread-1): 13:49:57 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 2.38s]
2021-01-29 18:49:57.437903 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:49:57.443365 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:49:57.444889 (MainThread): 13:49:57 | 
2021-01-29 18:49:57.445510 (MainThread): 13:49:57 | Finished running 1 test in 4.15s.
2021-01-29 18:49:57.445985 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:49:57.446350 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 18:49:57.462977 (MainThread): 
2021-01-29 18:49:57.463368 (MainThread): Completed successfully
2021-01-29 18:49:57.463677 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 18:49:57.464173 (MainThread): Flushing usage events
2021-01-29 18:50:44.887483 (MainThread): Running with dbt=0.19.0
2021-01-29 18:50:45.367796 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 18:50:45.368099 (MainThread): Tracking: tracking
2021-01-29 18:50:45.368235 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e21cef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a00eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e21cf8a60>]}
2021-01-29 18:50:45.368858 (MainThread): Set downloads directory='/tmp/dbt-downloads-mg4cd2t0'
2021-01-29 18:50:45.379081 (MainThread): Installing ../../
2021-01-29 18:50:45.379348 (MainThread):   Creating symlink to local dependency.
2021-01-29 18:50:45.379465 (MainThread):   Installed from <local @ ../../>

2021-01-29 18:50:45.379609 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '64deae66-e3ca-4670-9b41-a8d59a6c898e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e21cf8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e21cf8e20>]}
2021-01-29 18:50:45.379924 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e21cef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a00eeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e21c8bd00>]}
2021-01-29 18:50:45.380076 (MainThread): Flushing usage events
2021-01-29 18:50:47.042280 (MainThread): Running with dbt=0.19.0
2021-01-29 18:50:47.541240 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 18:50:47.542001 (MainThread): Tracking: tracking
2021-01-29 18:50:47.542321 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb3d3b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb9a67580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb3ccb700>]}
2021-01-29 18:50:47.579160 (MainThread): Partial parsing not enabled
2021-01-29 18:50:47.580325 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:50:47.583388 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:50:47.618451 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:50:47.620194 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:50:47.630004 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:50:47.632089 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:50:47.637126 (MainThread): Parsing macros/core.sql
2021-01-29 18:50:47.641307 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:50:47.643023 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:50:47.644528 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:50:47.646388 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:50:47.649226 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:50:47.658135 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:50:47.664434 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:50:47.669769 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:50:47.688076 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:50:47.690162 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:50:47.725169 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:50:47.732274 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:50:47.738935 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:50:47.740921 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:50:47.755728 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:50:47.778517 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:50:47.787523 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:50:47.789196 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:50:47.790272 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:50:47.792214 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:50:47.793289 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:50:47.794959 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:50:47.839554 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:50:47.854235 (MainThread): Partial parsing not enabled
2021-01-29 18:50:47.891424 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:50:47.911334 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:50:47.921387 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:47.931806 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:50:47.942197 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:47.952564 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:50:47.962902 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:50:47.982369 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:50:48.119173 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb2a06070>]}
2021-01-29 18:50:48.158638 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 18:50:48.159501 (MainThread): 
2021-01-29 18:50:48.159861 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:50:48.168219 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 18:50:48.183665 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 18:50:48.183813 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 18:50:48.183903 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 18:50:49.181818 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.00 seconds
2021-01-29 18:50:49.213535 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 18:50:49.481711 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:50:49.491432 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:50:49.491591 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:50:49.491715 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 18:50:50.503001 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 1.01 seconds
2021-01-29 18:50:50.857507 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:50:51.182608 (MainThread): Using snowflake connection "master".
2021-01-29 18:50:51.182841 (MainThread): On master: BEGIN
2021-01-29 18:50:51.182996 (MainThread): Opening a new connection, currently in state init
2021-01-29 18:50:52.213884 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 18:50:52.214637 (MainThread): On master: COMMIT
2021-01-29 18:50:52.215395 (MainThread): Using snowflake connection "master".
2021-01-29 18:50:52.215827 (MainThread): On master: COMMIT
2021-01-29 18:50:52.626512 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-01-29 18:50:52.626733 (MainThread): On master: Close
2021-01-29 18:50:52.874428 (MainThread): 13:50:52 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:50:52.875473 (MainThread): 13:50:52 | 
2021-01-29 18:50:52.882173 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:50:52.888488 (Thread-1): 13:50:52 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 18:50:52.890178 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:52.890870 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:50:52.937141 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:50:52.937575 (Thread-1): finished collecting timing info
2021-01-29 18:50:52.985521 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:52.985716 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:50:52.985815 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:50:54.078311 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-01-29 18:50:54.092293 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:54.092460 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:50:54.489008 (Thread-1): SQL status: SUCCESS 3 in 0.40 seconds
2021-01-29 18:50:54.500039 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:54.500418 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 18:50:54.700070 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 18:50:54.737617 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:54.737808 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 18:50:55.205659 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-29 18:50:55.247675 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:50:55.248886 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:55.249025 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 18:50:55.450506 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 18:50:55.451181 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:55.451605 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:50:56.567417 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-29 18:50:56.572311 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:50:56.573146 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:50:56.573597 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:50:56.732290 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 18:50:56.765534 (Thread-1): finished collecting timing info
2021-01-29 18:50:56.765937 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 18:50:57.054991 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb29fa8b0>]}
2021-01-29 18:50:57.061724 (Thread-1): 13:50:57 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.16s]
2021-01-29 18:50:57.062595 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:50:57.063380 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:50:57.070646 (Thread-1): 13:50:57 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 18:50:57.072543 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:57.073368 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:50:57.093231 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:50:57.093653 (Thread-1): finished collecting timing info
2021-01-29 18:50:57.108178 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:57.108352 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 18:50:57.108449 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:50:58.094958 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-29 18:50:58.097558 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:58.097673 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:50:58.264209 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-29 18:50:58.288901 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:58.289257 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 18:50:58.791849 (Thread-1): SQL status: SUCCESS 4 in 0.50 seconds
2021-01-29 18:50:58.810681 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:58.811245 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 18:50:59.305585 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-29 18:50:59.312252 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:50:59.316809 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:59.317352 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 18:50:59.503861 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 18:50:59.504552 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:50:59.505069 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 18:51:00.536013 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 18:51:00.537920 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:51:00.538250 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:51:00.538420 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:51:00.706532 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:51:00.710065 (Thread-1): finished collecting timing info
2021-01-29 18:51:00.710436 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 18:51:00.977669 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb0f70910>]}
2021-01-29 18:51:00.983851 (Thread-1): 13:51:00 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.90s]
2021-01-29 18:51:00.984617 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:51:00.985532 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:51:00.991597 (Thread-1): 13:51:00 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:51:00.993212 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:00.993766 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:51:01.013821 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:51:01.014512 (Thread-1): finished collecting timing info
2021-01-29 18:51:01.029924 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:01.030084 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:51:01.030187 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:51:02.276068 (Thread-1): SQL status: SUCCESS 1 in 1.25 seconds
2021-01-29 18:51:02.288965 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:02.289534 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:51:02.517746 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-01-29 18:51:02.529453 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:02.529835 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 18:51:02.733665 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 18:51:02.741551 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:02.741730 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 18:51:02.985544 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 18:51:02.993807 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:51:02.995055 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:02.995181 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:51:03.184371 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 18:51:03.185086 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:03.185521 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 18:51:03.740503 (Thread-1): SQL status: SUCCESS 1 in 0.55 seconds
2021-01-29 18:51:03.741104 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:03.741345 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:51:04.335820 (Thread-1): SQL status: SUCCESS 2 in 0.59 seconds
2021-01-29 18:51:04.340601 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:51:04.341445 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:04.341918 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:51:04.934130 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-01-29 18:51:04.946089 (Thread-1): finished collecting timing info
2021-01-29 18:51:04.947379 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:51:05.225627 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb0725370>]}
2021-01-29 18:51:05.231875 (Thread-1): 13:51:05 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.23s]
2021-01-29 18:51:05.232705 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:51:05.233517 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:51:05.239925 (Thread-1): 13:51:05 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 18:51:05.241641 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:05.242189 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:51:05.257393 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:51:05.257837 (Thread-1): finished collecting timing info
2021-01-29 18:51:05.273228 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:05.273385 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 18:51:05.273496 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:51:06.221466 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 18:51:06.226455 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:06.226665 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:51:06.774474 (Thread-1): SQL status: SUCCESS 3 in 0.55 seconds
2021-01-29 18:51:06.780564 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:06.780727 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 18:51:07.288841 (Thread-1): SQL status: SUCCESS 2 in 0.51 seconds
2021-01-29 18:51:07.312803 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:07.313350 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 18:51:07.549668 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 18:51:07.555889 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:51:07.559897 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:07.560410 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 18:51:08.005274 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-29 18:51:08.005564 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:08.005749 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 18:51:10.052985 (Thread-1): SQL status: SUCCESS 1 in 2.05 seconds
2021-01-29 18:51:10.057866 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:51:10.058657 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:10.059097 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:51:10.236965 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 18:51:10.249086 (Thread-1): finished collecting timing info
2021-01-29 18:51:10.250370 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 18:51:10.539296 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb06c62e0>]}
2021-01-29 18:51:10.545573 (Thread-1): 13:51:10 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 5.30s]
2021-01-29 18:51:10.546395 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:51:10.547188 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:51:10.553594 (Thread-1): 13:51:10 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 18:51:10.555198 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:10.555753 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:51:10.572797 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:51:10.573307 (Thread-1): finished collecting timing info
2021-01-29 18:51:10.588692 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:10.588863 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:51:10.588977 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:51:11.899839 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-01-29 18:51:11.912679 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:11.913331 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:51:12.408805 (Thread-1): SQL status: SUCCESS 3 in 0.49 seconds
2021-01-29 18:51:12.425379 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:12.425924 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 18:51:12.729859 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-29 18:51:12.744639 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:12.745066 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 18:51:13.235217 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-29 18:51:13.242838 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:51:13.247227 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:13.247734 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 18:51:13.470607 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-29 18:51:13.471294 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:13.471730 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:51:14.875975 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-01-29 18:51:14.880827 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:51:14.881644 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:14.882086 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:51:15.178202 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-29 18:51:15.182947 (Thread-1): finished collecting timing info
2021-01-29 18:51:15.183461 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 18:51:15.471557 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb29e5160>]}
2021-01-29 18:51:15.478512 (Thread-1): 13:51:15 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.92s]
2021-01-29 18:51:15.479489 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:51:15.480261 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:51:15.485636 (Thread-1): 13:51:15 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-01-29 18:51:15.487844 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:51:15.488403 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:51:15.505004 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:51:15.505520 (Thread-1): finished collecting timing info
2021-01-29 18:51:15.518704 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:51:15.520367 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:51:15.520578 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-01-29 18:51:15.520778 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:51:16.606603 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-01-29 18:51:16.607324 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:51:16.607767 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:51:17.944374 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-01-29 18:51:17.949396 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:51:17.950199 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:51:17.950650 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:51:18.113215 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 18:51:18.125045 (Thread-1): finished collecting timing info
2021-01-29 18:51:18.126308 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-01-29 18:51:18.396516 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb0f65340>]}
2021-01-29 18:51:18.402998 (Thread-1): 13:51:18 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 2.91s]
2021-01-29 18:51:18.403746 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:51:18.404445 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:51:18.410065 (Thread-1): 13:51:18 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-01-29 18:51:18.412294 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:51:18.412913 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:51:18.430757 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:51:18.431269 (Thread-1): finished collecting timing info
2021-01-29 18:51:18.442966 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-01-29 18:51:18.447472 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:51:18.447599 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-01-29 18:51:18.447695 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:51:19.782712 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-01-29 18:51:19.789902 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:51:19.794743 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:51:19.795277 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-01-29 18:51:19.996795 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 18:51:19.997453 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:51:19.997915 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:51:21.317369 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-01-29 18:51:21.322186 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:51:21.322985 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:51:21.323432 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:51:21.487276 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 18:51:21.499010 (Thread-1): finished collecting timing info
2021-01-29 18:51:21.500283 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-01-29 18:51:21.804437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5917647-4b17-4702-9b7b-b6d578721cd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb06bc310>]}
2021-01-29 18:51:21.810614 (Thread-1): 13:51:21 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.39s]
2021-01-29 18:51:21.811389 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:51:21.816650 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:51:21.817543 (MainThread): Using snowflake connection "master".
2021-01-29 18:51:21.817801 (MainThread): On master: BEGIN
2021-01-29 18:51:21.818051 (MainThread): Opening a new connection, currently in state closed
2021-01-29 18:51:22.741322 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-29 18:51:22.741580 (MainThread): On master: COMMIT
2021-01-29 18:51:22.741799 (MainThread): Using snowflake connection "master".
2021-01-29 18:51:22.741921 (MainThread): On master: COMMIT
2021-01-29 18:51:23.165499 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-01-29 18:51:23.166263 (MainThread): On master: Close
2021-01-29 18:51:23.449663 (MainThread): 13:51:23 | 
2021-01-29 18:51:23.450477 (MainThread): 13:51:23 | Finished running 7 snowflake_timetravel_table models in 35.29s.
2021-01-29 18:51:23.451016 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:51:23.451404 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-01-29 18:51:23.524504 (MainThread): 
2021-01-29 18:51:23.524672 (MainThread): Completed successfully
2021-01-29 18:51:23.524815 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-29 18:51:23.525014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb2b03ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb070e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eb06ee820>]}
2021-01-29 18:51:23.525214 (MainThread): Flushing usage events
2021-01-29 18:51:25.411211 (MainThread): Running with dbt=0.19.0
2021-01-29 18:51:25.940741 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 18:51:25.941696 (MainThread): Tracking: do not track
2021-01-29 18:51:26.004508 (MainThread): Partial parsing not enabled
2021-01-29 18:51:26.006276 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:51:26.010787 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:51:26.043344 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:51:26.044952 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:51:26.054502 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:51:26.056468 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:51:26.061218 (MainThread): Parsing macros/core.sql
2021-01-29 18:51:26.065092 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:51:26.066802 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:51:26.068324 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:51:26.070223 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:51:26.073039 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:51:26.082100 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:51:26.089285 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:51:26.094608 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:51:26.112719 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:51:26.114503 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:51:26.148030 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:51:26.155149 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:51:26.161392 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:51:26.163246 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:51:26.177477 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:51:26.199841 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:51:26.209245 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:51:26.210891 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:51:26.211812 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:51:26.213779 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:51:26.214802 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:51:26.216464 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:51:26.263971 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:51:26.278902 (MainThread): Partial parsing not enabled
2021-01-29 18:51:26.317721 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:26.338336 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:51:26.350554 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:51:26.361732 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:51:26.372660 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:51:26.383405 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:51:26.394127 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:51:26.414403 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:26.585808 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 18:51:26.586626 (MainThread): 
2021-01-29 18:51:26.586911 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:51:26.596555 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:51:26.611276 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:51:26.611419 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:51:26.611531 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 18:51:27.674457 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.06 seconds
2021-01-29 18:51:28.029413 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:51:29.147492 (MainThread): 13:51:29 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:51:29.147757 (MainThread): 13:51:29 | 
2021-01-29 18:51:29.149570 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:51:29.149805 (Thread-1): 13:51:29 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:51:29.150231 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:29.150402 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:51:29.172532 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:51:29.172895 (Thread-1): finished collecting timing info
2021-01-29 18:51:29.173709 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:29.173802 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:51:29.173898 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:51:30.149533 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-01-29 18:51:30.150254 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:51:30.150693 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T18:51:01.014944Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 18:51:30.415647 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-01-29 18:51:30.417576 (Thread-1): finished collecting timing info
2021-01-29 18:51:30.419202 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 18:51:31.104645 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:51:31.562098 (Thread-1): 13:51:31 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 2.41s]
2021-01-29 18:51:31.563025 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:51:31.568409 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:51:31.569974 (MainThread): 13:51:31 | 
2021-01-29 18:51:31.570611 (MainThread): 13:51:31 | Finished running 1 test in 4.98s.
2021-01-29 18:51:31.571112 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:51:31.571489 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 18:51:31.640139 (MainThread): 
2021-01-29 18:51:31.640370 (MainThread): Completed successfully
2021-01-29 18:51:31.640556 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 18:51:31.641422 (MainThread): Flushing usage events
2021-01-29 18:53:37.995274 (MainThread): Running with dbt=0.18.1
2021-01-29 18:53:38.470531 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 18:53:38.470812 (MainThread): Tracking: tracking
2021-01-29 18:53:38.470943 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81e16efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe824f443a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81e1063a0>]}
2021-01-29 18:53:38.471518 (MainThread): Set downloads directory='/tmp/dbt-downloads-208g4uub'
2021-01-29 18:53:38.481781 (MainThread): Installing ../../
2021-01-29 18:53:38.482081 (MainThread):   Creating symlink to local dependency.
2021-01-29 18:53:38.482202 (MainThread):   Installed from <local @ ../../>

2021-01-29 18:53:38.482348 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc5c5987-2d9d-4708-ad5b-fa3149aa11f8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81e177fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81e1069a0>]}
2021-01-29 18:53:38.482678 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81e16efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81e177b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe81e10d070>]}
2021-01-29 18:53:38.482842 (MainThread): Flushing usage events
2021-01-29 18:53:40.118666 (MainThread): Running with dbt=0.18.1
2021-01-29 18:53:40.593426 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 18:53:40.594204 (MainThread): Tracking: tracking
2021-01-29 18:53:40.594513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2616f88370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f261dd933a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2616f8d5b0>]}
2021-01-29 18:53:40.630033 (MainThread): Partial parsing not enabled
2021-01-29 18:53:40.631214 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:53:40.634088 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:53:40.670385 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:53:40.672178 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:53:40.683969 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:53:40.686358 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:53:40.691809 (MainThread): Parsing macros/core.sql
2021-01-29 18:53:40.695883 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:53:40.697801 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:53:40.699501 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:53:40.701587 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:53:40.705882 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:53:40.716535 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:53:40.723649 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:53:40.729182 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:53:40.746673 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:53:40.748463 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:53:40.778893 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:53:40.785829 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:53:40.791861 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:53:40.794834 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:53:40.809289 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:53:40.830478 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:53:40.839246 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:53:40.840864 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:53:40.841787 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:53:40.843885 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:53:40.844939 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:53:40.846595 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:53:40.890828 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:53:40.906834 (MainThread): Partial parsing not enabled
2021-01-29 18:53:40.944943 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:40.966662 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:53:40.976873 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:40.986976 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:53:40.997208 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:41.007283 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:53:41.017391 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:53:41.036328 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:41.200406 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 18:53:41.201280 (MainThread): 
2021-01-29 18:53:41.201618 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:53:41.210433 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 18:53:41.225385 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 18:53:41.225534 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 18:53:41.225624 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 18:53:42.273732 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.05 seconds
2021-01-29 18:53:42.307680 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 18:53:42.616974 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:53:42.627056 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:53:42.627212 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:53:42.627325 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 18:53:43.761237 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 1.13 seconds
2021-01-29 18:53:44.120700 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:53:44.406180 (MainThread): Using snowflake connection "master".
2021-01-29 18:53:44.406368 (MainThread): On master: BEGIN
2021-01-29 18:53:44.406488 (MainThread): Opening a new connection, currently in state init
2021-01-29 18:53:45.233320 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-29 18:53:45.233677 (MainThread): On master: COMMIT
2021-01-29 18:53:45.234039 (MainThread): Using snowflake connection "master".
2021-01-29 18:53:45.234252 (MainThread): On master: COMMIT
2021-01-29 18:53:45.601721 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-29 18:53:45.602473 (MainThread): On master: Close
2021-01-29 18:53:45.896601 (MainThread): 13:53:45 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:53:45.897511 (MainThread): 13:53:45 | 
2021-01-29 18:53:45.909070 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:53:45.917086 (Thread-1): 13:53:45 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 18:53:45.918825 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:45.919456 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:53:45.961609 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:53:45.961987 (Thread-1): finished collecting timing info
2021-01-29 18:53:46.009623 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:46.009781 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:53:46.009878 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:53:47.141427 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-01-29 18:53:47.181436 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:47.181686 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:53:47.348089 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-29 18:53:47.367409 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:47.368010 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 18:53:47.576199 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-29 18:53:47.612433 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:47.612619 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 18:53:48.055371 (Thread-1): SQL status: SUCCESS 1 in 0.44 seconds
2021-01-29 18:53:48.073741 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:53:48.074993 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:48.075135 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 18:53:48.252522 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 18:53:48.253219 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:48.253642 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:53:49.228306 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-29 18:53:49.233502 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:53:49.234320 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:53:49.234759 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:53:49.404413 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:53:49.448538 (Thread-1): finished collecting timing info
2021-01-29 18:53:49.448973 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 18:53:49.721809 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e3db4a-9c1f-4878-805c-85678298096b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26152d9ac0>]}
2021-01-29 18:53:49.730918 (Thread-1): 13:53:49 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 3.80s]
2021-01-29 18:53:49.732250 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:53:49.733708 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:53:49.741287 (Thread-1): 13:53:49 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 18:53:49.742858 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:49.743445 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:53:49.759520 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:53:49.760033 (Thread-1): finished collecting timing info
2021-01-29 18:53:49.775197 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:49.775348 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 18:53:49.775448 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:53:50.733799 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-01-29 18:53:50.750741 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:50.751384 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:53:50.949049 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 18:53:50.963965 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:50.964538 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 18:53:51.437606 (Thread-1): SQL status: SUCCESS 4 in 0.47 seconds
2021-01-29 18:53:51.454744 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:51.455308 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 18:53:51.783677 (Thread-1): SQL status: SUCCESS 1 in 0.33 seconds
2021-01-29 18:53:51.789846 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:53:51.794112 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:51.794646 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 18:53:52.257185 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-29 18:53:52.257842 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:52.258268 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 18:53:53.431968 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-29 18:53:53.438224 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:53:53.439152 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:53:53.439700 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:53:53.613287 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:53:53.624419 (Thread-1): finished collecting timing info
2021-01-29 18:53:53.625972 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 18:53:53.884251 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e3db4a-9c1f-4878-805c-85678298096b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26152ac760>]}
2021-01-29 18:53:53.890462 (Thread-1): 13:53:53 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.14s]
2021-01-29 18:53:53.891263 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:53:53.891878 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:53:53.894828 (Thread-1): 13:53:53 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:53:53.896088 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:53.896416 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:53:53.908503 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:53:53.908948 (Thread-1): finished collecting timing info
2021-01-29 18:53:53.924128 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:53.924321 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:53:53.924459 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:53:54.927458 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-29 18:53:54.939954 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:54.940532 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:53:55.432473 (Thread-1): SQL status: SUCCESS 3 in 0.49 seconds
2021-01-29 18:53:55.439132 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:55.439317 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 18:53:55.945024 (Thread-1): SQL status: SUCCESS 3 in 0.51 seconds
2021-01-29 18:53:55.968820 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:55.969806 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 18:53:56.456435 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-29 18:53:56.487375 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:53:56.488589 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:56.488700 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:53:56.680154 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 18:53:56.680840 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:56.681280 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 18:53:57.987182 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-01-29 18:53:57.987371 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:57.987454 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:53:58.910595 (Thread-1): SQL status: SUCCESS 2 in 0.92 seconds
2021-01-29 18:53:58.912470 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:53:58.912784 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:53:58.912923 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:53:59.533104 (Thread-1): SQL status: SUCCESS 1 in 0.62 seconds
2021-01-29 18:53:59.544203 (Thread-1): finished collecting timing info
2021-01-29 18:53:59.545552 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:53:59.813114 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e3db4a-9c1f-4878-805c-85678298096b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26152d9d00>]}
2021-01-29 18:53:59.819551 (Thread-1): 13:53:59 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.92s]
2021-01-29 18:53:59.820441 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:53:59.821234 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:53:59.826541 (Thread-1): 13:53:59 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 18:53:59.828799 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:53:59.829375 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:53:59.849365 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:53:59.850086 (Thread-1): finished collecting timing info
2021-01-29 18:53:59.865076 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:53:59.865242 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 18:53:59.865339 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:54:01.065464 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-01-29 18:54:01.079551 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:54:01.080128 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:54:01.255911 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-01-29 18:54:01.271962 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:54:01.272519 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 18:54:01.576546 (Thread-1): SQL status: SUCCESS 2 in 0.30 seconds
2021-01-29 18:54:01.592985 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:54:01.593531 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 18:54:02.089104 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-29 18:54:02.095653 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:54:02.100100 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:54:02.100623 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 18:54:02.297210 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 18:54:02.298005 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:54:02.298531 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 18:54:04.033130 (Thread-1): SQL status: SUCCESS 1 in 1.73 seconds
2021-01-29 18:54:04.037867 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:54:04.038669 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:54:04.039148 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:54:04.203093 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 18:54:04.214566 (Thread-1): finished collecting timing info
2021-01-29 18:54:04.215876 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 18:54:04.512251 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e3db4a-9c1f-4878-805c-85678298096b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2614274fa0>]}
2021-01-29 18:54:04.519871 (Thread-1): 13:54:04 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.68s]
2021-01-29 18:54:04.520621 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:54:04.521418 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:54:04.527906 (Thread-1): 13:54:04 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 18:54:04.529412 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:04.529734 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:54:04.545156 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:54:04.545577 (Thread-1): finished collecting timing info
2021-01-29 18:54:04.560095 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:04.560250 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:54:04.560351 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:54:05.684504 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-29 18:54:05.702553 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:05.703166 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:54:05.890591 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 18:54:05.907086 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:05.907676 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 18:54:06.388587 (Thread-1): SQL status: SUCCESS 3 in 0.48 seconds
2021-01-29 18:54:06.405227 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:06.405785 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 18:54:06.900433 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-29 18:54:06.906503 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:54:06.910804 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:06.911301 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 18:54:07.412765 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-29 18:54:07.413415 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:07.413845 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:54:08.649398 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-01-29 18:54:08.654407 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:54:08.655270 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:08.655710 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:54:08.824343 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:54:08.840223 (Thread-1): finished collecting timing info
2021-01-29 18:54:08.841617 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 18:54:09.262407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e3db4a-9c1f-4878-805c-85678298096b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26152f4130>]}
2021-01-29 18:54:09.268545 (Thread-1): 13:54:09 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.73s]
2021-01-29 18:54:09.269359 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:54:09.270041 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:54:09.275384 (Thread-1): 13:54:09 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-01-29 18:54:09.277575 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:54:09.278142 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:54:09.296531 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:54:09.297054 (Thread-1): finished collecting timing info
2021-01-29 18:54:09.308875 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:54:09.309797 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:54:09.309902 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-01-29 18:54:09.309993 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:54:10.278924 (Thread-1): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-29 18:54:10.279722 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:54:10.280253 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:54:11.405013 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-29 18:54:11.409942 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:54:11.410774 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:54:11.411212 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:54:11.568815 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 18:54:11.581519 (Thread-1): finished collecting timing info
2021-01-29 18:54:11.582819 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-01-29 18:54:11.842706 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e3db4a-9c1f-4878-805c-85678298096b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26142023d0>]}
2021-01-29 18:54:11.849360 (Thread-1): 13:54:11 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 2.56s]
2021-01-29 18:54:11.850203 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:54:11.850932 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:54:11.856144 (Thread-1): 13:54:11 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-01-29 18:54:11.857043 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:54:11.857351 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:54:11.871106 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:54:11.871556 (Thread-1): finished collecting timing info
2021-01-29 18:54:11.883515 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-01-29 18:54:11.888234 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:54:11.888378 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-01-29 18:54:11.888472 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:54:12.947423 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-29 18:54:12.953732 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:54:12.958858 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:54:12.959407 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-01-29 18:54:13.147524 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 18:54:13.148186 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:54:13.148611 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:54:14.260721 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-01-29 18:54:14.265542 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:54:14.266342 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:54:14.266821 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:54:14.437390 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:54:14.448784 (Thread-1): finished collecting timing info
2021-01-29 18:54:14.450122 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-01-29 18:54:14.734868 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e3db4a-9c1f-4878-805c-85678298096b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2614276b20>]}
2021-01-29 18:54:14.741137 (Thread-1): 13:54:14 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 2.88s]
2021-01-29 18:54:14.741870 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:54:14.747121 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:54:14.748189 (MainThread): Using snowflake connection "master".
2021-01-29 18:54:14.748646 (MainThread): On master: BEGIN
2021-01-29 18:54:14.749160 (MainThread): Opening a new connection, currently in state closed
2021-01-29 18:54:15.911188 (MainThread): SQL status: SUCCESS 1 in 1.16 seconds
2021-01-29 18:54:15.911919 (MainThread): On master: COMMIT
2021-01-29 18:54:15.912641 (MainThread): Using snowflake connection "master".
2021-01-29 18:54:15.913093 (MainThread): On master: COMMIT
2021-01-29 18:54:16.283859 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-01-29 18:54:16.284583 (MainThread): On master: Close
2021-01-29 18:54:16.551578 (MainThread): 13:54:16 | 
2021-01-29 18:54:16.552385 (MainThread): 13:54:16 | Finished running 7 snowflake_timetravel_table models in 35.35s.
2021-01-29 18:54:16.553129 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:54:16.553560 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-01-29 18:54:16.602202 (MainThread): 
2021-01-29 18:54:16.602389 (MainThread): Completed successfully
2021-01-29 18:54:16.602541 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-29 18:54:16.602778 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26152d5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26152d5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26152d5670>]}
2021-01-29 18:54:16.602998 (MainThread): Flushing usage events
2021-01-29 18:54:18.475786 (MainThread): Running with dbt=0.18.1
2021-01-29 18:54:18.991709 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 18:54:18.992451 (MainThread): Tracking: do not track
2021-01-29 18:54:19.027999 (MainThread): Partial parsing not enabled
2021-01-29 18:54:19.029253 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:54:19.032147 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:54:19.066598 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:54:19.068196 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:54:19.079056 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:54:19.081297 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:54:19.086464 (MainThread): Parsing macros/core.sql
2021-01-29 18:54:19.090425 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:54:19.092293 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:54:19.093935 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:54:19.095925 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:54:19.099942 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:54:19.110149 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:54:19.117020 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:54:19.122188 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:54:19.139126 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:54:19.140919 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:54:19.170826 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:54:19.177811 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:54:19.183862 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:54:19.185699 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:54:19.200536 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:54:19.221915 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:54:19.230702 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:54:19.232744 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:54:19.233759 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:54:19.235723 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:54:19.236752 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:54:19.238414 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:54:19.284560 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:54:19.301521 (MainThread): Partial parsing not enabled
2021-01-29 18:54:19.341893 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:54:19.366921 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:54:19.378170 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:54:19.390264 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:54:19.401162 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:54:19.412705 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:54:19.424297 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:54:19.443963 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:54:19.617799 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 18:54:19.618533 (MainThread): 
2021-01-29 18:54:19.618824 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:54:19.628434 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:54:19.642532 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:54:19.642665 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:54:19.642772 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 18:54:20.707219 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.06 seconds
2021-01-29 18:54:21.055333 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:54:21.353449 (MainThread): 13:54:21 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:54:21.353755 (MainThread): 13:54:21 | 
2021-01-29 18:54:21.356440 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:54:21.356673 (Thread-1): 13:54:21 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:54:21.357084 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:54:21.357257 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:54:21.380253 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:54:21.380704 (Thread-1): finished collecting timing info
2021-01-29 18:54:21.381669 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:54:21.381768 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:54:21.381865 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:54:22.567572 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-01-29 18:54:22.568203 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:54:22.568332 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T18:53:53.909258Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 18:54:22.957476 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-01-29 18:54:22.959152 (Thread-1): finished collecting timing info
2021-01-29 18:54:22.960565 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 18:54:23.284025 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:54:24.107566 (Thread-1): 13:54:24 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 2.75s]
2021-01-29 18:54:24.108381 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:54:24.114110 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:54:24.115590 (MainThread): 13:54:24 | 
2021-01-29 18:54:24.116209 (MainThread): 13:54:24 | Finished running 1 test in 4.50s.
2021-01-29 18:54:24.116712 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:54:24.117164 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 18:54:24.135906 (MainThread): 
2021-01-29 18:54:24.136406 (MainThread): Completed successfully
2021-01-29 18:54:24.136718 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 18:54:24.137336 (MainThread): Flushing usage events
2021-01-29 18:55:12.366804 (MainThread): Running with dbt=0.19.0
2021-01-29 18:55:12.841039 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 18:55:12.841346 (MainThread): Tracking: tracking
2021-01-29 18:55:12.841499 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37039520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e3f35df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37048a90>]}
2021-01-29 18:55:12.842107 (MainThread): Set downloads directory='/tmp/dbt-downloads-3pgortvs'
2021-01-29 18:55:12.852670 (MainThread): Installing ../../
2021-01-29 18:55:12.852978 (MainThread):   Creating symlink to local dependency.
2021-01-29 18:55:12.853105 (MainThread):   Installed from <local @ ../../>

2021-01-29 18:55:12.853251 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '415b1cf7-526a-421c-abf9-0eeb08c146ef', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37048d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37048e80>]}
2021-01-29 18:55:12.853565 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e37039520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e35fcf490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e35fcf670>]}
2021-01-29 18:55:12.853722 (MainThread): Flushing usage events
2021-01-29 18:55:14.497952 (MainThread): Running with dbt=0.19.0
2021-01-29 18:55:14.980894 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 18:55:14.981681 (MainThread): Tracking: tracking
2021-01-29 18:55:14.982009 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b3fd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f064212f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b389760>]}
2021-01-29 18:55:15.020627 (MainThread): Partial parsing not enabled
2021-01-29 18:55:15.021741 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:55:15.024800 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:55:15.059944 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:55:15.061673 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:55:15.071653 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:55:15.073777 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:55:15.078851 (MainThread): Parsing macros/core.sql
2021-01-29 18:55:15.083231 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:55:15.085137 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:55:15.086779 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:55:15.088873 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:55:15.091878 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:55:15.100934 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:55:15.107319 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:55:15.112256 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:55:15.130618 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:55:15.132384 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:55:15.170592 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:55:15.183224 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:55:15.190170 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:55:15.192181 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:55:15.207680 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:55:15.229559 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:55:15.238416 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:55:15.240005 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:55:15.241000 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:55:15.242915 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:55:15.243926 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:55:15.245728 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:55:15.291465 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:55:15.306841 (MainThread): Partial parsing not enabled
2021-01-29 18:55:15.345842 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:15.366296 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:15.376019 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:15.386477 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:55:15.396677 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:15.406867 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:55:15.417626 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:15.436584 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:15.592237 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b17cd00>]}
2021-01-29 18:55:15.628354 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 18:55:15.629196 (MainThread): 
2021-01-29 18:55:15.629547 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:55:15.637700 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 18:55:15.652926 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 18:55:15.653074 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 18:55:15.653166 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 18:55:16.823654 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.17 seconds
2021-01-29 18:55:16.853926 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 18:55:17.163113 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:55:17.172594 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:55:17.172757 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:55:17.172860 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 18:55:18.585774 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 1.41 seconds
2021-01-29 18:55:18.956919 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:55:19.253514 (MainThread): Using snowflake connection "master".
2021-01-29 18:55:19.253746 (MainThread): On master: BEGIN
2021-01-29 18:55:19.253896 (MainThread): Opening a new connection, currently in state init
2021-01-29 18:55:20.221484 (MainThread): SQL status: SUCCESS 1 in 0.97 seconds
2021-01-29 18:55:20.222237 (MainThread): On master: COMMIT
2021-01-29 18:55:20.222972 (MainThread): Using snowflake connection "master".
2021-01-29 18:55:20.223391 (MainThread): On master: COMMIT
2021-01-29 18:55:20.729349 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-29 18:55:20.729984 (MainThread): On master: Close
2021-01-29 18:55:21.018035 (MainThread): 13:55:21 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:55:21.019493 (MainThread): 13:55:21 | 
2021-01-29 18:55:21.029429 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:55:21.035871 (Thread-1): 13:55:21 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 18:55:21.038396 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:21.039104 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:55:21.073052 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:55:21.073450 (Thread-1): finished collecting timing info
2021-01-29 18:55:21.121221 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:21.121388 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:55:21.121489 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:22.265700 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-01-29 18:55:22.303908 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:22.304129 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:55:22.778811 (Thread-1): SQL status: SUCCESS 3 in 0.47 seconds
2021-01-29 18:55:22.795627 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:22.796199 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 18:55:23.037183 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-29 18:55:23.077438 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:23.077615 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 18:55:23.461034 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-29 18:55:23.503408 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 18:55:23.504590 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:23.504721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 18:55:23.690441 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 18:55:23.691093 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:23.691520 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:55:25.238231 (Thread-1): SQL status: SUCCESS 1 in 1.55 seconds
2021-01-29 18:55:25.243251 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:55:25.244064 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:25.244540 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 18:55:25.399521 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-29 18:55:25.444582 (Thread-1): finished collecting timing info
2021-01-29 18:55:25.445036 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 18:55:26.054126 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b0f7820>]}
2021-01-29 18:55:26.055701 (Thread-1): 13:55:26 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 5.02s]
2021-01-29 18:55:26.055880 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 18:55:26.056035 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:55:26.057229 (Thread-1): 13:55:26 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 18:55:26.057568 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:26.057680 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:55:26.065458 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:55:26.065796 (Thread-1): finished collecting timing info
2021-01-29 18:55:26.078450 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:26.078617 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 18:55:26.078734 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:27.386539 (Thread-1): SQL status: SUCCESS 1 in 1.31 seconds
2021-01-29 18:55:27.399048 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:27.399597 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:55:27.899562 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-01-29 18:55:27.918711 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:27.919322 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 18:55:28.719525 (Thread-1): SQL status: SUCCESS 4 in 0.80 seconds
2021-01-29 18:55:28.723460 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:28.723596 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 18:55:29.230803 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-29 18:55:29.236943 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 18:55:29.241356 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:29.241862 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 18:55:29.433134 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 18:55:29.433791 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:29.434222 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 18:55:30.534303 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-01-29 18:55:30.535937 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:55:30.536175 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:30.536304 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 18:55:30.692717 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 18:55:30.704458 (Thread-1): finished collecting timing info
2021-01-29 18:55:30.705798 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 18:55:30.973420 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b2cf580>]}
2021-01-29 18:55:30.980604 (Thread-1): 13:55:30 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.91s]
2021-01-29 18:55:30.981422 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 18:55:30.982127 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:55:30.987440 (Thread-1): 13:55:30 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:55:30.989604 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:30.990182 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:55:31.004824 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:55:31.005302 (Thread-1): finished collecting timing info
2021-01-29 18:55:31.021539 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:31.021694 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:55:31.021793 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:31.971832 (Thread-1): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 18:55:31.984354 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:31.984923 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:55:32.178670 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 18:55:32.193928 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:32.194484 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 18:55:32.417016 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 18:55:32.438378 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:32.438965 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 18:55:32.915876 (Thread-1): SQL status: SUCCESS 1 in 0.48 seconds
2021-01-29 18:55:32.944751 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:55:32.946702 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:32.946951 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:55:33.130531 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 18:55:33.131199 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:33.131814 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 18:55:33.636160 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-29 18:55:33.636564 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:33.636722 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:55:34.452111 (Thread-1): SQL status: SUCCESS 2 in 0.82 seconds
2021-01-29 18:55:34.454444 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:55:34.454717 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:34.454840 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 18:55:34.926580 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-29 18:55:34.932264 (Thread-1): finished collecting timing info
2021-01-29 18:55:34.932988 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:55:35.481918 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385f9340>]}
2021-01-29 18:55:35.483799 (Thread-1): 13:55:35 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.49s]
2021-01-29 18:55:35.484015 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:55:35.484252 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:55:35.486016 (Thread-1): 13:55:35 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 18:55:35.486799 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:35.487002 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:55:35.500276 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:55:35.500846 (Thread-1): finished collecting timing info
2021-01-29 18:55:35.520692 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:35.520928 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 18:55:35.521065 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:36.810854 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-01-29 18:55:36.823948 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:36.824511 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:55:37.018467 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 18:55:37.035236 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:37.035869 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 18:55:37.495672 (Thread-1): SQL status: SUCCESS 2 in 0.46 seconds
2021-01-29 18:55:37.512700 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:37.513356 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 18:55:37.756598 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 18:55:37.763673 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 18:55:37.767801 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:37.768310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 18:55:38.082465 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-29 18:55:38.082658 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:38.082762 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 18:55:39.774317 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-01-29 18:55:39.776208 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:55:39.776524 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:39.776683 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 18:55:39.932812 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 18:55:39.936786 (Thread-1): finished collecting timing info
2021-01-29 18:55:39.937223 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 18:55:40.498564 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385f9790>]}
2021-01-29 18:55:40.505231 (Thread-1): 13:55:40 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 5.01s]
2021-01-29 18:55:40.506178 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 18:55:40.506930 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:55:40.512279 (Thread-1): 13:55:40 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 18:55:40.514636 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:40.515212 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:55:40.536051 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:55:40.536763 (Thread-1): finished collecting timing info
2021-01-29 18:55:40.555691 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:40.556011 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 18:55:40.556251 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:41.620247 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-29 18:55:41.632990 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:41.633554 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:55:41.808980 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-01-29 18:55:41.826802 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:41.827392 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 18:55:42.021833 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 18:55:42.038530 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:42.039087 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 18:55:42.542446 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-01-29 18:55:42.544959 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 18:55:42.546226 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:42.546366 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 18:55:43.053704 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-01-29 18:55:43.054664 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:43.055376 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:55:44.180051 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-01-29 18:55:44.185167 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:55:44.186119 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:44.186663 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 18:55:44.490588 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-29 18:55:44.508150 (Thread-1): finished collecting timing info
2021-01-29 18:55:44.509571 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 18:55:44.776277 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385ccca0>]}
2021-01-29 18:55:44.782430 (Thread-1): 13:55:44 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.26s]
2021-01-29 18:55:44.783311 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 18:55:44.784112 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:55:44.790494 (Thread-1): 13:55:44 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-01-29 18:55:44.792135 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:55:44.792694 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:55:44.814270 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:55:44.814829 (Thread-1): finished collecting timing info
2021-01-29 18:55:44.825879 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 18:55:44.826845 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:55:44.826949 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-01-29 18:55:44.827040 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:46.022997 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-01-29 18:55:46.023700 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:55:46.024137 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:55:47.192032 (Thread-1): SQL status: SUCCESS 1 in 1.17 seconds
2021-01-29 18:55:47.197878 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:55:47.198947 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:55:47.199513 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 18:55:47.370162 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 18:55:47.382396 (Thread-1): finished collecting timing info
2021-01-29 18:55:47.383709 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-01-29 18:55:47.974309 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063965b5e0>]}
2021-01-29 18:55:47.980512 (Thread-1): 13:55:47 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 3.18s]
2021-01-29 18:55:47.981314 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 18:55:47.982018 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:55:47.987412 (Thread-1): 13:55:47 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-01-29 18:55:47.989658 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:55:47.990241 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:55:48.007825 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:55:48.008315 (Thread-1): finished collecting timing info
2021-01-29 18:55:48.020620 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-01-29 18:55:48.025161 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:55:48.025289 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-01-29 18:55:48.025382 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:48.949153 (Thread-1): SQL status: SUCCESS 1 in 0.92 seconds
2021-01-29 18:55:48.955542 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 18:55:48.959751 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:55:48.960258 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-01-29 18:55:49.160459 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 18:55:49.161157 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:55:49.161587 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 18:55:50.294311 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-01-29 18:55:50.299436 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:55:50.300263 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:55:50.300707 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 18:55:50.735245 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-29 18:55:50.748499 (Thread-1): finished collecting timing info
2021-01-29 18:55:50.749824 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-01-29 18:55:51.053151 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f698d548-870c-4055-b7fe-bf0acf7877d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06385e7f10>]}
2021-01-29 18:55:51.061235 (Thread-1): 13:55:51 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.06s]
2021-01-29 18:55:51.061778 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 18:55:51.064789 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:55:51.065194 (MainThread): Using snowflake connection "master".
2021-01-29 18:55:51.065373 (MainThread): On master: BEGIN
2021-01-29 18:55:51.065549 (MainThread): Opening a new connection, currently in state closed
2021-01-29 18:55:52.095835 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 18:55:52.096585 (MainThread): On master: COMMIT
2021-01-29 18:55:52.097415 (MainThread): Using snowflake connection "master".
2021-01-29 18:55:52.097843 (MainThread): On master: COMMIT
2021-01-29 18:55:52.556715 (MainThread): SQL status: SUCCESS 1 in 0.46 seconds
2021-01-29 18:55:52.557655 (MainThread): On master: Close
2021-01-29 18:55:52.883080 (MainThread): 13:55:52 | 
2021-01-29 18:55:52.884413 (MainThread): 13:55:52 | Finished running 7 snowflake_timetravel_table models in 37.25s.
2021-01-29 18:55:52.885190 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:55:52.885610 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-01-29 18:55:52.953478 (MainThread): 
2021-01-29 18:55:52.953646 (MainThread): Completed successfully
2021-01-29 18:55:52.953771 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-29 18:55:52.953968 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b01bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b0e46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f063b0e4040>]}
2021-01-29 18:55:52.954161 (MainThread): Flushing usage events
2021-01-29 18:55:54.859564 (MainThread): Running with dbt=0.19.0
2021-01-29 18:55:55.350086 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 18:55:55.350857 (MainThread): Tracking: do not track
2021-01-29 18:55:55.387532 (MainThread): Partial parsing not enabled
2021-01-29 18:55:55.388723 (MainThread): Parsing macros/catalog.sql
2021-01-29 18:55:55.391698 (MainThread): Parsing macros/adapters.sql
2021-01-29 18:55:55.426818 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 18:55:55.428527 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 18:55:55.438545 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 18:55:55.440645 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 18:55:55.445650 (MainThread): Parsing macros/core.sql
2021-01-29 18:55:55.449584 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 18:55:55.451330 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 18:55:55.452925 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 18:55:55.455046 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 18:55:55.457880 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 18:55:55.467111 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 18:55:55.473499 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 18:55:55.478698 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 18:55:55.500630 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 18:55:55.502688 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 18:55:55.540369 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 18:55:55.547635 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 18:55:55.554049 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 18:55:55.556361 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 18:55:55.570892 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 18:55:55.593289 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 18:55:55.602177 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 18:55:55.603769 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 18:55:55.604695 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 18:55:55.606749 (MainThread): Parsing macros/etc/query.sql
2021-01-29 18:55:55.607778 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 18:55:55.609450 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 18:55:55.655494 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 18:55:55.670412 (MainThread): Partial parsing not enabled
2021-01-29 18:55:55.708079 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:55.727836 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 18:55:55.737696 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 18:55:55.748207 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 18:55:55.758870 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 18:55:55.769462 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 18:55:55.780252 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 18:55:55.799811 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:55.973707 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 18:55:55.974477 (MainThread): 
2021-01-29 18:55:55.974776 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:55:55.984555 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:55:55.998796 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 18:55:55.998962 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 18:55:55.999051 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 18:55:57.156514 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.16 seconds
2021-01-29 18:55:57.525391 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 18:55:57.845706 (MainThread): 13:55:57 | Concurrency: 1 threads (target='snowflake')
2021-01-29 18:55:57.846053 (MainThread): 13:55:57 | 
2021-01-29 18:55:57.848346 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:55:57.848601 (Thread-1): 13:55:57 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 18:55:57.849034 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:57.849225 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:55:57.874440 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 18:55:57.874844 (Thread-1): finished collecting timing info
2021-01-29 18:55:57.875814 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:57.875926 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 18:55:57.876039 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 18:55:58.709312 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-29 18:55:58.710002 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 18:55:58.710432 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T18:55:31.005654Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 18:55:59.137060 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-01-29 18:55:59.138901 (Thread-1): finished collecting timing info
2021-01-29 18:55:59.140319 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 18:55:59.436078 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 18:55:59.839824 (Thread-1): 13:55:59 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 1.99s]
2021-01-29 18:55:59.840811 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 18:55:59.846689 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 18:55:59.848231 (MainThread): 13:55:59 | 
2021-01-29 18:55:59.848916 (MainThread): 13:55:59 | Finished running 1 test in 3.87s.
2021-01-29 18:55:59.849444 (MainThread): Connection 'master' was properly closed.
2021-01-29 18:55:59.849818 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 18:55:59.913363 (MainThread): 
2021-01-29 18:55:59.913521 (MainThread): Completed successfully
2021-01-29 18:55:59.913629 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 18:55:59.913818 (MainThread): Flushing usage events
2021-01-29 20:35:37.050261 (MainThread): Running with dbt=0.18.1
2021-01-29 20:35:37.579507 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 20:35:37.580178 (MainThread): Tracking: tracking
2021-01-29 20:35:37.580422 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec6fa3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecdd6b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec6f43700>]}
2021-01-29 20:35:37.581180 (MainThread): Set downloads directory='/tmp/dbt-downloads-45os_2vi'
2021-01-29 20:35:37.598991 (MainThread): Installing ../../
2021-01-29 20:35:37.599359 (MainThread):   Creating symlink to local dependency.
2021-01-29 20:35:37.599534 (MainThread):   Installed from <local @ ../../>

2021-01-29 20:35:37.599755 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a514a4f-e7d7-4cba-8998-13a8de709f51', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec6f4c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec6f4c520>]}
2021-01-29 20:35:37.600201 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec6fa3df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efecdd6b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efec6f4cb50>]}
2021-01-29 20:35:37.600444 (MainThread): Flushing usage events
2021-01-29 20:35:39.262856 (MainThread): Running with dbt=0.18.1
2021-01-29 20:35:39.776492 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 20:35:39.777282 (MainThread): Tracking: tracking
2021-01-29 20:35:39.777601 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1680244550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168708d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f168024c670>]}
2021-01-29 20:35:39.817016 (MainThread): Partial parsing not enabled
2021-01-29 20:35:39.818137 (MainThread): Parsing macros/catalog.sql
2021-01-29 20:35:39.821131 (MainThread): Parsing macros/adapters.sql
2021-01-29 20:35:39.859988 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 20:35:39.863481 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 20:35:39.887616 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 20:35:39.891702 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 20:35:39.901953 (MainThread): Parsing macros/core.sql
2021-01-29 20:35:39.912596 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 20:35:39.916996 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 20:35:39.921578 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 20:35:39.926427 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 20:35:39.933035 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 20:35:39.957978 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 20:35:39.979455 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 20:35:39.995995 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 20:35:40.047125 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 20:35:40.053205 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 20:35:40.115829 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 20:35:40.125031 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 20:35:40.133362 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 20:35:40.135691 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 20:35:40.154116 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 20:35:40.187799 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 20:35:40.205746 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 20:35:40.209726 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 20:35:40.211635 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 20:35:40.216363 (MainThread): Parsing macros/etc/query.sql
2021-01-29 20:35:40.218944 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 20:35:40.223669 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 20:35:40.324472 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 20:35:40.370786 (MainThread): Partial parsing not enabled
2021-01-29 20:35:40.447072 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:40.488036 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:35:40.504041 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:40.525460 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:35:40.545559 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:40.566272 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:35:40.587499 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:35:40.633234 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:40.899254 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 20:35:40.900197 (MainThread): 
2021-01-29 20:35:40.900535 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:35:40.909934 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 20:35:40.925980 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 20:35:40.926145 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 20:35:40.926257 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 20:35:42.607930 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.68 seconds
2021-01-29 20:35:42.641576 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 20:35:42.937037 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:35:42.946437 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:35:42.946595 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 20:35:42.946699 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 20:35:43.870955 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 0.92 seconds
2021-01-29 20:35:44.241914 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 20:35:44.546693 (MainThread): Using snowflake connection "master".
2021-01-29 20:35:44.546886 (MainThread): On master: BEGIN
2021-01-29 20:35:44.546996 (MainThread): Opening a new connection, currently in state init
2021-01-29 20:35:45.498698 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-01-29 20:35:45.500485 (MainThread): On master: COMMIT
2021-01-29 20:35:45.502561 (MainThread): Using snowflake connection "master".
2021-01-29 20:35:45.503855 (MainThread): On master: COMMIT
2021-01-29 20:35:45.867370 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-01-29 20:35:45.868566 (MainThread): On master: Close
2021-01-29 20:35:46.219844 (MainThread): 15:35:46 | Concurrency: 1 threads (target='snowflake')
2021-01-29 20:35:46.220838 (MainThread): 15:35:46 | 
2021-01-29 20:35:46.232994 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:35:46.243213 (Thread-1): 15:35:46 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 20:35:46.244951 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:46.245606 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:35:46.281644 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 20:35:46.282076 (Thread-1): finished collecting timing info
2021-01-29 20:35:46.331157 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:46.331326 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:35:46.331431 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:35:47.831240 (Thread-1): SQL status: SUCCESS 1 in 1.50 seconds
2021-01-29 20:35:47.891585 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:47.891957 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:35:48.114765 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 20:35:48.135218 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:48.135886 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 20:35:48.890695 (Thread-1): SQL status: SUCCESS 3 in 0.75 seconds
2021-01-29 20:35:48.912806 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:48.913016 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 20:35:49.260439 (Thread-1): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-29 20:35:49.307230 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 20:35:49.308362 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:49.308471 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 20:35:49.556954 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 20:35:49.557599 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:49.558031 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:35:50.902731 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-01-29 20:35:50.908586 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 20:35:50.909526 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:35:50.909984 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 20:35:51.088114 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 20:35:51.117963 (Thread-1): finished collecting timing info
2021-01-29 20:35:51.118480 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 20:35:51.422695 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8026d5c-e859-4e09-8573-442ec87821cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167a55b550>]}
2021-01-29 20:35:51.429669 (Thread-1): 15:35:51 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 5.18s]
2021-01-29 20:35:51.430651 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:35:51.431438 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:35:51.437684 (Thread-1): 15:35:51 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 20:35:51.438669 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:51.438982 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:35:51.453591 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 20:35:51.454024 (Thread-1): finished collecting timing info
2021-01-29 20:35:51.469234 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:51.469395 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 20:35:51.469498 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:35:53.049026 (Thread-1): SQL status: SUCCESS 1 in 1.58 seconds
2021-01-29 20:35:53.056138 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:53.056471 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:35:53.562687 (Thread-1): SQL status: SUCCESS 3 in 0.51 seconds
2021-01-29 20:35:53.577562 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:53.578101 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 20:35:53.905239 (Thread-1): SQL status: SUCCESS 4 in 0.33 seconds
2021-01-29 20:35:53.909250 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:53.909395 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 20:35:54.380457 (Thread-1): SQL status: SUCCESS 1 in 0.47 seconds
2021-01-29 20:35:54.386819 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 20:35:54.391367 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:54.391881 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 20:35:54.601065 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 20:35:54.601268 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:54.601389 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 20:35:56.025297 (Thread-1): SQL status: SUCCESS 1 in 1.42 seconds
2021-01-29 20:35:56.030409 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 20:35:56.031250 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:35:56.031695 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 20:35:56.198484 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 20:35:56.207285 (Thread-1): finished collecting timing info
2021-01-29 20:35:56.208112 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 20:35:56.472310 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8026d5c-e859-4e09-8573-442ec87821cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167a578520>]}
2021-01-29 20:35:56.478479 (Thread-1): 15:35:56 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 5.03s]
2021-01-29 20:35:56.479214 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:35:56.479977 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:35:56.486119 (Thread-1): 15:35:56 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 20:35:56.487618 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:56.488161 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:35:56.507528 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 20:35:56.508107 (Thread-1): finished collecting timing info
2021-01-29 20:35:56.523678 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:56.523852 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:35:56.523954 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:35:57.963951 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-01-29 20:35:57.976850 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:57.977407 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:35:58.476481 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-01-29 20:35:58.493460 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:58.494052 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 20:35:58.901184 (Thread-1): SQL status: SUCCESS 3 in 0.41 seconds
2021-01-29 20:35:58.918118 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:58.918812 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 20:35:59.299687 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-29 20:35:59.321797 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 20:35:59.323993 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:59.324232 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 20:35:59.498181 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 20:35:59.498850 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:59.499486 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 20:35:59.991733 (Thread-1): SQL status: SUCCESS 1 in 0.49 seconds
2021-01-29 20:35:59.992580 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:35:59.993094 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:36:01.344113 (Thread-1): SQL status: SUCCESS 2 in 1.35 seconds
2021-01-29 20:36:01.350287 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 20:36:01.351357 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:36:01.351832 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 20:36:01.876720 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-01-29 20:36:01.886397 (Thread-1): finished collecting timing info
2021-01-29 20:36:01.887148 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 20:36:02.156553 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8026d5c-e859-4e09-8573-442ec87821cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678cf1850>]}
2021-01-29 20:36:02.163190 (Thread-1): 15:36:02 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.67s]
2021-01-29 20:36:02.163971 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:36:02.164819 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:36:02.170097 (Thread-1): 15:36:02 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 20:36:02.171344 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:02.171836 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:36:02.185344 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 20:36:02.185804 (Thread-1): finished collecting timing info
2021-01-29 20:36:02.202502 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:02.202663 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 20:36:02.202764 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:36:03.593287 (Thread-1): SQL status: SUCCESS 1 in 1.39 seconds
2021-01-29 20:36:03.596302 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:03.596447 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:36:03.897289 (Thread-1): SQL status: SUCCESS 3 in 0.30 seconds
2021-01-29 20:36:03.914330 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:03.914955 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 20:36:04.413240 (Thread-1): SQL status: SUCCESS 2 in 0.50 seconds
2021-01-29 20:36:04.419445 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:04.419608 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 20:36:04.673945 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 20:36:04.680174 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 20:36:04.684716 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:04.685371 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 20:36:05.132884 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-01-29 20:36:05.133689 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:05.134369 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 20:36:06.322271 (Thread-1): SQL status: SUCCESS 1 in 1.19 seconds
2021-01-29 20:36:06.323315 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 20:36:06.323507 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:06.323593 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 20:36:06.474117 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-01-29 20:36:06.476426 (Thread-1): finished collecting timing info
2021-01-29 20:36:06.476728 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 20:36:06.726311 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8026d5c-e859-4e09-8573-442ec87821cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678cba3a0>]}
2021-01-29 20:36:06.727757 (Thread-1): 15:36:06 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.56s]
2021-01-29 20:36:06.727935 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:36:06.728076 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:36:06.730642 (Thread-1): 15:36:06 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 20:36:06.731429 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:06.731676 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:36:06.741299 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 20:36:06.741671 (Thread-1): finished collecting timing info
2021-01-29 20:36:06.769310 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:06.769581 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:36:06.769765 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:36:07.876102 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-01-29 20:36:07.880268 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:07.880516 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:36:08.320994 (Thread-1): SQL status: SUCCESS 3 in 0.44 seconds
2021-01-29 20:36:08.330274 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:08.330507 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 20:36:08.536398 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-29 20:36:08.539790 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:08.539937 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 20:36:08.916226 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-29 20:36:08.918394 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 20:36:08.919971 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:08.920163 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 20:36:09.166733 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-01-29 20:36:09.166941 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:09.167035 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:36:10.452871 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-01-29 20:36:10.454000 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 20:36:10.454191 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:10.454281 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 20:36:10.613907 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 20:36:10.618902 (Thread-1): finished collecting timing info
2021-01-29 20:36:10.619409 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 20:36:10.906739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8026d5c-e859-4e09-8573-442ec87821cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167a55b730>]}
2021-01-29 20:36:10.913206 (Thread-1): 15:36:10 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.17s]
2021-01-29 20:36:10.914092 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:36:10.915350 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 20:36:10.922656 (Thread-1): 15:36:10 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-01-29 20:36:10.925212 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:36:10.925765 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 20:36:10.941967 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 20:36:10.942457 (Thread-1): finished collecting timing info
2021-01-29 20:36:10.958793 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 20:36:10.959754 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:36:10.959863 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-01-29 20:36:10.959956 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:36:12.518232 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-01-29 20:36:12.518464 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:36:12.518599 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:36:13.862031 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-01-29 20:36:13.867575 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 20:36:13.868061 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:36:13.868312 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 20:36:14.042560 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 20:36:14.055653 (Thread-1): finished collecting timing info
2021-01-29 20:36:14.057210 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-01-29 20:36:14.305129 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8026d5c-e859-4e09-8573-442ec87821cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f167a55b100>]}
2021-01-29 20:36:14.307738 (Thread-1): 15:36:14 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 3.38s]
2021-01-29 20:36:14.308071 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 20:36:14.308380 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 20:36:14.310460 (Thread-1): 15:36:14 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-01-29 20:36:14.311334 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:36:14.311570 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 20:36:14.327382 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 20:36:14.327803 (Thread-1): finished collecting timing info
2021-01-29 20:36:14.341528 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-01-29 20:36:14.346285 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:36:14.346433 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-01-29 20:36:14.346532 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:36:15.783636 (Thread-1): SQL status: SUCCESS 1 in 1.44 seconds
2021-01-29 20:36:15.789810 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 20:36:15.795862 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:36:15.796275 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-01-29 20:36:15.996123 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-01-29 20:36:15.996458 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:36:15.996657 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:36:17.214546 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-01-29 20:36:17.222794 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 20:36:17.224273 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:36:17.225115 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 20:36:17.397913 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 20:36:17.403307 (Thread-1): finished collecting timing info
2021-01-29 20:36:17.403837 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-01-29 20:36:17.712945 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8026d5c-e859-4e09-8573-442ec87821cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678ca9d00>]}
2021-01-29 20:36:17.716921 (Thread-1): 15:36:17 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.40s]
2021-01-29 20:36:17.717290 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 20:36:17.719346 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:36:17.719755 (MainThread): Using snowflake connection "master".
2021-01-29 20:36:17.719923 (MainThread): On master: BEGIN
2021-01-29 20:36:17.720081 (MainThread): Opening a new connection, currently in state closed
2021-01-29 20:36:18.568105 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-29 20:36:18.569295 (MainThread): On master: COMMIT
2021-01-29 20:36:18.570511 (MainThread): Using snowflake connection "master".
2021-01-29 20:36:18.570989 (MainThread): On master: COMMIT
2021-01-29 20:36:18.918058 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-01-29 20:36:18.918312 (MainThread): On master: Close
2021-01-29 20:36:19.195001 (MainThread): 15:36:19 | 
2021-01-29 20:36:19.195939 (MainThread): 15:36:19 | Finished running 7 snowflake_timetravel_table models in 38.29s.
2021-01-29 20:36:19.196954 (MainThread): Connection 'master' was properly closed.
2021-01-29 20:36:19.197307 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-01-29 20:36:19.231644 (MainThread): 
2021-01-29 20:36:19.231826 (MainThread): Completed successfully
2021-01-29 20:36:19.231949 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-29 20:36:19.232147 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678c95b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678c95820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1678c95670>]}
2021-01-29 20:36:19.232345 (MainThread): Flushing usage events
2021-01-29 20:36:21.573050 (MainThread): Running with dbt=0.18.1
2021-01-29 20:36:22.068494 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 20:36:22.069243 (MainThread): Tracking: do not track
2021-01-29 20:36:22.114934 (MainThread): Partial parsing not enabled
2021-01-29 20:36:22.116381 (MainThread): Parsing macros/catalog.sql
2021-01-29 20:36:22.119384 (MainThread): Parsing macros/adapters.sql
2021-01-29 20:36:22.156703 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 20:36:22.158595 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 20:36:22.171286 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 20:36:22.173837 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 20:36:22.179731 (MainThread): Parsing macros/core.sql
2021-01-29 20:36:22.184377 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 20:36:22.186534 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 20:36:22.188526 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 20:36:22.190855 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 20:36:22.194219 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 20:36:22.205926 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 20:36:22.213927 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 20:36:22.220701 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 20:36:22.241660 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 20:36:22.244111 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 20:36:22.281518 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 20:36:22.292015 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 20:36:22.299619 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 20:36:22.301976 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 20:36:22.318719 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 20:36:22.347521 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 20:36:22.358880 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 20:36:22.361497 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 20:36:22.362719 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 20:36:22.365170 (MainThread): Parsing macros/etc/query.sql
2021-01-29 20:36:22.366441 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 20:36:22.368535 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 20:36:22.419414 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 20:36:22.435897 (MainThread): Partial parsing not enabled
2021-01-29 20:36:22.474871 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:36:22.497431 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:36:22.508105 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:36:22.519243 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:36:22.531396 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:36:22.545480 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:36:22.556558 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:36:22.577554 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:36:22.763446 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-01-29 20:36:22.764304 (MainThread): 
2021-01-29 20:36:22.764636 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:36:22.775129 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:36:22.789777 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:36:22.789911 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 20:36:22.789999 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 20:36:24.294307 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.50 seconds
2021-01-29 20:36:24.659615 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 20:36:24.995994 (MainThread): 15:36:24 | Concurrency: 1 threads (target='snowflake')
2021-01-29 20:36:24.996231 (MainThread): 15:36:24 | 
2021-01-29 20:36:24.998241 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:36:24.998447 (Thread-1): 15:36:24 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 20:36:24.998789 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:36:24.998923 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:36:25.021535 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 20:36:25.021891 (Thread-1): finished collecting timing info
2021-01-29 20:36:25.022686 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:36:25.022783 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 20:36:25.022874 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:36:26.020526 (Thread-1): SQL status: SUCCESS 1 in 1.00 seconds
2021-01-29 20:36:26.021270 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:36:26.021724 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T20:35:56.508547Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 20:36:27.289287 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-01-29 20:36:27.296425 (Thread-1): finished collecting timing info
2021-01-29 20:36:27.299090 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 20:36:27.762942 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 20:36:28.128972 (Thread-1): 15:36:28 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 3.13s]
2021-01-29 20:36:28.129775 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:36:28.135797 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:36:28.137969 (MainThread): 15:36:28 | 
2021-01-29 20:36:28.138960 (MainThread): 15:36:28 | Finished running 1 test in 5.37s.
2021-01-29 20:36:28.139506 (MainThread): Connection 'master' was properly closed.
2021-01-29 20:36:28.139881 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 20:36:28.161608 (MainThread): 
2021-01-29 20:36:28.162033 (MainThread): Completed successfully
2021-01-29 20:36:28.162346 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 20:36:28.162866 (MainThread): Flushing usage events
2021-01-29 20:37:14.660650 (MainThread): Running with dbt=0.19.0
2021-01-29 20:37:15.204481 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-01-29 20:37:15.204805 (MainThread): Tracking: tracking
2021-01-29 20:37:15.204960 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50ebd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a591e4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50ecb6a0>]}
2021-01-29 20:37:15.205592 (MainThread): Set downloads directory='/tmp/dbt-downloads-36jfl0y7'
2021-01-29 20:37:15.217871 (MainThread): Installing ../../
2021-01-29 20:37:15.218273 (MainThread):   Creating symlink to local dependency.
2021-01-29 20:37:15.218409 (MainThread):   Installed from <local @ ../../>

2021-01-29 20:37:15.218626 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f7ecadd1-6354-448a-b6b3-013b0629c91f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50ecbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50ecb4c0>]}
2021-01-29 20:37:15.218959 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50ebd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50ecbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a50ecbb50>]}
2021-01-29 20:37:15.219128 (MainThread): Flushing usage events
2021-01-29 20:37:16.932354 (MainThread): Running with dbt=0.19.0
2021-01-29 20:37:17.436550 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-01-29 20:37:17.437341 (MainThread): Tracking: tracking
2021-01-29 20:37:17.437674 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62aff07a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62b5c3d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62afe9c820>]}
2021-01-29 20:37:17.474765 (MainThread): Partial parsing not enabled
2021-01-29 20:37:17.475874 (MainThread): Parsing macros/catalog.sql
2021-01-29 20:37:17.479655 (MainThread): Parsing macros/adapters.sql
2021-01-29 20:37:17.517060 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 20:37:17.518924 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 20:37:17.529529 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 20:37:17.532078 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 20:37:17.537578 (MainThread): Parsing macros/core.sql
2021-01-29 20:37:17.541872 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 20:37:17.543772 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 20:37:17.545487 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 20:37:17.547899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 20:37:17.551129 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 20:37:17.560851 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 20:37:17.568035 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 20:37:17.574283 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 20:37:17.594307 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 20:37:17.596233 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 20:37:17.631404 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 20:37:17.638554 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 20:37:17.644663 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 20:37:17.646490 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 20:37:17.661950 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 20:37:17.684847 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 20:37:17.694345 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 20:37:17.695984 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 20:37:17.696963 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 20:37:17.699225 (MainThread): Parsing macros/etc/query.sql
2021-01-29 20:37:17.700297 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 20:37:17.702015 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 20:37:17.765477 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 20:37:17.784065 (MainThread): Partial parsing not enabled
2021-01-29 20:37:17.836907 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:17.866526 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:17.880960 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:17.899767 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:37:17.916389 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:17.927648 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:37:17.940119 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:17.959944 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:18.124591 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62aeb12fd0>]}
2021-01-29 20:37:18.173387 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 20:37:18.174370 (MainThread): 
2021-01-29 20:37:18.174708 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:37:18.184427 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-01-29 20:37:18.201926 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-01-29 20:37:18.202091 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-01-29 20:37:18.202214 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-01-29 20:37:19.283755 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.08 seconds
2021-01-29 20:37:19.314007 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-01-29 20:37:19.603875 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:37:19.613744 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:37:19.613936 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 20:37:19.614136 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-01-29 20:37:20.547415 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 0.93 seconds
2021-01-29 20:37:20.935620 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 20:37:21.233979 (MainThread): Using snowflake connection "master".
2021-01-29 20:37:21.234203 (MainThread): On master: BEGIN
2021-01-29 20:37:21.234346 (MainThread): Opening a new connection, currently in state init
2021-01-29 20:37:22.066829 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-29 20:37:22.067115 (MainThread): On master: COMMIT
2021-01-29 20:37:22.067369 (MainThread): Using snowflake connection "master".
2021-01-29 20:37:22.067511 (MainThread): On master: COMMIT
2021-01-29 20:37:22.369586 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-01-29 20:37:22.370362 (MainThread): On master: Close
2021-01-29 20:37:22.655969 (MainThread): 15:37:22 | Concurrency: 1 threads (target='snowflake')
2021-01-29 20:37:22.657160 (MainThread): 15:37:22 | 
2021-01-29 20:37:22.663300 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:37:22.666848 (Thread-1): 15:37:22 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-01-29 20:37:22.667778 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:22.668172 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:37:22.707422 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 20:37:22.707776 (Thread-1): finished collecting timing info
2021-01-29 20:37:22.756752 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:22.756924 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:37:22.757046 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:23.999906 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-01-29 20:37:24.043087 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:24.043289 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:37:24.250715 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-01-29 20:37:24.267635 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:24.268247 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-01-29 20:37:24.509302 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-01-29 20:37:24.545443 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:24.545637 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-01-29 20:37:24.781913 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 20:37:24.825769 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-01-29 20:37:24.826973 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:24.827171 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-01-29 20:37:25.065987 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 20:37:25.066420 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:25.066676 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:37:26.105428 (Thread-1): SQL status: SUCCESS 1 in 1.04 seconds
2021-01-29 20:37:26.111631 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 20:37:26.112482 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:26.112971 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-01-29 20:37:26.323266 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-01-29 20:37:26.367215 (Thread-1): finished collecting timing info
2021-01-29 20:37:26.367864 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-01-29 20:37:26.674832 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ad1945e0>]}
2021-01-29 20:37:26.681449 (Thread-1): 15:37:26 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.01s]
2021-01-29 20:37:26.682208 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-01-29 20:37:26.682997 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:37:26.689232 (Thread-1): 15:37:26 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-01-29 20:37:26.691213 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:26.691562 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:37:26.707718 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 20:37:26.708174 (Thread-1): finished collecting timing info
2021-01-29 20:37:26.723606 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:26.723773 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-01-29 20:37:26.723874 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:27.710051 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-01-29 20:37:27.723481 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:27.724099 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:37:27.911519 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 20:37:27.918337 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:27.918549 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-01-29 20:37:28.114503 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-01-29 20:37:28.133509 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:28.134177 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-01-29 20:37:28.454410 (Thread-1): SQL status: SUCCESS 1 in 0.32 seconds
2021-01-29 20:37:28.464295 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-01-29 20:37:28.469447 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:28.470058 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-01-29 20:37:28.707243 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-01-29 20:37:28.707939 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:28.708370 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-01-29 20:37:29.787530 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-01-29 20:37:29.792420 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 20:37:29.793336 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:29.793812 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-01-29 20:37:29.962351 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-01-29 20:37:29.974537 (Thread-1): finished collecting timing info
2021-01-29 20:37:29.975809 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-01-29 20:37:30.265396 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ac10d4c0>]}
2021-01-29 20:37:30.271539 (Thread-1): 15:37:30 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.57s]
2021-01-29 20:37:30.272376 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-01-29 20:37:30.273189 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:37:30.279539 (Thread-1): 15:37:30 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 20:37:30.281568 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:30.282194 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:37:30.300519 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 20:37:30.301016 (Thread-1): finished collecting timing info
2021-01-29 20:37:30.315270 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:30.315426 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:37:30.315529 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:31.336888 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 20:37:31.349507 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:31.350057 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:37:31.565845 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 20:37:31.583575 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:31.584128 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-01-29 20:37:31.784254 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 20:37:31.805131 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:31.805740 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-01-29 20:37:32.028050 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-01-29 20:37:32.058801 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 20:37:32.060865 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:32.061101 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 20:37:32.246628 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 20:37:32.247296 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:32.247722 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-01-29 20:37:32.626020 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-01-29 20:37:32.626870 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:32.627312 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:37:33.239511 (Thread-1): SQL status: SUCCESS 2 in 0.61 seconds
2021-01-29 20:37:33.244268 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 20:37:33.245128 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:33.245578 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-01-29 20:37:34.073751 (Thread-1): SQL status: SUCCESS 1 in 0.83 seconds
2021-01-29 20:37:34.085561 (Thread-1): finished collecting timing info
2021-01-29 20:37:34.086812 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 20:37:34.387251 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ac124160>]}
2021-01-29 20:37:34.402098 (Thread-1): 15:37:34 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.11s]
2021-01-29 20:37:34.402927 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:37:34.403658 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:37:34.411568 (Thread-1): 15:37:34 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-01-29 20:37:34.413210 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:34.413764 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:37:34.433273 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 20:37:34.433842 (Thread-1): finished collecting timing info
2021-01-29 20:37:34.448987 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:34.449160 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-01-29 20:37:34.449288 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:35.512008 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-01-29 20:37:35.524607 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:35.525182 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:37:35.711846 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-01-29 20:37:35.725401 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:35.725870 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-01-29 20:37:36.027197 (Thread-1): SQL status: SUCCESS 2 in 0.30 seconds
2021-01-29 20:37:36.053063 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:36.053859 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-01-29 20:37:36.328865 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-01-29 20:37:36.335530 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-01-29 20:37:36.339603 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:36.340113 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-01-29 20:37:36.533357 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-01-29 20:37:36.534063 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:36.534543 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-01-29 20:37:37.679611 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-01-29 20:37:37.684569 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 20:37:37.685445 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:37.685938 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-01-29 20:37:37.851116 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 20:37:37.867868 (Thread-1): finished collecting timing info
2021-01-29 20:37:37.869674 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-01-29 20:37:38.130760 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ac124af0>]}
2021-01-29 20:37:38.138256 (Thread-1): 15:37:38 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 3.72s]
2021-01-29 20:37:38.139186 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-01-29 20:37:38.139911 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:37:38.146497 (Thread-1): 15:37:38 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-01-29 20:37:38.148056 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:38.148605 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:37:38.182268 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 20:37:38.182741 (Thread-1): finished collecting timing info
2021-01-29 20:37:38.197429 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:38.197596 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-01-29 20:37:38.197700 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:39.218671 (Thread-1): SQL status: SUCCESS 1 in 1.02 seconds
2021-01-29 20:37:39.231339 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:39.231890 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:37:39.449076 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-01-29 20:37:39.465772 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:39.466370 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-01-29 20:37:39.668278 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-01-29 20:37:39.685340 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:39.685936 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-01-29 20:37:39.992128 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-29 20:37:39.998392 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-01-29 20:37:40.003653 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:40.004540 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-01-29 20:37:40.310882 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-01-29 20:37:40.311545 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:40.311980 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:37:41.421549 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-01-29 20:37:41.427469 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 20:37:41.428322 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:41.428842 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-01-29 20:37:41.587941 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 20:37:41.602146 (Thread-1): finished collecting timing info
2021-01-29 20:37:41.603421 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-01-29 20:37:41.897437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ac12b460>]}
2021-01-29 20:37:41.903603 (Thread-1): 15:37:41 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.75s]
2021-01-29 20:37:41.904364 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-01-29 20:37:41.905224 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 20:37:41.911679 (Thread-1): 15:37:41 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-01-29 20:37:41.912642 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:37:41.913189 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 20:37:41.929019 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 20:37:41.929413 (Thread-1): finished collecting timing info
2021-01-29 20:37:41.940429 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-01-29 20:37:41.941495 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:37:41.941619 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-01-29 20:37:41.941712 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:42.794522 (Thread-1): SQL status: SUCCESS 1 in 0.85 seconds
2021-01-29 20:37:42.795252 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:37:42.795699 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:37:44.064827 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-01-29 20:37:44.070822 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 20:37:44.071668 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:37:44.072365 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-01-29 20:37:44.233966 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-01-29 20:37:44.246183 (Thread-1): finished collecting timing info
2021-01-29 20:37:44.247445 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-01-29 20:37:44.528993 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ad1b5af0>]}
2021-01-29 20:37:44.535288 (Thread-1): 15:37:44 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 2.62s]
2021-01-29 20:37:44.536015 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-01-29 20:37:44.536821 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 20:37:44.542702 (Thread-1): 15:37:44 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-01-29 20:37:44.544199 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:37:44.544509 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 20:37:44.559088 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 20:37:44.559532 (Thread-1): finished collecting timing info
2021-01-29 20:37:44.572073 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-01-29 20:37:44.576693 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:37:44.576844 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-01-29 20:37:44.576942 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:45.602791 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-01-29 20:37:45.609208 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-01-29 20:37:45.613468 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:37:45.614055 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-01-29 20:37:45.956835 (Thread-1): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-29 20:37:45.957083 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:37:45.957229 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-01-29 20:37:47.241760 (Thread-1): SQL status: SUCCESS 1 in 1.28 seconds
2021-01-29 20:37:47.246709 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 20:37:47.247520 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:37:47.247970 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-01-29 20:37:47.427063 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-01-29 20:37:47.441553 (Thread-1): finished collecting timing info
2021-01-29 20:37:47.443000 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-01-29 20:37:47.749285 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '384ad6e2-d3de-43a2-b533-dca333dc9084', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ac10d4c0>]}
2021-01-29 20:37:47.755848 (Thread-1): 15:37:47 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.20s]
2021-01-29 20:37:47.756628 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-01-29 20:37:47.761929 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:37:47.762936 (MainThread): Using snowflake connection "master".
2021-01-29 20:37:47.763388 (MainThread): On master: BEGIN
2021-01-29 20:37:47.763983 (MainThread): Opening a new connection, currently in state closed
2021-01-29 20:37:48.665340 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-01-29 20:37:48.666079 (MainThread): On master: COMMIT
2021-01-29 20:37:48.666820 (MainThread): Using snowflake connection "master".
2021-01-29 20:37:48.667239 (MainThread): On master: COMMIT
2021-01-29 20:37:49.002825 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-01-29 20:37:49.003594 (MainThread): On master: Close
2021-01-29 20:37:49.271435 (MainThread): 15:37:49 | 
2021-01-29 20:37:49.272326 (MainThread): 15:37:49 | Finished running 7 snowflake_timetravel_table models in 31.10s.
2021-01-29 20:37:49.273205 (MainThread): Connection 'master' was properly closed.
2021-01-29 20:37:49.273712 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-01-29 20:37:49.341152 (MainThread): 
2021-01-29 20:37:49.341380 (MainThread): Completed successfully
2021-01-29 20:37:49.341545 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-01-29 20:37:49.341780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62aecd81c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ac126190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62ac126fd0>]}
2021-01-29 20:37:49.341974 (MainThread): Flushing usage events
2021-01-29 20:37:51.319766 (MainThread): Running with dbt=0.19.0
2021-01-29 20:37:51.809634 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-01-29 20:37:51.810461 (MainThread): Tracking: do not track
2021-01-29 20:37:51.847508 (MainThread): Partial parsing not enabled
2021-01-29 20:37:51.848609 (MainThread): Parsing macros/catalog.sql
2021-01-29 20:37:51.851502 (MainThread): Parsing macros/adapters.sql
2021-01-29 20:37:51.889876 (MainThread): Parsing macros/materializations/view.sql
2021-01-29 20:37:51.891644 (MainThread): Parsing macros/materializations/incremental.sql
2021-01-29 20:37:51.902152 (MainThread): Parsing macros/materializations/merge.sql
2021-01-29 20:37:51.904323 (MainThread): Parsing macros/materializations/table.sql
2021-01-29 20:37:51.909465 (MainThread): Parsing macros/core.sql
2021-01-29 20:37:51.914806 (MainThread): Parsing macros/schema_tests/unique.sql
2021-01-29 20:37:51.916842 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-01-29 20:37:51.918579 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-01-29 20:37:51.920724 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-01-29 20:37:51.923864 (MainThread): Parsing macros/materializations/helpers.sql
2021-01-29 20:37:51.936007 (MainThread): Parsing macros/materializations/view/view.sql
2021-01-29 20:37:51.944741 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-01-29 20:37:51.950741 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-01-29 20:37:51.970804 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-01-29 20:37:51.972748 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-01-29 20:37:52.007933 (MainThread): Parsing macros/materializations/table/table.sql
2021-01-29 20:37:52.015217 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-01-29 20:37:52.022927 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-01-29 20:37:52.025158 (MainThread): Parsing macros/materializations/common/merge.sql
2021-01-29 20:37:52.040719 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-01-29 20:37:52.062713 (MainThread): Parsing macros/etc/datetime.sql
2021-01-29 20:37:52.071729 (MainThread): Parsing macros/etc/is_incremental.sql
2021-01-29 20:37:52.073342 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-01-29 20:37:52.074281 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-01-29 20:37:52.076222 (MainThread): Parsing macros/etc/query.sql
2021-01-29 20:37:52.077396 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-01-29 20:37:52.079529 (MainThread): Parsing macros/adapters/common.sql
2021-01-29 20:37:52.125066 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-01-29 20:37:52.140519 (MainThread): Partial parsing not enabled
2021-01-29 20:37:52.183160 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:52.207437 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-01-29 20:37:52.218357 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-01-29 20:37:52.229350 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-01-29 20:37:52.240268 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-01-29 20:37:52.251372 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-01-29 20:37:52.262485 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-01-29 20:37:52.282996 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:52.454430 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-01-29 20:37:52.455173 (MainThread): 
2021-01-29 20:37:52.455530 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:37:52.465441 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:37:52.480142 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-01-29 20:37:52.480315 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-01-29 20:37:52.480408 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-01-29 20:37:53.580528 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.10 seconds
2021-01-29 20:37:53.960698 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-01-29 20:37:54.229790 (MainThread): 15:37:54 | Concurrency: 1 threads (target='snowflake')
2021-01-29 20:37:54.230008 (MainThread): 15:37:54 | 
2021-01-29 20:37:54.231269 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:37:54.231461 (Thread-1): 15:37:54 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-01-29 20:37:54.231796 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:54.231936 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:37:54.254654 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-01-29 20:37:54.255038 (Thread-1): finished collecting timing info
2021-01-29 20:37:54.255883 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:54.255994 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-01-29 20:37:54.256092 (Thread-1): Opening a new connection, currently in state closed
2021-01-29 20:37:56.202792 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-01-29 20:37:56.203205 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-01-29 20:37:56.203450 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-01-29T20:37:30.301394Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-01-29 20:37:56.763382 (Thread-1): SQL status: SUCCESS 1 in 0.56 seconds
2021-01-29 20:37:56.767317 (Thread-1): finished collecting timing info
2021-01-29 20:37:56.768828 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-01-29 20:37:57.063991 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-01-29 20:37:57.339609 (Thread-1): 15:37:57 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 3.11s]
2021-01-29 20:37:57.340431 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-01-29 20:37:57.346195 (MainThread): Acquiring new snowflake connection "master".
2021-01-29 20:37:57.347742 (MainThread): 15:37:57 | 
2021-01-29 20:37:57.348352 (MainThread): 15:37:57 | Finished running 1 test in 4.89s.
2021-01-29 20:37:57.349023 (MainThread): Connection 'master' was properly closed.
2021-01-29 20:37:57.349653 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-01-29 20:37:57.424458 (MainThread): 
2021-01-29 20:37:57.424625 (MainThread): Completed successfully
2021-01-29 20:37:57.424743 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-01-29 20:37:57.424937 (MainThread): Flushing usage events
2021-02-01 16:16:05.908143 (MainThread): Running with dbt=0.18.1
2021-02-01 16:16:06.408846 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-02-01 16:16:06.409825 (MainThread): Tracking: tracking
2021-02-01 16:16:06.409989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7957b5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79c589370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7957474c0>]}
2021-02-01 16:16:06.410744 (MainThread): Set downloads directory='/tmp/dbt-downloads-hily21l3'
2021-02-01 16:16:06.423848 (MainThread): Installing ../../
2021-02-01 16:16:06.424756 (MainThread):   Creating symlink to local dependency.
2021-02-01 16:16:06.424906 (MainThread):   Installed from <local @ ../../>

2021-02-01 16:16:06.425059 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '73a3749e-b685-4820-9c2f-8d1ca82234f9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795747a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795747640>]}
2021-02-01 16:16:06.425382 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7957b5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79c589370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc795747f10>]}
2021-02-01 16:16:06.425548 (MainThread): Flushing usage events
2021-02-01 16:16:08.034226 (MainThread): Running with dbt=0.18.1
2021-02-01 16:16:08.522095 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-01 16:16:08.522862 (MainThread): Tracking: tracking
2021-02-01 16:16:08.523154 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc922c08490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc929a3f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc922c0c580>]}
2021-02-01 16:16:08.558832 (MainThread): Partial parsing not enabled
2021-02-01 16:16:08.560061 (MainThread): Parsing macros/catalog.sql
2021-02-01 16:16:08.562920 (MainThread): Parsing macros/adapters.sql
2021-02-01 16:16:08.597656 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 16:16:08.599291 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 16:16:08.609948 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 16:16:08.612105 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 16:16:08.617544 (MainThread): Parsing macros/core.sql
2021-02-01 16:16:08.621593 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 16:16:08.623422 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 16:16:08.625103 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 16:16:08.627018 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 16:16:08.629911 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 16:16:08.640082 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 16:16:08.646595 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 16:16:08.651617 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 16:16:08.669457 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 16:16:08.671303 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 16:16:08.701579 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 16:16:08.709565 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 16:16:08.716154 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 16:16:08.718067 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 16:16:08.734556 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 16:16:08.758796 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 16:16:08.767814 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 16:16:08.769449 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 16:16:08.770381 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 16:16:08.772296 (MainThread): Parsing macros/etc/query.sql
2021-02-01 16:16:08.773298 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 16:16:08.774941 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 16:16:08.819299 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 16:16:08.833899 (MainThread): Partial parsing not enabled
2021-02-01 16:16:08.872534 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:08.896123 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:08.907098 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:08.917953 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:16:08.928869 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:08.941519 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:16:08.952531 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:08.971503 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:09.147561 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-02-01 16:16:09.148450 (MainThread): 
2021-02-01 16:16:09.148773 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:16:09.157415 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-02-01 16:16:09.172286 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-02-01 16:16:09.172444 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-02-01 16:16:09.172542 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-01 16:16:10.318694 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.15 seconds
2021-02-01 16:16:10.348566 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-02-01 16:16:10.796553 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:16:10.808183 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:16:10.808385 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 16:16:10.808528 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-01 16:16:12.300996 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 1.49 seconds
2021-02-01 16:16:12.756896 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 16:16:13.027880 (MainThread): Using snowflake connection "master".
2021-02-01 16:16:13.028044 (MainThread): On master: BEGIN
2021-02-01 16:16:13.028146 (MainThread): Opening a new connection, currently in state init
2021-02-01 16:16:14.106527 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-02-01 16:16:14.107217 (MainThread): On master: COMMIT
2021-02-01 16:16:14.107997 (MainThread): Using snowflake connection "master".
2021-02-01 16:16:14.108400 (MainThread): On master: COMMIT
2021-02-01 16:16:14.903791 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-02-01 16:16:14.904551 (MainThread): On master: Close
2021-02-01 16:16:15.207724 (MainThread): 11:16:15 | Concurrency: 1 threads (target='snowflake')
2021-02-01 16:16:15.208724 (MainThread): 11:16:15 | 
2021-02-01 16:16:15.217284 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:16:15.224107 (Thread-1): 11:16:15 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-02-01 16:16:15.230289 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:15.230983 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:16:15.268785 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 16:16:15.271415 (Thread-1): finished collecting timing info
2021-02-01 16:16:15.322091 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:15.322261 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:16:15.322366 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:16:16.768988 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-02-01 16:16:16.807550 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:16.807794 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:16:16.996639 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-02-01 16:16:17.016716 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:17.017299 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-02-01 16:16:17.203724 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-02-01 16:16:17.240108 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:17.240308 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-02-01 16:16:17.692272 (Thread-1): SQL status: SUCCESS 1 in 0.45 seconds
2021-02-01 16:16:17.710034 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 16:16:17.713824 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:17.713970 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-02-01 16:16:17.944425 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-02-01 16:16:17.944665 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:17.944784 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:16:19.635892 (Thread-1): SQL status: SUCCESS 1 in 1.69 seconds
2021-02-01 16:16:19.638012 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 16:16:19.638256 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:19.638386 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 16:16:19.795715 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-02-01 16:16:19.838754 (Thread-1): finished collecting timing info
2021-02-01 16:16:19.839173 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-02-01 16:16:20.926237 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4904c15-1be2-45cc-b9e7-38808e4ea04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920f56af0>]}
2021-02-01 16:16:20.932472 (Thread-1): 11:16:20 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 5.70s]
2021-02-01 16:16:20.933357 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:16:20.934129 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:16:20.939482 (Thread-1): 11:16:20 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-02-01 16:16:20.942375 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:20.944164 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:16:20.955557 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 16:16:20.955926 (Thread-1): finished collecting timing info
2021-02-01 16:16:20.970994 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:20.971171 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-02-01 16:16:20.971272 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:16:22.092558 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-02-01 16:16:22.110972 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:22.111571 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:16:22.606509 (Thread-1): SQL status: SUCCESS 3 in 0.49 seconds
2021-02-01 16:16:22.610688 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:22.610846 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-02-01 16:16:23.073090 (Thread-1): SQL status: SUCCESS 4 in 0.46 seconds
2021-02-01 16:16:23.090154 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:23.090736 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-02-01 16:16:23.372064 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-02-01 16:16:23.374755 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 16:16:23.376676 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:23.376857 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-02-01 16:16:23.616323 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-02-01 16:16:23.617192 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:23.617741 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-02-01 16:16:25.369142 (Thread-1): SQL status: SUCCESS 1 in 1.75 seconds
2021-02-01 16:16:25.373916 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 16:16:25.374832 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:25.375296 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 16:16:25.882260 (Thread-1): SQL status: SUCCESS 1 in 0.51 seconds
2021-02-01 16:16:25.886279 (Thread-1): finished collecting timing info
2021-02-01 16:16:25.886709 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-02-01 16:16:26.408099 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4904c15-1be2-45cc-b9e7-38808e4ea04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920f22fa0>]}
2021-02-01 16:16:26.419937 (Thread-1): 11:16:26 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 5.46s]
2021-02-01 16:16:26.421239 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:16:26.422446 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:16:26.432912 (Thread-1): 11:16:26 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 16:16:26.435407 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:26.436311 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:16:26.476999 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 16:16:26.477607 (Thread-1): finished collecting timing info
2021-02-01 16:16:26.498616 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:26.498840 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:16:26.498983 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:16:29.874836 (Thread-1): SQL status: SUCCESS 1 in 3.38 seconds
2021-02-01 16:16:29.889243 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:29.889776 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:16:30.234693 (Thread-1): SQL status: SUCCESS 3 in 0.34 seconds
2021-02-01 16:16:30.251222 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:30.252071 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-02-01 16:16:31.391267 (Thread-1): SQL status: SUCCESS 3 in 1.14 seconds
2021-02-01 16:16:31.407824 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:31.408396 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-02-01 16:16:31.939848 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-02-01 16:16:31.952812 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 16:16:31.955534 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:31.955657 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 16:16:33.051952 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-02-01 16:16:33.052274 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:33.052507 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-02-01 16:16:33.707316 (Thread-1): SQL status: SUCCESS 1 in 0.65 seconds
2021-02-01 16:16:33.708818 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:33.709775 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:16:34.991590 (Thread-1): SQL status: SUCCESS 2 in 1.28 seconds
2021-02-01 16:16:34.993552 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 16:16:34.993812 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:34.993943 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 16:16:35.583004 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-02-01 16:16:35.594396 (Thread-1): finished collecting timing info
2021-02-01 16:16:35.595712 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 16:16:35.934682 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4904c15-1be2-45cc-b9e7-38808e4ea04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920f56070>]}
2021-02-01 16:16:35.940888 (Thread-1): 11:16:35 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 9.50s]
2021-02-01 16:16:35.941635 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:16:35.942390 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:16:35.948469 (Thread-1): 11:16:35 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-02-01 16:16:35.949951 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:35.950488 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:16:35.969987 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 16:16:35.970627 (Thread-1): finished collecting timing info
2021-02-01 16:16:35.986659 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:35.986853 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-02-01 16:16:35.986975 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:16:37.065983 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-02-01 16:16:37.079480 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:37.080133 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:16:37.268337 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-02-01 16:16:37.297007 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:37.297406 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-02-01 16:16:37.503399 (Thread-1): SQL status: SUCCESS 2 in 0.21 seconds
2021-02-01 16:16:37.520243 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:37.520800 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-02-01 16:16:37.919873 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-02-01 16:16:37.926234 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 16:16:37.930393 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:37.930904 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-02-01 16:16:38.163335 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-02-01 16:16:38.163993 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:38.164469 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-02-01 16:16:40.111436 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-02-01 16:16:40.116332 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 16:16:40.117132 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:40.117567 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 16:16:40.310315 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-01 16:16:40.322036 (Thread-1): finished collecting timing info
2021-02-01 16:16:40.323288 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-02-01 16:16:40.605072 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4904c15-1be2-45cc-b9e7-38808e4ea04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc92067fdc0>]}
2021-02-01 16:16:40.611180 (Thread-1): 11:16:40 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.65s]
2021-02-01 16:16:40.611970 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:16:40.612794 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:16:40.618065 (Thread-1): 11:16:40 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-02-01 16:16:40.620260 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:40.620846 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:16:40.644852 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 16:16:40.645507 (Thread-1): finished collecting timing info
2021-02-01 16:16:40.659747 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:40.659944 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:16:40.660056 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:16:41.750033 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-02-01 16:16:41.754090 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:41.754259 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:16:42.009341 (Thread-1): SQL status: SUCCESS 3 in 0.25 seconds
2021-02-01 16:16:42.018733 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:42.019098 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-02-01 16:16:42.262105 (Thread-1): SQL status: SUCCESS 3 in 0.24 seconds
2021-02-01 16:16:42.279069 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:42.279619 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-02-01 16:16:42.671533 (Thread-1): SQL status: SUCCESS 1 in 0.39 seconds
2021-02-01 16:16:42.677712 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 16:16:42.682081 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:42.682592 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-02-01 16:16:43.182377 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-02-01 16:16:43.183065 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:43.183829 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:16:44.393614 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-02-01 16:16:44.398549 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 16:16:44.399672 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:44.400276 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 16:16:44.552391 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-02-01 16:16:44.564882 (Thread-1): finished collecting timing info
2021-02-01 16:16:44.566192 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-02-01 16:16:45.127820 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4904c15-1be2-45cc-b9e7-38808e4ea04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920efb7c0>]}
2021-02-01 16:16:45.130429 (Thread-1): 11:16:45 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.51s]
2021-02-01 16:16:45.130759 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:16:45.131108 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 16:16:45.133603 (Thread-1): 11:16:45 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-02-01 16:16:45.134546 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:16:45.134877 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 16:16:45.159716 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 16:16:45.160171 (Thread-1): finished collecting timing info
2021-02-01 16:16:45.171136 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 16:16:45.172372 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:16:45.172631 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-02-01 16:16:45.172772 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:16:46.883403 (Thread-1): SQL status: SUCCESS 1 in 1.71 seconds
2021-02-01 16:16:46.884122 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:16:46.884573 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:16:48.157041 (Thread-1): SQL status: SUCCESS 1 in 1.27 seconds
2021-02-01 16:16:48.162162 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 16:16:48.163040 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:16:48.163483 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 16:16:48.353268 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-01 16:16:48.365617 (Thread-1): finished collecting timing info
2021-02-01 16:16:48.367027 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-02-01 16:16:48.642636 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4904c15-1be2-45cc-b9e7-38808e4ea04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9206f8670>]}
2021-02-01 16:16:48.649179 (Thread-1): 11:16:48 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 3.51s]
2021-02-01 16:16:48.650047 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 16:16:48.650847 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 16:16:48.656213 (Thread-1): 11:16:48 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-02-01 16:16:48.658508 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:16:48.659081 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 16:16:48.682128 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 16:16:48.682715 (Thread-1): finished collecting timing info
2021-02-01 16:16:48.694396 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-02-01 16:16:48.699164 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:16:48.699310 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-02-01 16:16:48.699410 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:16:50.037707 (Thread-1): SQL status: SUCCESS 1 in 1.34 seconds
2021-02-01 16:16:50.044742 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 16:16:50.048461 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:16:50.048750 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-02-01 16:16:50.261628 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-02-01 16:16:50.262291 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:16:50.262717 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:16:51.887896 (Thread-1): SQL status: SUCCESS 1 in 1.62 seconds
2021-02-01 16:16:51.890273 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 16:16:51.890648 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:16:51.890853 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 16:16:52.075753 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-02-01 16:16:52.094260 (Thread-1): finished collecting timing info
2021-02-01 16:16:52.095741 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-02-01 16:16:52.363042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4904c15-1be2-45cc-b9e7-38808e4ea04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920681eb0>]}
2021-02-01 16:16:52.369926 (Thread-1): 11:16:52 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.70s]
2021-02-01 16:16:52.370910 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 16:16:52.379033 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:16:52.379660 (MainThread): Using snowflake connection "master".
2021-02-01 16:16:52.379916 (MainThread): On master: BEGIN
2021-02-01 16:16:52.380231 (MainThread): Opening a new connection, currently in state closed
2021-02-01 16:16:53.249361 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-02-01 16:16:53.250096 (MainThread): On master: COMMIT
2021-02-01 16:16:53.250818 (MainThread): Using snowflake connection "master".
2021-02-01 16:16:53.251241 (MainThread): On master: COMMIT
2021-02-01 16:16:53.646001 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-02-01 16:16:53.646728 (MainThread): On master: Close
2021-02-01 16:16:53.935483 (MainThread): 11:16:53 | 
2021-02-01 16:16:53.936315 (MainThread): 11:16:53 | Finished running 7 snowflake_timetravel_table models in 44.79s.
2021-02-01 16:16:53.936876 (MainThread): Connection 'master' was properly closed.
2021-02-01 16:16:53.937260 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-02-01 16:16:53.984463 (MainThread): 
2021-02-01 16:16:53.984649 (MainThread): Completed successfully
2021-02-01 16:16:53.984763 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-02-01 16:16:53.984969 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920f08e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920f08c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc920f085e0>]}
2021-02-01 16:16:53.985187 (MainThread): Flushing usage events
2021-02-01 16:16:56.730114 (MainThread): Running with dbt=0.18.1
2021-02-01 16:16:57.219176 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-02-01 16:16:57.219968 (MainThread): Tracking: do not track
2021-02-01 16:16:57.255619 (MainThread): Partial parsing not enabled
2021-02-01 16:16:57.256858 (MainThread): Parsing macros/catalog.sql
2021-02-01 16:16:57.259748 (MainThread): Parsing macros/adapters.sql
2021-02-01 16:16:57.295069 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 16:16:57.296774 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 16:16:57.307798 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 16:16:57.310075 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 16:16:57.315284 (MainThread): Parsing macros/core.sql
2021-02-01 16:16:57.319334 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 16:16:57.321240 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 16:16:57.323860 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 16:16:57.326458 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 16:16:57.330447 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 16:16:57.341938 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 16:16:57.351871 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 16:16:57.357746 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 16:16:57.378669 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 16:16:57.380898 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 16:16:57.413938 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 16:16:57.420761 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 16:16:57.426662 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 16:16:57.428480 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 16:16:57.443278 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 16:16:57.469836 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 16:16:57.480378 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 16:16:57.482271 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 16:16:57.483370 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 16:16:57.486603 (MainThread): Parsing macros/etc/query.sql
2021-02-01 16:16:57.488442 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 16:16:57.490804 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 16:16:57.540053 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 16:16:57.555318 (MainThread): Partial parsing not enabled
2021-02-01 16:16:57.592613 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:57.614493 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:16:57.624851 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:16:57.634980 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:16:57.645135 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:16:57.655197 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:16:57.665296 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:16:57.683388 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:57.856058 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-02-01 16:16:57.856785 (MainThread): 
2021-02-01 16:16:57.857067 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:16:57.866382 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:16:57.880019 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:16:57.880159 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 16:16:57.880249 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-01 16:16:59.054752 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.17 seconds
2021-02-01 16:16:59.490615 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 16:16:59.819688 (MainThread): 11:16:59 | Concurrency: 1 threads (target='snowflake')
2021-02-01 16:16:59.820035 (MainThread): 11:16:59 | 
2021-02-01 16:16:59.822840 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:16:59.823053 (Thread-1): 11:16:59 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 16:16:59.823424 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:59.823590 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:16:59.846181 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 16:16:59.847164 (Thread-1): finished collecting timing info
2021-02-01 16:16:59.848170 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:16:59.848274 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 16:16:59.848376 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:17:01.068476 (Thread-1): SQL status: SUCCESS 1 in 1.22 seconds
2021-02-01 16:17:01.069199 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:17:01.069643 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-02-01T16:16:26.478071Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-02-01 16:17:01.445300 (Thread-1): SQL status: SUCCESS 1 in 0.38 seconds
2021-02-01 16:17:01.448263 (Thread-1): finished collecting timing info
2021-02-01 16:17:01.449734 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-02-01 16:17:01.920372 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 16:17:02.537993 (Thread-1): 11:17:02 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 2.71s]
2021-02-01 16:17:02.538802 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:17:02.544160 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:17:02.545668 (MainThread): 11:17:02 | 
2021-02-01 16:17:02.546328 (MainThread): 11:17:02 | Finished running 1 test in 4.69s.
2021-02-01 16:17:02.546830 (MainThread): Connection 'master' was properly closed.
2021-02-01 16:17:02.547200 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-02-01 16:17:02.565937 (MainThread): 
2021-02-01 16:17:02.566620 (MainThread): Completed successfully
2021-02-01 16:17:02.567180 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-01 16:17:02.568158 (MainThread): Flushing usage events
2021-02-01 16:17:59.107461 (MainThread): Running with dbt=0.19.0
2021-02-01 16:17:59.650007 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-02-01 16:17:59.650338 (MainThread): Tracking: tracking
2021-02-01 16:17:59.650480 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57043a65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f570c6cbeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57043b6790>]}
2021-02-01 16:17:59.651080 (MainThread): Set downloads directory='/tmp/dbt-downloads-yyr6h572'
2021-02-01 16:17:59.662108 (MainThread): Installing ../../
2021-02-01 16:17:59.664390 (MainThread):   Creating symlink to local dependency.
2021-02-01 16:17:59.664764 (MainThread):   Installed from <local @ ../../>

2021-02-01 16:17:59.665181 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c12f9266-07b4-4418-804b-eac5af188af2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57043461f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5704346ee0>]}
2021-02-01 16:17:59.666289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57043a65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57043462b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5704346490>]}
2021-02-01 16:17:59.666938 (MainThread): Flushing usage events
2021-02-01 16:18:01.329845 (MainThread): Running with dbt=0.19.0
2021-02-01 16:18:01.813310 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-01 16:18:01.814067 (MainThread): Tracking: tracking
2021-02-01 16:18:01.814387 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ccefa970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8d2c275e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cce8a730>]}
2021-02-01 16:18:01.851178 (MainThread): Partial parsing not enabled
2021-02-01 16:18:01.852320 (MainThread): Parsing macros/catalog.sql
2021-02-01 16:18:01.855402 (MainThread): Parsing macros/adapters.sql
2021-02-01 16:18:01.890773 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 16:18:01.892472 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 16:18:01.902787 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 16:18:01.905112 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 16:18:01.910330 (MainThread): Parsing macros/core.sql
2021-02-01 16:18:01.914557 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 16:18:01.916386 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 16:18:01.917983 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 16:18:01.919937 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 16:18:01.922903 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 16:18:01.932197 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 16:18:01.938489 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 16:18:01.943479 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 16:18:01.961472 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 16:18:01.963229 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 16:18:01.996752 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 16:18:02.003559 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 16:18:02.009847 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 16:18:02.011699 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 16:18:02.025888 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 16:18:02.047204 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 16:18:02.056068 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 16:18:02.057662 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 16:18:02.058575 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 16:18:02.060595 (MainThread): Parsing macros/etc/query.sql
2021-02-01 16:18:02.061641 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 16:18:02.063322 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 16:18:02.110378 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 16:18:02.126927 (MainThread): Partial parsing not enabled
2021-02-01 16:18:02.168599 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:02.190225 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:02.200631 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:02.213750 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:18:02.225853 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:02.237132 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:18:02.248206 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:02.268408 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:02.405294 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cbaff370>]}
2021-02-01 16:18:02.446563 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-01 16:18:02.447421 (MainThread): 
2021-02-01 16:18:02.447738 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:18:02.456510 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-02-01 16:18:02.472807 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-02-01 16:18:02.472966 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-02-01 16:18:02.473063 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-01 16:18:03.569838 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.10 seconds
2021-02-01 16:18:03.600182 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-02-01 16:18:04.057328 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:18:04.068616 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:18:04.068832 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 16:18:04.068966 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-01 16:18:05.203145 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 1.13 seconds
2021-02-01 16:18:05.580361 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 16:18:06.236005 (MainThread): Using snowflake connection "master".
2021-02-01 16:18:06.236242 (MainThread): On master: BEGIN
2021-02-01 16:18:06.236375 (MainThread): Opening a new connection, currently in state init
2021-02-01 16:18:07.449636 (MainThread): SQL status: SUCCESS 1 in 1.21 seconds
2021-02-01 16:18:07.450399 (MainThread): On master: COMMIT
2021-02-01 16:18:07.451124 (MainThread): Using snowflake connection "master".
2021-02-01 16:18:07.451543 (MainThread): On master: COMMIT
2021-02-01 16:18:07.771962 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-02-01 16:18:07.772757 (MainThread): On master: Close
2021-02-01 16:18:08.068349 (MainThread): 11:18:08 | Concurrency: 1 threads (target='snowflake')
2021-02-01 16:18:08.069321 (MainThread): 11:18:08 | 
2021-02-01 16:18:08.075845 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:18:08.082206 (Thread-1): 11:18:08 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-02-01 16:18:08.083801 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:08.084511 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:18:08.128523 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 16:18:08.128911 (Thread-1): finished collecting timing info
2021-02-01 16:18:08.176648 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:08.176875 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:18:08.176978 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:09.995345 (Thread-1): SQL status: SUCCESS 1 in 1.82 seconds
2021-02-01 16:18:10.011592 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:10.011808 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:18:10.212337 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-02-01 16:18:10.241530 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:10.241915 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-02-01 16:18:10.435651 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-02-01 16:18:10.479515 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:10.479764 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-02-01 16:18:10.728073 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-02-01 16:18:10.771435 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 16:18:10.772599 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:10.772737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-02-01 16:18:10.961641 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-01 16:18:10.962299 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:10.962773 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:18:12.053998 (Thread-1): SQL status: SUCCESS 1 in 1.09 seconds
2021-02-01 16:18:12.059328 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 16:18:12.060267 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:12.060733 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 16:18:12.256486 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-02-01 16:18:12.291867 (Thread-1): finished collecting timing info
2021-02-01 16:18:12.292238 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-02-01 16:18:12.571459 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ca15b7f0>]}
2021-02-01 16:18:12.578229 (Thread-1): 11:18:12 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.49s]
2021-02-01 16:18:12.579148 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 16:18:12.579921 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:18:12.585941 (Thread-1): 11:18:12 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-02-01 16:18:12.587535 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:12.588144 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:18:12.604976 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 16:18:12.605457 (Thread-1): finished collecting timing info
2021-02-01 16:18:12.620549 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:12.620706 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-02-01 16:18:12.620818 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:13.796686 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-02-01 16:18:13.809486 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:13.810038 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:18:14.006374 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-02-01 16:18:14.023738 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:14.024368 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-02-01 16:18:14.216953 (Thread-1): SQL status: SUCCESS 4 in 0.19 seconds
2021-02-01 16:18:14.234922 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:14.235524 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-02-01 16:18:14.550865 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-02-01 16:18:14.556924 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 16:18:14.559245 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:14.559447 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-02-01 16:18:15.023817 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-02-01 16:18:15.024544 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:15.024982 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-02-01 16:18:16.354555 (Thread-1): SQL status: SUCCESS 1 in 1.33 seconds
2021-02-01 16:18:16.359381 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 16:18:16.360202 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:16.360643 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 16:18:16.514789 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-02-01 16:18:16.526565 (Thread-1): finished collecting timing info
2021-02-01 16:18:16.527828 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-02-01 16:18:16.838999 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ca164520>]}
2021-02-01 16:18:16.845959 (Thread-1): 11:18:16 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 4.25s]
2021-02-01 16:18:16.846989 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 16:18:16.847745 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:18:16.853642 (Thread-1): 11:18:16 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 16:18:16.855129 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:16.855668 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:18:16.876903 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 16:18:16.877502 (Thread-1): finished collecting timing info
2021-02-01 16:18:16.891975 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:16.892139 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:18:16.892241 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:18.096961 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-02-01 16:18:18.109470 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:18.110011 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:18:18.610520 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-02-01 16:18:18.626010 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:18.626823 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-02-01 16:18:19.123720 (Thread-1): SQL status: SUCCESS 3 in 0.50 seconds
2021-02-01 16:18:19.131536 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:19.131737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-02-01 16:18:19.631963 (Thread-1): SQL status: SUCCESS 1 in 0.50 seconds
2021-02-01 16:18:19.661699 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 16:18:19.663721 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:19.664039 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 16:18:20.061582 (Thread-1): SQL status: SUCCESS 1 in 0.40 seconds
2021-02-01 16:18:20.062274 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:20.062721 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-02-01 16:18:20.654216 (Thread-1): SQL status: SUCCESS 1 in 0.59 seconds
2021-02-01 16:18:20.654598 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:20.654784 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:18:21.271992 (Thread-1): SQL status: SUCCESS 2 in 0.62 seconds
2021-02-01 16:18:21.280671 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 16:18:21.281765 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:21.282513 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 16:18:21.711246 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-02-01 16:18:21.725392 (Thread-1): finished collecting timing info
2021-02-01 16:18:21.726745 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 16:18:22.102492 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c88d60a0>]}
2021-02-01 16:18:22.108661 (Thread-1): 11:18:22 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 5.25s]
2021-02-01 16:18:22.109180 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:18:22.109644 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:18:22.113739 (Thread-1): 11:18:22 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-02-01 16:18:22.114618 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:22.114921 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:18:22.134562 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 16:18:22.135058 (Thread-1): finished collecting timing info
2021-02-01 16:18:22.160627 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:22.160781 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-02-01 16:18:22.160880 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:23.235289 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-02-01 16:18:23.251661 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:23.252386 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:18:23.727755 (Thread-1): SQL status: SUCCESS 3 in 0.47 seconds
2021-02-01 16:18:23.744052 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:23.744607 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-02-01 16:18:23.935962 (Thread-1): SQL status: SUCCESS 2 in 0.19 seconds
2021-02-01 16:18:23.952325 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:23.952984 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-02-01 16:18:24.382961 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-02-01 16:18:24.389351 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 16:18:24.393247 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:24.393534 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-02-01 16:18:24.593390 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-02-01 16:18:24.594086 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:24.594524 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-02-01 16:18:26.594341 (Thread-1): SQL status: SUCCESS 1 in 2.00 seconds
2021-02-01 16:18:26.599193 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 16:18:26.599996 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:26.600518 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 16:18:26.787600 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-01 16:18:26.801023 (Thread-1): finished collecting timing info
2021-02-01 16:18:26.802369 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-02-01 16:18:27.076664 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c88d6be0>]}
2021-02-01 16:18:27.082925 (Thread-1): 11:18:27 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.96s]
2021-02-01 16:18:27.083674 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 16:18:27.084400 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:18:27.090296 (Thread-1): 11:18:27 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-02-01 16:18:27.091782 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:27.092373 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:18:27.111675 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 16:18:27.112415 (Thread-1): finished collecting timing info
2021-02-01 16:18:27.127915 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:27.128080 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 16:18:27.128183 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:28.238610 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-02-01 16:18:28.264463 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:28.265001 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:18:28.434212 (Thread-1): SQL status: SUCCESS 3 in 0.17 seconds
2021-02-01 16:18:28.451081 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:28.451672 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-02-01 16:18:28.645123 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-02-01 16:18:28.661718 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:28.662325 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-02-01 16:18:28.928826 (Thread-1): SQL status: SUCCESS 1 in 0.27 seconds
2021-02-01 16:18:28.934871 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 16:18:28.939105 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:28.939618 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-02-01 16:18:29.359204 (Thread-1): SQL status: SUCCESS 1 in 0.42 seconds
2021-02-01 16:18:29.359883 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:29.360352 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:18:30.416166 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-02-01 16:18:30.421049 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 16:18:30.421876 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:30.422339 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 16:18:30.601419 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-02-01 16:18:30.609900 (Thread-1): finished collecting timing info
2021-02-01 16:18:30.610412 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-02-01 16:18:32.033131 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c88f7610>]}
2021-02-01 16:18:32.040201 (Thread-1): 11:18:32 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.94s]
2021-02-01 16:18:32.041000 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 16:18:32.041748 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 16:18:32.047086 (Thread-1): 11:18:32 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-02-01 16:18:32.050121 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:18:32.051080 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 16:18:32.070456 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 16:18:32.071181 (Thread-1): finished collecting timing info
2021-02-01 16:18:32.082480 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 16:18:32.083383 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:18:32.083487 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-02-01 16:18:32.083578 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:33.246210 (Thread-1): SQL status: SUCCESS 1 in 1.16 seconds
2021-02-01 16:18:33.246421 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:18:33.246537 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:18:34.371095 (Thread-1): SQL status: SUCCESS 1 in 1.12 seconds
2021-02-01 16:18:34.372570 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 16:18:34.372801 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:18:34.372918 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 16:18:34.525763 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-02-01 16:18:34.535347 (Thread-1): finished collecting timing info
2021-02-01 16:18:34.536121 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-02-01 16:18:34.801577 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ca174dc0>]}
2021-02-01 16:18:34.807697 (Thread-1): 11:18:34 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 2.75s]
2021-02-01 16:18:34.808501 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 16:18:34.809195 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 16:18:34.815537 (Thread-1): 11:18:34 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-02-01 16:18:34.817115 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:18:34.817676 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 16:18:34.834767 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 16:18:34.835231 (Thread-1): finished collecting timing info
2021-02-01 16:18:34.847330 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-02-01 16:18:34.851768 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:18:34.851894 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-02-01 16:18:34.851989 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:35.832186 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-02-01 16:18:35.838683 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 16:18:35.843014 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:18:35.843533 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-02-01 16:18:36.421643 (Thread-1): SQL status: SUCCESS 1 in 0.58 seconds
2021-02-01 16:18:36.422306 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:18:36.422729 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 16:18:37.553917 (Thread-1): SQL status: SUCCESS 1 in 1.13 seconds
2021-02-01 16:18:37.555866 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 16:18:37.556098 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:18:37.556217 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 16:18:37.704781 (Thread-1): SQL status: SUCCESS 1 in 0.15 seconds
2021-02-01 16:18:37.716708 (Thread-1): finished collecting timing info
2021-02-01 16:18:37.717948 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-02-01 16:18:37.985156 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291caee7-7f11-47f2-ac3e-50fc7f601a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c884eca0>]}
2021-02-01 16:18:37.991294 (Thread-1): 11:18:37 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.17s]
2021-02-01 16:18:37.992079 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 16:18:37.997273 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:18:37.998254 (MainThread): Using snowflake connection "master".
2021-02-01 16:18:37.998735 (MainThread): On master: BEGIN
2021-02-01 16:18:37.999184 (MainThread): Opening a new connection, currently in state closed
2021-02-01 16:18:38.983715 (MainThread): SQL status: SUCCESS 1 in 0.98 seconds
2021-02-01 16:18:38.984482 (MainThread): On master: COMMIT
2021-02-01 16:18:38.985214 (MainThread): Using snowflake connection "master".
2021-02-01 16:18:38.985628 (MainThread): On master: COMMIT
2021-02-01 16:18:39.499172 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-02-01 16:18:39.499951 (MainThread): On master: Close
2021-02-01 16:18:40.035327 (MainThread): 11:18:40 | 
2021-02-01 16:18:40.036237 (MainThread): 11:18:40 | Finished running 7 snowflake_timetravel_table models in 37.59s.
2021-02-01 16:18:40.036918 (MainThread): Connection 'master' was properly closed.
2021-02-01 16:18:40.037368 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-02-01 16:18:40.106364 (MainThread): 
2021-02-01 16:18:40.106526 (MainThread): Completed successfully
2021-02-01 16:18:40.106677 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-02-01 16:18:40.106900 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8cbcf7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c88ad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c88adb20>]}
2021-02-01 16:18:40.107101 (MainThread): Flushing usage events
2021-02-01 16:18:42.038490 (MainThread): Running with dbt=0.19.0
2021-02-01 16:18:42.521434 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-02-01 16:18:42.522213 (MainThread): Tracking: do not track
2021-02-01 16:18:42.559623 (MainThread): Partial parsing not enabled
2021-02-01 16:18:42.560861 (MainThread): Parsing macros/catalog.sql
2021-02-01 16:18:42.563756 (MainThread): Parsing macros/adapters.sql
2021-02-01 16:18:42.601703 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 16:18:42.603560 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 16:18:42.616963 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 16:18:42.619461 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 16:18:42.625164 (MainThread): Parsing macros/core.sql
2021-02-01 16:18:42.629504 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 16:18:42.631420 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 16:18:42.633125 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 16:18:42.635144 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 16:18:42.638077 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 16:18:42.647508 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 16:18:42.654087 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 16:18:42.658958 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 16:18:42.687790 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 16:18:42.691868 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 16:18:42.732433 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 16:18:42.739741 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 16:18:42.746256 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 16:18:42.748188 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 16:18:42.762876 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 16:18:42.784126 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 16:18:42.792999 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 16:18:42.794595 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 16:18:42.795520 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 16:18:42.797443 (MainThread): Parsing macros/etc/query.sql
2021-02-01 16:18:42.798449 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 16:18:42.800097 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 16:18:42.843736 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 16:18:42.858432 (MainThread): Partial parsing not enabled
2021-02-01 16:18:42.895942 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:42.916282 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 16:18:42.926265 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 16:18:42.936592 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 16:18:42.946740 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 16:18:42.956996 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 16:18:42.967484 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 16:18:42.988037 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:43.155904 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-01 16:18:43.156636 (MainThread): 
2021-02-01 16:18:43.156926 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:18:43.168551 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:18:43.183056 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 16:18:43.183203 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 16:18:43.183293 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-01 16:18:44.399735 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.22 seconds
2021-02-01 16:18:44.749281 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 16:18:45.042452 (MainThread): 11:18:45 | Concurrency: 1 threads (target='snowflake')
2021-02-01 16:18:45.042758 (MainThread): 11:18:45 | 
2021-02-01 16:18:45.044567 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:18:45.044810 (Thread-1): 11:18:45 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 16:18:45.045227 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:45.045405 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:18:45.071616 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 16:18:45.071982 (Thread-1): finished collecting timing info
2021-02-01 16:18:45.072872 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:45.073057 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 16:18:45.073186 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 16:18:47.071178 (Thread-1): SQL status: SUCCESS 1 in 2.00 seconds
2021-02-01 16:18:47.071898 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 16:18:47.072385 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-02-01T16:18:16.877975Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-02-01 16:18:47.604546 (Thread-1): SQL status: SUCCESS 1 in 0.53 seconds
2021-02-01 16:18:47.607986 (Thread-1): finished collecting timing info
2021-02-01 16:18:47.610164 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-02-01 16:18:48.101590 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 16:18:48.911921 (Thread-1): 11:18:48 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 3.87s]
2021-02-01 16:18:48.912170 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 16:18:48.913661 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 16:18:48.913946 (MainThread): 11:18:48 | 
2021-02-01 16:18:48.914059 (MainThread): 11:18:48 | Finished running 1 test in 5.76s.
2021-02-01 16:18:48.914152 (MainThread): Connection 'master' was properly closed.
2021-02-01 16:18:48.914220 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-02-01 16:18:48.957856 (MainThread): 
2021-02-01 16:18:48.958021 (MainThread): Completed successfully
2021-02-01 16:18:48.958126 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-01 16:18:48.958316 (MainThread): Flushing usage events
2021-02-01 20:47:53.614487 (MainThread): Running with dbt=0.18.1
2021-02-01 20:47:54.116066 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-02-01 20:47:54.116389 (MainThread): Tracking: tracking
2021-02-01 20:47:54.116538 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcef7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c03c84070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce8a430>]}
2021-02-01 20:47:54.117154 (MainThread): Set downloads directory='/tmp/dbt-downloads-1s5ivq86'
2021-02-01 20:47:54.128388 (MainThread): Installing ../../
2021-02-01 20:47:54.128702 (MainThread):   Creating symlink to local dependency.
2021-02-01 20:47:54.128826 (MainThread):   Installed from <local @ ../../>

2021-02-01 20:47:54.128972 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '069a8bf5-113b-4c1a-a139-335e89530d19', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce8a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce8a4c0>]}
2021-02-01 20:47:54.129300 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfcef7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce8ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfce8d220>]}
2021-02-01 20:47:54.129464 (MainThread): Flushing usage events
2021-02-01 20:47:55.821254 (MainThread): Running with dbt=0.18.1
2021-02-01 20:47:56.331466 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-01 20:47:56.332282 (MainThread): Tracking: tracking
2021-02-01 20:47:56.332594 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8e18a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f94f97310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8e18d520>]}
2021-02-01 20:47:56.370358 (MainThread): Partial parsing not enabled
2021-02-01 20:47:56.371479 (MainThread): Parsing macros/catalog.sql
2021-02-01 20:47:56.374566 (MainThread): Parsing macros/adapters.sql
2021-02-01 20:47:56.411067 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 20:47:56.412890 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 20:47:56.425400 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 20:47:56.427809 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 20:47:56.433427 (MainThread): Parsing macros/core.sql
2021-02-01 20:47:56.437702 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 20:47:56.439671 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 20:47:56.441431 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 20:47:56.443834 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 20:47:56.447090 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 20:47:56.457579 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 20:47:56.465121 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 20:47:56.470953 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 20:47:56.493253 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 20:47:56.495917 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 20:47:56.535597 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 20:47:56.544655 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 20:47:56.557753 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 20:47:56.560106 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 20:47:56.577112 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 20:47:56.601207 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 20:47:56.612218 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 20:47:56.614086 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 20:47:56.615205 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 20:47:56.617489 (MainThread): Parsing macros/etc/query.sql
2021-02-01 20:47:56.618665 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 20:47:56.621021 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 20:47:56.671106 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 20:47:56.688733 (MainThread): Partial parsing not enabled
2021-02-01 20:47:56.731210 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:47:56.756164 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:47:56.767811 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:47:56.779838 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:47:56.791684 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:47:56.803198 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:47:56.814544 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:47:56.834929 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:47:57.025179 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-02-01 20:47:57.026051 (MainThread): 
2021-02-01 20:47:57.026357 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:47:57.035422 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-02-01 20:47:57.051703 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-02-01 20:47:57.051857 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-02-01 20:47:57.051961 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-01 20:47:58.118727 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.07 seconds
2021-02-01 20:47:58.146567 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-02-01 20:47:58.610325 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:47:58.619914 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:47:58.620101 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 20:47:58.620210 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-01 20:47:59.831255 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 1.21 seconds
2021-02-01 20:48:00.205799 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 20:48:00.552502 (MainThread): Using snowflake connection "master".
2021-02-01 20:48:00.552699 (MainThread): On master: BEGIN
2021-02-01 20:48:00.552796 (MainThread): Opening a new connection, currently in state init
2021-02-01 20:48:01.715698 (MainThread): SQL status: SUCCESS 1 in 1.16 seconds
2021-02-01 20:48:01.716506 (MainThread): On master: COMMIT
2021-02-01 20:48:01.717247 (MainThread): Using snowflake connection "master".
2021-02-01 20:48:01.717667 (MainThread): On master: COMMIT
2021-02-01 20:48:02.107592 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-02-01 20:48:02.108401 (MainThread): On master: Close
2021-02-01 20:48:02.394266 (MainThread): 15:48:02 | Concurrency: 1 threads (target='snowflake')
2021-02-01 20:48:02.395349 (MainThread): 15:48:02 | 
2021-02-01 20:48:02.404859 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:48:02.413068 (Thread-1): 15:48:02 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-02-01 20:48:02.415048 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:02.415696 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:48:02.445673 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 20:48:02.446057 (Thread-1): finished collecting timing info
2021-02-01 20:48:02.495704 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:02.495876 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:48:02.496001 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:03.871804 (Thread-1): SQL status: SUCCESS 1 in 1.38 seconds
2021-02-01 20:48:03.903845 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:03.904033 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:48:04.122155 (Thread-1): SQL status: SUCCESS 3 in 0.22 seconds
2021-02-01 20:48:04.143776 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:04.144155 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-02-01 20:48:04.329221 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-02-01 20:48:04.365767 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:04.366013 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-02-01 20:48:04.621232 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-02-01 20:48:04.656605 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 20:48:04.657695 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:04.657868 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-02-01 20:48:04.852969 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-01 20:48:04.853140 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:04.853237 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:48:06.416461 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-02-01 20:48:06.422438 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 20:48:06.423304 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:06.423826 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 20:48:06.617394 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-01 20:48:06.641938 (Thread-1): finished collecting timing info
2021-02-01 20:48:06.642273 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-02-01 20:48:06.909775 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2df0f5-70cc-4108-8375-c0ba77eff773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c4d6c70>]}
2021-02-01 20:48:06.916645 (Thread-1): 15:48:06 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.49s]
2021-02-01 20:48:06.917257 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:48:06.917721 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:48:06.921162 (Thread-1): 15:48:06 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-02-01 20:48:06.921961 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:06.922185 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:48:06.934719 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 20:48:06.935121 (Thread-1): finished collecting timing info
2021-02-01 20:48:06.950244 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:06.950483 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-02-01 20:48:06.950630 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:08.016788 (Thread-1): SQL status: SUCCESS 1 in 1.07 seconds
2021-02-01 20:48:08.031479 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:08.032124 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:48:08.234867 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-02-01 20:48:08.250605 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:08.251000 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-02-01 20:48:08.537991 (Thread-1): SQL status: SUCCESS 4 in 0.29 seconds
2021-02-01 20:48:08.541505 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:08.541624 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-02-01 20:48:08.762624 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-02-01 20:48:08.769565 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 20:48:08.774638 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:08.775267 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-02-01 20:48:08.977159 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-02-01 20:48:08.977824 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:08.978283 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-02-01 20:48:10.190690 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-02-01 20:48:10.196156 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 20:48:10.197027 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:10.197475 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 20:48:10.366566 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-02-01 20:48:10.372096 (Thread-1): finished collecting timing info
2021-02-01 20:48:10.372717 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-02-01 20:48:10.651150 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2df0f5-70cc-4108-8375-c0ba77eff773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c523640>]}
2021-02-01 20:48:10.660122 (Thread-1): 15:48:10 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.73s]
2021-02-01 20:48:10.660664 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:48:10.661094 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:48:10.664274 (Thread-1): 15:48:10 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 20:48:10.665258 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:10.665516 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:48:10.676932 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 20:48:10.677368 (Thread-1): finished collecting timing info
2021-02-01 20:48:10.694290 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:10.694474 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:48:10.694585 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:11.746925 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-02-01 20:48:11.751231 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:11.751428 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:48:11.928822 (Thread-1): SQL status: SUCCESS 3 in 0.18 seconds
2021-02-01 20:48:11.933166 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:11.933316 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-02-01 20:48:12.122121 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-02-01 20:48:12.141632 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:12.142106 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-02-01 20:48:12.366852 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-02-01 20:48:12.392350 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 20:48:12.393913 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:12.394077 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 20:48:12.604003 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-02-01 20:48:12.604811 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:12.605465 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-02-01 20:48:13.036993 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-02-01 20:48:13.037830 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:13.038290 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:48:13.624755 (Thread-1): SQL status: SUCCESS 2 in 0.59 seconds
2021-02-01 20:48:13.631745 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 20:48:13.632642 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:13.633092 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 20:48:14.242243 (Thread-1): SQL status: SUCCESS 1 in 0.61 seconds
2021-02-01 20:48:14.254541 (Thread-1): finished collecting timing info
2021-02-01 20:48:14.255965 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 20:48:14.520112 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2df0f5-70cc-4108-8375-c0ba77eff773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c400940>]}
2021-02-01 20:48:14.527578 (Thread-1): 15:48:14 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 3.85s]
2021-02-01 20:48:14.528660 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:48:14.529387 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:48:14.535978 (Thread-1): 15:48:14 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-02-01 20:48:14.537426 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:14.537748 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:48:14.553499 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 20:48:14.554044 (Thread-1): finished collecting timing info
2021-02-01 20:48:14.571017 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:14.571197 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-02-01 20:48:14.571318 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:15.673458 (Thread-1): SQL status: SUCCESS 1 in 1.10 seconds
2021-02-01 20:48:15.687171 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:15.687528 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:48:16.002356 (Thread-1): SQL status: SUCCESS 3 in 0.31 seconds
2021-02-01 20:48:16.018414 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:16.018804 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-02-01 20:48:16.247948 (Thread-1): SQL status: SUCCESS 2 in 0.23 seconds
2021-02-01 20:48:16.264495 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:16.264940 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-02-01 20:48:16.491070 (Thread-1): SQL status: SUCCESS 1 in 0.23 seconds
2021-02-01 20:48:16.497986 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 20:48:16.502902 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:16.504169 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-02-01 20:48:16.713368 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-02-01 20:48:16.714733 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:16.715565 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-02-01 20:48:17.948561 (Thread-1): SQL status: SUCCESS 1 in 1.23 seconds
2021-02-01 20:48:17.953973 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 20:48:17.954829 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:17.955282 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 20:48:18.159905 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-02-01 20:48:18.163689 (Thread-1): finished collecting timing info
2021-02-01 20:48:18.164127 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-02-01 20:48:18.454564 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2df0f5-70cc-4108-8375-c0ba77eff773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c47aee0>]}
2021-02-01 20:48:18.462335 (Thread-1): 15:48:18 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 3.92s]
2021-02-01 20:48:18.463451 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:48:18.464580 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:48:18.469175 (Thread-1): 15:48:18 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-02-01 20:48:18.470145 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:18.470460 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:48:18.485778 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 20:48:18.486308 (Thread-1): finished collecting timing info
2021-02-01 20:48:18.501699 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:18.501849 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:48:18.501976 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:19.534609 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-02-01 20:48:19.548996 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:19.549661 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:48:19.747632 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-02-01 20:48:19.767076 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:19.767442 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-02-01 20:48:19.954263 (Thread-1): SQL status: SUCCESS 3 in 0.19 seconds
2021-02-01 20:48:19.972778 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:19.973132 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-02-01 20:48:20.210264 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-02-01 20:48:20.216751 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 20:48:20.225557 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:20.226257 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-02-01 20:48:20.412712 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-01 20:48:20.413008 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:20.413175 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:48:21.615695 (Thread-1): SQL status: SUCCESS 1 in 1.20 seconds
2021-02-01 20:48:21.621874 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 20:48:21.623207 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:21.623704 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 20:48:21.767941 (Thread-1): SQL status: SUCCESS 1 in 0.14 seconds
2021-02-01 20:48:21.780801 (Thread-1): finished collecting timing info
2021-02-01 20:48:21.781601 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-02-01 20:48:22.041703 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2df0f5-70cc-4108-8375-c0ba77eff773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c4e69a0>]}
2021-02-01 20:48:22.049113 (Thread-1): 15:48:22 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 3.57s]
2021-02-01 20:48:22.050353 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:48:22.051250 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 20:48:22.056796 (Thread-1): 15:48:22 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-02-01 20:48:22.057940 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:48:22.058349 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 20:48:22.070236 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 20:48:22.070743 (Thread-1): finished collecting timing info
2021-02-01 20:48:22.082321 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 20:48:22.083465 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:48:22.083630 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-02-01 20:48:22.083756 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:22.950512 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-02-01 20:48:22.951221 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:48:22.951672 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:48:24.000109 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-02-01 20:48:24.005548 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 20:48:24.006440 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:48:24.006901 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 20:48:24.175843 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-02-01 20:48:24.190923 (Thread-1): finished collecting timing info
2021-02-01 20:48:24.192427 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-02-01 20:48:24.458471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2df0f5-70cc-4108-8375-c0ba77eff773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c43d280>]}
2021-02-01 20:48:24.465795 (Thread-1): 15:48:24 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 2.40s]
2021-02-01 20:48:24.466575 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 20:48:24.467389 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 20:48:24.473588 (Thread-1): 15:48:24 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-02-01 20:48:24.475229 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:48:24.475792 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 20:48:24.493633 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 20:48:24.494118 (Thread-1): finished collecting timing info
2021-02-01 20:48:24.506708 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-02-01 20:48:24.511309 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:48:24.511462 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-02-01 20:48:24.511563 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:25.444979 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-02-01 20:48:25.456621 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 20:48:25.461951 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:48:25.462452 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-02-01 20:48:25.643686 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-02-01 20:48:25.644116 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:48:25.644367 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:48:26.601416 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-02-01 20:48:26.606653 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 20:48:26.607485 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:48:26.608047 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 20:48:26.770622 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-02-01 20:48:26.783745 (Thread-1): finished collecting timing info
2021-02-01 20:48:26.785192 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-02-01 20:48:27.085611 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad2df0f5-70cc-4108-8375-c0ba77eff773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c4d68e0>]}
2021-02-01 20:48:27.088100 (Thread-1): 15:48:27 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 2.61s]
2021-02-01 20:48:27.088433 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 20:48:27.090763 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:48:27.091179 (MainThread): Using snowflake connection "master".
2021-02-01 20:48:27.091356 (MainThread): On master: BEGIN
2021-02-01 20:48:27.091530 (MainThread): Opening a new connection, currently in state closed
2021-02-01 20:48:27.997020 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-02-01 20:48:27.997846 (MainThread): On master: COMMIT
2021-02-01 20:48:28.000548 (MainThread): Using snowflake connection "master".
2021-02-01 20:48:28.001243 (MainThread): On master: COMMIT
2021-02-01 20:48:28.351212 (MainThread): SQL status: SUCCESS 1 in 0.35 seconds
2021-02-01 20:48:28.351950 (MainThread): On master: Close
2021-02-01 20:48:28.657070 (MainThread): 15:48:28 | 
2021-02-01 20:48:28.657586 (MainThread): 15:48:28 | Finished running 7 snowflake_timetravel_table models in 31.63s.
2021-02-01 20:48:28.658010 (MainThread): Connection 'master' was properly closed.
2021-02-01 20:48:28.658257 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-02-01 20:48:28.695289 (MainThread): 
2021-02-01 20:48:28.695469 (MainThread): Completed successfully
2021-02-01 20:48:28.695606 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-02-01 20:48:28.695810 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c476d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c476b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8c476850>]}
2021-02-01 20:48:28.696047 (MainThread): Flushing usage events
2021-02-01 20:48:30.694431 (MainThread): Running with dbt=0.18.1
2021-02-01 20:48:31.209180 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-02-01 20:48:31.209937 (MainThread): Tracking: do not track
2021-02-01 20:48:31.249955 (MainThread): Partial parsing not enabled
2021-02-01 20:48:31.251206 (MainThread): Parsing macros/catalog.sql
2021-02-01 20:48:31.254572 (MainThread): Parsing macros/adapters.sql
2021-02-01 20:48:31.291390 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 20:48:31.293385 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 20:48:31.305425 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 20:48:31.307870 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 20:48:31.313619 (MainThread): Parsing macros/core.sql
2021-02-01 20:48:31.317984 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 20:48:31.320066 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 20:48:31.322036 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 20:48:31.324272 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 20:48:31.327424 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 20:48:31.337939 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 20:48:31.345176 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 20:48:31.350778 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 20:48:31.373363 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 20:48:31.378342 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 20:48:31.415774 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 20:48:31.423728 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 20:48:31.430341 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 20:48:31.432444 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 20:48:31.448804 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 20:48:31.471920 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 20:48:31.481375 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 20:48:31.483050 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 20:48:31.484013 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 20:48:31.486218 (MainThread): Parsing macros/etc/query.sql
2021-02-01 20:48:31.487345 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 20:48:31.489225 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 20:48:31.538777 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 20:48:31.554764 (MainThread): Partial parsing not enabled
2021-02-01 20:48:31.594486 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:31.617475 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:48:31.630067 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:48:31.642422 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:48:31.654222 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:48:31.665687 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:48:31.679794 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:48:31.700760 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:31.888590 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources
2021-02-01 20:48:31.889360 (MainThread): 
2021-02-01 20:48:31.889671 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:48:31.900383 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:48:31.915269 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:48:31.915417 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 20:48:31.915509 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-01 20:48:33.050414 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.13 seconds
2021-02-01 20:48:33.432424 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 20:48:33.817845 (MainThread): 15:48:33 | Concurrency: 1 threads (target='snowflake')
2021-02-01 20:48:33.818150 (MainThread): 15:48:33 | 
2021-02-01 20:48:33.820386 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:48:33.820656 (Thread-1): 15:48:33 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 20:48:33.821054 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:33.821201 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:48:33.842711 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 20:48:33.843096 (Thread-1): finished collecting timing info
2021-02-01 20:48:33.843938 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:33.844043 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 20:48:33.844145 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:48:34.827282 (Thread-1): SQL status: SUCCESS 1 in 0.98 seconds
2021-02-01 20:48:34.827648 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:48:34.827963 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.18.1", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-02-01T20:48:10.677680Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-02-01 20:48:35.107767 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-02-01 20:48:35.108626 (Thread-1): finished collecting timing info
2021-02-01 20:48:35.109318 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-02-01 20:48:35.379423 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 20:48:35.668890 (Thread-1): 15:48:35 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 1.85s]
2021-02-01 20:48:35.669706 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:48:35.675849 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:48:35.678536 (MainThread): 15:48:35 | 
2021-02-01 20:48:35.679871 (MainThread): 15:48:35 | Finished running 1 test in 3.79s.
2021-02-01 20:48:35.680732 (MainThread): Connection 'master' was properly closed.
2021-02-01 20:48:35.681157 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-02-01 20:48:35.700516 (MainThread): 
2021-02-01 20:48:35.700849 (MainThread): Completed successfully
2021-02-01 20:48:35.701131 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-01 20:48:35.701576 (MainThread): Flushing usage events
2021-02-01 20:49:22.218048 (MainThread): Running with dbt=0.19.0
2021-02-01 20:49:22.749968 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-02-01 20:49:22.750307 (MainThread): Tracking: tracking
2021-02-01 20:49:22.750478 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b25e84490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2e133190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b25e8fa00>]}
2021-02-01 20:49:22.751164 (MainThread): Set downloads directory='/tmp/dbt-downloads-y9511lhh'
2021-02-01 20:49:22.763754 (MainThread): Installing ../../
2021-02-01 20:49:22.764056 (MainThread):   Creating symlink to local dependency.
2021-02-01 20:49:22.764182 (MainThread):   Installed from <local @ ../../>

2021-02-01 20:49:22.764324 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '8ef389fc-4477-424c-a80f-77ee1ec52b65', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b25e8fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b25e8fc70>]}
2021-02-01 20:49:22.764705 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b25e84490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b2e133190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b25e20d30>]}
2021-02-01 20:49:22.764923 (MainThread): Flushing usage events
2021-02-01 20:49:24.700370 (MainThread): Running with dbt=0.19.0
2021-02-01 20:49:25.272068 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-01 20:49:25.273271 (MainThread): Tracking: tracking
2021-02-01 20:49:25.273988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e61108b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ebe3e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e60a26d0>]}
2021-02-01 20:49:25.321848 (MainThread): Partial parsing not enabled
2021-02-01 20:49:25.323041 (MainThread): Parsing macros/catalog.sql
2021-02-01 20:49:25.326926 (MainThread): Parsing macros/adapters.sql
2021-02-01 20:49:25.397754 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 20:49:25.400555 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 20:49:25.416582 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 20:49:25.419976 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 20:49:25.427580 (MainThread): Parsing macros/core.sql
2021-02-01 20:49:25.434152 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 20:49:25.436919 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 20:49:25.439555 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 20:49:25.443352 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 20:49:25.448076 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 20:49:25.469795 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 20:49:25.480180 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 20:49:25.488098 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 20:49:25.540570 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 20:49:25.545778 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 20:49:25.595647 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 20:49:25.605909 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 20:49:25.614390 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 20:49:25.616769 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 20:49:25.638442 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 20:49:25.668675 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 20:49:25.683516 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 20:49:25.685735 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 20:49:25.687059 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 20:49:25.690803 (MainThread): Parsing macros/etc/query.sql
2021-02-01 20:49:25.692396 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 20:49:25.694714 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 20:49:25.758908 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 20:49:25.779837 (MainThread): Partial parsing not enabled
2021-02-01 20:49:25.831569 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:25.860446 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:25.874417 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:25.887377 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:49:25.901350 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:25.915651 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:49:25.931599 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:25.970742 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:26.163526 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e4d24a00>]}
2021-02-01 20:49:26.214956 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-01 20:49:26.216236 (MainThread): 
2021-02-01 20:49:26.216702 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:49:26.227824 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_USER_DATA".
2021-02-01 20:49:26.245800 (ThreadPoolExecutor-0_0): Using snowflake connection "list_USER_DATA".
2021-02-01 20:49:26.246016 (ThreadPoolExecutor-0_0): On list_USER_DATA: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */

    show terse schemas in database USER_DATA
    limit 10000
2021-02-01 20:49:26.246193 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-01 20:49:27.372220 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 174 in 1.13 seconds
2021-02-01 20:49:27.395394 (ThreadPoolExecutor-0_0): On list_USER_DATA: Close
2021-02-01 20:49:27.694855 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:49:27.705288 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:49:27.705460 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 20:49:27.705570 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-02-01 20:49:28.734342 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 468 in 1.03 seconds
2021-02-01 20:49:29.467031 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 20:49:29.854849 (MainThread): Using snowflake connection "master".
2021-02-01 20:49:29.855012 (MainThread): On master: BEGIN
2021-02-01 20:49:29.855135 (MainThread): Opening a new connection, currently in state init
2021-02-01 20:49:30.819218 (MainThread): SQL status: SUCCESS 1 in 0.96 seconds
2021-02-01 20:49:30.819718 (MainThread): On master: COMMIT
2021-02-01 20:49:30.820243 (MainThread): Using snowflake connection "master".
2021-02-01 20:49:30.820521 (MainThread): On master: COMMIT
2021-02-01 20:49:31.094840 (MainThread): SQL status: SUCCESS 1 in 0.27 seconds
2021-02-01 20:49:31.095582 (MainThread): On master: Close
2021-02-01 20:49:31.921256 (MainThread): 15:49:31 | Concurrency: 1 threads (target='snowflake')
2021-02-01 20:49:31.921872 (MainThread): 15:49:31 | 
2021-02-01 20:49:31.926460 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:49:31.931018 (Thread-1): 15:49:31 | 1 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [RUN]
2021-02-01 20:49:31.932112 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:31.932510 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:49:31.960839 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 20:49:31.961199 (Thread-1): finished collecting timing info
2021-02-01 20:49:32.013091 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:32.013263 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp  as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:49:32.013361 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:49:33.462309 (Thread-1): SQL status: SUCCESS 1 in 1.45 seconds
2021-02-01 20:49:33.491443 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:33.491645 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:49:33.889019 (Thread-1): SQL status: SUCCESS 3 in 0.40 seconds
2021-02-01 20:49:33.903709 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:33.904276 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
2021-02-01 20:49:34.277922 (Thread-1): SQL status: SUCCESS 3 in 0.37 seconds
2021-02-01 20:49:34.315655 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:34.315838 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
2021-02-01 20:49:34.568756 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-02-01 20:49:34.618873 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
2021-02-01 20:49:34.620589 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:34.620738 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: BEGIN
2021-02-01 20:49:34.818113 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-02-01 20:49:34.818566 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:34.818858 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed  as
      (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:49:36.058764 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-02-01 20:49:36.065778 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 20:49:36.067135 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:49:36.067873 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: COMMIT
2021-02-01 20:49:36.245509 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-02-01 20:49:36.321444 (Thread-1): finished collecting timing info
2021-02-01 20:49:36.322086 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
2021-02-01 20:49:36.591336 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e60d8e20>]}
2021-02-01 20:49:36.592945 (Thread-1): 15:49:36 | 1 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_column_types_changed [SUCCESS 1 in 4.66s]
2021-02-01 20:49:36.593245 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
2021-02-01 20:49:36.593484 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:49:36.595095 (Thread-1): 15:49:36 | 2 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [RUN]
2021-02-01 20:49:36.595497 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:36.595614 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:49:36.605408 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 20:49:36.605804 (Thread-1): finished collecting timing info
2021-02-01 20:49:36.620977 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:36.621164 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp  as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
2021-02-01 20:49:36.621352 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:49:37.834710 (Thread-1): SQL status: SUCCESS 1 in 1.21 seconds
2021-02-01 20:49:37.849055 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:37.849790 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:49:38.060952 (Thread-1): SQL status: SUCCESS 3 in 0.21 seconds
2021-02-01 20:49:38.071907 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:38.072253 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
2021-02-01 20:49:38.271376 (Thread-1): SQL status: SUCCESS 4 in 0.20 seconds
2021-02-01 20:49:38.300106 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:38.300823 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
2021-02-01 20:49:38.562636 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-02-01 20:49:38.570149 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
2021-02-01 20:49:38.575868 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:38.576458 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: BEGIN
2021-02-01 20:49:38.872202 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-02-01 20:49:38.872887 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:38.873327 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_added  as
      (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
      );
2021-02-01 20:49:39.955746 (Thread-1): SQL status: SUCCESS 1 in 1.08 seconds
2021-02-01 20:49:39.959137 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 20:49:39.959677 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:49:39.959954 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: COMMIT
2021-02-01 20:49:40.122085 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-02-01 20:49:40.125476 (Thread-1): finished collecting timing info
2021-02-01 20:49:40.125820 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
2021-02-01 20:49:40.380003 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e60d8e20>]}
2021-02-01 20:49:40.382761 (Thread-1): 15:49:40 | 2 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_added [SUCCESS 1 in 3.78s]
2021-02-01 20:49:40.383442 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
2021-02-01 20:49:40.383720 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:49:40.385674 (Thread-1): 15:49:40 | 3 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 20:49:40.386478 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:40.386763 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:49:40.397396 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 20:49:40.397788 (Thread-1): finished collecting timing info
2021-02-01 20:49:40.414214 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:40.414413 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp  as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:49:40.414532 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:49:41.973384 (Thread-1): SQL status: SUCCESS 1 in 1.56 seconds
2021-02-01 20:49:41.989362 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:41.990174 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:49:42.221332 (Thread-1): SQL status: SUCCESS 3 in 0.23 seconds
2021-02-01 20:49:42.229610 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:42.229886 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
2021-02-01 20:49:42.434200 (Thread-1): SQL status: SUCCESS 3 in 0.20 seconds
2021-02-01 20:49:42.452658 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:42.452878 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
2021-02-01 20:49:42.739197 (Thread-1): SQL status: SUCCESS 1 in 0.29 seconds
2021-02-01 20:49:42.771469 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 20:49:42.773377 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:42.773547 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 20:49:42.983003 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-02-01 20:49:42.983342 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:42.983495 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */

  truncate table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change;
2021-02-01 20:49:43.446779 (Thread-1): SQL status: SUCCESS 1 in 0.46 seconds
2021-02-01 20:49:43.447289 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:43.447546 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: insert into USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
  (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:49:43.998336 (Thread-1): SQL status: SUCCESS 2 in 0.55 seconds
2021-02-01 20:49:44.003938 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 20:49:44.004836 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:49:44.005279 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: COMMIT
2021-02-01 20:49:44.879486 (Thread-1): SQL status: SUCCESS 1 in 0.87 seconds
2021-02-01 20:49:44.892525 (Thread-1): finished collecting timing info
2021-02-01 20:49:44.894253 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 20:49:45.179438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ddadb0d0>]}
2021-02-01 20:49:45.182095 (Thread-1): 15:49:45 | 3 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change [SUCCESS 2 in 4.79s]
2021-02-01 20:49:45.182417 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:49:45.182700 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:49:45.185026 (Thread-1): 15:49:45 | 4 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [RUN]
2021-02-01 20:49:45.185721 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:45.185947 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:49:45.205124 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 20:49:45.205979 (Thread-1): finished collecting timing info
2021-02-01 20:49:45.229449 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:45.229638 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp  as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
2021-02-01 20:49:45.229754 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:49:46.468683 (Thread-1): SQL status: SUCCESS 1 in 1.24 seconds
2021-02-01 20:49:46.472478 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:46.472664 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:49:46.735814 (Thread-1): SQL status: SUCCESS 3 in 0.26 seconds
2021-02-01 20:49:46.740244 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:46.740428 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
2021-02-01 20:49:46.933311 (Thread-1): SQL status: SUCCESS 2 in 0.19 seconds
2021-02-01 20:49:46.942069 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:46.942446 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
2021-02-01 20:49:47.198878 (Thread-1): SQL status: SUCCESS 1 in 0.26 seconds
2021-02-01 20:49:47.205367 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
2021-02-01 20:49:47.210062 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:47.210736 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: BEGIN
2021-02-01 20:49:47.421144 (Thread-1): SQL status: SUCCESS 1 in 0.21 seconds
2021-02-01 20:49:47.421318 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:47.421416 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed  as
      (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
      );
2021-02-01 20:49:48.744456 (Thread-1): SQL status: SUCCESS 1 in 1.32 seconds
2021-02-01 20:49:48.752190 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 20:49:48.753779 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:49:48.754651 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: COMMIT
2021-02-01 20:49:48.958906 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-02-01 20:49:48.962647 (Thread-1): finished collecting timing info
2021-02-01 20:49:48.963111 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
2021-02-01 20:49:49.218737 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ddadb940>]}
2021-02-01 20:49:49.220039 (Thread-1): 15:49:49 | 4 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_removed [SUCCESS 1 in 4.03s]
2021-02-01 20:49:49.220217 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
2021-02-01 20:49:49.220364 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:49:49.221587 (Thread-1): 15:49:49 | 5 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [RUN]
2021-02-01 20:49:49.222125 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:49.222316 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:49:49.232697 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 20:49:49.233033 (Thread-1): finished collecting timing info
2021-02-01 20:49:49.252543 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:49.252704 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    
  create or replace  view USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp  as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
2021-02-01 20:49:49.252810 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:49:50.396332 (Thread-1): SQL status: SUCCESS 1 in 1.14 seconds
2021-02-01 20:49:50.409742 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:50.414737 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:49:50.700871 (Thread-1): SQL status: SUCCESS 3 in 0.29 seconds
2021-02-01 20:49:50.708035 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:50.708269 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */

    describe table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
2021-02-01 20:49:50.978732 (Thread-1): SQL status: SUCCESS 3 in 0.27 seconds
2021-02-01 20:49:50.985456 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:50.985677 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
2021-02-01 20:49:51.282696 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-02-01 20:49:51.289942 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
2021-02-01 20:49:51.294693 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:51.295400 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: BEGIN
2021-02-01 20:49:51.592570 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-02-01 20:49:51.592744 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:51.592833 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed  as
      (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:49:53.573166 (Thread-1): SQL status: SUCCESS 1 in 1.98 seconds
2021-02-01 20:49:53.574526 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 20:49:53.574745 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:49:53.574855 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: COMMIT
2021-02-01 20:49:53.738735 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-02-01 20:49:53.741717 (Thread-1): finished collecting timing info
2021-02-01 20:49:53.742050 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
2021-02-01 20:49:54.044507 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ddaf24c0>]}
2021-02-01 20:49:54.050706 (Thread-1): 15:49:54 | 5 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_columns_renamed [SUCCESS 1 in 4.82s]
2021-02-01 20:49:54.051971 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
2021-02-01 20:49:54.052781 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 20:49:54.066599 (Thread-1): 15:49:54 | 6 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [RUN]
2021-02-01 20:49:54.069545 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:49:54.070486 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 20:49:54.105427 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 20:49:54.106079 (Thread-1): finished collecting timing info
2021-02-01 20:49:54.120525 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
2021-02-01 20:49:54.121690 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:49:54.121799 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: BEGIN
2021-02-01 20:49:54.121906 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:49:55.077903 (Thread-1): SQL status: SUCCESS 1 in 0.96 seconds
2021-02-01 20:49:55.078290 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:49:55.078536 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  as
      (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:49:56.369859 (Thread-1): SQL status: SUCCESS 1 in 1.29 seconds
2021-02-01 20:49:56.371180 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 20:49:56.371400 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:49:56.371490 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: COMMIT
2021-02-01 20:49:56.538255 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-02-01 20:49:56.543264 (Thread-1): finished collecting timing info
2021-02-01 20:49:56.543757 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
2021-02-01 20:49:56.822792 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e404dd60>]}
2021-02-01 20:49:56.826575 (Thread-1): 15:49:56 | 6 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_table_does_not_exist [SUCCESS 1 in 2.75s]
2021-02-01 20:49:56.827135 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
2021-02-01 20:49:56.827586 (Thread-1): Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 20:49:56.833212 (Thread-1): 15:49:56 | 7 of 7 START snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [RUN]
2021-02-01 20:49:56.835071 (Thread-1): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:49:56.835448 (Thread-1): Compiling model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 20:49:56.852475 (Thread-1): Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 20:49:56.852931 (Thread-1): finished collecting timing info
2021-02-01 20:49:56.867271 (Thread-1): Dropping relation "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
2021-02-01 20:49:56.872536 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:49:56.872682 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."TSANKEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
2021-02-01 20:49:56.872780 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:49:57.808610 (Thread-1): SQL status: SUCCESS 1 in 0.94 seconds
2021-02-01 20:49:57.815413 (Thread-1): Writing runtime SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
2021-02-01 20:49:57.822841 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:49:57.823426 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: BEGIN
2021-02-01 20:49:58.074095 (Thread-1): SQL status: SUCCESS 1 in 0.25 seconds
2021-02-01 20:49:58.074395 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:49:58.074572 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */


      create or replace  table USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view  as
      (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
      );
2021-02-01 20:49:59.478326 (Thread-1): SQL status: SUCCESS 1 in 1.40 seconds
2021-02-01 20:49:59.485346 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 20:49:59.486777 (Thread-1): Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:49:59.487569 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: COMMIT
2021-02-01 20:49:59.711317 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-02-01 20:49:59.716234 (Thread-1): finished collecting timing info
2021-02-01 20:49:59.716724 (Thread-1): On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
2021-02-01 20:50:00.072902 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b4361a1-eccf-493d-a7e9-2f14905513e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ddac2b50>]}
2021-02-01 20:50:00.074330 (Thread-1): 15:50:00 | 7 of 7 OK created snowflake_timetravel_table model TSANKEY.snowflake_timetravel_table_integration_tests_was_a_view [SUCCESS 1 in 3.24s]
2021-02-01 20:50:00.074556 (Thread-1): Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
2021-02-01 20:50:00.075864 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:50:00.076116 (MainThread): Using snowflake connection "master".
2021-02-01 20:50:00.076211 (MainThread): On master: BEGIN
2021-02-01 20:50:00.076301 (MainThread): Opening a new connection, currently in state closed
2021-02-01 20:50:01.150987 (MainThread): SQL status: SUCCESS 1 in 1.07 seconds
2021-02-01 20:50:01.151256 (MainThread): On master: COMMIT
2021-02-01 20:50:01.151525 (MainThread): Using snowflake connection "master".
2021-02-01 20:50:01.151656 (MainThread): On master: COMMIT
2021-02-01 20:50:01.738671 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-02-01 20:50:01.738877 (MainThread): On master: Close
2021-02-01 20:50:02.040722 (MainThread): 15:50:02 | 
2021-02-01 20:50:02.040942 (MainThread): 15:50:02 | Finished running 7 snowflake_timetravel_table models in 35.82s.
2021-02-01 20:50:02.041089 (MainThread): Connection 'master' was properly closed.
2021-02-01 20:50:02.041173 (MainThread): Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
2021-02-01 20:50:02.090835 (MainThread): 
2021-02-01 20:50:02.091046 (MainThread): Completed successfully
2021-02-01 20:50:02.091212 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-02-01 20:50:02.091450 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e4d43b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e4de00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0e4de07c0>]}
2021-02-01 20:50:02.091662 (MainThread): Flushing usage events
2021-02-01 20:50:04.011076 (MainThread): Running with dbt=0.19.0
2021-02-01 20:50:04.505219 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test_snowflake_timetravel_table_integration_tests_columns_no_change'], partial_parse=None, profile=None, profiles_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/tests/../test_profile', project_dir='/home/tsankey/tmp/edx/warehouse-transforms/tools/dbt_packages/snowflake_timetravel_table/integration_tests/run_project', record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-02-01 20:50:04.506191 (MainThread): Tracking: do not track
2021-02-01 20:50:04.570690 (MainThread): Partial parsing not enabled
2021-02-01 20:50:04.572426 (MainThread): Parsing macros/catalog.sql
2021-02-01 20:50:04.577231 (MainThread): Parsing macros/adapters.sql
2021-02-01 20:50:04.614374 (MainThread): Parsing macros/materializations/view.sql
2021-02-01 20:50:04.616338 (MainThread): Parsing macros/materializations/incremental.sql
2021-02-01 20:50:04.628907 (MainThread): Parsing macros/materializations/merge.sql
2021-02-01 20:50:04.631427 (MainThread): Parsing macros/materializations/table.sql
2021-02-01 20:50:04.637981 (MainThread): Parsing macros/core.sql
2021-02-01 20:50:04.644199 (MainThread): Parsing macros/schema_tests/unique.sql
2021-02-01 20:50:04.646377 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-02-01 20:50:04.648359 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-02-01 20:50:04.650637 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-02-01 20:50:04.654082 (MainThread): Parsing macros/materializations/helpers.sql
2021-02-01 20:50:04.665104 (MainThread): Parsing macros/materializations/view/view.sql
2021-02-01 20:50:04.672775 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-01 20:50:04.678673 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-02-01 20:50:04.699482 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-01 20:50:04.701670 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-01 20:50:04.746259 (MainThread): Parsing macros/materializations/table/table.sql
2021-02-01 20:50:04.754384 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-02-01 20:50:04.761374 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-02-01 20:50:04.763554 (MainThread): Parsing macros/materializations/common/merge.sql
2021-02-01 20:50:04.782053 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-02-01 20:50:04.810436 (MainThread): Parsing macros/etc/datetime.sql
2021-02-01 20:50:04.820625 (MainThread): Parsing macros/etc/is_incremental.sql
2021-02-01 20:50:04.822600 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-02-01 20:50:04.823773 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-02-01 20:50:04.825996 (MainThread): Parsing macros/etc/query.sql
2021-02-01 20:50:04.827184 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-02-01 20:50:04.829103 (MainThread): Parsing macros/adapters/common.sql
2021-02-01 20:50:04.879167 (MainThread): Parsing macros/snowflake_timetravel_table.sql
2021-02-01 20:50:04.895615 (MainThread): Partial parsing not enabled
2021-02-01 20:50:04.937612 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:50:04.961054 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed".
2021-02-01 20:50:04.972064 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed".
2021-02-01 20:50:04.983165 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view".
2021-02-01 20:50:04.994353 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added".
2021-02-01 20:50:05.007241 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist".
2021-02-01 20:50:05.019072 (MainThread): Acquiring new snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed".
2021-02-01 20:50:05.041972 (MainThread): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:50:05.235789 (MainThread): Found 7 models, 1 test, 0 snapshots, 0 analyses, 146 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-02-01 20:50:05.236600 (MainThread): 
2021-02-01 20:50:05.236908 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:50:05.247252 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:50:05.266979 (ThreadPoolExecutor-1_0): Using snowflake connection "list_USER_DATA_TSANKEY".
2021-02-01 20:50:05.267260 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_TSANKEY"} */

    show terse objects in USER_DATA.TSANKEY
2021-02-01 20:50:05.267454 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-01 20:50:06.483279 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 469 in 1.22 seconds
2021-02-01 20:50:06.880733 (ThreadPoolExecutor-1_0): On list_USER_DATA_TSANKEY: Close
2021-02-01 20:50:07.298516 (MainThread): 15:50:07 | Concurrency: 1 threads (target='snowflake')
2021-02-01 20:50:07.298792 (MainThread): 15:50:07 | 
2021-02-01 20:50:07.300590 (Thread-1): Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:50:07.300895 (Thread-1): 15:50:07 | 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change [RUN]
2021-02-01 20:50:07.301394 (Thread-1): Acquiring new snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:50:07.301591 (Thread-1): Compiling test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:50:07.323761 (Thread-1): Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
2021-02-01 20:50:07.324117 (Thread-1): finished collecting timing info
2021-02-01 20:50:07.324918 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:50:07.325009 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: BEGIN
2021-02-01 20:50:07.325102 (Thread-1): Opening a new connection, currently in state closed
2021-02-01 20:50:08.381679 (Thread-1): SQL status: SUCCESS 1 in 1.06 seconds
2021-02-01 20:50:08.382270 (Thread-1): Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change".
2021-02-01 20:50:08.382631 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */

with dbt__CTE__INTERNAL_test as (
select *
from USER_DATA.TSANKEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2021-02-01T20:49:40.398184Z'::timestamp_tz)
where col2 = 'new'
)select count(*) from dbt__CTE__INTERNAL_test
2021-02-01 20:50:08.899663 (Thread-1): SQL status: SUCCESS 1 in 0.52 seconds
2021-02-01 20:50:08.901310 (Thread-1): finished collecting timing info
2021-02-01 20:50:08.902489 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: ROLLBACK
2021-02-01 20:50:09.360935 (Thread-1): On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
2021-02-01 20:50:09.676784 (Thread-1): 15:50:09 | 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change [PASS in 2.38s]
2021-02-01 20:50:09.677245 (Thread-1): Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
2021-02-01 20:50:09.679810 (MainThread): Acquiring new snowflake connection "master".
2021-02-01 20:50:09.680687 (MainThread): 15:50:09 | 
2021-02-01 20:50:09.681022 (MainThread): 15:50:09 | Finished running 1 test in 4.44s.
2021-02-01 20:50:09.681310 (MainThread): Connection 'master' was properly closed.
2021-02-01 20:50:09.681529 (MainThread): Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
2021-02-01 20:50:09.738760 (MainThread): 
2021-02-01 20:50:09.738929 (MainThread): Completed successfully
2021-02-01 20:50:09.739036 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-01 20:50:09.739230 (MainThread): Flushing usage events


============================== 17:50:02.586409 | f4b528cc-d385-447d-ae92-15215e0b6fca ==============================
[0m17:50:02.586409 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:50:02.588466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'integration_tests/test_profile', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'integration_tests/run_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --project-dir integration_tests/run_project --profiles-dir integration_tests/test_profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:50:02.638805 [debug] [MainThread]: Set downloads directory='/var/folders/km/w4j5n82573q2nbdnzyk1sjtw0000gp/T/dbt-downloads-vwx4hnd8'
[0m17:50:02.640285 [info ] [MainThread]: Updating lock file in file path: /Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/run_project/package-lock.yml
[0m17:50:02.641283 [debug] [MainThread]: Set downloads directory='/var/folders/km/w4j5n82573q2nbdnzyk1sjtw0000gp/T/dbt-downloads-vgpy43n5'
[0m17:50:02.641494 [info ] [MainThread]: Installing ../../
[0m17:50:02.642039 [debug] [MainThread]: Creating symlink to local dependency.
[0m17:50:02.642238 [info ] [MainThread]: Installed from <local @ ../../>
[0m17:50:02.643360 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08713171, "process_user_time": 1.215008, "process_kernel_time": 0.085833, "process_mem_max_rss": "98844672", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:50:02.643671 [debug] [MainThread]: Command `dbt deps` succeeded at 17:50:02.643600 after 0.09 seconds
[0m17:50:02.643846 [debug] [MainThread]: Flushing usage events


============================== 17:50:03.869125 | c814b0fc-36c5-4543-9c98-3ee5dd95b06b ==============================
[0m17:50:03.869125 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:50:03.871197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'integration_tests/test_profile', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'integration_tests/run_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir integration_tests/run_project --profiles-dir integration_tests/test_profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:50:04.113972 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:50:04.126578 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:50:04.127194 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:50:04.746112 [info ] [MainThread]: Found 7 models, 1 test, 0 sources, 0 exposures, 0 metrics, 433 macros, 0 groups, 0 semantic models
[0m17:50:04.747009 [info ] [MainThread]: 
[0m17:50:04.747407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:04.748082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DATA'
[0m17:50:04.755626 [debug] [ThreadPool]: Using snowflake connection "list_USER_DATA"
[0m17:50:04.755852 [debug] [ThreadPool]: On list_USER_DATA: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */
show terse schemas in database USER_DATA
    limit 10000
[0m17:50:04.756048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:07.718871 [debug] [ThreadPool]: SQL status: SUCCESS 93 in 3.0 seconds
[0m17:50:07.729763 [debug] [ThreadPool]: On list_USER_DATA: Close
[0m17:50:08.560277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DATA, now list_USER_DATA_ARAFEY)
[0m17:50:08.572974 [debug] [ThreadPool]: Using snowflake connection "list_USER_DATA_ARAFEY"
[0m17:50:08.573384 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_ARAFEY"} */
show terse objects in USER_DATA.ARAFEY limit 10000
[0m17:50:08.573710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:11.166780 [debug] [ThreadPool]: SQL status: SUCCESS 968 in 3.0 seconds
[0m17:50:11.223604 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: Close
[0m17:50:12.219091 [info ] [MainThread]: Concurrency: 10 threads (target='snowflake')
[0m17:50:12.219401 [info ] [MainThread]: 
[0m17:50:12.221838 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m17:50:12.222080 [debug] [Thread-2  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m17:50:12.222325 [debug] [Thread-3  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:12.222784 [debug] [Thread-4  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m17:50:12.223055 [debug] [Thread-5  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m17:50:12.222593 [info ] [Thread-1  ]: 1 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed  [RUN]
[0m17:50:12.223342 [debug] [Thread-6  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m17:50:12.223782 [debug] [Thread-7  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m17:50:12.223581 [info ] [Thread-2  ]: 2 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_added  [RUN]
[0m17:50:12.224177 [info ] [Thread-3  ]: 3 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change  [RUN]
[0m17:50:12.224471 [info ] [Thread-4  ]: 4 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed  [RUN]
[0m17:50:12.224767 [info ] [Thread-5  ]: 5 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed  [RUN]
[0m17:50:12.225192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_USER_DATA_ARAFEY, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed)
[0m17:50:12.225500 [info ] [Thread-6  ]: 6 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  [RUN]
[0m17:50:12.225785 [info ] [Thread-7  ]: 7 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_was_a_view  [RUN]
[0m17:50:12.226214 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added'
[0m17:50:12.226632 [debug] [Thread-3  ]: Acquiring new snowflake connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change'
[0m17:50:12.227026 [debug] [Thread-4  ]: Acquiring new snowflake connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed'
[0m17:50:12.227424 [debug] [Thread-5  ]: Acquiring new snowflake connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed'
[0m17:50:12.227682 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m17:50:12.228062 [debug] [Thread-6  ]: Acquiring new snowflake connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist'
[0m17:50:12.228443 [debug] [Thread-7  ]: Acquiring new snowflake connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view'
[0m17:50:12.228649 [debug] [Thread-2  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m17:50:12.228878 [debug] [Thread-3  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:12.229259 [debug] [Thread-4  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m17:50:12.229733 [debug] [Thread-5  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m17:50:12.235238 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m17:50:12.235558 [debug] [Thread-6  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m17:50:12.236221 [debug] [Thread-7  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m17:50:12.238503 [debug] [Thread-2  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m17:50:12.240882 [debug] [Thread-3  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:12.242676 [debug] [Thread-4  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m17:50:12.244445 [debug] [Thread-5  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m17:50:12.246879 [debug] [Thread-6  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
[0m17:50:12.247544 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed (compile): 17:50:12.230013 => 17:50:12.247172
[0m17:50:12.249510 [debug] [Thread-7  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m17:50:12.250219 [debug] [Thread-3  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change (compile): 17:50:12.238691 => 17:50:12.250012
[0m17:50:12.250489 [debug] [Thread-2  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added (compile): 17:50:12.236618 => 17:50:12.250347
[0m17:50:12.251403 [debug] [Thread-5  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed (compile): 17:50:12.242922 => 17:50:12.251259
[0m17:50:12.251669 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m17:50:12.251929 [debug] [Thread-4  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed (compile): 17:50:12.241142 => 17:50:12.251809
[0m17:50:12.252212 [debug] [Thread-6  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist (compile): 17:50:12.245258 => 17:50:12.252089
[0m17:50:12.252410 [debug] [Thread-3  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:12.252650 [debug] [Thread-2  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m17:50:12.252876 [debug] [Thread-5  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m17:50:12.253135 [debug] [Thread-7  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view (compile): 17:50:12.247741 => 17:50:12.253014
[0m17:50:12.261211 [debug] [Thread-4  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m17:50:12.277474 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m17:50:12.277743 [debug] [Thread-6  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m17:50:12.283760 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:12.290257 [debug] [Thread-2  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m17:50:12.296485 [debug] [Thread-5  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m17:50:12.296728 [debug] [Thread-7  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m17:50:12.302487 [debug] [Thread-4  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m17:50:12.302736 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
  
   as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
[0m17:50:12.314827 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
  
   as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
[0m17:50:12.317580 [debug] [Thread-6  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
[0m17:50:12.317835 [debug] [Thread-2  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
  
   as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
[0m17:50:12.318063 [debug] [Thread-5  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
  
   as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
[0m17:50:12.323295 [debug] [Thread-7  ]: Dropping relation "USER_DATA"."ARAFEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
[0m17:50:12.323531 [debug] [Thread-4  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
  
   as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
[0m17:50:12.323735 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:12.323918 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m17:50:12.324198 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m17:50:12.324438 [debug] [Thread-5  ]: Opening a new connection, currently in state init
[0m17:50:12.329116 [debug] [Thread-7  ]: Applying DROP to: "USER_DATA"."ARAFEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW"
[0m17:50:12.329352 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m17:50:12.330621 [debug] [Thread-6  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
[0m17:50:12.334573 [debug] [Thread-7  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m17:50:12.336718 [debug] [Thread-6  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_table_does_not_exist
         as
        (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m17:50:12.337560 [debug] [Thread-7  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."ARAFEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
[0m17:50:12.339110 [debug] [Thread-6  ]: Opening a new connection, currently in state init
[0m17:50:12.339920 [debug] [Thread-7  ]: Opening a new connection, currently in state init
[0m17:50:14.483736 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:50:14.498540 [debug] [Thread-4  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m17:50:14.499107 [debug] [Thread-4  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed
[0m17:50:14.507024 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:50:14.508947 [debug] [Thread-7  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m17:50:14.509656 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:50:14.513503 [debug] [Thread-5  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m17:50:14.513909 [debug] [Thread-5  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed
[0m17:50:14.514888 [debug] [Thread-7  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m17:50:14.515595 [debug] [Thread-7  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_was_a_view
         as
        (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m17:50:14.533944 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:50:14.537406 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m17:50:14.537782 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed
[0m17:50:14.538892 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:50:14.542275 [debug] [Thread-2  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m17:50:14.542715 [debug] [Thread-2  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added
[0m17:50:14.546214 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:50:14.548990 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:14.549318 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:14.922829 [debug] [Thread-4  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:14.931683 [debug] [Thread-5  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:14.933281 [debug] [Thread-4  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m17:50:14.940975 [debug] [Thread-5  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m17:50:14.941632 [debug] [Thread-4  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
[0m17:50:14.942158 [debug] [Thread-5  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
[0m17:50:14.974113 [debug] [Thread-3  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:14.975220 [debug] [Thread-2  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:14.985004 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:14.989265 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:14.997249 [debug] [Thread-2  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m17:50:14.997628 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
[0m17:50:15.001077 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m17:50:15.001462 [debug] [Thread-2  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
[0m17:50:15.002140 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
[0m17:50:15.180291 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:50:15.197278 [debug] [Thread-6  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist (execute): 17:50:12.302881 => 17:50:15.196963
[0m17:50:15.197822 [debug] [Thread-6  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
[0m17:50:15.369363 [debug] [Thread-5  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:15.385697 [debug] [Thread-5  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
[0m17:50:15.388056 [debug] [Thread-5  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m17:50:15.389264 [debug] [Thread-4  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m17:50:15.389822 [debug] [Thread-5  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
[0m17:50:15.394903 [debug] [Thread-4  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
[0m17:50:15.396657 [debug] [Thread-4  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m17:50:15.397445 [debug] [Thread-4  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
[0m17:50:15.445759 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:15.448662 [debug] [Thread-7  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view (execute): 17:50:12.318199 => 17:50:15.448378
[0m17:50:15.449142 [debug] [Thread-7  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
[0m17:50:15.457135 [debug] [Thread-2  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m17:50:15.462243 [debug] [Thread-2  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
[0m17:50:15.465000 [debug] [Thread-2  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m17:50:15.465432 [debug] [Thread-2  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
[0m17:50:15.467105 [debug] [Thread-3  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:15.467862 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m17:50:15.471775 [debug] [Thread-3  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
[0m17:50:15.475703 [debug] [Thread-1  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
[0m17:50:15.476772 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:15.477915 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m17:50:15.478592 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
[0m17:50:15.479039 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
[0m17:50:15.897217 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:15.901847 [debug] [Thread-4  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m17:50:15.903245 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:15.905865 [debug] [Thread-5  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m17:50:15.907431 [debug] [Thread-4  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m17:50:15.908008 [debug] [Thread-4  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed
         as
        (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
        );
[0m17:50:15.909177 [debug] [Thread-5  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m17:50:15.910410 [debug] [Thread-5  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed
         as
        (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m17:50:15.941070 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:15.944034 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m17:50:15.945853 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m17:50:15.946488 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed
         as
        (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m17:50:15.952587 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:15.954574 [debug] [Thread-2  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m17:50:15.955879 [debug] [Thread-2  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m17:50:15.956364 [debug] [Thread-2  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added
         as
        (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
        );
[0m17:50:15.973766 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:15.984138 [debug] [Thread-3  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:15.985555 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:15.985972 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
BEGIN
[0m17:50:16.021666 [info ] [Thread-6  ]: 6 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  [[32mSUCCESS 1[0m in 3.79s]
[0m17:50:16.022511 [debug] [Thread-6  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m17:50:16.250239 [info ] [Thread-7  ]: 7 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_was_a_view  [[32mSUCCESS 1[0m in 4.02s]
[0m17:50:16.251974 [debug] [Thread-7  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m17:50:16.426574 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:50:16.427896 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:16.428732 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
truncate table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change;
[0m17:50:16.918441 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:16.923011 [debug] [Thread-5  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed (execute): 17:50:12.290424 => 17:50:16.922629
[0m17:50:16.923699 [debug] [Thread-5  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
[0m17:50:16.936817 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:16.939858 [debug] [Thread-2  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added (execute): 17:50:12.284542 => 17:50:16.939524
[0m17:50:16.940441 [debug] [Thread-2  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
[0m17:50:16.947071 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:16.949423 [debug] [Thread-4  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed (execute): 17:50:12.296859 => 17:50:16.949153
[0m17:50:16.949903 [debug] [Thread-4  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
[0m17:50:17.075160 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:17.076392 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:17.077144 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
insert into USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
    (
      -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
    );
[0m17:50:17.183429 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:17.186605 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed (execute): 17:50:12.253251 => 17:50:17.186313
[0m17:50:17.187133 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
[0m17:50:17.717539 [info ] [Thread-5  ]: 5 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed  [[32mSUCCESS 1[0m in 5.49s]
[0m17:50:17.719206 [debug] [Thread-5  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m17:50:17.734880 [info ] [Thread-4  ]: 4 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed  [[32mSUCCESS 1[0m in 5.51s]
[0m17:50:17.735788 [debug] [Thread-4  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m17:50:17.737256 [info ] [Thread-2  ]: 2 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_added  [[32mSUCCESS 1[0m in 5.51s]
[0m17:50:17.738010 [debug] [Thread-2  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m17:50:17.781580 [debug] [Thread-3  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m17:50:17.782350 [debug] [Thread-3  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:17.782852 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
COMMIT
[0m17:50:17.983240 [info ] [Thread-1  ]: 1 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed  [[32mSUCCESS 1[0m in 5.76s]
[0m17:50:17.984776 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m17:50:18.499696 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:50:18.505220 [debug] [Thread-3  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change (execute): 17:50:12.277898 => 17:50:18.504802
[0m17:50:18.505900 [debug] [Thread-3  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
[0m17:50:19.371534 [info ] [Thread-3  ]: 3 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change  [[32mSUCCESS 2[0m in 7.14s]
[0m17:50:19.373251 [debug] [Thread-3  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:19.376552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:19.377234 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed' was properly closed.
[0m17:50:19.377801 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added' was properly closed.
[0m17:50:19.378242 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
[0m17:50:19.378671 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed' was properly closed.
[0m17:50:19.379077 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed' was properly closed.
[0m17:50:19.379483 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist' was properly closed.
[0m17:50:19.379892 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
[0m17:50:19.380447 [info ] [MainThread]: 
[0m17:50:19.380959 [info ] [MainThread]: Finished running 7 snowflake_timetravel_table models in 0 hours 0 minutes and 14.63 seconds (14.63s).
[0m17:50:19.383106 [debug] [MainThread]: Command end result
[0m17:50:19.396364 [info ] [MainThread]: 
[0m17:50:19.396793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:19.397131 [info ] [MainThread]: 
[0m17:50:19.397474 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:50:19.399166 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.5589, "process_user_time": 3.049629, "process_kernel_time": 0.174957, "process_mem_max_rss": "149340160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:50:19.399654 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:19.399550 after 15.56 seconds
[0m17:50:19.399954 [debug] [MainThread]: Flushing usage events


============================== 17:50:22.209434 | 02e3eaed-16ff-46cf-9cb4-d75063729457 ==============================
[0m17:50:22.209434 [info ] [MainThread]: Running with dbt=1.7.4
[0m17:50:22.212073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../test_profile', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../run_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test -m test_snowflake_timetravel_table_integration_tests_columns_no_change --project-dir /Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../run_project --profiles-dir /Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../test_profile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:50:22.453709 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:50:22.465861 [debug] [MainThread]: checksum: 248e8aba381ba2d577dce7ab50d2010c2aac45d2b27e6e6214cdd96d2d41fabc, vars: {}, profile: , target: , version: 1.7.4
[0m17:50:22.528552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:50:22.528902 [debug] [MainThread]: Partial parsing: updated file: snowflake_timetravel_table_integration_tests://tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
[0m17:50:22.589768 [info ] [MainThread]: Found 7 models, 1 test, 0 sources, 0 exposures, 0 metrics, 433 macros, 0 groups, 0 semantic models
[0m17:50:22.590370 [info ] [MainThread]: 
[0m17:50:22.590743 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:22.591455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DATA_ARAFEY'
[0m17:50:22.599735 [debug] [ThreadPool]: Using snowflake connection "list_USER_DATA_ARAFEY"
[0m17:50:22.599926 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_ARAFEY"} */
show terse objects in USER_DATA.ARAFEY limit 10000
[0m17:50:22.600088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:25.078292 [debug] [ThreadPool]: SQL status: SUCCESS 969 in 2.0 seconds
[0m17:50:25.108365 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: Close
[0m17:50:26.028183 [info ] [MainThread]: Concurrency: 10 threads (target='snowflake')
[0m17:50:26.028462 [info ] [MainThread]: 
[0m17:50:26.029824 [debug] [Thread-1  ]: Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:26.030067 [info ] [Thread-1  ]: 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change  [RUN]
[0m17:50:26.030433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_USER_DATA_ARAFEY, now test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change)
[0m17:50:26.030643 [debug] [Thread-1  ]: Began compiling node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:26.035683 [debug] [Thread-1  ]: Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:26.036227 [debug] [Thread-1  ]: Timing info for test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change (compile): 17:50:26.030780 => 17:50:26.036105
[0m17:50:26.036442 [debug] [Thread-1  ]: Began executing node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:26.049734 [debug] [Thread-1  ]: Writing runtime sql for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:26.050559 [debug] [Thread-1  ]: Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
[0m17:50:26.050784 [debug] [Thread-1  ]: On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.4", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2024-03-13T12:50:12.277898Z'::timestamp_tz)
where col2 = 'new'
      
    ) dbt_internal_test
[0m17:50:26.050985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:50:28.480690 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:50:28.492784 [debug] [Thread-1  ]: Timing info for test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change (execute): 17:50:26.036554 => 17:50:28.492370
[0m17:50:28.493537 [debug] [Thread-1  ]: On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
[0m17:50:29.296743 [info ] [Thread-1  ]: 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change  [[32mPASS[0m in 3.27s]
[0m17:50:29.297955 [debug] [Thread-1  ]: Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m17:50:29.300509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:29.300979 [debug] [MainThread]: Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
[0m17:50:29.301453 [info ] [MainThread]: 
[0m17:50:29.301899 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m17:50:29.302713 [debug] [MainThread]: Command end result
[0m17:50:29.313499 [info ] [MainThread]: 
[0m17:50:29.313957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:29.314261 [info ] [MainThread]: 
[0m17:50:29.314616 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:29.316157 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.1360297, "process_user_time": 1.772092, "process_kernel_time": 0.140364, "process_mem_max_rss": "135086080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:50:29.316697 [debug] [MainThread]: Command `dbt test` succeeded at 17:50:29.316585 after 7.14 seconds
[0m17:50:29.317030 [debug] [MainThread]: Flushing usage events


============================== 16:00:45.223067 | c0992cc9-75e0-4db7-8cba-86b26591b348 ==============================
[0m16:00:45.223067 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:00:45.225679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'integration_tests/test_profile', 'log_path': 'integration_tests/run_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --project-dir integration_tests/run_project --profiles-dir integration_tests/test_profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:00:45.285083 [debug] [MainThread]: Set downloads directory='/var/folders/km/w4j5n82573q2nbdnzyk1sjtw0000gp/T/dbt-downloads-cr_fachd'
[0m16:00:45.285372 [info ] [MainThread]: Installing ../../
[0m16:00:45.286110 [debug] [MainThread]: Creating symlink to local dependency.
[0m16:00:45.286326 [info ] [MainThread]: Installed from <local @ ../../>
[0m16:00:45.287259 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09756962, "process_user_time": 1.114986, "process_kernel_time": 0.087613, "process_mem_max_rss": "94699520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:00:45.287572 [debug] [MainThread]: Command `dbt deps` succeeded at 16:00:45.287506 after 0.10 seconds
[0m16:00:45.287749 [debug] [MainThread]: Flushing usage events


============================== 16:00:46.509924 | c0d8c95a-1924-4f6d-a2d0-0f18f06deb57 ==============================
[0m16:00:46.509924 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:00:46.512123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'integration_tests/test_profile', 'log_path': 'integration_tests/run_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir integration_tests/run_project --profiles-dir integration_tests/test_profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:00:46.758393 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:00:46.771207 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:00:46.778427 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m16:00:47.401368 [info ] [MainThread]: Found 7 models, 1 test, 0 sources, 0 exposures, 0 metrics, 433 macros, 0 groups, 0 semantic models
[0m16:00:47.402304 [info ] [MainThread]: 
[0m16:00:47.402716 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:00:47.403365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DATA'
[0m16:00:47.410892 [debug] [ThreadPool]: Using snowflake connection "list_USER_DATA"
[0m16:00:47.411165 [debug] [ThreadPool]: On list_USER_DATA: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA"} */
show terse schemas in database USER_DATA
    limit 10000
[0m16:00:47.411355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:49.800112 [debug] [ThreadPool]: SQL status: SUCCESS 93 in 2.0 seconds
[0m16:00:49.805283 [debug] [ThreadPool]: On list_USER_DATA: Close
[0m16:00:50.738584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DATA, now list_USER_DATA_ARAFEY)
[0m16:00:50.753407 [debug] [ThreadPool]: Using snowflake connection "list_USER_DATA_ARAFEY"
[0m16:00:50.753886 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_ARAFEY"} */
show terse objects in USER_DATA.ARAFEY limit 10000
[0m16:00:50.754232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:00:53.219578 [debug] [ThreadPool]: SQL status: SUCCESS 968 in 2.0 seconds
[0m16:00:53.251118 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: Close
[0m16:00:54.227436 [info ] [MainThread]: Concurrency: 1 threads (target='snowflake')
[0m16:00:54.227711 [info ] [MainThread]: 
[0m16:00:54.229891 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m16:00:54.230160 [info ] [Thread-1  ]: 1 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed  [RUN]
[0m16:00:54.230554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_USER_DATA_ARAFEY, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed)
[0m16:00:54.230750 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m16:00:54.235624 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m16:00:54.236471 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed (compile): 16:00:54.230868 => 16:00:54.236315
[0m16:00:54.236713 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m16:00:54.258843 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m16:00:54.259100 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
  
   as (
    -- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
[0m16:00:54.259303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:00:56.823657 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:00:56.840957 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m16:00:56.841681 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed
[0m16:00:57.316300 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:00:57.324220 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m16:00:57.325054 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
[0m16:00:57.803685 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:00:57.825576 [debug] [Thread-1  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp
[0m16:00:57.832930 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m16:00:57.833388 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed__dbt_tmp cascade
[0m16:00:58.378888 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:00:58.402685 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m16:00:58.405381 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"
[0m16:00:58.405850 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed
         as
        (-- Test changing the type of a column without altering the column count or names.
-- In this case, we changed col2 from a varchar(10) to a varchar(15).



select 1::int as col1, 'new'::varchar(15) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m16:00:59.777672 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:00:59.795275 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed (execute): 16:00:54.236844 => 16:00:59.794981
[0m16:00:59.795833 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed: Close
[0m16:01:00.670382 [info ] [Thread-1  ]: 1 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_column_types_changed  [[32mSUCCESS 1[0m in 6.44s]
[0m16:01:00.672063 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed
[0m16:01:00.672835 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m16:01:00.673749 [info ] [Thread-1  ]: 2 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_added  [RUN]
[0m16:01:00.675136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_column_types_changed, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added)
[0m16:01:00.675789 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m16:01:00.681237 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m16:01:00.682436 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added (compile): 16:01:00.676145 => 16:01:00.682133
[0m16:01:00.682937 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m16:01:00.695899 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m16:01:00.696319 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
  
   as (
    -- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
  );
[0m16:01:00.696678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:08.023630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 7.0 seconds
[0m16:01:08.032870 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m16:01:08.033721 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added
[0m16:01:08.472076 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:01:08.480187 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m16:01:08.480955 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
[0m16:01:08.928748 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:01:08.937652 [debug] [Thread-1  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp
[0m16:01:08.939604 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m16:01:08.940203 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added__dbt_tmp cascade
[0m16:01:09.411637 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:09.415906 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m16:01:09.418278 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"
[0m16:01:09.419010 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_added
         as
        (-- Test adding new columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3, 3::int as newcol
union all
select 2, 'new', 'values', 4
        );
[0m16:01:10.707173 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:10.712903 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added (execute): 16:01:00.683222 => 16:01:10.712432
[0m16:01:10.713683 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added: Close
[0m16:01:11.577246 [info ] [Thread-1  ]: 2 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_added  [[32mSUCCESS 1[0m in 10.90s]
[0m16:01:11.578979 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added
[0m16:01:11.579867 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:11.580832 [info ] [Thread-1  ]: 3 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change  [RUN]
[0m16:01:11.582075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_added, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change)
[0m16:01:11.582676 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:11.589114 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:11.590539 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change (compile): 16:01:11.582997 => 16:01:11.590177
[0m16:01:11.591039 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:11.605175 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:11.605668 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
  
   as (
    -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
[0m16:01:11.606099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:13.901953 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:01:13.911442 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:13.912223 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:14.357086 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:01:14.369003 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:14.369788 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
[0m16:01:14.804913 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:01:14.815741 [debug] [Thread-1  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp
[0m16:01:14.817915 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:14.818582 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change__dbt_tmp cascade
[0m16:01:15.307135 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:15.321745 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:15.323747 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:15.324251 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
BEGIN
[0m16:01:15.870049 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:15.871116 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:15.871863 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
truncate table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change;
[0m16:01:16.580783 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:16.582189 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:16.582965 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
insert into USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change ("COL1", "COL2", "COL3")
    (
      -- Test case for no change in the columns.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
    );
[0m16:01:17.353863 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:01:17.355469 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:17.356176 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change"} */
COMMIT
[0m16:01:18.091209 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:18.096574 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change (execute): 16:01:11.591323 => 16:01:18.096147
[0m16:01:18.097304 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change: Close
[0m16:01:19.087947 [info ] [Thread-1  ]: 3 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change  [[32mSUCCESS 2[0m in 7.51s]
[0m16:01:19.089289 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:19.090003 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m16:01:19.090854 [info ] [Thread-1  ]: 4 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed  [RUN]
[0m16:01:19.092066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_no_change, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed)
[0m16:01:19.092679 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m16:01:19.098068 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m16:01:19.099231 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed (compile): 16:01:19.093027 => 16:01:19.098927
[0m16:01:19.099711 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m16:01:19.112317 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m16:01:19.112732 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
  
   as (
    -- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
  );
[0m16:01:19.113075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:21.358696 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:01:21.367178 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m16:01:21.367946 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed
[0m16:01:21.813012 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:01:21.819338 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m16:01:21.819997 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
[0m16:01:22.295964 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m16:01:22.305500 [debug] [Thread-1  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp
[0m16:01:22.306965 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m16:01:22.307406 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed__dbt_tmp cascade
[0m16:01:22.871965 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:22.874628 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m16:01:22.876182 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"
[0m16:01:22.876704 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed
         as
        (-- Test removing columns.



select 1::int as col1, 'new'::varchar(10) as col2
union all
select 2, 'new'
        );
[0m16:01:24.040687 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:24.046299 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed (execute): 16:01:19.099980 => 16:01:24.045828
[0m16:01:24.047173 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed: Close
[0m16:01:24.946852 [info ] [Thread-1  ]: 4 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_removed  [[32mSUCCESS 1[0m in 5.85s]
[0m16:01:24.948632 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed
[0m16:01:24.949461 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m16:01:24.950321 [info ] [Thread-1  ]: 5 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed  [RUN]
[0m16:01:24.951460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_removed, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed)
[0m16:01:24.952286 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m16:01:24.957238 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m16:01:24.958476 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed (compile): 16:01:24.952735 => 16:01:24.958074
[0m16:01:24.959075 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m16:01:24.973103 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m16:01:24.973623 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
create or replace   view USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
  
   as (
    -- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
  );
[0m16:01:24.973990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:27.299264 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:01:27.307448 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m16:01:27.308252 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed
[0m16:01:27.727436 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m16:01:27.731465 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m16:01:27.731870 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
describe table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
[0m16:01:28.253661 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:01:28.264358 [debug] [Thread-1  ]: Applying DROP to: USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp
[0m16:01:28.266726 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m16:01:28.267360 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
drop view if exists USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed__dbt_tmp cascade
[0m16:01:28.738000 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:01:28.742140 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m16:01:28.744585 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"
[0m16:01:28.745259 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed
         as
        (-- Test renaming columns without altering the column count or types.



select 1::int as col1, 'new'::varchar(10) as col2renamed, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m16:01:29.753288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:29.758808 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed (execute): 16:01:24.959408 => 16:01:29.758371
[0m16:01:29.759605 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed: Close
[0m16:01:30.830482 [info ] [Thread-1  ]: 5 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_columns_renamed  [[32mSUCCESS 1[0m in 5.88s]
[0m16:01:30.832072 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed
[0m16:01:30.832744 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m16:01:30.833552 [info ] [Thread-1  ]: 6 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  [RUN]
[0m16:01:30.834849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_columns_renamed, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist)
[0m16:01:30.835520 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m16:01:30.842423 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
[0m16:01:30.843588 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist (compile): 16:01:30.835884 => 16:01:30.843279
[0m16:01:30.844074 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m16:01:30.855888 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
[0m16:01:30.856820 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"
[0m16:01:30.857185 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_table_does_not_exist
         as
        (-- Test what happens when no relation exists before running this model.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m16:01:30.857523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:33.594691 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:01:33.600739 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist (execute): 16:01:30.844359 => 16:01:33.600322
[0m16:01:33.601564 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist: Close
[0m16:01:34.450515 [info ] [Thread-1  ]: 6 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_table_does_not_exist  [[32mSUCCESS 1[0m in 3.61s]
[0m16:01:34.452126 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist
[0m16:01:34.452887 [debug] [Thread-1  ]: Began running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m16:01:34.453779 [info ] [Thread-1  ]: 7 of 7 START sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_was_a_view  [RUN]
[0m16:01:34.454970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_table_does_not_exist, now model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view)
[0m16:01:34.455583 [debug] [Thread-1  ]: Began compiling node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m16:01:34.460641 [debug] [Thread-1  ]: Writing injected SQL for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m16:01:34.461761 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view (compile): 16:01:34.455928 => 16:01:34.461457
[0m16:01:34.462231 [debug] [Thread-1  ]: Began executing node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m16:01:34.473572 [debug] [Thread-1  ]: Dropping relation "USER_DATA"."ARAFEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" because it is of type view
[0m16:01:34.478197 [debug] [Thread-1  ]: Applying DROP to: "USER_DATA"."ARAFEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW"
[0m16:01:34.479137 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m16:01:34.479498 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
drop view if exists "USER_DATA"."ARAFEY"."SNOWFLAKE_TIMETRAVEL_TABLE_INTEGRATION_TESTS_WAS_A_VIEW" cascade
[0m16:01:34.479821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:36.935907 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:01:36.938290 [debug] [Thread-1  ]: Writing runtime sql for node "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m16:01:36.940618 [debug] [Thread-1  ]: Using snowflake connection "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"
[0m16:01:36.941067 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view"} */
create or replace  table USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_was_a_view
         as
        (-- Test what happens when a relation for this model did pre-exist, but it ws a view instead of a table.



select 1::int as col1, 'new'::varchar(10) as col2, 'values'::varchar(20) as col3
union all
select 2, 'new', 'values'
        );
[0m16:01:38.250224 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:01:38.253864 [debug] [Thread-1  ]: Timing info for model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view (execute): 16:01:34.462508 => 16:01:38.253471
[0m16:01:38.254557 [debug] [Thread-1  ]: On model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view: Close
[0m16:01:39.093881 [info ] [Thread-1  ]: 7 of 7 OK created sql snowflake_timetravel_table model ARAFEY.snowflake_timetravel_table_integration_tests_was_a_view  [[32mSUCCESS 1[0m in 4.64s]
[0m16:01:39.094935 [debug] [Thread-1  ]: Finished running node model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view
[0m16:01:39.096858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:39.097233 [debug] [MainThread]: Connection 'model.snowflake_timetravel_table_integration_tests.snowflake_timetravel_table_integration_tests_was_a_view' was properly closed.
[0m16:01:39.097666 [info ] [MainThread]: 
[0m16:01:39.098077 [info ] [MainThread]: Finished running 7 snowflake_timetravel_table models in 0 hours 0 minutes and 51.70 seconds (51.70s).
[0m16:01:39.099641 [debug] [MainThread]: Command end result
[0m16:01:39.112889 [info ] [MainThread]: 
[0m16:01:39.113271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:39.113564 [info ] [MainThread]: 
[0m16:01:39.113862 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:01:39.115769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 52.637787, "process_user_time": 3.487949, "process_kernel_time": 0.173052, "process_mem_max_rss": "136511488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:39.116253 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:39.116148 after 52.64 seconds
[0m16:01:39.116532 [debug] [MainThread]: Flushing usage events


============================== 16:01:41.997905 | 0ab0a63f-e481-4045-9a14-573e684adc4f ==============================
[0m16:01:41.997905 [info ] [MainThread]: Running with dbt=1.7.10
[0m16:01:42.000550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../test_profile', 'log_path': '/Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../run_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test -m test_snowflake_timetravel_table_integration_tests_columns_no_change --project-dir /Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../run_project --profiles-dir /Users/abdul.rafey/Projects/edx/snowflake_timetravel_table/integration_tests/tests/../test_profile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m16:01:42.245182 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:01:42.257824 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m16:01:42.287418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:01:42.287796 [debug] [MainThread]: Partial parsing: updated file: snowflake_timetravel_table_integration_tests://tests/test_snowflake_timetravel_table_integration_tests_columns_no_change.sql
[0m16:01:42.374472 [info ] [MainThread]: Found 7 models, 1 test, 0 sources, 0 exposures, 0 metrics, 433 macros, 0 groups, 0 semantic models
[0m16:01:42.375143 [info ] [MainThread]: 
[0m16:01:42.375524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:01:42.376204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DATA_ARAFEY'
[0m16:01:42.384613 [debug] [ThreadPool]: Using snowflake connection "list_USER_DATA_ARAFEY"
[0m16:01:42.384804 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "connection_name": "list_USER_DATA_ARAFEY"} */
show terse objects in USER_DATA.ARAFEY limit 10000
[0m16:01:42.384993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:45.222010 [debug] [ThreadPool]: SQL status: SUCCESS 969 in 3.0 seconds
[0m16:01:45.249010 [debug] [ThreadPool]: On list_USER_DATA_ARAFEY: Close
[0m16:01:46.219463 [info ] [MainThread]: Concurrency: 1 threads (target='snowflake')
[0m16:01:46.219716 [info ] [MainThread]: 
[0m16:01:46.221751 [debug] [Thread-1  ]: Began running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:46.221982 [info ] [Thread-1  ]: 1 of 1 START test test_snowflake_timetravel_table_integration_tests_columns_no_change  [RUN]
[0m16:01:46.222331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_USER_DATA_ARAFEY, now test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change)
[0m16:01:46.222520 [debug] [Thread-1  ]: Began compiling node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:46.227166 [debug] [Thread-1  ]: Writing injected SQL for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:46.228114 [debug] [Thread-1  ]: Timing info for test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change (compile): 16:01:46.222635 => 16:01:46.227959
[0m16:01:46.228309 [debug] [Thread-1  ]: Began executing node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:46.240645 [debug] [Thread-1  ]: Writing runtime sql for node "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:46.241255 [debug] [Thread-1  ]: Using snowflake connection "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"
[0m16:01:46.241466 [debug] [Thread-1  ]: On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "integration_tests", "target_name": "snowflake", "node_id": "test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select *
from USER_DATA.ARAFEY.snowflake_timetravel_table_integration_tests_columns_no_change
at (timestamp => '2024-03-14T11:01:11.591323Z'::timestamp_tz)
where col2 = 'new'
      
    ) dbt_internal_test
[0m16:01:46.241666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:01:48.622690 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:01:48.635201 [debug] [Thread-1  ]: Timing info for test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change (execute): 16:01:46.228422 => 16:01:48.634787
[0m16:01:48.635832 [debug] [Thread-1  ]: On test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change: Close
[0m16:01:49.502264 [info ] [Thread-1  ]: 1 of 1 PASS test_snowflake_timetravel_table_integration_tests_columns_no_change  [[32mPASS[0m in 3.28s]
[0m16:01:49.503531 [debug] [Thread-1  ]: Finished running node test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change
[0m16:01:49.505579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:49.505983 [debug] [MainThread]: Connection 'test.snowflake_timetravel_table_integration_tests.test_snowflake_timetravel_table_integration_tests_columns_no_change' was properly closed.
[0m16:01:49.506384 [info ] [MainThread]: 
[0m16:01:49.506803 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 7.13 seconds (7.13s).
[0m16:01:49.507599 [debug] [MainThread]: Command end result
[0m16:01:49.519783 [info ] [MainThread]: 
[0m16:01:49.520202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:49.520504 [info ] [MainThread]: 
[0m16:01:49.520835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:01:49.522681 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.55996, "process_user_time": 1.753429, "process_kernel_time": 0.134342, "process_mem_max_rss": "130957312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:01:49.523197 [debug] [MainThread]: Command `dbt test` succeeded at 16:01:49.523087 after 7.56 seconds
[0m16:01:49.523533 [debug] [MainThread]: Flushing usage events
